var gridRenderer=function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=47)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=r(1),i=r(2),a=r(13),l=r(3),d=r(5),s=r(4),u=r(11),c=r(33);function g(e,t,r){if(null==e)throw Error(r+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}function f(e,t,r,n,o){for(var i=t,a=t+r-1;i<=a;){var l=i+(a-i>>1),d=o(e instanceof Array?e[l]:e.item(l),n);if(0===d)return l;d<0?i=l+1:a=l-1}return~i}function h(e,t){return e.Row===t.Row&&e.Col===t.Col?0:e.Row>t.Row||e.Row===t.Row&&e.Col>t.Col?1:-1}function m(e,t){var r;return C(e.Bold||!1,e.Italic||!1)+" "+(null!=(r=null!=t?t:e.Size)?r:a.DefaultFontSizePt)+"pt "+b(e.FontName)}function C(e,t){return e&&t?"bold italic":e?"bold":t?"italic":"normal"}function p(e){g(e,"model","initCellLookup"),g(e.Cells,"model.Cells","initCellLookup");for(var t={},r=0;r<e.Cells.length;r++){var n=e.Cells[r];if(n)if(t[i.cellLookupKey(n.Row,n.Col)]=n,n.Merge)for(var o=0;o<=n.Merge.Rows;o++)for(var a=0;a<=n.Merge.Columns;a++)t[i.cellLookupKey(n.Row+o,n.Col+a)]=n;else t[i.cellLookupKey(n.Row,n.Col)]=n}return t}function y(e,t,r){return g(r,"model","initCellLookup"),r.CellLookup||(r.CellLookup=p(r)),r.CellLookup[i.cellLookupKey(e,t)]}function v(e,t){return g(e,"cell","getCellStyle"),g(t.Styles,"Styles","getCellStyle"),e.CachedStyle||(e.CachedStyle=n.getReferencedObjectById(e.StyleID,t.Styles)),e.CachedStyle}function F(e){return e.CachedStyle.ShrinkToFit&&!e.WrapText}function w(e){if(F(e))return e.ShrunkSize}function T(e,t){return t&&!s.isNullOrUndefined(e)}function S(e,t,r){if(i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,r)&&t.TextRuns&&r.Fonts)return{Text:e,TextRuns:t.TextRuns,Fonts:r.Fonts}}function R(e,t){if(!D(e,t))return e.Text;if(s.isNullOrUndefined(e.CachedDisplayText))if(!s.isNullOrUndefined(e.Text)&&s.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(d.HardBreak)>=0){var r=S(e.Text,e,t);!s.isNullOrUndefined(r)&&r.Text.indexOf(d.HardBreak)>=0&&function(e,t){var r=e.TextRuns,n=e.Text;A(r,e);for(var o=0,i=0;i<r.length;i++){var a=r[i];g(a.EndIndex,"EndIndex","adjustHardBreakIndices"),g(a.StartIndex,"StartIndex ","adjustHardBreakIndices");var l=a.StartIndex,s=a.EndIndex;o!==l&&(s+=o-l,l=o);for(var u=l;u<s;u++)n.charAt(u)!==d.HardBreak||t.WrapText||s--;a.EndIndex=s,a.StartIndex=l,o=s}}(r,e),e.CachedDisplayText=I(e.Text)}else e.CachedDisplayText=e.Text;return e.CachedDisplayText}function x(e){var t="Custom Font";return a.knownFontNamesLowerCase.indexOf(e.replace(/\s/g,"").toLowerCase())>-1&&(t=e),t}function b(e){var t=e.indexOf("(Body)");return t>0?e.substring(0,t).trim():e}function I(e){return-1!==e.indexOf(d.HardBreakCRLF)||-1!==e.indexOf(d.HardBreak)?e.replace(/\r\n|\n/g,""):e}function A(e,t){var r;if(void 0===(null===(r=e[0])||void 0===r?void 0:r.EndIndex))for(var n=0;n<e.length;n++){var o=e[n],i=n<e.length-1?e[n+1].StartIndex:t.Text.length;o.EndIndex=i}}function D(e,t){return i.isRenderFlagEnabled(o.RenderFlags.NumFmtAccountingAndCustom,t)||!s.isNullOrUndefined(e.Text)&&s.isNullOrUndefined(e.WrapText)&&e.Text.indexOf(d.HardBreak)>=0}t.verifyArgumentNotNull=g,t.numbersComparer=function(e,t){return e-t},t.binarySearch=f,t.cellsPositionComparer=h,t.getDefaultCell=function(e,t,r,i){void 0===r&&(r=void 0),void 0===i&&(i=void 0);var a=r?n.getReferencedObjectById(o.UniqueStyleID.Default,r):void 0;return{Col:t,CachedStyle:a,CachedFont:i&&a?n.getReferencedObjectById(a.FontID,i):void 0,HorizontalAlignmentSet:!1,Ifmt:0,IfmtStamped:0,Row:e,StyleID:o.UniqueStyleID.Default,BorderStyleID:o.UniqueStyleID.DefaultBorder,Text:"",ValueType:o.CellValueType.None,CachedDrawingLayout:{UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}}}},t.getFontCssStringFromCell=function(e){return m(e.CachedFont,w(e))},t.getFontCssStringFromFont=m,t.getCellFontWeightStyle=C,t.throwError=function(e,t){throw Error(t+": "+e)},t.getLinePixelTranslation=function(e){return e/2},t.isCellAdjacentToMergedCell=function(e,t,r){g(r,"model","isCellAdjacentToMergedCell");for(var n=function(e,t,r){return[y(e-1,t,r),y(e+1,t,r),y(e,t-1,r),y(e,t+1,r)]}(e,t,r),o=0;o<n.length;o++)if(n[o]&&n[o].Merge)return!0;return!1},t.initCellLookup=p,t.getCell=y,t.getColumnWidth=function(e,t){if(g(t,"model","getColumnWidth"),g(t.ColumnWidths,"ColumnWidths","getColumnWidth"),e>t.ColumnWidths.length-1||e<0)throw Error("getColumnWidth: column width requested for a cell which is not in range of the model");return t.ColumnWidths[e]},t.getCellStyle=v,t.getCellFont=function(e,t){if(g(e,"cell","getCellFont"),g(t.Styles,"Styles","getCellFont"),g(t.Fonts,"Fonts","getCellFont"),!e.CachedFont){var r=v(e,t);e.CachedFont=n.getReferencedObjectById(r.FontID,t.Fonts)}return e.CachedFont},t.getCellPositionInArray=function(e,t){var r=f(t,0,t.length,e,h);return r<0&&(r=~r),r},t.cellHasShrinkToFit=F,t.getShrunkFontSize=w,t.getTextRunText=function(e,t,r){var n=t[e].StartIndex,o=r.length;return e<t.length-1&&(o=t[e+1].StartIndex),r.substring(n,o)},t.getActualFontSize=function(e){var t,r,n=F(e),o=n?e.ShrunkSize:e.CachedFont.Size;return o<0&&u.setActualFontSizeWarning("\n      actual font size < 0.\n      doesCellHaveShrinkToFit: "+n+",\n      cell.ShrunkSize: "+e.ShrunkSize+",\n      cell.CachedFont:\n        size: "+e.CachedFont.Size+";\n        fontName: "+x(e.CachedFont.FontName)+";\n        refCount: "+e.CachedFont.RefCount+";\n      cell.CachedStyle:\n        isHidden: "+(null===(t=e.CachedStyle)||void 0===t?void 0:t.IsHidden)+";\n        shrinkToFit: "+(null===(r=e.CachedStyle)||void 0===r?void 0:r.ShrinkToFit)+";\n      cell.Ifmt: "+e.Ifmt+";\n      cell.WrapText: "+e.WrapText+";\n    "),o},t.setCellCachedDisplayText=function(e,t){e.CachedDisplayText=t,e.CachedDrawingLayout.CellTextLayout.Width=void 0},t.getWorkbookBackgroundColor=function(e,t,r){return s.isNullOrUndefined(e)?T(t,r)?t:d.DefaultBackgroundColor:l.rgbToColorHex(e.BackgroundColor)},t.hasWorkbookBackgroundColor=T,t.isHighContrastMode=function(e){return!s.isNullOrUndefined(e.highContrastScheme)},t.getFormattedText=S,t.getDisplayText=R,t.getFontNameForLogging=x,t.updateCellText=function(e,t,r){t.Text=r,D(t,e)&&(t.CachedDisplayText=R(t,e)),i.isAccAndCustomNumFmtApplicable(t,e)?c.updateNumFmtFromCell(t):t.NumFmt=void 0},t.canonizeFontName=b,t.removeHardBreaks=I,t.prepareTextRunRanges=A},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.None=-1]="None",e[e.Sum=0]="Sum",e[e.Count=1]="Count",e[e.Average=2]="Average",e[e.Max=3]="Max",e[e.Min=4]="Min",e[e.Product=5]="Product",e[e.CountNumbers=6]="CountNumbers",e[e.StdDeviation=7]="StdDeviation",e[e.StdDeviationPercent=8]="StdDeviationPercent",e[e.Variant=9]="Variant",e[e.VariantPercent=10]="VariantPercent",e[e.DistinctCountPPM=11]="DistinctCountPPM",e[e.AggregationTypeMax=11]="AggregationTypeMax"}(t.PivotTableDataFieldAggregationType||(t.PivotTableDataFieldAggregationType={})),function(e){e[e.None=-1]="None",e[e.NoCalculation=0]="NoCalculation",e[e.DifferenceFrom=1]="DifferenceFrom",e[e.PercentOf=2]="PercentOf",e[e.PercentDifferenceFrom=3]="PercentDifferenceFrom",e[e.RunningTotalIn=4]="RunningTotalIn",e[e.PercentOfRowTotal=5]="PercentOfRowTotal",e[e.PercentOfColumnTotal=6]="PercentOfColumnTotal",e[e.PercentOfGrandTotal=7]="PercentOfGrandTotal",e[e.Index=8]="Index",e[e.PercentOfParentRowTotal=9]="PercentOfParentRowTotal",e[e.PercentOfParentColumnTotal=10]="PercentOfParentColumnTotal",e[e.PercentOfParentTotal=11]="PercentOfParentTotal",e[e.PercentRunningTotalIn=12]="PercentRunningTotalIn",e[e.RankSmallestToLargest=13]="RankSmallestToLargest",e[e.RankLargestToSmallest=14]="RankLargestToSmallest",e[e.DataFormatMax=14]="DataFormatMax"}(t.PivotTableDataFieldFormatType||(t.PivotTableDataFieldFormatType={})),function(e){e[e.Unknown=0]="Unknown",e[e.UsedRange=1]="UsedRange",e[e.PivotTable=2]="PivotTable",e[e.Hyperlink=3]="Hyperlink",e[e.Autofilter=4]="Autofilter",e[e.DataValidation=5]="DataValidation",e[e.Sparkline=6]="Sparkline",e[e.FloatingObjectAnchor=7]="FloatingObjectAnchor",e[e.DynamicArray=8]="DynamicArray",e[e.AutoDetect=9]="AutoDetect"}(t.RangeType||(t.RangeType={})),function(e){e[e.Vertical=0]="Vertical",e[e.Horizontal=1]="Horizontal",e[e.ReversedVertical=2]="ReversedVertical",e[e.ReversedHorizontal=3]="ReversedHorizontal",e[e.DiagonalUp=4]="DiagonalUp",e[e.DiagonalDown=5]="DiagonalDown",e[e.ReversedDiagonalUp=6]="ReversedDiagonalUp",e[e.ReversedDiagonalDown=7]="ReversedDiagonalDown",e[e.TopLeftCorner=8]="TopLeftCorner",e[e.TopRightCorner=9]="TopRightCorner",e[e.BottomLeftCorner=10]="BottomLeftCorner",e[e.BottomRightCorner=11]="BottomRightCorner",e[e.Center=12]="Center"}(t.GradientShadingStyle||(t.GradientShadingStyle={})),function(e){e[e.Solid=0]="Solid",e[e.Gradient=1]="Gradient"}(t.BackgroundFillType||(t.BackgroundFillType={})),function(e){e[e.Context=0]="Context",e[e.LeftToRight=1]="LeftToRight",e[e.RightToLeft=2]="RightToLeft"}(t.ReadingOrderType||(t.ReadingOrderType={})),function(e){e[e.Automatic=0]="Automatic",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Fill=4]="Fill",e[e.Justify=5]="Justify",e[e.CenterAcrossSelection=6]="CenterAcrossSelection",e[e.Distributed=7]="Distributed",e[e.JustifyDistributed=8]="JustifyDistributed"}(t.HorizontalAlignment||(t.HorizontalAlignment={})),function(e){e[e.Top=0]="Top",e[e.Center=1]="Center",e[e.Bottom=2]="Bottom",e[e.Justify=3]="Justify",e[e.Distributed=4]="Distributed"}(t.VerticalAlignment||(t.VerticalAlignment={})),function(e){e[e.DefaultBorder=0]="DefaultBorder",e[e.Default=-1]="Default",e[e.Hyperlink=-2]="Hyperlink",e[e.FormulaError=-3]="FormulaError"}(t.UniqueStyleID||(t.UniqueStyleID={})),function(e){e[e.None=0]="None",e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=3]="Boolean",e[e.Error=4]="Error"}(t.CellValueType||(t.CellValueType={})),function(e){e[e.Value=0]="Value",e[e.Formula=1]="Formula",e[e.ArrayFormula=2]="ArrayFormula"}(t.CellFormulaType||(t.CellFormulaType={})),function(e){e[e.None=0]="None",e[e.Filtered=1]="Filtered",e[e.SortedAsc=2]="SortedAsc",e[e.SortedDesc=3]="SortedDesc",e[e.SortedTop=4]="SortedTop",e[e.SortedBottom=5]="SortedBottom",e[e.BothAsc=6]="BothAsc",e[e.BothDesc=7]="BothDesc",e[e.BothTop=8]="BothTop",e[e.BothBottom=9]="BothBottom",e[e.Sorted=10]="Sorted",e[e.Both=11]="Both"}(t.AutoFilterType||(t.AutoFilterType={})),function(e){e[e.None=0]="None",e[e.CData=1]="CData"}(t.CellsEncoding||(t.CellsEncoding={})),function(e){e[e.None=0]="None",e[e.HasErrorRefactoring=1]="HasErrorRefactoring",e[e.EmptyPivotTable=8]="EmptyPivotTable",e[e.DataBars=32]="DataBars",e[e.GradientFill=64]="GradientFill",e[e.Hyperlink=128]="Hyperlink",e[e.Sparklines=256]="Sparklines",e[e.RichTextFormat=1024]="RichTextFormat",e[e.MeasureTextRefactor=2048]="MeasureTextRefactor",e[e.FixImmediateSetRichTextCell=4096]="FixImmediateSetRichTextCell",e[e.AdvancedTextMetrics=8192]="AdvancedTextMetrics",e[e.MeasureTextAfterFontDownload=131072]="MeasureTextAfterFontDownload",e[e.NumFmtAccountingAndCustom=262144]="NumFmtAccountingAndCustom",e[e.NumFmtAndWrapText=524288]="NumFmtAndWrapText",e[e.ThaiLineBreaking=2097152]="ThaiLineBreaking",e[e.CFIcons=4194304]="CFIcons",e[e.GridLineColor=8388608]="GridLineColor",e[e.WorkbookBackgroundColor=16777216]="WorkbookBackgroundColor",e[e.AdvHorizontalAlignmentFillAndCAS=33554432]="AdvHorizontalAlignmentFillAndCAS",e[e.AdvHorizontalAlignmentJustifyAndDistributed=67108864]="AdvHorizontalAlignmentJustifyAndDistributed",e[e.PageBreaks=134217728]="PageBreaks",e[e.TextBaselineRefactor=268435456]="TextBaselineRefactor",e[e.PrintArea=536870912]="PrintArea",e[e.CFIconsHighContrast=1073741824]="CFIconsHighContrast"}(t.RenderFlags||(t.RenderFlags={})),function(e){e[e.None=0]="None",e[e.Flyout=1]="Flyout",e[e.Toggle=2]="Toggle",e[e.Button=3]="Button"}(t.MenuItemType||(t.MenuItemType={})),function(e){e[e.None=0]="None",e[e.Thin=1]="Thin",e[e.Medium=2]="Medium",e[e.Dashed=3]="Dashed",e[e.Dotted=4]="Dotted",e[e.Thick=5]="Thick",e[e.Double=6]="Double",e[e.Hair=7]="Hair",e[e.MediumDashed=8]="MediumDashed",e[e.DashDot=9]="DashDot",e[e.MediumDashDot=10]="MediumDashDot",e[e.DashDotDot=11]="DashDotDot",e[e.MediumDashDotDot=12]="MediumDashDotDot",e[e.SlantDashDot=13]="SlantDashDot"}(t.BorderLineType||(t.BorderLineType={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Diagonal=4]="Diagonal",e[e.Vertical=5]="Vertical",e[e.Horizontal=6]="Horizontal",e[e.BorderMax=7]="BorderMax"}(t.BorderPositionType||(t.BorderPositionType={})),function(e){e[e.None=0]="None",e[e.Single=1]="Single",e[e.Double=2]="Double",e[e.SingleAccounting=3]="SingleAccounting",e[e.DoubleAccounting=4]="DoubleAccounting"}(t.FontUnderline||(t.FontUnderline={})),function(e){e[e.None=0]="None",e[e.Subscript=1]="Subscript",e[e.Superscript=2]="Superscript"}(t.FontVerticalAlignment||(t.FontVerticalAlignment={})),function(e){e[e.None=0]="None",e[e.Expanded=1]="Expanded",e[e.Collapsed=2]="Collapsed"}(t.OutlineState||(t.OutlineState={})),function(e){e[e.None=0]="None",e[e.CustomSort=1]="CustomSort",e[e.Filter=2]="Filter",e[e.SheetViewDefault=3]="SheetViewDefault",e[e.SheetViewTemp=4]="SheetViewTemp",e[e.SheetViewSwitch=5]="SheetViewSwitch",e[e.SheetViewMoreViews=6]="SheetViewMoreViews",e[e.SheetViewCreate=7]="SheetViewCreate",e[e.SheetViewOptions=8]="SheetViewOptions",e[e.GenericScript=9]="GenericScript",e[e.ClearFilter=10]="ClearFilter",e[e.ShowRichFieldsList=11]="ShowRichFieldsList",e[e.ShowPivotFilter=12]="ShowPivotFilter",e[e.SortByValue=13]="SortByValue",e[e.SortAscending=14]="SortAscending",e[e.SortDescending=15]="SortDescending",e[e.FieldListToReportFilter=16]="FieldListToReportFilter",e[e.FieldListToRowLabels=17]="FieldListToRowLabels",e[e.FieldListToColumnLabels=18]="FieldListToColumnLabels",e[e.FieldListToValues=19]="FieldListToValues",e[e.FieldListAddAsSlicer=20]="FieldListAddAsSlicer",e[e.RemoveFilter=21]="RemoveFilter",e[e.FilterType=22]="FilterType",e[e.FilterPivot=23]="FilterPivot",e[e.FilterSubMenu=24]="FilterSubMenu",e[e.FieldSubMenu=25]="FieldSubMenu",e[e.SheetViewSubMenu=26]="SheetViewSubMenu",e[e.GenericSortAscending=27]="GenericSortAscending",e[e.GenericSortDescending=28]="GenericSortDescending",e[e.RemovePivotFilter=29]="RemovePivotFilter"}(t.MenuEntryIdentifier||(t.MenuEntryIdentifier={})),function(e){e[e.None=0]="None",e[e.AmbiguousLinkedEntity=1]="AmbiguousLinkedEntity",e[e.ConnectedLinkedEntityBlocked=2]="ConnectedLinkedEntityBlocked",e[e.ConnectedLinkedEntityNotBlocked=3]="ConnectedLinkedEntityNotBlocked",e[e.DisconnectedLinkedEntity=4]="DisconnectedLinkedEntity",e[e.RichError=5]="RichError",e[e.ImageUrl=6]="ImageUrl",e[e.OtherRichValue=7]="OtherRichValue"}(t.RichValueCellType||(t.RichValueCellType={})),function(e){e[e.ThreeArrowsColored=0]="ThreeArrowsColored",e[e.ThreeArrowsGray=1]="ThreeArrowsGray",e[e.ThreeFlags=2]="ThreeFlags",e[e.ThreeTrafficLightsUnrimmed=3]="ThreeTrafficLightsUnrimmed",e[e.ThreeTrafficLightsRimmed=4]="ThreeTrafficLightsRimmed",e[e.ThreeSigns=5]="ThreeSigns",e[e.ThreeSymbolsCircled=6]="ThreeSymbolsCircled",e[e.ThreeSymbolsUncircled=7]="ThreeSymbolsUncircled",e[e.FourArrowsColored=8]="FourArrowsColored",e[e.FourArrowsGray=9]="FourArrowsGray",e[e.RedToBlack=10]="RedToBlack",e[e.FourRatings=11]="FourRatings",e[e.FourTrafficLights=12]="FourTrafficLights",e[e.FiveArrowsColored=13]="FiveArrowsColored",e[e.FiveArrowsGray=14]="FiveArrowsGray",e[e.FiveRatings=15]="FiveRatings",e[e.FiveQuarters=16]="FiveQuarters",e[e.ThreeStarts=17]="ThreeStarts",e[e.ThreeTriangles=18]="ThreeTriangles",e[e.FiveBoxes=19]="FiveBoxes"}(t.CFIconSet||(t.CFIconSet={})),function(e){e[e.Line=0]="Line",e[e.Column=1]="Column",e[e.Stacked=2]="Stacked"}(t.SparklineType||(t.SparklineType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(10),o=r(1),i=r(4),a=r(52);function l(e,t){return 0!=(e&t.RenderFlags)}function d(e,t){return!!s(e)&&(l(o.RenderFlags.NumFmtAccountingAndCustom,t)&&e.Ifmt>=a.NumFmtAccountingStartIndex&&!i.isNullOrUndefined(e.NumFmt)&&""!==e.Text)}function s(e){return e.ValueType===o.CellValueType.Number}t.cellLookupKey=function(e,t){return t+"_"+e},t.getReferencedObjectToCache=function(e,t){if(!i.isNullOrUndefined(e)&&!i.isNullOrUndefined(t))return n.getReferencedObjectById(e,t)},t.isRenderFlagEnabled=l,t.doesNumFmtOverrideText=function(e,t){return!!s(e)&&(l(o.RenderFlags.NumFmtAndWrapText,t)&&""!==e.WrapText&&""!==e.Text||d(e,t))},t.isAccAndCustomNumFmtApplicable=d,t.verifyArgumentNotNull=function(e,t,r){if(null==e)throw Error(r+".verifyArgumentNotNull: "+t+" cannot be null or undefined")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(5),i=r(4),a=r(2),l={},d={},s={};function u(e){for(var t=Number(e).toString(16);t.length<6;)t="0"+t;return"#"+t}function c(e,t,r,n,o){e.beginPath(),e.rect(t,r,n,o),e.stroke(),e.clip()}function g(e,t,r,n){return!(t<r||n<e)}function f(e){var t=e.charCodeAt(0);return t>=1424&&t<=1535||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=64336&&t<=65023||t>=65136&&t<=65279||t>=1984&&t<=1792||t>=1792&&t<=1871||t>=1920&&t<=1983||t>=11568&&t<=11647}t.getDefaultBorderLineWidth=function(e){return i.isNullOrUndefined(l[e])?(l[e]=Math.max(Math.round(e),1),l[e]):l[e]},t.rgbToColorHex=u,t.getColWidthFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getColWidthFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getRowHeightFromOffsets=function(e,t){if(e<0||e>t.length-1)throw"getRowHeightFromOffsets:: invalid colIndex "+e;return t[e+1]-t[e]},t.getBlockDimensionsAdjustedForDrawing=function(e,t){return Math.round(e*t)},t.isSafari=function(){if(window&&window.navigator){var e=window.navigator.userAgent.toLowerCase();return e.indexOf("safari")>=0&&e.indexOf("chrome")<0&&e.indexOf("edge")<0}return!1},t.getTextDrawingMaxWidth=function(e,t,r){return Math.max(0,e-o.GridLineWidthPx-t-r)},t.getContainerClipMaskWidth=function(e){return e-o.GridLineWidthPx},t.drawClipRect=c,t.applyClipping=function(e,t){t&&(e.save(),e.strokeStyle="transparent",c(e,t.x,t.y,t.width,t.height))},t.restoreClipping=function(e,t){t&&e.restore()},t.drawLine=function(e,t,r,n,o){e.moveTo(t,r),e.lineTo(n,o)},t.hexToRgb=function(e){var t="#"===e[0]?e.substr(1):e,r=parseInt(t,16);return{Red:r>>16&255,Green:r>>8&255,Blue:255&r}},t.cellIntersectsRenderingRegion=function(e,t){var r=e.Row,n=e.Row,o=e.Col,i=e.Col;e.Merge?(n+=e.Merge.Rows,i+=e.Merge.Columns,e.Merge.SpansBlocks&&(e.Merge.OriginDeltaX&&(o=0),e.Merge.OriginDeltaY&&(r=0))):e.Spill&&(o-=e.Spill.SpanToStart,i+=e.Spill.SpanToEnd);var a=g(o,i,t.startColumn,t.endColumn),l=g(r,n,t.startRow,t.endRow);return a&&l},t.shouldRenderGridLines=function(e,t){return e||!t},t.getColOffsetsAdjustedForDrawing=function(e,t){var r=t.ColOffsetsAdjustedForDrawing[t.ColOffsetsAdjustedForDrawing.length-1];return t.IsRtl?r-t.ColOffsetsAdjustedForDrawing[e+1]:t.ColOffsetsAdjustedForDrawing[e]},t.isRtlChar=f,t.isStartLineRtl=function(e){return!i.isNullOrUndefined(e)&&""!==e&&f(e[0])},t.getHighContrastTextColor=function(e,t,r){return a.isRenderFlagEnabled(n.RenderFlags.Hyperlink,e)&&!i.isNullOrUndefined(t.Hyperlink)?function(e){d[e]||(d[e]=u(e));return d[e]}(r.LinkColor):function(e){s[e]||(s[e]=u(e));return s[e]}(r.TextColor)}},function(e,t,r){(function(e){var n=Object.getOwnPropertyDescriptors||function(e){for(var t=Object.keys(e),r={},n=0;n<t.length;n++)r[t[n]]=Object.getOwnPropertyDescriptor(e,t[n]);return r},o=/%[sdj%]/g;t.format=function(e){if(!p(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(l(arguments[r]));return t.join(" ")}r=1;for(var n=arguments,i=n.length,a=String(e).replace(o,(function(e){if("%%"===e)return"%";if(r>=i)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}})),d=n[r];r<i;d=n[++r])m(d)||!F(d)?a+=" "+d:a+=" "+l(d);return a},t.deprecate=function(r,n){if(void 0!==e&&!0===e.noDeprecation)return r;if(void 0===e)return function(){return t.deprecate(r,n).apply(this,arguments)};var o=!1;return function(){if(!o){if(e.throwDeprecation)throw new Error(n);e.traceDeprecation?console.trace(n):console.error(n),o=!0}return r.apply(this,arguments)}};var i,a={};function l(e,r){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),h(r)?n.showHidden=r:r&&t._extend(n,r),y(n.showHidden)&&(n.showHidden=!1),y(n.depth)&&(n.depth=2),y(n.colors)&&(n.colors=!1),y(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=d),u(n,e,n.depth)}function d(e,t){var r=l.styles[t];return r?"["+l.colors[r][0]+"m"+e+"["+l.colors[r][1]+"m":e}function s(e,t){return e}function u(e,r,n){if(e.customInspect&&r&&S(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var o=r.inspect(n,e);return p(o)||(o=u(e,o,n)),o}var i=function(e,t){if(y(t))return e.stylize("undefined","undefined");if(p(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}if(C(t))return e.stylize(""+t,"number");if(h(t))return e.stylize(""+t,"boolean");if(m(t))return e.stylize("null","null")}(e,r);if(i)return i;var a=Object.keys(r),l=function(e){var t={};return e.forEach((function(e,r){t[e]=!0})),t}(a);if(e.showHidden&&(a=Object.getOwnPropertyNames(r)),T(r)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return c(r);if(0===a.length){if(S(r)){var d=r.name?": "+r.name:"";return e.stylize("[Function"+d+"]","special")}if(v(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(w(r))return e.stylize(Date.prototype.toString.call(r),"date");if(T(r))return c(r)}var s,F="",R=!1,x=["{","}"];(f(r)&&(R=!0,x=["[","]"]),S(r))&&(F=" [Function"+(r.name?": "+r.name:"")+"]");return v(r)&&(F=" "+RegExp.prototype.toString.call(r)),w(r)&&(F=" "+Date.prototype.toUTCString.call(r)),T(r)&&(F=" "+c(r)),0!==a.length||R&&0!=r.length?n<0?v(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special"):(e.seen.push(r),s=R?function(e,t,r,n,o){for(var i=[],a=0,l=t.length;a<l;++a)A(t,String(a))?i.push(g(e,t,r,n,String(a),!0)):i.push("");return o.forEach((function(o){o.match(/^\d+$/)||i.push(g(e,t,r,n,o,!0))})),i}(e,r,n,l,a):a.map((function(t){return g(e,r,n,l,t,R)})),e.seen.pop(),function(e,t,r){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1];return r[0]+t+" "+e.join(", ")+" "+r[1]}(s,F,x)):x[0]+F+x[1]}function c(e){return"["+Error.prototype.toString.call(e)+"]"}function g(e,t,r,n,o,i){var a,l,d;if((d=Object.getOwnPropertyDescriptor(t,o)||{value:t[o]}).get?l=d.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):d.set&&(l=e.stylize("[Setter]","special")),A(n,o)||(a="["+o+"]"),l||(e.seen.indexOf(d.value)<0?(l=m(r)?u(e,d.value,null):u(e,d.value,r-1)).indexOf("\n")>-1&&(l=i?l.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+l.split("\n").map((function(e){return"   "+e})).join("\n")):l=e.stylize("[Circular]","special")),y(a)){if(i&&o.match(/^\d+$/))return l;(a=JSON.stringify(""+o)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=e.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=e.stylize(a,"string"))}return a+": "+l}function f(e){return Array.isArray(e)}function h(e){return"boolean"==typeof e}function m(e){return null===e}function C(e){return"number"==typeof e}function p(e){return"string"==typeof e}function y(e){return void 0===e}function v(e){return F(e)&&"[object RegExp]"===R(e)}function F(e){return"object"==typeof e&&null!==e}function w(e){return F(e)&&"[object Date]"===R(e)}function T(e){return F(e)&&("[object Error]"===R(e)||e instanceof Error)}function S(e){return"function"==typeof e}function R(e){return Object.prototype.toString.call(e)}function x(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(r){if(y(i)&&(i=Object({NODE_ENV:"production"}).NODE_DEBUG||""),r=r.toUpperCase(),!a[r])if(new RegExp("\\b"+r+"\\b","i").test(i)){var n=e.pid;a[r]=function(){var e=t.format.apply(t,arguments);console.error("%s %d: %s",r,n,e)}}else a[r]=function(){};return a[r]},t.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=f,t.isBoolean=h,t.isNull=m,t.isNullOrUndefined=function(e){return null==e},t.isNumber=C,t.isString=p,t.isSymbol=function(e){return"symbol"==typeof e},t.isUndefined=y,t.isRegExp=v,t.isObject=F,t.isDate=w,t.isError=T,t.isFunction=S,t.isPrimitive=function(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=r(50);var b=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function I(){var e=new Date,t=[x(e.getHours()),x(e.getMinutes()),x(e.getSeconds())].join(":");return[e.getDate(),b[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",I(),t.format.apply(t,arguments))},t.inherits=r(51),t._extend=function(e,t){if(!t||!F(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e};var D="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function M(e,t){if(!e){var r=new Error("Promise was rejected with a falsy value");r.reason=e,e=r}return t(e)}t.promisify=function(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(D&&e[D]){var t;if("function"!=typeof(t=e[D]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,D,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,r,n=new Promise((function(e,n){t=e,r=n})),o=[],i=0;i<arguments.length;i++)o.push(arguments[i]);o.push((function(e,n){e?r(e):t(n)}));try{e.apply(this,o)}catch(e){r(e)}return n}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),D&&Object.defineProperty(t,D,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,n(e))},t.promisify.custom=D,t.callbackify=function(t){if("function"!=typeof t)throw new TypeError('The "original" argument must be of type Function');function r(){for(var r=[],n=0;n<arguments.length;n++)r.push(arguments[n]);var o=r.pop();if("function"!=typeof o)throw new TypeError("The last argument must be of type Function");var i=this,a=function(){return o.apply(i,arguments)};t.apply(this,r).then((function(t){e.nextTick(a,null,t)}),(function(t){e.nextTick(M,t,a)}))}return Object.setPrototypeOf(r,Object.getPrototypeOf(t)),Object.defineProperties(r,n(t)),r}}).call(this,r(49))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.DefaultGridlineColor="#d4d4d4",t.PageLayoutLineColor="#9e9e9e",t.MinimalDprForGridlinesRendering=.4,t.InCellHorizontalPaddingPx=2,t.InCellEndOfTextHorizontalPaddingPx=2,t.InCellBottomAndCenterVerticalPaddingPx=1,t.InCellIndentPaddingPx=9,t.InCellDoubleBorderVerticalPaddingPx=-1,t.TextLineHeightPx=20,t.GridLineWidthPx=1,t.DefaultBackgroundColor="#ffffff",t.DefaultCellFontColor="#000000",t.EmptyLine={text:"",width:0,underlineWidth:0},t.EmptyFormattedText={Text:"",Fonts:[],TextRuns:[]},t.EmptyLineTextToken={tokens:[{text:"",width:0,start:0}]},t.RightHorizontalAlignmentItalicExtraPadding=3,t.Whitespace=" ",t.HardBreak="\n",t.HardBreakCR="\r",t.HardBreakCRLF="\r\n",t.ThinBorderWeight=1,t.MediumBorderWeight=2,t.DefaultDash=[],t.ColoredGridLineDash=[1,1],t.DottedLineDash=[2,2],t.DashedLineDash=[6,2],t.DashedDotLineDash=[9,3,3,3],t.DashedDotDotLineDash=[9,3,3,3,3,3],t.MediumDashedLineDash=[9,3],t.MediumDotDashedLineDash=[9,3,3,3],t.UnderlineLineWidth=1,t.UnderlineMarginFromTextBaseline=1,t.SkeletonColor="#E4E4E4",t.FontHeightToBaselineGapRatio=.22;var o={Red:255,Green:0,Blue:0};t.FormulaErrorBackgroundColor="#FFFFFF",t.FormulaErrorFontColor="#000000",t.FormulaErrorBorderStyle={Borders:[{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Top,Color:o,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Bottom,Color:o,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Left,Color:o,Weight:2},{BorderLineStyle:n.BorderLineType.Dashed,BorderPosition:n.BorderPositionType.Right,Color:o,Weight:2}],ID:n.UniqueStyleID.FormulaError,RefCount:0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(3),i=r(5),a=r(4);function l(e,t,r){if(n.verifyArgumentNotNull(t,"cell","getCellWidth"),n.verifyArgumentNotNull(e,"model","getCellWidth"),n.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","getCellWidth"),t.Merge){if(t.Merge.SpansBlocks&&!r)return t.Merge.Width;n.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","getCellWidth");var o=t.Col+t.Merge.Columns,i=e.ColumnOffsets[t.Col];return e.ColumnOffsets[o]+e.ColumnWidths[o]-i}return e.ColumnWidths[t.Col]}function d(e,t,r){if(n.verifyArgumentNotNull(t,"cell","getCellHeight"),n.verifyArgumentNotNull(e,"model","getCellHeight"),n.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","getCellHeight"),t.Merge){if(t.Merge.SpansBlocks&&!r)return t.Merge.Height;n.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","getCellHeight");var o=t.Row+t.Merge.Rows,i=e.RowOffsets[t.Row];return e.RowOffsets[o]+e.RowHeights[o]-i}return e.RowHeights[t.Row]}function s(e,t){var r=e.RowOffsets[t.Row];return t.Merge&&t.Merge.SpansBlocks&&(r-=t.Merge.OriginDeltaY),r}function u(e,t){if(n.verifyArgumentNotNull(e,"model","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(e.ColOffsetsAdjustedForDrawing,"model.ColOffsetsAdjustedForDrawing","getCellWidthAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellWidthAdjustedForDrawing"),t.Merge){if(t.Merge.SpansBlocks)return t.Merge.WidthAdjustedForDrawing;var r=t.Col+t.Merge.Columns,i=e.ColOffsetsAdjustedForDrawing[t.Col];return e.ColOffsetsAdjustedForDrawing[r+1]-i}return o.getColWidthFromOffsets(t.Col,e.ColOffsetsAdjustedForDrawing)}function c(e,t){if(n.verifyArgumentNotNull(e,"model","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(e.RowOffsetsAdjustedForDrawing,"model.RowOffsetsAdjustedForDrawing","getCellHeightAdjustedForDrawing"),n.verifyArgumentNotNull(t,"cell","getCellHeightAdjustedForDrawing"),t.Merge){if(t.Merge.SpansBlocks)return t.Merge.HeightAdjustedForDrawing;var r=t.Row+t.Merge.Rows,i=e.RowOffsetsAdjustedForDrawing[t.Row];return e.RowOffsetsAdjustedForDrawing[r+1]-i}return o.getRowHeightFromOffsets(t.Row,e.RowOffsetsAdjustedForDrawing)}function g(e,t,r){var n=t.Col,o=0;return t.Merge&&(e.IsRtl&&!r&&(n+=t.Merge.Columns),t.Merge.SpansBlocks&&(o=t.Merge.OriginDeltaXAdjustedForDrawing)),!e.IsRtl||r?e.ColOffsetsAdjustedForDrawing[n]-o:f(e,t)-u(e,t)+i.GridLineWidthPx}function f(e,t){var r=e.ColOffsetsAdjustedForDrawing,n=r.length-1,o=t.Col;if(!e.IsRtl)return g(e,t,!1)+u(e,t)-i.GridLineWidthPx;var a=t.Merge&&t.Merge.SpansBlocks?t.Merge.OriginDeltaXAdjustedForDrawing:0;return r[n]+a-r[o]}function h(e,t){var r=0;return t.Merge&&t.Merge.SpansBlocks&&(r=t.Merge.OriginDeltaYAdjustedForDrawing),e.RowOffsetsAdjustedForDrawing[t.Row]-r}function m(e,t){var r=t.ColumnOffsets[C(e)],o=function(e,t){return n.verifyArgumentNotNull(t.ColumnNumbers,"model.ColumnNumbers","spillCell.getSpillCellEndCol"),Math.min(t.ColumnNumbers.length-1,e.Col+e.Spill.SpanToEnd)}(e,t),i=t.ColumnOffsets[o];return t.ColumnWidths[o]+Math.abs(i-r)}function C(e){return Math.max(0,e.Col-e.Spill.SpanToStart)}t.getCellWidth=l,t.getCellHeight=d,t.getCellLeft=function(e,t,r){var n=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(n-=t.Merge.OriginDeltaX),e.IsRtl?r-n-l(e,t,!1)+i.GridLineWidthPx:n},t.getCellRight=function(e,t,r){var n=e.ColumnOffsets[t.Col];return t.Merge&&t.Merge.SpansBlocks&&(n-=t.Merge.OriginDeltaX),e.IsRtl?r-n:n+l(e,t,!1)-i.GridLineWidthPx},t.getCellBottom=function(e,t){return s(e,t)+d(e,t,!1)},t.getCellTop=s,t.getCellCenterY=function(e,t){return s(e,t)+d(e,t,!1)/2-i.GridLineWidthPx/2},t.getCellWidthAdjustedForDrawing=u,t.getCellHeightAdjustedForDrawing=c,t.getCellLeftAdjustedForDrawing=g,t.getCellRightAdjustedForDrawing=f,t.getCellBottomAdjustedForDrawing=function(e,t){return h(e,t)+c(e,t)},t.getCellCenterYAdjustedForDrawing=function(e,t){return h(e,t)+c(e,t)/2},t.getCellCenterXAdjustedForDrawing=function(e,t){return(f(e,t)+g(e,t,!1))/2},t.getCellTopAdjustedForDrawing=h,t.isCellSpansMultipleRowsOrBlocks=function(e){return!a.isNullOrUndefined(e.Merge)&&(e.Merge.Rows>0||!0===e.Merge.SpansBlocks)},t.getSpillCellWidth=m,t.getSpillCellStartOffset=function(e,t){var r=t.ColumnOffsets[C(e)];return t.IsRtl?t.BlockWidth-m(e,t)-r+1:r},t.getCellDimensionsAdjustedForDrawing=function(e,t,r){return{x:g(e,t,r)-i.GridLineWidthPx,y:h(e,t)-i.GridLineWidthPx,width:u(e,t)+i.GridLineWidthPx,height:c(e,t)+i.GridLineWidthPx}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24),o=r(1),i=r(2),a=r(5),l=r(13),d=r(4),s=r(0),u=r(25),c=r(35),g=r(36),f=r(10),h=r(15),m=r(16),C=r(18),p=r(6),y=r(37),v=!0,F={},w={};function T(e,t,r){if(!t)return 0;if(r&&v){var n=t.trim(),o=e.measureText(n);if(!d.isNullOrUndefined(o.actualBoundingBoxLeft)&&!d.isNullOrUndefined(o.actualBoundingBoxRight)){var i=Math.abs(o.actualBoundingBoxRight)+Math.abs(o.actualBoundingBoxLeft),a=t.length-n.length,l=0;if(a>0)l=a*e.measureText(" ").width;return i+l}v=!1}return R(e,t)}function S(e,t){var r=j(e,t),n=e.IsRtl?a.GridLineWidthPx:0;return p.getCellLeft(e,t,e.BlockWidth)+r+(p.getCellWidth(e,t,!1)-r)/2-n}function R(e,t){return e.measureText(t).width}function x(e){return e*a.InCellIndentPaddingPx}function b(e,t,r,n,i,a){var l=x(n),d=g.CalibriRegularPadding;switch(t){case o.HorizontalAlignment.Automatic:case o.HorizontalAlignment.Left:return l+c.approximateValue(e,d)+a;case o.HorizontalAlignment.Right:return r&&(d=g.CalibriItalicPadding),l+c.approximateValue(e,d);case o.HorizontalAlignment.Center:case o.HorizontalAlignment.CenterAcrossSelection:return i?c.approximateValue(e,d):0;default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+t)}}function I(e,t){return u.getCachedFontMetrics(t,e).height}function A(e,t){var r=I(e,t);return Math.ceil(r*l.LineHeightUsingDivFontFactor)}function D(e,t,r,n){return e+r-Math.round(t*l.LineLeading)+n}function M(e,t,r){var n=Math.round(t*l.LineLeading*1.5)-a.InCellBottomAndCenterVerticalPaddingPx-r;return e-Math.max(n,1)}function k(e,t,r,n,o,i){return o?function(e,t,r){return O(e+t,r)}(e,r,i):D(e,t,r,n)}function L(e,t,r,n,o){return n?function(e,t){return O(e,t)}(e,o):M(e,t,r)}function P(e,t,r,n,o,i,d){return i?function(e,t,r,n){var o=t+a.GridLineWidthPx;return O(e-(o-r)/2,n)}(e,t,n,d):function(e,t,r,n,o){var i=t+a.GridLineWidthPx,d=Math.round(r*(l.LineLeading/2));return e-(i-n-d)/2-r/2+o+a.InCellBottomAndCenterVerticalPaddingPx}(e,t,r,n,o)}function O(e,t){return e-l.LineHeightBottomConstantPx-t}function N(e,t,r){r.CachedDrawingLayout||(r.CachedDrawingLayout={CellTextLayout:{}}),r.CachedDisplayText||s.updateCellText(t,r,r.Text);var n=r.TextRuns&&i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,t);if(r.CachedDrawingLayout.CellTextLayout.Width){if(n&&!r.CachedDrawingLayout.TextRunDrawingInformation)throw"getTextWidthInternal: TextRunsDrawingData is supposed to be defined";return{width:r.CachedDrawingLayout.CellTextLayout.Width,textRunsDrawingInformation:r.CachedDrawingLayout.TextRunDrawingInformation}}var a=i.isRenderFlagEnabled(o.RenderFlags.AdvancedTextMetrics,t),l=s.getDisplayText(r,t);if(n){var d=E(r),u=B(e,r.TextRuns,r.Text,d);return{width:u.totalWidth,textRunsDrawingInformation:u.textRunsDrawingInformation}}return{width:T(e,l,a)}}function B(e,t,r,o){var i=e.textAlign;e.textAlign="left";var a=0,l=[],d=t;void 0!==o&&o.HasBidi&&(d=h.prepareTextRunsForBidiLayout(t,r));for(var u=0;u<d.length;u++){var c=d[u],g={FontID:c.FontID,StartIndex:c.StartIndex},f=s.getTextRunText(u,d,r),m=c.CachedFont,C=s.getFontCssStringFromFont(m,void 0);e.font=C;var p=T(e,f,u===d.length-1);g.WidthPx=p,g.Text=f,g.FontCss=C,g.Strikethrough=m.StrikeThrough,g.Underline=m.Underline,l[u]=n.__assign(n.__assign({},g),c),a+=p}return e.textAlign=i,{totalWidth:a,textRunsDrawingInformation:l}}function E(e){s.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getBidiContext");var t=e.CachedDrawingLayout.BidiContext;if(t)return t;var r=h.analyzeBidiText(e.Text,e.CachedStyle.ReadingOrder);return e.CachedDrawingLayout.BidiContext=r,r}function H(e,t){s.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getTextLineHeight"),s.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getTextLineHeight"),s.verifyArgumentNotNull(e.CachedFont,"CachedFont","getTextLineHeight");var r,n=e.TextRuns&&i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,t);if(void 0!==e.CachedDrawingLayout.CellTextLayout.LineHeight)return e.CachedDrawingLayout.CellTextLayout.LineHeight;n&&(r=W(t,e.TextRuns));var a=A(n?r.Size:s.getActualFontSize(e),n?r.FontName:e.CachedFont.FontName);return e.CachedDrawingLayout.CellTextLayout.LineHeight=a,a}function W(e,t){for(var r,n=0;n<t.length;n++){var o=t[n],i=f.getReferencedObjectById(o.FontID,e.Fonts);(!r||r.Size<i.Size)&&(r=i)}if(!r)throw"getLargestFont: Largest fonts is supposed to be defined";return r}function j(e,t){var r;if(i.isRenderFlagEnabled(o.RenderFlags.CFIcons,e)&&(null===(r=t.CondFormat)||void 0===r?void 0:r.Icon)){var n=s.getActualFontSize(t);return m.getIconSize(n,1)+m.getIconHorizontalPadding(n,1)}return 0}function z(e,t,r){var n=t.CachedStyle.Indentation||0,o=s.getActualFontSize(t),i=!d.isNullOrUndefined(t.WrapText)||s.cellHasShrinkToFit(t);return b(o,C.getEffectiveHorizontalAlignment(e,t),t.CachedFont.Italic,n,i,r)}function G(e,t,r){if(r!==o.VerticalAlignment.Bottom)return 0;switch(e){case"Book Antiqua":return t<10?-2:t<20?-1:0;case"Cambria":return t<12?-2:t<17?-1:0;case"Century":return t<10?-2:t<16?-1:0;case"Comic Sans MS":return t<9?-3:t<14?-2:t<20?-1:0;case"Constantia":return t<10?-2:t<22?-1:0;case"Georgia":return t<11?-2:t<=16?-1:0;case"Trebuchet MS":return t<11?-3:t<17?-1:0;default:return 0}}t.measureTextWidth=T,t.getCellTextCenterX=S,t.getTextCenterForCenterAcrossSelection=function(e,t){if(t.Spill){var r=j(e,t),n=e.IsRtl?a.GridLineWidthPx:0,o=p.getSpillCellWidth(t,e)-r;return p.getSpillCellStartOffset(t,e)+r+o/2-n}return S(e,t)},t.getIndentationPaddingPx=x,t.getCellTextHorizontalPadding=function(e,t){return z(t,e,j(t,e))},t.getCellTextHorizontalPaddingWithoutIcons=function(e,t){return z(e,t,0)},t.getWrapTextAdditionalPadding=function(e,t){var r=s.getActualFontSize(t),n=!d.isNullOrUndefined(t.WrapText)||s.cellHasShrinkToFit(t);return b(r,C.getEffectiveHorizontalAlignment(e,t),t.CachedFont.Italic,0,n,0)},t.getHorizontalPadding=b,t.getFontLineHeight=A,t.getTextVerticalPosition=function(e,t,r,n,l){var d=e.CachedStyle.VerticalAlignment,c=H(e,t),g=i.isRenderFlagEnabled(o.RenderFlags.TextBaselineRefactor,t),f=e.TextRuns,h=f?W(t,e.TextRuns):e.CachedFont,m=f?h.Size:s.getActualFontSize(e),C=G(h.FontName,h.Size,d),v=p.getCellTop(t,e),F=p.getCellBottom(t,e),w=y.cellHasBottomDoubleBorder(e,t)?a.InCellDoubleBorderVerticalPaddingPx:0,T=l||u.getCachedFontMetrics(h.FontName,m).baseline;switch(d){case o.VerticalAlignment.Bottom:return w+L(F,c,C,g,T);case o.VerticalAlignment.Top:return k(v,c,r,C,g,T);case o.VerticalAlignment.Center:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return P(F,n,c,r,C,g,T);default:throw Error("getTextVerticalPosition: unsupported verticalAlignment: "+d)}},t.getTextOffsetYAlphabeticBaseline=function(e,t,r,n,i,a){var l=A(r,n),d=G(n,r,i),s=u.getCachedFontMetrics(n,r).baseline;switch(i){case o.VerticalAlignment.Center:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return P(e,t,l,l,d,a,s);case o.VerticalAlignment.Bottom:return L(e,l,d,a,s);case o.VerticalAlignment.Top:return k(e-t,l,l,d,a,s)}},t.getTextBaseline=function(e,t){switch(e){case o.VerticalAlignment.Bottom:case o.VerticalAlignment.Top:return t?"alphabetic":"bottom";case o.VerticalAlignment.Center:case o.VerticalAlignment.Justify:case o.VerticalAlignment.Distributed:return t?"alphabetic":"middle";default:throw Error("getTextBaseline: unsupported verticalAlignment: "+e)}},t.getTextAlphabeticBaseline=function(e,t){var r=t.CachedFont,n=t.TextRuns;n&&(r=W(e,t.TextRuns));var o=n?r.Size:s.getActualFontSize(t);return u.getCachedFontMetrics(r.FontName,o).baseline},t.getLastRowYTopAlignmentBottomBaseline=D,t.getLastRowYBottomAlignmentBottomBaseline=M,t.getLastRowBaselineOffsetYTop=k,t.getLastRowBaselineOffsetYBottom=L,t.getMiddleBaseline=function(e,t,r){var n=u.getCachedFontMetrics(t.FontName,r);return e-(n.middle-n.baseline)},t.getTextDecorationLineWidth=function(e){return c.approximateValue(e,g.CalibriTextDecorationLineWidth)},t.getTextHeight=function(e,t,r){if(s.verifyArgumentNotNull(e.CachedDrawingLayout,"CachedDrawingLayout","getOrMeasureCellPaddingPx"),s.verifyArgumentNotNull(e.CachedDrawingLayout.CellTextLayout,"CellTextLayout","getOrMeasureCellPaddingPx"),void 0!==e.CachedDrawingLayout.CellTextLayout.Height)return e.CachedDrawingLayout.CellTextLayout.Height;var n=I(t,r);return e.CachedDrawingLayout.CellTextLayout.Height=n,n},t.getTextWidth=function(e,t,r){var n=N(e,t,r),a=n.width,l=n.textRunsDrawingInformation;return r.CachedDrawingLayout.CellTextLayout.Width=a,i.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,t)&&(r.CachedDrawingLayout.TextRunDrawingInformation=l),a},t.getTextWidthNoCaching=function(e,t,r){return N(e,t,r).width},t.measureTextRunsWidth=B,t.getBidiContext=E,t.getTextLineHeight=H,t.getFormattedTextLineHeight=function(e,t){var r=W(e,t.TextRuns);return A(r.Size,r.FontName)},t.getFormattedTextLineFontMetrics=function(e,t){var r=W(e,t.TextRuns);return u.getCachedFontMetrics(r.FontName,r.Size)},t.getNumFmtSeparatorWidth=function(e,t){var r,n;s.verifyArgumentNotNull(null===(r=t.NumFmt)||void 0===r?void 0:r.Separator,"separator","getNumFmtSeparatorWidth");var o=null===(n=t.NumFmt)||void 0===n?void 0:n.Separator,i=s.getFontCssStringFromCell(t)+o,a=F[i];if(d.isNullOrUndefined(a)||0===a){var l=R(e,o);return F[i]=l,l}return F[i]},t.getNumFmtHashesWidth=function(e,t){s.verifyArgumentNotNull(t,"cell","getNumFmtSeparatorWidth");var r=s.getFontCssStringFromCell(t),n=w[r];if(d.isNullOrUndefined(n)||0===n){var o=R(e,"#");return w[r]=o,o}return w[r]},t.getTextIconPadding=j},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(0);!function(e){e[e.ColoredArrowUp=0]="ColoredArrowUp",e[e.ColoredArrowUpRight=1]="ColoredArrowUpRight",e[e.ColoredArrowRight=2]="ColoredArrowRight",e[e.ColoredArrowDownRight=3]="ColoredArrowDownRight",e[e.ColoredArrowDown=4]="ColoredArrowDown",e[e.TriangleHigh=5]="TriangleHigh",e[e.TriangleMedium=6]="TriangleMedium",e[e.TriangleLow=7]="TriangleLow",e[e.GrayArrowUp=8]="GrayArrowUp",e[e.GrayArrowUpRight=9]="GrayArrowUpRight",e[e.GrayArrowRight=10]="GrayArrowRight",e[e.GrayArrowDownRight=11]="GrayArrowDownRight",e[e.GrayArrowDown=12]="GrayArrowDown",e[e.CircleHigh=13]="CircleHigh",e[e.CircleMedium=14]="CircleMedium",e[e.CircleLow=15]="CircleLow",e[e.SignMedium=16]="SignMedium",e[e.SignLow=17]="SignLow",e[e.FourCircleHigh=18]="FourCircleHigh",e[e.FourCircleMedium1=19]="FourCircleMedium1",e[e.FourCircleMedium2=20]="FourCircleMedium2",e[e.FourCircleLow=21]="FourCircleLow",e[e.TrafficHigh=22]="TrafficHigh",e[e.TrafficMedium=23]="TrafficMedium",e[e.TrafficLow=24]="TrafficLow",e[e.CircleSymbolHigh=25]="CircleSymbolHigh",e[e.CircleSymbolMedium=26]="CircleSymbolMedium",e[e.CircleSymbolLow=27]="CircleSymbolLow",e[e.FlagHigh=28]="FlagHigh",e[e.FlagMedium=29]="FlagMedium",e[e.FlagLow=30]="FlagLow",e[e.SymbolHigh=31]="SymbolHigh",e[e.SymbolMedium=32]="SymbolMedium",e[e.SymbolLow=33]="SymbolLow",e[e.StarHigh=34]="StarHigh",e[e.StarMedium=35]="StarMedium",e[e.StarLow=36]="StarLow",e[e.CircleFilled=37]="CircleFilled",e[e.Circle75=38]="Circle75",e[e.CircleHalf=39]="CircleHalf",e[e.Circle25=40]="Circle25",e[e.CircleEmpty=41]="CircleEmpty",e[e.QuadrantFull=42]="QuadrantFull",e[e.Quadrant75=43]="Quadrant75",e[e.QuadrantHalf=44]="QuadrantHalf",e[e.Quadrant25=45]="Quadrant25",e[e.QuadrantEmpty=46]="QuadrantEmpty",e[e.SignalBarEmpty=47]="SignalBarEmpty",e[e.SignalBarLow=48]="SignalBarLow",e[e.SignalBarMedium1=49]="SignalBarMedium1",e[e.SignalBarMedium2=50]="SignalBarMedium2",e[e.SignalBarHigh=51]="SignalBarHigh"}(n=t.CFIconImage||(t.CFIconImage={})),t.IconImageLookup=[[n.ColoredArrowDown,n.ColoredArrowRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowRight,n.GrayArrowUp],[n.FlagLow,n.FlagMedium,n.FlagHigh],[n.CircleLow,n.CircleMedium,n.CircleHigh],[n.TrafficLow,n.TrafficMedium,n.TrafficHigh],[n.SignLow,n.SignMedium,n.CircleHigh],[n.CircleSymbolLow,n.CircleSymbolMedium,n.CircleSymbolHigh],[n.SymbolLow,n.SymbolMedium,n.SymbolHigh],[n.ColoredArrowDown,n.ColoredArrowDownRight,n.ColoredArrowUpRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowDownRight,n.GrayArrowUpRight,n.GrayArrowUp],[n.FourCircleLow,n.FourCircleMedium1,n.FourCircleMedium2,n.FourCircleHigh],[n.SignalBarLow,n.SignalBarMedium1,n.SignalBarMedium2,n.SignalBarHigh],[n.FourCircleLow,n.CircleLow,n.CircleMedium,n.CircleHigh],[n.ColoredArrowDown,n.ColoredArrowDownRight,n.ColoredArrowRight,n.ColoredArrowUpRight,n.ColoredArrowUp],[n.GrayArrowDown,n.GrayArrowDownRight,n.GrayArrowRight,n.GrayArrowUpRight,n.GrayArrowUp],[n.SignalBarEmpty,n.SignalBarLow,n.SignalBarMedium1,n.SignalBarMedium2,n.SignalBarHigh],[n.CircleEmpty,n.Circle25,n.CircleHalf,n.Circle75,n.CircleFilled],[n.StarLow,n.StarMedium,n.StarHigh],[n.TriangleLow,n.TriangleMedium,n.TriangleHigh],[n.QuadrantEmpty,n.Quadrant25,n.QuadrantHalf,n.Quadrant75,n.QuadrantFull]],t.IconOutlineWidthPx=1,t.CirclePaddingFromBoundariesPx=2,t.FlagPoleWidth=1,t.MinimalIconPadding=3;var i=Math.PI/5;t.StarRotationSin=Math.sin(i),t.StarRotation2Sin=Math.sin(2*i),t.StarRotationCos=Math.cos(i),t.StarRotation2Cos=Math.cos(2*i),t.StarInset=.4,t.Circle270Deg=1.5*Math.PI,t.Circle0Deg=0,t.Circle90Deg=.5*Math.PI,t.Circle180Deg=Math.PI,t.Circle360Deg=2*Math.PI,t.UnusedColor="unused",t.CheckMarkMiddleXRatio=.375,t.CheckMarkMiddleYRatio=.5625,t.CheckMarkBottomYRatio=.9375,t.CheckMarkTopRightYRatio=.125,t.CheckMarkTopRightXRatio=.8125,t.CheckMarkMiddleRightYRatio=.3125,t.CheckMarkTopLeftYRatio=.34375,t.CheckMarkTopLeftXRatio=.1875,t.CheckMarkTopMiddleYRatio=.53125,t.CheckMarkTopMiddleXRatio=0,t.CircledCheckMarkMiddleXRatio=.4,t.CircledCheckMarkMiddleYRatio=.575,t.CircledCheckMarkBottomYRatio=.87,t.CircledCheckMarkTopRightYRatio=.22,t.CircledCheckMarkTopRightXRatio=.775,t.CircledCheckMarkMiddleRightYRatio=.37,t.CircledCheckMarkMiddleRightXRatio=.91,t.CircledCheckMarkTopLeftYRatio=.4,t.CircledCheckMarkTopLeftXRatio=.24,t.CircledCheckMarkTopMiddleYRatio=.55,t.CircledCheckMarkTopMiddleXRatio=.09,t.CrossMarkOuterBigPaddingRatio=.8125,t.CrossMarkOuterSmallPaddingRatio=.1875,t.CrossMarkInnerCenterRatio=.5,t.CrossMarkInnerBigPaddingRatio=.6875,t.CrossMarkInnerSmallPaddingRatio=.3125,t.ExclamationMarkBottomRectHeightSizeRatio=.25,t.ExclamationMarkWidthRectSizeRatio=.25,t.ExclamationMarkLeftRectanglePaddingRatio=.375,t.ExclamationMarkSpaceBetweenRectanglesRatio=.125,t.ExclamationMarkTopRectHeightSizeRatio=.6,t.ExclamationMarkMinSpaceBetweenRectangels=2,t.CircledExclamationMarkWidthRectSizeRatio=.2,t.CircledExclamationMarkLeftCircleSizeRatio=.325,t.CircledExclamationMarkTopRectHeightSizeRatio=.625,t.CircledExclamationMarkTopPadding=.05,t.ArrowWidthRatio=.18,t.ArrowHeightRatio=.62,t.ArrowDownRightTipXRatio=.875,t.ArrowDownRightTipYRatio=.875,t.ArrowUpRightTipXRatio=.875,t.ArrowUpRightTipYRatio=.13,t.ArrowAngle=Math.PI/4,t.CFIconOutlineWidth=1,t.IconLinesAdjustment=o.getLinePixelTranslation(t.CFIconOutlineWidth),t.CircledCrossMarkOuterSmallPaddingRatio=.305,t.CircledCrossMarkOuterBigPaddingRatio=1-t.CircledCrossMarkOuterSmallPaddingRatio,t.CircledCrossMarkInnerCenterRatio=.5,t.CircledCrossMarkInnerSmallPaddingRatio=.325,t.CircledCrossMarkInnerBigPaddingRatio=1-t.CircledCrossMarkInnerSmallPaddingRatio,t.CircledCrossMarkPaddingFromCircleRatio=.125},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CircleLowInnerColor="#FF9198",t.CircleLowOuterColor="#D42314",t.CircleMediumInnerColor="#F8DB8F",t.CircleMediumOuterColor="#DE6C00",t.CircleHighInnerColor="#A1DDAA",t.CircleHighOuterColor="#309048",t.CircleFilledInnerColor="#797774",t.CircleFilledOuterColor="#3A3A38",t.CircleEmptyInnerColor="#FAFAFA",t.CircleEmptyOuterColor="#3A3A38",t.FourCircleMedium2InnerColor="#D492D8",t.FourCircleMedium2OuterColor="#922E9B",t.FourCircleMedium1InnerColor="#C8C6C4",t.FourCircleMedium1OuterColor="#3A3A38",t.FourCircleLowOuterColor="#3A3A38",t.FourCircleHighInnerColor="#FF9198",t.FourCircleHighOuterColor="#D42314",t.TrafficHighRimmedRectColor="#3A3A38",t.SignalBarEmptyColor="#FAFAFA",t.SignalBarFilledColor="#83BEEC",t.SignalBarOutlineColor="#3A3A38",t.QuadrantBoxesEmptyColor="#FAFAFA",t.QuadrantBoxesFilledColor="#83BEEC",t.QuadrantBoxesOutlineColor="#3A3A38",t.FlagStickColor="#3A3A38",t.FlagLowOuterColor="#D42314",t.FlagLowInnerColor="#FF9198",t.FlagMediumOuterColor="#DE6C00",t.FlagMediumInnerColor="#F8DB8F",t.FlagHighOuterColor="#309048",t.FlagHighInnerColor="#A1DDAA",t.TriangleLowOuterColor="#D42314",t.TriangleLowInnerColor="#FF9198",t.TriangleMediumOuterColor="#DE6C00",t.TriangleMediumInnerColor="#F8DB8F",t.TriangleHighOuterColor="#309048",t.TriangleHighInnerColor="#A1DDAA",t.StarFilledOuterColor="#DE6C00",t.StarFilledInnerColor="#F8DB8F",t.StarEmptyOuterColor="#3A3A38",t.StarEmptyInnerColor="#FAFAFA",t.SignMediumOuterColor="#DE6C00",t.SignMediumInnerColor="#F8DB8F",t.SignLowOuterColor="#D42314",t.SignLowInnerColor="#FF9198",t.SymbolLowOuterColor="#D42314",t.SymbolLowInnerColor="#FF9198",t.SymbolMediumOuterColor="#DE6C00",t.SymbolMediumInnerColor="#F8DB8F",t.SymbolHighOuterColor="#309048",t.SymbolHighInnerColor="#A1DDAA",t.ArrowGrayOuterColor="#797774",t.ArrowGrayInnerColor="#C8C6C4",t.ArrowUpInnerColor="#A1DDAA",t.ArrowDownInnerColor="#FF9198",t.ArrowRightInnerColor="#F8DB8F",t.ArrowUpOuterColor="#309048",t.ArrowDownOuterColor="#D42314",t.ArrowRightOuterColor="#DE6C00",t.CircleSymbolInnerShapeInnerColor="#FAFAFA"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1);t.getReferencedObjectById=function(e,t){var r;switch(e){case n.UniqueStyleID.Default:case n.UniqueStyleID.Hyperlink:r=t[t.length+e];break;default:r=t[e]}if(null===r)throw Error("RefObject is null");if(r.ID!==e)throw Error("RefIDs are not sorted as expected");return r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o="",i=[],a=d()?window.performance:void 0,l=void 0;function d(){if(l)return l;l=!1,window.performance&&"function"==typeof window.performance.now&&(l=!0);try{window.performance.now()}catch(e){l=!1}return l}t.verifyPerformanceNowSupported=d,t.createRenderResult=function(e,t){return{succeeded:e,message:t,performance:i}},t.clearPerformanceMetrics=function(){i=[]},t.trackDuration=function(e,t,r){var n=a?a.now():-1;if(t(),a){var o=a.now()-n;r?i[e]+=o:i[e]=o}},function(e){e[e.DrawGridlinesDurationMs=0]="DrawGridlinesDurationMs",e[e.DrawTextDurationMs=1]="DrawTextDurationMs",e[e.ClearDurationMs=2]="ClearDurationMs",e[e.RenderBlockInternalDurationMs=3]="RenderBlockInternalDurationMs",e[e.ModelPreparationsMs=4]="ModelPreparationsMs",e[e.ClearRectDurationMs=5]="ClearRectDurationMs",e[e.FillRectDurationMs=6]="FillRectDurationMs",e[e.GetContextDurationMs=7]="GetContextDurationMs",e[e.DrawSpillCellsDurationMs=8]="DrawSpillCellsDurationMs",e[e.DrawBackgroundFillMs=9]="DrawBackgroundFillMs",e[e.ClearGridlinesMs=10]="ClearGridlinesMs",e[e.ClearGridlinesForBorderMs=11]="ClearGridlinesForBorderMs",e[e.ClearGridLinesForSpannedCellsMs=12]="ClearGridLinesForSpannedCellsMs",e[e.DrawBordersMs=13]="DrawBordersMs",e[e.DrawTextDecoration=14]="DrawTextDecoration",e[e.GetFontMetrics=15]="GetFontMetrics",e[e.DrawCFIconsMs=16]="DrawCFIconsMs",e[e.ReorderBidiTextRuns=17]="ReorderBidiTextRuns",e[e.DrawPageBreaksDurationMs=18]="DrawPageBreaksDurationMs",e[e.DrawSkeletonMs=19]="DrawSkeletonMs",e[e.DrawPrintAreasDurationMs=20]="DrawPrintAreasDurationMs",e[e.ClearGridLinesForEmptyPivot=21]="ClearGridLinesForEmptyPivot",e[e.DrawEmptyPivotTableTitleContainers=22]="DrawEmptyPivotTableTitleContainers",e[e.DrawEmptyPivotTableImages=23]="DrawEmptyPivotTableImages",e[e.DrawEmptyPivotTableTitleText=24]="DrawEmptyPivotTableTitleText",e[e.DrawDataBarsMs=25]="DrawDataBarsMs",e[e.DrawSparklines=26]="DrawSparklines"}(t.RenderPerformanceMetric||(t.RenderPerformanceMetric={})),t.getRenderingMessage=function(){var e=o;return o="",e},t.setDivMetricWarning=function(e){n.isNullOrUndefined(e)||""===e||(o=(o+"; "+e).substring(0,2500))},t.setActualFontSizeWarning=function(e){n.isNullOrUndefined(e)||""===e||(o=(o+"; "+e).substring(0,2500))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8);t.drawRectangleIcon=function(e,t,r,i){n.verifyArgumentNotNull(e,"ctx","drawRectangleIcon"),n.verifyArgumentNotNull(t,"model","drawRectangleIcon"),n.verifyArgumentNotNull(r,"cell","drawRectangleIcon"),n.verifyArgumentNotNull(i,"drawingContext","drawRectangleIcon");var a=i.innerColor,l=i.outerColor,d=i.left,s=i.bottom,u=i.height,c=i.width;(function(e,t,r,n,o,i){e.strokeStyle=i,e.beginPath(),e.rect(t,r,n,o),e.stroke()})(e,d+o.IconLinesAdjustment,s-u-o.IconLinesAdjustment,c,u,l),a&&function(e,t,r,n,o,i){e.fillStyle=i,e.beginPath(),e.fillRect(t,r,n,o),e.fill()}(e,d+o.IconOutlineWidthPx,s-u,c-o.IconOutlineWidthPx,u-o.IconOutlineWidthPx,a)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MinAllowedFontSize=1,t.MaxAllowedFontSize=409,t.DefaultFontSizePt=11,t.DefaultFontName="Calibri",t.PointToPixelRatio=4/3,t.LineHeightFontFactor=1.28,t.LineLeading=.06,t.LineHeightUsingDivFontFactor=1+t.LineLeading,t.LineHeightBottomConstantPx=1,t.knownFontNamesLowerCase=["angsananew","arial","arialblack","batang","bookantiqua","browallianew","calibri","cambria","candara","century","comicsansms","consolas","constantia","corbel","cordianew","dilleniaupc","courier","couriernew","dotum","fangsong","garamond","georgia","gulim","gungsuh","kaiti","jasmineupc","malgungothic","mangal","meiryo","microsoftjhengHei","microsoftyahei","mingliu","mingliuhkscs","msgothic","msmincho","mspgothic","mspmincho","pmingliu","pmingliuextb","simhei","simsun","simsunextb","sourcesanspro","tahoma","thsarabunpsk","times","timesnewroman","trebuchetms","verdana","yugothic","yumincho"]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=r(7),l=r(15),d=r(19),s=r(3),u=r(6),c=r(25),g=r(11),f=r(5),h=r(18),m=r(4),C=r(40);function p(e,t){return e>=t.StartIndex&&e<t.EndIndex}function y(e,t){for(var r=0;r<t.length;r++){if(p(e,t[r]))return r}throw Error("Failed to find text run index for textOffsetIndex: "+e)}function v(e,t){var r=e.CachedFont;e.ShrunkSize=r.Size*t,e.FontCss=o.getFontCssStringFromFont(r,e.ShrunkSize),e.WidthPx=e.WidthPx*t}function F(e,t){for(var r=0,o=t,i=t;i<e.length;i++){var a=e[i];if(a.Underline===n.FontUnderline.None)break;var l=a.CachedFont;r=Math.max(r,a.ShrunkSize||l.Size),o=i}return{maxFontSize:r,sequenceEndRunIndex:o}}function w(e,t,r,o,i,a,l,s,u,c){var g,f;if(!r.JustifyDistributedLine)return t;var h=r.JustifyDistributedLine.SpaceWidthBetweenWords,m=t+r.JustifyDistributedLine.Start.OffsetX;(function(e,t){return e.JustifyDistributedLine.HasPartialText&&t&&t.JustifyDistributedLine&&t.JustifyDistributedLine.HasPartialText})(r,u)&&(m-=h);var C=m;if(T(e,r.JustifyDistributedLine.Start,m,o),m=S(m,r.JustifyDistributedLine.Start.Width,h),(null===(g=r.JustifyDistributedLine)||void 0===g?void 0:g.Middle)&&(T(e,r.JustifyDistributedLine.Middle,m,o),m=S(m,r.JustifyDistributedLine.Middle.Width,h)),(null===(f=r.JustifyDistributedLine)||void 0===f?void 0:f.End)&&(T(e,r.JustifyDistributedLine.End,m,o),m=S(m,r.JustifyDistributedLine.End.Width,h)),r.Underline!==n.FontUnderline.None||r.Strikethrough){var p={dpr:l,clipRect:c,textPositionX:C,textPositionY:o,textWidth:m-C};d.cacheTextDecorationLayout(i,a,p,s,r.UnderlineWidth)}return m}function T(e,t,r,n){e.fillText(t.Text,r,n)}function S(e,t,r){return e+t+r}t.fillRichTextFormat=function(e,t,r,f,p,y,T,S,R,x){var b;if(o.verifyArgumentNotNull(f,"cell","fillRichTextFormat"),o.verifyArgumentNotNull(r,"model","fillRichTextFormat"),o.verifyArgumentNotNull(p,"formattedText","fillRichTextFormat"),o.verifyArgumentNotNull(p.TextRuns[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat"),0!==p.Text.length){var I=p.TextRuns;o.verifyArgumentNotNull(I[0].CachedFont,"formattedText.CachedFont","fillRichTextFormat");var A=function(e,t,r,o,i,d,c){var f=a.getBidiContext(r),p=function(e,t,r,n,o){var i,l,d=t.Fonts;if(r.WrapText){var s=a.measureTextRunsWidth(e,n,o,a.getBidiContext(r));l=s.totalWidth,i=s.textRunsDrawingInformation}else l=a.getTextWidth(e,t,r),i=r.CachedDrawingLayout.TextRunDrawingInformation;if(!i||!n)throw"Unexpected: cachedCellRuns and runs are supposed to be defined";for(var u=0,c=d[0],g=0;g<i.length;g++){var f=i[g].CachedFont;u=Math.max(u,f.Size),c.Size<u&&(c=f)}return{totalTextRunWidth:l,largestFont:c,preparedRuns:i}}(e,t,r,o,i),y=p.totalTextRunWidth,w=p.largestFont,T=p.preparedRuns;f.HasRtl&&g.trackDuration(g.RenderPerformanceMetric.ReorderBidiTextRuns,(function(){l.reorderTextRunsForBidiDrawing(T,i,f)}),!0);r.CachedStyle.ShrinkToFit&&(y=function(e,t,r,n){var o=u.getCellWidth(e,t,!1),i=t.CachedStyle.Indentation||0,l=r[0].CachedFont,d=a.getHorizontalPadding(l.Size,t.CachedStyle.HorizontalAlignment,t.CachedFont.Italic,i,!0,0),c=s.getTextDrawingMaxWidth(o,d,a.getTextIconPadding(e,t));if(n<c)return n;for(var g=c/(n+d),f=0,h=0;h<r.length;h++){var m=r[h];v(m,g),f+=m.WidthPx}return f}(t,r,T,y));(function(e){var t=0;for(;t<e.length;){if(e[t].Underline===n.FontUnderline.None)t++;else for(var r=F(e,t),o=r.maxFontSize,i=r.sequenceEndRunIndex,l=a.getTextDecorationLineWidth(o);t<=i;t++)e[t].UnderlineWidth=l}})(T),!h.isHorizontalAlignmentJustifiedAndDistributed(t,r)||m.isNullOrUndefined(d)||m.isNullOrUndefined(c)||C.prepareTextRunsForJustifyAndDistributed(e,c,d,T);return{totalTextRunWidth:y,largestFont:w,preparedRuns:T}}(e,r,f,I,p.Text,R,x),D=A.totalTextRunWidth,M=A.largestFont,k=A.preparedRuns,L=o.getCellStyle(f,r);o.verifyArgumentNotNull(L,"cellStyle","fillRichTextFormat"),function(e,t,r,l,u,g,f,C,p,y,v){var F=e.textAlign,T=e.textBaseline,S=e.font,R=e.fillStyle,x=i.isRenderFlagEnabled(n.RenderFlags.TextBaselineRefactor,r),b=h.isHorizontalAlignmentJustifiedAndDistributed(r,l),I=x?C:function(e,t,r){var i=t.CachedStyle.VerticalAlignment,l=a.getFontLineHeight(e.Size,e.FontName),d=c.getCachedFontMetrics(e.FontName,e.Size).baseline;o.verifyArgumentNotNull(d,"textBaselineAdjustY","adjustYForVerticalAlignment");var s=r-d;if(i===n.VerticalAlignment.Center)return s+(l-d)/2;return s}(g,l,C),A=function(e,t,r,o,i,a){var l=o&&!m.isNullOrUndefined(a)?a:i;return function(e,t,r,o){var i=0,a=h.getEffectiveHorizontalAlignment(e,t);switch(a){case n.HorizontalAlignment.Left:i=r;break;case n.HorizontalAlignment.Right:i=r-o;break;case n.HorizontalAlignment.Center:case n.HorizontalAlignment.CenterAcrossSelection:i=r-o/2;break;default:throw Error("unexpected context alignment "+a)}return i}(e,t,r,l)}(r,l,f,b,u,v);e.textAlign="left",e.textBaseline="alphabetic";var D=t.devicePixelRatio,M=void 0;t.highContrastScheme&&(e.fillStyle=s.getHighContrastTextColor(r,l,t.highContrastScheme));for(var k=0;k<p.length;k++){var L=p[k];if(o.verifyArgumentNotNull(L.CachedFont,"run.CachedFont","drawTextRuns"),e.font=L.FontCss,t.highContrastScheme||(e.fillStyle=L.CachedFont.Color),b)k>0&&(M=p[k-1]),A=w(e,A,L,I,r,l,D,L.CachedFont,M,y);else{if(e.fillText(L.Text,A,I),L.Underline!==n.FontUnderline.None||L.Strikethrough){var P={dpr:D,clipRect:y,textPositionX:A,textPositionY:I,textWidth:L.WidthPx};d.cacheTextDecorationLayout(r,l,P,L.CachedFont,L.UnderlineWidth)}A+=L.WidthPx}}e.textAlign=F,e.textBaseline=T,e.font=S,e.fillStyle=R}(e,t,r,f,D,M,y,T,k,S,null===(b=x)||void 0===b?void 0:b.maxWidth)}},t.substringFormattedText=function(e,t,r){if(o.verifyArgumentNotNull(e.Text,"formattedText.Text","substringFormattedText"),0===e.Text.length)return f.EmptyFormattedText;var n=e.Text.substring(t,r);if(0===n.length)return{Text:n,Fonts:e.Fonts,TextRuns:[]};var i=e.TextRuns;if(o.verifyArgumentNotNull(i,"formattedText.runs","substringFormattedText"),0===i.length)throw Error("Invalid param: formattedText runs.length === 0");o.prepareTextRunRanges(i,e);var a=y(t,i),l=r&&r<e.Text.length?y(r-1,i):i.length-1,d=[],s=i[a];d.push({StartIndex:0,FontID:s.FontID,CachedFont:s.CachedFont});for(var u=a+1;u<=l;u++){var c=i[u],g=c.StartIndex-t;d.push({StartIndex:g,FontID:c.FontID,CachedFont:c.CachedFont})}return{Text:n,Fonts:e.Fonts,TextRuns:d}},t.measureFormattedTextWidth=function(e,t){return a.measureTextRunsWidth(e,t.TextRuns,t.Text).totalWidth}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(3);function a(e,t){var r=[s(e,0)];if(1===t.length)return r;for(var n=void 0,o=0;o<t.length;o++){if(u(t[o])){l(o,n)&&r.push(s(e,o));var i=o+1;d(i,t.length)&&r.push(s(e,i)),n=o}}return r}function l(e,t){return e>0&&!(e-1===t)}function d(e,t){return e<t}function s(e,t){return{FontID:e.FontID,StartIndex:e.StartIndex+t,CachedFont:e.CachedFont}}function u(e){return" "===e||'"'===e||"'"===e||"."===e||"?"===e||":"===e||";"===e||"-"===e||","===e||"!"===e||"("===e||")"===e}t.analyzeBidiText=function(e,t){for(var r=!1,o=!1,a=0;a<e.length;a++){var l=e[a];if(i.isRtlChar(l)?r=!0:o=!0,o&&r)break}return{HasLtr:o,HasRtl:r,HasBidi:o&&r,BaseDir:function(e,t){switch(t){case n.ReadingOrderType.LeftToRight:return"ltr";case n.ReadingOrderType.RightToLeft:return"rtl";case n.ReadingOrderType.Context:return i.isRtlChar(e[0])?"rtl":"ltr"}}(e,t)}},t.prepareTextRunsForBidiLayout=function(e,t){for(var r=[],n=0;n<e.length;n++){var i=a(e[n],o.getTextRunText(n,e,t));r.push.apply(r,i)}return r},t.reorderTextRunsForBidiDrawing=function(e,t,r){if(!r.HasRtl||r.HasLtr){var n=document.createElement("div");n.style.visibility="hidden",n.style.direction=r.BaseDir,n.style.position="absolute";for(var i=0;i<e.length;i++){var a=o.getTextRunText(i,e,t),l=document.createElement("span");l.innerText=a,l.setAttribute("rid",i.toString()),n.appendChild(l)}document.body.appendChild(n);for(var d=0;d<n.children.length;d++){var s=n.children[d],u=s.getAttribute("rid");if(!u)throw Error("reorderTextRunsForBidiDrawing: runIndexAttr is undefined");var c=s.getBoundingClientRect().left;e[i=parseInt(u,10)].OffsetX=c}e.sort((function(e,t){return e.OffsetX-t.OffsetX})),document.body.removeChild(n)}else e.reverse()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(35),o=r(36),i=r(13);t.getIconSize=function(e,t){return Math.floor(n.approximateValue(e,o.FontSizeToIconSize)*t)},t.getIconHorizontalPadding=function(e,t){return Math.floor(n.approximateValue(e,o.IconHorizontalPadding)*t)},t.pointsToPixels=function(e){return Math.round(e*i.PointToPixelRatio)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(5),i=r(3),a=r(0),l=r(2),d=r(4);function s(e,t,r){var n=Math.round(e*t)-o.GridLineWidthPx/2;if(r&&i.isSafari()){var a=window?window.devicePixelRatio:-1;2===a&&t===a/2&&(n-=1)}return n}function u(e,t,r,n){var o=e+t-r;return o=Math.min(o,n)}t.drawGridLines=function(e,t,r){if(!(t.RowOffsets&&t.ColumnOffsets&&t.RowHeights&&t.ColumnWidths))throw"drawGridLines:: one or more elements is null: RowOffset: "+!t.RowOffsets+", ColumnOffsets: "+!t.ColumnOffsets+", RowHeights: "+!t.RowHeights+", ColumnWidths: "+!t.ColumnWidths;if(t.RowOffsets.length!==t.RowHeights.length)throw"drawGridLines:: RowOffsets.length !== RowHeights.length";if(t.ColumnOffsets.length!==t.ColumnWidths.length)throw"drawGridLines:: ColumnOffsets.length !== ColumnWidths.length";if(t.ShowGridLines&&!(r.devicePixelRatio<o.MinimalDprForGridlinesRendering)&&i.shouldRenderGridLines(a.isHighContrastMode(r),a.hasWorkbookBackgroundColor(t.BackgroundColor,l.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))){e.lineWidth=o.GridLineWidthPx,e.setLineDash(function(e){if(l.isRenderFlagEnabled(n.RenderFlags.GridLineColor,e)&&!d.isNullOrUndefined(e.GridLineColor))return o.ColoredGridLineDash;return o.DefaultDash}(t)),e.strokeStyle=function(e,t){if(!d.isNullOrUndefined(t.highContrastScheme))return""+i.rgbToColorHex(t.highContrastScheme.TextColor);if(l.isRenderFlagEnabled(n.RenderFlags.GridLineColor,e)&&!d.isNullOrUndefined(e.GridLineColor))return e.GridLineColor;return o.DefaultGridlineColor}(t,r);var c=a.getLinePixelTranslation(o.GridLineWidthPx),g=s(t.BlockWidth,r.devicePixelRatio,!1),f=s(t.BlockHeight,r.devicePixelRatio,!0);e.beginPath(),function(e,t,r,n,o,a){for(var l=a.startRow,d=a.endRow,s=l;s<=d;s++){var c=u(t[s],i.getRowHeightFromOffsets(s,t),n,o);i.drawLine(e,0,c,r,c)}}(e,t.RowOffsetsAdjustedForDrawing,t.BlockWidth*r.devicePixelRatio,c,f,r.renderingRegion),function(e,t,r,n,o,a){for(var l=a.startColumn,d=a.endColumn,s=l;s<=d;s++){var c=u(t[s],i.getColWidthFromOffsets(s,t),n,o);i.drawLine(e,c,0,c,r)}}(e,t.ColOffsetsAdjustedForDrawing,t.BlockHeight*r.devicePixelRatio,c,g,r.renderingRegion),e.stroke()}},t.getMaxLineOffset=s,t.getAdjustedDrawingOffset=u},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(4),i=r(3),a=r(2);function l(e,t){var r,l=null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment;switch(l){case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.Distributed:case n.HorizontalAlignment.Fill:case n.HorizontalAlignment.Automatic:return a.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)?function(e){var t;switch(null===(t=e.CachedStyle)||void 0===t?void 0:t.ReadingOrder){case n.ReadingOrderType.LeftToRight:return n.HorizontalAlignment.Left;case n.ReadingOrderType.RightToLeft:return n.HorizontalAlignment.Right;case n.ReadingOrderType.Context:var r=e.Text;if(!o.isNullOrUndefined(r)&&""!==r)return i.isRtlChar(r[0])?n.HorizontalAlignment.Right:n.HorizontalAlignment.Left}return n.HorizontalAlignment.Left}(t):n.HorizontalAlignment.Left}return l}t.isHorizontalAlignmentCenteredAcrossSelection=function(e,t){var r;return a.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)&&(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment)===n.HorizontalAlignment.CenterAcrossSelection},t.isHorizontalAlignmentJustifiedAndDistributed=function(e,t){var r;if(a.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentJustifyAndDistributed,e))switch(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment){case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Distributed:return!0}return!1},t.getTextAlignment=function(e,t){var r=l(e,t);switch(r){case n.HorizontalAlignment.Right:return"right";case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Center:return"center";case n.HorizontalAlignment.Left:return"left";default:throw Error("getTextAlignment: unsupported horizontalAlignment: "+r)}},t.getEffectiveHorizontalAlignment=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(5),i=r(0),a=r(3),l=r(2),d=r(7),s=r(6),u=r(16),c=r(18);function g(e,t,r,o,a){if(i.verifyArgumentNotNull(t,"cell","CacheUnderlineLayout"),i.verifyArgumentNotNull(t.CachedFont,"cell.CachedFont","CacheUnderlineLayout"),i.verifyArgumentNotNull(t.CachedStyle,"cell.CachedStyle","CacheUnderlineLayout"),i.verifyArgumentNotNull(t.CachedDrawingLayout,"cell.CachedDrawingLayout","CacheUnderlineLayout"),o.Underline!==n.FontUnderline.None){var l={underline:o.Underline},d=f(e,t,r,l,o,!1,a),s=t.CachedDrawingLayout.UnderlineRuns;if(d&&s.push(d),h(l)){var u=f(e,t,r,{underline:l.underline===n.FontUnderline.DoubleAccounting?n.FontUnderline.SingleAccounting:n.FontUnderline.Single},o,!0,a);u&&s.push(u)}}if(o.StrikeThrough){var c=f(e,t,r,{strikethrough:!0},o,!1,void 0);if(c)t.CachedDrawingLayout.StrikethroughRuns.push(c)}}function f(e,t,r,a,g,f,C){var p=r.dpr,y=r.clipRect,v=i.getActualFontSize(t),F=function(e,t,r,o,a,g,f){var h,m,C,p,y=r.dpr,v=r.textPositionX,F=r.textWidth;if(o.underline===n.FontUnderline.SingleAccounting||o.underline===n.FontUnderline.DoubleAccounting){var w=d.getCellTextHorizontalPadding(t,e);m=s.getCellLeft(e,t,e.BlockWidth)+w,C=s.getCellRight(e,t,e.BlockWidth)-w}else{var T=!!t.TextRuns;h=function(e,t,r,o,i){var a,l;switch(i?n.HorizontalAlignment.Left:c.getEffectiveHorizontalAlignment(e,t)){case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:a=r,l=r+o;break;case n.HorizontalAlignment.Right:a=r-o,l=r;break;case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Center:a=r-o/2,l=r+o/2;break;default:a=r,l=r+o}return{startX:a,endX:l}}(e,t,v,F,T),m=h.startX,C=h.endX}var S=l.isRenderFlagEnabled(n.RenderFlags.TextBaselineRefactor,e);p=o.strikethrough?function(e,t,r,o,a){var l,s=t.textPositionY;i.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateStrikethroughY");var c=null===(l=e.CachedStyle)||void 0===l?void 0:l.VerticalAlignment;if(!a)return function(e,t,r,o){var i=t.textPositionY,a=u.pointsToPixels(r)/(e.TextRuns?4:2);switch(o){case n.VerticalAlignment.Center:return i;case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Top:return i-a;default:throw Error("calculateUnderlinePosition: Vertical alignment type not supported!")}}(e,t,r,c);switch(c){case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Top:case n.VerticalAlignment.Center:var g=d.getTextDecorationLineWidth(o.Size);return d.getMiddleBaseline(s,o,r)-g/2;default:throw Error("calculateUnderlinePosition: Vertical alignment type not supported!")}}(t,r,a,g,S):function(e,t,r,o,a){var l,s=t.textPositionY;i.verifyArgumentNotNull(e.CachedFont,"cell.CachedFont","calculateUnderlineY");var c=null===(l=e.CachedStyle)||void 0===l?void 0:l.VerticalAlignment,g=2*(null!=a?a:d.getTextDecorationLineWidth(r));if(o)return s+g;e.TextRuns&&c!==n.VerticalAlignment.Center&&(g=-g);switch(c){case n.VerticalAlignment.Bottom:case n.VerticalAlignment.Top:return s-g;case n.VerticalAlignment.Center:return s+u.pointsToPixels(r)/2-g;default:throw Error("calculateUnderlinePosition: Vertical alignment type not supported!")}}(t,r,a,S,f);return m=Math.round(m*y),C=Math.round(C*y),p=Math.round(p*y),{startX:m,endX:C,Y:p}}(e,t,r,a,v,g,C),w=F.startX,T=F.endX,S=F.Y,R=function(e,t,r){var n=(null!=r?r:d.getTextDecorationLineWidth(t))*e;return Math.max(Math.floor(n),1)}(p,v,C),x=Math.round(o.UnderlineMarginFromTextBaseline*R);(h(a)&&(S+=x),f)&&(S=S-2*R+x);if(!function(e,t,r,n,o,i,a){var l=r.dpr,d=r.clipRect,u=o+n,c=s.getCellTopAdjustedForDrawing(e,t),g=s.getCellBottomAdjustedForDrawing(e,t),f=d?(d.x+d.width)*l:0,h=d?d.x*l:0,m=!1,C=!1;var p=o>=g&&u>=g;d&&(C=i<=h&&a<=h,m=i>=f&&a>=f);return o<=c&&u<=c||p||m||C}(e,t,r,R,S,w,T)){if(y){var b=m(w,T,I=Math.round(y.x*p),Math.round(y.width*p)+I);w=b.start,T=b.end}if(function(e,t,r,n){var i=n+r,a=s.getCellTopAdjustedForDrawing(e,t)+o.GridLineWidthPx,l=s.getCellBottomAdjustedForDrawing(e,t)-o.GridLineWidthPx;return n<=a||i>=l}(e,t,R,S)){var I,A=m(S,S+R,I=s.getCellTopAdjustedForDrawing(e,t),s.getCellBottomAdjustedForDrawing(e,t)-o.GridLineWidthPx);S=A.start,R=A.end-S}return{StartX:w,EndX:T,Y:S,LineWidth:R,Color:g.Color}}}function h(e){return e.underline===n.FontUnderline.Double||e.underline===n.FontUnderline.DoubleAccounting}function m(e,t,r,n){var o=Math.min(e,t),i=Math.max(e,t),a=Math.min(r,n),l=Math.max(r,n);return{start:Math.max(o,a),end:Math.min(i,l)}}function C(e,t){if(0!==t.LineWidth){var r=t.Y+i.getLinePixelTranslation(t.LineWidth);!function(e,t,r,n){e.moveTo(t,n),e.lineTo(r,n)}(e,t.StartX,t.EndX,r)}}t.measureAndCacheTextDecorationLayout=function(e,t,r,n){var o=r.CachedFont.Underline,i=r.CachedFont.StrikeThrough;(o||i)&&""!==r.CachedDisplayText&&(n.textWidth=d.getTextWidth(e,t,r),g(t,r,n,r.CachedFont))},t.cacheTextDecorationLayout=g,t.drawTextDecoration=function(e,t,r){var o,d,s,u,c;i.verifyArgumentNotNull(t.Cells,"model.cells","drawTextDecoration"),e.beginPath();for(var g=0;g<t.Cells.length;g++){var f=t.Cells[g];if(a.cellIntersectsRenderingRegion(f,r.renderingRegion)&&(i.verifyArgumentNotNull(f.CachedFont,"cell.CachedFont","drawTextDecoration"),(f.CachedFont.StrikeThrough||f.CachedFont.Underline||f.TextRuns)&&!(l.isRenderFlagEnabled(n.RenderFlags.CFIcons,t)&&f.CondFormat&&(null===(o=f.CondFormat)||void 0===o?void 0:o.Icon)&&(null===(s=null===(d=f.CondFormat)||void 0===d?void 0:d.Icon)||void 0===s?void 0:s.IconOnly)))){i.verifyArgumentNotNull(f.CachedDrawingLayout,"cell.CachedDrawingLayout","drawTextDecoration");for(var h=f.CachedDrawingLayout.UnderlineRuns,m=f.CachedDrawingLayout.StrikethroughRuns,p=r.highContrastScheme?a.getHighContrastTextColor(t,f,r.highContrastScheme):void 0,y=0,v=[h,m];y<v.length;y++){var F=v[y];if(F&&F.length>0){if(!u||!c){var w=F[0];u=S=null!=p?p:w.Color,c=w.LineWidth,e.strokeStyle=S,e.lineWidth=w.LineWidth}for(var T=0;T<F.length;T++){var S,R=F[T],x=u!==(S=null!=p?p:R.Color),b=c!==R.LineWidth;(x||b)&&(u=S,c=R.LineWidth,e.stroke(),e.strokeStyle=S,e.lineWidth=R.LineWidth,e.beginPath()),C(e,R)}}}}}e.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27),o=r(62),i=r(2),a=n.UserContentList.Cell.concat(n.UserContentList.GridBlockModel).concat(n.UserContentList.CellStyle).concat(n.UserContentList.Font).concat(n.UserContentList.BorderStyle).concat(n.UserContentList.AutoFilter).concat(n.UserContentList.PivotFilter).concat(n.UserContentList.MenuItem).concat(n.UserContentList.FormulaInformation).concat(n.UserContentList.NumberFormatInformation);function l(e){return e.toLowerCase().replace(o.DigitReplaceValue,o.CharacterReplaceValue).replace(o.Digit,o.DigitReplaceValue).replace(o.ValueAnnonymizerRegex,o.CharacterReplaceValue)}function d(e){return function(t,r){return r&&e&&e.indexOf(t)>-1?l(r):r}}t.serializeCell=function(e,t){return e&&t?(e.CachedStyle=i.getReferencedObjectToCache(e.StyleID,t.Styles),e.CachedBorderStyle=i.getReferencedObjectToCache(e.BorderStyleID,t.BorderStyles),e.CachedFont=i.getReferencedObjectToCache(e.CachedStyle.FontID,t.Fonts),a?JSON.stringify(e,d(a)):JSON.stringify(e)):""},t.serializeModel=function(e){return e?a?JSON.stringify(e,d(a)):JSON.stringify(e):""},t.annonymize=l},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(2);!function(e){e[e.Initialized=0]="Initialized",e[e.Loading=1]="Loading",e[e.Loaded=2]="Loaded",e[e.LoadFailed=3]="LoadFailed"}(n=t.ImageLoadStatus||(t.ImageLoadStatus={})),function(e){e[e.Sparkline=0]="Sparkline"}(t.ImageType||(t.ImageType={}));var i={onImageLoadSuccessCallback:void 0,onImageLoadFailureCallback:void 0},a={};function l(e,t,r,o){var i=g(e);if(i||(f(e,i={blockIdentifiers:[t],status:n.Initialized,version:r,url:o}),o))switch(i.status){case n.Loaded:return i.image;case n.LoadFailed:return;case n.Loading:return void u(t,i);case n.Initialized:return u(t,i),void(i.url&&c(i));default:throw Error("getOrLoadImageByKey: unexpected image statue: "+i.status)}}function d(e){return"STATIC"+e}function s(e,t){return e+t}function u(e,t){-1===t.blockIdentifiers.indexOf(e)&&t.blockIdentifiers.push(e)}function c(e){if(!e.url)throw Error("image url is not set, unexpected call");var t=new Image;t.onload=function(){e.status=n.Loaded,o.verifyArgumentNotNull(i.onImageLoadSuccessCallback,"onImageLoadSuccessCallback","imageLoader::onload"),i.onImageLoadSuccessCallback(e.blockIdentifiers),e.blockIdentifiers=[]},t.onerror=function(){e.status=n.LoadFailed,o.verifyArgumentNotNull(i.onImageLoadFailureCallback,"onImageLoadFailureCallback","imageLoader::onerror"),i.onImageLoadFailureCallback("image failed to load, URL: "+e.url+", registeredModelsCount: "+e.blockIdentifiers.length+", registeredModelsCount: "+e.blockIdentifiers),e.blockIdentifiers=[]},t.src=e.url,e.image=t,e.status=n.Loading}function g(e){return a[e]}function f(e,t){a[e]=t}function h(e){a[e]=void 0}t.initializeGridRendererImageLoader=function(e,t){i.onImageLoadSuccessCallback=e,i.onImageLoadFailureCallback=t},t.setStaticImageUrl=function(e,t){o.verifyArgumentNotNull(t,"url","setStaticImageUrl");var r=d(e),i=g(r);if(i){if(i.url)throw Error("setStaticImageUrl: image url already defined. image: "+e+", old url: "+i.url+", new url: "+t);i.url=t,c(i)}else f(r,{blockIdentifiers:[],status:n.Initialized,url:t})},t.clearImageFromCache=function(e,t){var r=s(e,t);g(r)&&h(r)},t.getOrLoadVersionedImage=function(e,t,r,n,o){var i=s(e,n),a=g(i);return!a||a.version===t&&a.url===r||h(i),l(i,o,t,r)},t.getOrLoadStaticImage=function(e,t){return l(d(e),t,void 0,void 0)},t.testHelper={getImageCacheItem:function(e){return g(e)},resetImageCache:function(){for(var e in a)delete a[e]},getImageKey:function(e,t){return s(e,t)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(9);function a(e,t,r,n){var a=t.image,d=t.size,s=t.left,u=t.bottom,c=d/2;if(!(c<=0)){var g=Math.round(s+c),f=Math.round(u-c);if(l(e,g,f,c,o.Circle0Deg,o.Circle360Deg,r),n){var h=c-o.IconOutlineWidthPx;if(h<=0)return;!function(e,t,r,n,a,d){switch(d){case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:var s=function(e){switch(e){case o.CFIconImage.Circle25:return o.Circle0Deg;case o.CFIconImage.CircleHalf:return o.Circle90Deg;case o.CFIconImage.Circle75:return o.Circle180Deg;default:throw Error("getEndFilledAngle: image: "+e+" not supported")}}(d);l(e,t,r,n,o.Circle270Deg,s,i.CircleFilledInnerColor),l(e,t,r,n,s,o.Circle270Deg,i.CircleEmptyInnerColor);break;default:l(e,t,r,n,o.Circle0Deg,o.Circle360Deg,a)}}(e,g,f,h,n,a)}}}function l(e,t,r,n,o,i,a){e.fillStyle=a,e.beginPath(),e.moveTo(t,r),e.arc(t,r,n,o,i),e.fill()}t.drawCircleIcon=function(e,t,r,l){n.verifyArgumentNotNull(e,"ctx","drawCircleIcon"),n.verifyArgumentNotNull(t,"model","drawCircleIcon"),n.verifyArgumentNotNull(r,"cell","drawCircleIcon"),n.verifyArgumentNotNull(l,"drawingContext","drawCircleIcon");var d=l.image;a(e,l,function(e){switch(e){case o.CFIconImage.CircleHigh:case o.CFIconImage.TrafficHigh:case o.CFIconImage.CircleSymbolHigh:return i.CircleHighOuterColor;case o.CFIconImage.CircleMedium:case o.CFIconImage.TrafficMedium:case o.CFIconImage.CircleSymbolMedium:return i.CircleMediumOuterColor;case o.CFIconImage.CircleLow:case o.CFIconImage.TrafficLow:case o.CFIconImage.CircleSymbolLow:return i.CircleLowOuterColor;case o.CFIconImage.CircleEmpty:return i.CircleEmptyOuterColor;case o.CFIconImage.CircleFilled:case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:return i.CircleFilledOuterColor;case o.CFIconImage.FourCircleHigh:return i.FourCircleHighOuterColor;case o.CFIconImage.FourCircleLow:return i.FourCircleLowOuterColor;case o.CFIconImage.FourCircleMedium1:return i.FourCircleMedium1OuterColor;case o.CFIconImage.FourCircleMedium2:return i.FourCircleMedium2OuterColor;default:throw Error("getCircleOuterColor: unsupported image type = "+e)}}(d),function(e){switch(e){case o.CFIconImage.CircleHigh:case o.CFIconImage.TrafficHigh:case o.CFIconImage.CircleSymbolHigh:return i.CircleHighInnerColor;case o.CFIconImage.CircleMedium:case o.CFIconImage.TrafficMedium:case o.CFIconImage.CircleSymbolMedium:return i.CircleMediumInnerColor;case o.CFIconImage.CircleLow:case o.CFIconImage.TrafficLow:case o.CFIconImage.CircleSymbolLow:return i.CircleLowInnerColor;case o.CFIconImage.CircleEmpty:return i.CircleEmptyInnerColor;case o.CFIconImage.CircleFilled:return i.CircleFilledInnerColor;case o.CFIconImage.FourCircleHigh:return i.FourCircleHighInnerColor;case o.CFIconImage.FourCircleLow:return;case o.CFIconImage.FourCircleMedium1:return i.FourCircleMedium1InnerColor;case o.CFIconImage.FourCircleMedium2:return i.FourCircleMedium2InnerColor;case o.CFIconImage.Circle25:case o.CFIconImage.CircleHalf:case o.CFIconImage.Circle75:return o.UnusedColor;default:throw Error("getCircleInnerColor: unsupported image type = "+e)}}(d))},t.drawCircle=a},function(e,t,r){"use strict";function n(e,t,r){e.fillStyle=t,e.fill(),e.strokeStyle=r,e.stroke()}Object.defineProperty(t,"__esModule",{value:!0}),t.fillAndStroke=n,t.drawIconFromPoints=function(e,t,r,o){e.beginPath(),e.moveTo(o[0].x,o[0].y);for(var i=1;i<o.length;i++)e.lineTo(o[i].x,o[i].y);n(e,t,r)}},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return a})),r.d(t,"__decorate",(function(){return l})),r.d(t,"__param",(function(){return d})),r.d(t,"__metadata",(function(){return s})),r.d(t,"__awaiter",(function(){return u})),r.d(t,"__generator",(function(){return c})),r.d(t,"__createBinding",(function(){return g})),r.d(t,"__exportStar",(function(){return f})),r.d(t,"__values",(function(){return h})),r.d(t,"__read",(function(){return m})),r.d(t,"__spread",(function(){return C})),r.d(t,"__spreadArrays",(function(){return p})),r.d(t,"__await",(function(){return y})),r.d(t,"__asyncGenerator",(function(){return v})),r.d(t,"__asyncDelegator",(function(){return F})),r.d(t,"__asyncValues",(function(){return w})),r.d(t,"__makeTemplateObject",(function(){return T})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return R})),r.d(t,"__classPrivateFieldGet",(function(){return x})),r.d(t,"__classPrivateFieldSet",(function(){return b}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)};function o(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function a(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function l(e,t,r,n){var o,i=arguments.length,a=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,r,n);else for(var l=e.length-1;l>=0;l--)(o=e[l])&&(a=(i<3?o(a):i>3?o(t,r,a):o(t,r))||a);return i>3&&a&&Object.defineProperty(t,r,a),a}function d(e,t){return function(r,n){t(r,n,e)}}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function u(e,t,r,n){return new(r||(r=Promise))((function(o,i){function a(e){try{d(n.next(e))}catch(e){i(e)}}function l(e){try{d(n.throw(e))}catch(e){i(e)}}function d(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(a,l)}d((n=n.apply(e,t||[])).next())}))}function c(e,t){var r,n,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function l(i){return function(l){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;a;)try{if(r=1,n&&(o=2&i[0]?n.return:i[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,i[1])).done)return o;switch(n=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,n=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],n=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,l])}}}function g(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]}function f(e,t){for(var r in e)"default"===r||t.hasOwnProperty(r)||(t[r]=e[r])}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function m(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,i=r.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)a.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(o)throw o.error}}return a}function C(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(m(arguments[t]));return e}function p(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var i=arguments[t],a=0,l=i.length;a<l;a++,o++)n[o]=i[a];return n}function y(e){return this instanceof y?(this.v=e,this):new y(e)}function v(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),i=[];return n={},a("next"),a("throw"),a("return"),n[Symbol.asyncIterator]=function(){return this},n;function a(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||l(e,t)}))})}function l(e,t){try{(r=o[e](t)).value instanceof y?Promise.resolve(r.value.v).then(d,s):u(i[0][2],r)}catch(e){u(i[0][3],e)}var r}function d(e){l("next",e)}function s(e){l("throw",e)}function u(e,t){e(t),i.shift(),i.length&&l(i[0][0],i[0][1])}}function F(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:y(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function w(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=h(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function T(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function R(e){return e&&e.__esModule?e:{default:e}}function x(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function b(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),o=r(0),i=document.createElement("div"),a=document.createElement("img"),l=document.createElement("img");i.innerText=".",i.style.visibility="hidden",a.style.height="0px",l.style.height="0px",i.appendChild(a),i.appendChild(l),document.body.appendChild(i);var d={"6pt Arial":{height:9,baseline:2,middle:4.072916},"7pt Arial":{height:11,baseline:2,middle:4.416666698},"8pt Arial":{height:12,baseline:2.666666030883789,middle:4.765625},"9pt Arial":{height:14,baseline:3.33333,middle:6.109375},"10pt Arial":{height:15,baseline:3.6666666,middle:6.453125},"11pt Arial":{height:16,baseline:4,middle:6.796875},"12pt Arial":{height:19,baseline:4.33333333,middle:8.15625},"13pt Arial":{height:21,baseline:4.6666666679,middle:9.15625},"14pt Arial":{height:22,baseline:4.666666030883789,middle:9.84375},"16pt Arial":{height:25,baseline:5.33333333,middle:11.53125},"18pt Arial":{height:28,baseline:5.66666666,middle:12.21875},"20pt Arial":{height:30,baseline:6,middle:12.9166666},"22pt Arial":{height:34,baseline:6.666667938232422,middle:14.609375},"24pt Arial":{height:37,baseline:7.333333,middle:15.63541},"25pt Arial":{height:39,baseline:8,middle:16.6458339},"26pt Arial":{height:40,baseline:8,middle:16.984375},"28pt Arial":{height:43,baseline:8.6666666,middle:18.3437},"36pt Arial":{height:55,baseline:10.666667938232422,middle:23.453125},"16pt Browallia New":{height:27,baseline:8,middle:11.6145839},"6pt Calibri":{height:9,baseline:2,middle:3.8541669},"7pt Calibri":{height:11,baseline:2.666666698,middle:4.8333333969},"8pt Calibri":{height:13,baseline:2.6666669845581055,middle:5.46875},"9pt Calibri":{height:15,baseline:3.3333330154418945,middle:5.78125},"10pt Calibri":{height:17,baseline:3.3333330154418945,middle:7.09375},"11pt Calibri":{height:18,baseline:4,middle:7.40625},"12pt Calibri":{height:19,baseline:4,middle:7.71875},"13pt Calibri":{height:21,baseline:4.6666666,middle:8.6875},"14pt Calibri":{height:21,baseline:5.33333396911621,middle:9.328125},"15pt Calibri":{height:23,baseline:5.6666666667,middle:9.640625},"16pt Calibri":{height:26,baseline:6,middle:10.953125},"18pt Calibri":{height:29,baseline:6.666666030883789,middle:11.578125},"20pt Calibri":{height:32,baseline:7.333333969116211,middle:13.1875},"22pt Calibri":{height:36,baseline:8,middle:14.8125},"24pt Calibri":{height:39,baseline:8.666666793,middle:16.09375},"26pt Calibri":{height:43,baseline:9.333333,middle:17.3854179},"28pt Calibri":{height:45,baseline:10,middle:18.666666},"36pt Calibri":{height:59,baseline:12.666666679,middle:24.140625},"48pt Calibri":{height:72,baseline:17.333332061767578,middle:31.859375},"65pt Calibri":{height:106,baseline:23.3333328,middle:43.458332061},"14pt Comic Sans MS":{height:26,baseline:5.3333332061,middle:10.03125},"6pt Times New Roman":{height:10,baseline:2.666665,middle:4.45833301},"7pt Times New Roman":{height:11,baseline:2.666666698,middle:4.75},"8pt Times New Roman":{height:11,baseline:2.666666030883789,middle:4.390625},"8.5pt Times New Roman":{height:12,baseline:2.8888888888884,middle:4.53125},"9pt Times New Roman":{height:14,baseline:3,middle:6.6875},"10pt Times New Roman":{height:15,baseline:3.3333333,middle:6.984375},"11pt Times New Roman":{height:17,baseline:4,middle:7.28125},"12pt Times New Roman":{height:18,baseline:4.3333333,middle:7.578125},"13pt Times New Roman":{height:19,baseline:4.5,middle:8.875},"14pt Times New Roman":{height:22,baseline:4.666666030883789,middle:9.171875},"15pt Times New Roman":{height:23,baseline:4.6666667938,middle:9.13541793},"16pt Times New Roman":{height:25,baseline:5.333333,middle:10.765625},"18pt Times New Roman":{height:28,baseline:6,middle:11.375},"19pt Times New Roman":{height:29,baseline:6,middle:11.666666603},"20pt Times New Roman":{height:31,baseline:6.666666603,middle:12.635416},"8pt Tahoma":{height:13,baseline:2,middle:4.90625},"10pt Tahoma":{height:16,baseline:2.6666666,middle:6.30208301},"11pt Tahoma":{height:18,baseline:3.3333333015,middle:7.333333015},"12pt Trebuchet MS":{height:19,baseline:3.333333,middle:7.5208339691},"14pt Trebuchet MS":{height:22,baseline:4,middle:8.875},"8pt Verdana":{height:13,baseline:2,middle:4.90625},"10pt Verdana":{height:16,baseline:2.66666603,middle:6.302083015}};function s(e){var t=-1,r=-1,o=-1,d=a,s=l;return i.style.font=e,d.style.verticalAlign="baseline",s.style.verticalAlign="middle",n.trackDuration(n.RenderPerformanceMetric.GetFontMetrics,(function(){t=i.clientHeight,r=u(d),o=u(s)}),!0),{height:t,baseline:r,middle:o}}function u(e){return i.getBoundingClientRect().bottom-e.getBoundingClientRect().bottom}t.getCachedFontMetrics=function(e,t){var r=function(e,t){var r=o.canonizeFontName(e);return t+"pt "+r}(e,t),a=d[r];if(a)return a;if(t>=0&&t<1)return d[r]={baseline:0,height:1,middle:0},d[r];var l=s(r);if(0===l.height&&t>=1){var u=null!==i.parentNode?"Has Parent":"Parent is null",c=window.getComputedStyle(i).getPropertyValue("display");i.style.display="block",document.body.appendChild(i);var g=s(r),f=window.getComputedStyle(i),h=f.getPropertyValue("display"),m=f.getPropertyValue("height"),C=i.getBoundingClientRect();if(0!==g.height)return d[r]=g,g;i.style.overflow="hidden";var p=s(r);if(0!==p.height)return d[r]=p,p;var y="\n       fontMetricsDivHeight == 0.\n       Font name: "+o.getFontNameForLogging(e)+", font size: "+t+".\n       fontMetricsDiv "+u+". fontMetricsDivDisplayMode: "+c+".\n       After another appendChild:\n       FontMetricsDivHeight2: "+g.height+" (getFontMetricsDivHeight), fontMetricsDivDisplayMode: "+h+" (getComputedStyle),\n       fontBoundingClientRect.height: "+C.height+", top:"+C.top+", bottom:"+C.bottom+".\n       css.height: "+f.height+", css.line-height: "+f.lineHeight+", computedHeight: "+m+".\n       FontMetricsDiv.scrollWidth: "+i.scrollWidth+", fontMetricsDiv.scrollHeight: "+i.scrollHeight;if(n.setDivMetricWarning(y),e!==o.getFontNameForLogging(e)){var v=Math.round(t)+"pt Calibri";if(d[v])return d[v]}throw Error(y)}return d[r]=l,d[r]},t.recalculateFontHeights=function(e){for(var t=Object.getOwnPropertyNames(d),r=0;r<t.length;r++){var n=t[r];n.indexOf(e)>=0&&(d[n]=s(n))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(4),i=r(27),a=r(2),l=i.comparisonIgnoreLists.GridBlockModel.concat(["Cells"]),d=i.comparisonIgnoreLists.Cell,s=d.concat(["Text"]),u=i.comparisonIgnoreLists.ReferencedObject,c=i.comparisonIgnoreLists.CellStyle.concat(u),g=i.comparisonIgnoreLists.TextRun.concat(["Fonts"]);function f(e,t,r,o){e.CachedStyle=a.getReferencedObjectToCache(e.StyleID,r.Styles),t.CachedStyle=a.getReferencedObjectToCache(t.StyleID,o.Styles),e.CachedBorderStyle=a.getReferencedObjectToCache(e.BorderStyleID,r.BorderStyles),t.CachedBorderStyle=a.getReferencedObjectToCache(t.BorderStyleID,o.BorderStyles),e.CachedFont=a.getReferencedObjectToCache(e.CachedStyle.FontID,r.Fonts),t.CachedFont=a.getReferencedObjectToCache(t.CachedStyle.FontID,o.Fonts);var i=a.isAccAndCustomNumFmtApplicable(e,r)&&a.isAccAndCustomNumFmtApplicable(t,o);a.isRenderFlagEnabled(n.RenderFlags.RichTextFormat,r)&&v(e.TextRuns,t.TextRuns,r.Fonts,o.Fonts);var l=m(e,t,function(e){return e?s:d}(i));return l.isEqual||(l.message+="\nareCellsEqual: cell1.Row = "+e.Row+", cell1.Col = "+e.Col+", cell2.Row = "+t.Row+", cell2.Col = "+t.Col),l}function h(e,t,r){if(e===t)return{isEqual:!0};if(void 0===e&&void 0===t)return{isEqual:!0};if(void 0===e||void 0===t)return void 0===e?{isEqual:!1,message:"areArraysEqual: the first array is undefined."}:{isEqual:!1,message:"areArraysEqual: the second array is undefined."};if(e.length!==t.length)return{isEqual:!1,message:"areArraysEqual: arrays length are different. length1: "+e.length+", length2: "+t.length};for(var n=0;n<e.length;n++){var o=m(e[n],t[n],r);if(!o.isEqual)return o.message+="\nareArraysEqual: array objects are different. index: "+n,o}return{isEqual:!0}}function m(e,t,r){if(e===t)return{isEqual:!0};if(o.isNullOrUndefined(e)&&o.isNullOrUndefined(t))return{isEqual:!0};if(null==e||null==t)return{isEqual:!1,message:"areObjectsEqual: one object is null, o1 = "+!e+", o2 = "+!t};if(e!=e)return{isEqual:t!=t,message:"areObjectsEqual: NaN comparison"};var n=function(e,t){if(!e||!t)return e||t;var r=t.filter((function(t){return-1===e.indexOf(t)}));return e.concat(r)}(C(e,r),C(t,r));if(0===n.length)return{isEqual:e===t,message:"areObjectsEqual: simple object comparison"};for(var i=0;i<n.length;i++){var a=n[i],l=e[a],d=t[a],s=typeof l,u=typeof d;if(!o.isNullOrUndefined(l)||!o.isNullOrUndefined(d)){if(s!==u){if(p(l)&&p(d))continue;return{isEqual:!1,message:"areObjectsEqual: object types are different. propName = "+a+" type1 = "+s+", type2 = "+u}}switch(s){case"undefined":case"boolean":case"string":case"number":if(l!==d)return{isEqual:!1,message:"areObjectsEqual: simple types comparison, propertyName = "+a};break;case"object":if(l instanceof Array){if(!(d instanceof Array))return{isEqual:!1,message:"areObjectsEqual: array 2 is not an array, propertyName = "+a};if(!(c=h(l,d,y(a))).isEqual)return c.message+="\nareObjectsEqual: arrays mismatch, propertyName = "+a,c}else{var c;if(!(c=m(l,d,y(a))).isEqual)return c.message+="\nareObjectsEqual: objects mismatch, propertyName = "+a,c}break;default:return{isEqual:!1,message:"areObjectsEqual: unexpected type: "+s+", propertyName = "+a}}}}return{isEqual:!0}}function C(e,t){if("object"!=typeof e)return[];var r=Object.getOwnPropertyNames(e);return t?r.filter((function(e){return-1===t.indexOf(e)})):r}function p(e){return null==e||""===e||!1===e}function y(e){var t=i.propertyToClassMap[e];if(t){for(var r=[],n=0;n<t.length;n++)r=r.concat(i.comparisonIgnoreLists[t[n]]);return r}}function v(e,t,r,n){if(e&&t&&e.length===t.length)for(var o=0;o<e.length;o++)e[o].CachedFont=a.getReferencedObjectToCache(e[o].FontID,r),t[o].CachedFont=a.getReferencedObjectToCache(t[o].FontID,n)}t.areGridBlockModelsEqual=function(e,t){var r=m(e,t,l);return r.isEqual&&(r=function(e,t,r,n){if(e===t)return{isEqual:!0};if(e.length!==t.length)return{isEqual:!1,message:"areModelCellsEqual: Cells arrays length are different. length1: "+e.length+", length2: "+t.length};if(!r||!n)return{isEqual:!1,message:"areModelCellsEqual: one or more model is null: model1: "+!r+", model2: "+!n};for(var o=0;o<e.length;o++){var i=e[o],a=t[o],l=f(i,a,r,n);if(!l.isEqual)return l}return{isEqual:!0}}(e.Cells,t.Cells,e,t)),r},t.areCellsEqual=f,t.areStylesEqual=function(e,t){return m(e,t,c)},t.areFormattedTextsEqual=function(e,t){if(e&&t){if(e.TextRuns&&!e.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText1 has Textruns without Fonts."};if(t.TextRuns&&!t.Fonts)return{isEqual:!1,message:"couldn't compare formattedTexts, formattedText2 has Textruns without Fonts."};v(e.TextRuns,t.TextRuns,e.Fonts,t.Fonts)}return m(e,t,g)},t.areArraysEqual=h},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.comparisonIgnoreLists={},t.comparisonIgnoreLists.GridBlockModel=["RowOutlines","ColumnOutlines","Styles","Fonts","BorderStyles","CellsEncoding","RenderFlags","IsDirty","CellLookup","DirtyTimestamp","RowOffsetsAdjustedForDrawing","ColOffsetsAdjustedForDrawing"],t.comparisonIgnoreLists.Cell=["Formula","StyleID","Ifmt","IfmtStamped","BorderStyleID","HorizontalAlignmentSet","ShrunkSize","AutoFilter","PivotFilter","TextRuns","CommentID","RichValueType","ValueType","CachedDrawingLayout","CachedDisplayText","CachedIsTextWidthExceedsCellWidth","Value","UserInput","PhoneticInfo","OriginalText","ErrorTooltip"],t.comparisonIgnoreLists.ReferencedObject=["ID","RefCount"],t.comparisonIgnoreLists.CellStyle=["NamedStyleId","FontID","IsUnlocked","IsHidden"],t.comparisonIgnoreLists.FormulaInformation=["Formula","FormulaType"],t.comparisonIgnoreLists.MergeInformation=["WidthAdjustedForDrawing","HeightAdjustedForDrawing","OriginDeltaXAdjustedForDrawing","OriginDeltaYAdjustedForDrawing","SpansNextBlockVertically","SpansNextBlockHorizontally"],t.comparisonIgnoreLists.TextRun=["FontID"],t.comparisonIgnoreLists.RangeInformation=["RangeType"],t.comparisonIgnoreLists.PivotTableRangeInformation=["ConnectionName","ConfirmationRequiredForDataOps","FieldListVersion","FieldWellVersion","ColumnTotalIndexes","RowTotalIndexes","ColumnMemberPropIndexes","RowMemberPropIndexes","ColumnHeaderRange","RowHeaderRange","RowAreaCaptions","ExternalSourceIndex","IsActionable","IsOlap","SupportsBIExplore","Xluid","ShowDrillIndicators","ShowColumnStripes","ShowRowStripes","ShowRowHeaders","ShowColumnHeaders","DataSource","RowLocation","ColGrandTotalOn","RwGrandTotalOn","IndentIncrement","AutoFormatOnUpdate","ShowItemsWithNoDataOnRw","ShowItemsWithNoDataOnCol","SaveSourceDataWithFile","RefreshOnLoad","AltText","AltTextSummary","ErrorString","NullString","DataPivotFieldCaption","DataPivotFieldIndex","DisplayErrorString","DisplayNullString","HasActiveFilter","IsPageArea","RowAreaFields","ColumnAreaFields","ValueAreaFields","PageAreaFields","CurrentStyleName","OriginPTWidthAdjustedForDrawing","OriginPTHeightAdjustedForDrawing","DeltaXFromOriginPTAdjustedForDrawing","DeltaYFromOriginPTAdjustedForDrawing"],t.comparisonIgnoreLists.Hyperlink=["IsHyperlinkChecked"],t.comparisonIgnoreLists.Sparklines=["Ranges"],t.propertyToClassMap={},t.propertyToClassMap.Cells=["Cell"],t.propertyToClassMap.Styles=["CellStyle","ReferencedObject"],t.propertyToClassMap.Fonts=["Font","ReferencedObject"],t.propertyToClassMap.BorderStyles=["BorderStyle","ReferencedObject"],t.propertyToClassMap.PageBreaks=["PageBreaksInformation"],t.propertyToClassMap.PrintAreas=["SharedRange"],t.propertyToClassMap.PivotTables=["PivotTableRangeInformation","RangeInformation","SharedRange"],t.propertyToClassMap.Sparklines=["Sparklines"],t.propertyToClassMap.Spill=["SpillInformation"],t.propertyToClassMap.Merge=["MergeInformation"],t.propertyToClassMap.NumFmt=["NumberFormatInformation"],t.propertyToClassMap.WrapText=["WrapTextInformation"],t.propertyToClassMap.AutoFilter=["AutoFilter"],t.propertyToClassMap.PivotFilter=["PivotFilter"],t.propertyToClassMap.TextRuns=["TextRun"],t.propertyToClassMap.CondFormat=["ConditionalFormattingInformation"],t.propertyToClassMap.FormulaInfo=["FormulaInformation"],t.propertyToClassMap.Hyperlink=["Hyperlink"],t.propertyToClassMap.Sparkline=["SparklineInformation"],t.propertyToClassMap.CachedStyle=["CellStyle","ReferencedObject"],t.propertyToClassMap.CachedFont=["Font","ReferencedObject"],t.propertyToClassMap.CachedBorderStyle=["BorderStyle","ReferencedObject"],t.propertyToClassMap.Menu=["AutoFilterMenu"],t.propertyToClassMap.Icon=["ConditionalFormattingIcon"],t.propertyToClassMap.DataBar=["DataBarInformation"],t.propertyToClassMap.Sections=["MenuSection"],t.propertyToClassMap.MenuItems=["MenuItem"],t.propertyToClassMap.SubMenu=["AutoFilterMenu"],t.propertyToClassMap.Gradient=["GradientFill"],t.propertyToClassMap.Borders=["Border"],t.propertyToClassMap.Color=["RGBColor"],t.propertyToClassMap.Stops=["ColorStop"],t.propertyToClassMap.Row=["RowColBreak"],t.propertyToClassMap.Col=["RowColBreak"],t.propertyToClassMap.ColumnHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowHeaderRange=["RangeInformation","SharedRange"],t.propertyToClassMap.RowAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ColumnAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.ValueAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.PageAreaFields=["PivotTableFieldInfo"],t.propertyToClassMap.Ranges=["SparklineRangeInformation","RangeInformation","SharedRange"],t.UserContentList={},t.UserContentList.Cell=["Text","Formula","CachedDisplayText","Value","UserInput","OriginalText"],t.UserContentList.AutoFilter=["CommandData"],t.UserContentList.PivotFilter=["CommandData"],t.UserContentList.MenuItem=["CommandData","Label"],t.UserContentList.FormulaInformation=["Formula"],t.UserContentList.NumberFormatInformation=["Start","End","Separator"],t.UserContentList.Font=["FontName"],t.SerializationProperties={},t.SerializationPropertyKey="{className}.{propertyName}",t.SerializationProperties["GridBlockModel.BlockWidth"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.BlockHeight"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowOffsets"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnOffsets"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowHeights"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnWidths"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowNumbers"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnNumbers"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RowOutlines"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ColumnOutlines"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.ShowGridLines"]={type:"boolean",tsOnly:!1},t.SerializationProperties["GridBlockModel.IsRtl"]={type:"boolean",tsOnly:!1},t.SerializationProperties["GridBlockModel.GridLineColor"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.BackgroundColor"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Cells"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Styles"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Fonts"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.BorderStyles"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.CellsEncoding"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.RenderFlags"]={type:"number",tsOnly:!1},t.SerializationProperties["GridBlockModel.IsDirty"]={type:"boolean",tsOnly:!0},t.SerializationProperties["GridBlockModel.CellLookup"]={type:"object",tsOnly:!0},t.SerializationProperties["GridBlockModel.DirtyTimestamp"]={type:"object",tsOnly:!0},t.SerializationProperties["GridBlockModel.RowOffsetsAdjustedForDrawing"]={type:"object",tsOnly:!0},t.SerializationProperties["GridBlockModel.ColOffsetsAdjustedForDrawing"]={type:"object",tsOnly:!0},t.SerializationProperties["GridBlockModel.PageBreaks"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.PrintAreas"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.PivotTables"]={type:"object",tsOnly:!1},t.SerializationProperties["GridBlockModel.Sparklines"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.Col"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.Row"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.Text"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.Formula"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.StyleID"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.Ifmt"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.IfmtStamped"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.BorderStyleID"]={type:"number",tsOnly:!1},t.SerializationProperties["Cell.HorizontalAlignmentSet"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Cell.Spill"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.Merge"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.NumFmt"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.WrapText"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.ShrunkSize"]={type:"number",tsOnly:!0},t.SerializationProperties["Cell.AutoFilter"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.PivotFilter"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.TextRuns"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.CondFormat"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.CommentID"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.RichValueType"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.FormulaInfo"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.ValueType"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.HasError"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Cell.Hyperlink"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.Sparkline"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.CachedStyle"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedFont"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedBorderStyle"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedDrawingLayout"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedDisplayText"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.CachedIsTextWidthExceedsCellWidth"]={type:"boolean",tsOnly:!0},t.SerializationProperties["Cell.Value"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.UserInput"]={type:"object",tsOnly:!0},t.SerializationProperties["Cell.PhoneticInfo"]={type:"boolean",tsOnly:!1},t.SerializationProperties["Cell.OriginalText"]={type:"object",tsOnly:!1},t.SerializationProperties["Cell.ErrorTooltip"]={type:"boolean",tsOnly:!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.Wrap=0]="Wrap",e[e.Justify=1]="Justify",e[e.Distributed=2]="Distributed"}(t.BreakType||(t.BreakType={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(11),o=r(26),i=r(20),a=r(7),l=r(68),d=r(0),s=r(41),u=r(21),c=function(){function e(){}return e.lookupPerfMetricName=function(e){return n.RenderPerformanceMetric[e]},e.measureTextWidth=function(t,r,n){var o=e.canvasInstance().getContext("2d");if(!o)throw Error("calculateTextWidth: ctx is undefined");return o.font=r,a.measureTextWidth(o,t,n)},e.compareFormattedTexts=function(e,t){return o.areFormattedTextsEqual(e,t)},e.compareGridBlockModels=function(e,t){return o.areGridBlockModelsEqual(e,t)},e.serializeCell=function(e,t){return i.serializeCell(e,t)},e.registerActionOnFontLoad=function(e,t,r){s.registerActionOnFontLoadIfRequired(e,t,r)},e.cleanModelBeforeSerialization=function(e){d.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),l.cleanModelBeforeSerialization(e)},e.restoreModelAfterSerialization=function(e){d.verifyArgumentNotNull(e,"model","restoreModelAfterSerialization"),l.restoreModelAfterSerialization(e)},e.initializeGridRendererImageLoader=function(e,t){u.initializeGridRendererImageLoader(e,t)},e.setStaticImageUrl=function(e,t){u.setStaticImageUrl(e,t)},e.canvasInstance=function(){return e.canvas||(e.canvas=document.createElement("canvas")),e.canvas},e}();t.GridBlockRendererGlobals=c},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24);n.__exportStar(r(48),t),n.__exportStar(r(32),t),n.__exportStar(r(31),t),n.__exportStar(r(29),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(32),o=r(91),i=r(0),a=function(){function e(){}return e.prototype.getModelAccessor=function(e){return i.verifyArgumentNotNull(e,"model","GridBlockRendererFactory.getModelAccessor"),new o.GridBlockModelAccessor(e)},e.prototype.getGridBlockRenderer=function(){return new n.GridBlockRenderer},e}();t.GridBlockRendererFactory=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(17),i=r(53),a=r(54),l=r(11),d=r(55),s=r(56),u=r(10),c=r(3),g=r(66),f=r(0),h=r(4),m=r(2),C=r(37),p=r(38),y=r(42),v=r(19),F=r(69),w=r(13),T=r(70),S=r(81),R=r(84),x=r(85),b=r(86),I=r(88),A=r(90),D=function(){function e(){}return e.prototype.renderBlock=function(e,t,r){var o=this;if(l.clearPerformanceMetrics(),S.loadPolyFills(),!e)return l.createRenderResult(!1,"renderBlock:: canvas is undefined");if(!t)return l.createRenderResult(!1,"renderBlock:: model is undefined");if(!r)return l.createRenderResult(!1,"renderBlock:: context is undefined");if(!d.isCanvasElement(e))return l.createRenderResult(!1,"renderBlock:: canvas is not HTMLCanvasElement");var i,a=null;return l.trackDuration(l.RenderPerformanceMetric.GetContextDurationMs,(function(){a=e.getContext("2d",{alpha:!r.subPixelRenderingEnabled})})),a?(l.trackDuration(l.RenderPerformanceMetric.ModelPreparationsMs,(function(){o.initializeCachedObjects(t),o.createOffsetsForDrawing(t,r.devicePixelRatio),o.updateCellsBeforeDrawing(a,t,r.devicePixelRatio),m.isRenderFlagEnabled(n.RenderFlags.EmptyPivotTable,t)&&o.updatePivotTablesInformationBeforeDrawing(t.PivotTables,r.devicePixelRatio)})),l.trackDuration(l.RenderPerformanceMetric.RenderBlockInternalDurationMs,(function(){i=o.renderBlockInternal(e,a,t,r)})),t.IsDirty=!1,h.isNullOrUndefined(i)&&(i=l.createRenderResult(!0,"")),i.succeeded&&(i.message=h.isNullOrUndefined(i.message)?l.getRenderingMessage():i.message+"; "+l.getRenderingMessage()),i):l.createRenderResult(!1,"renderBlock:: ctx is undefined")},e.prototype.renderBlockInternal=function(t,r,d,u){try{var c,f,h=u.devicePixelRatio,y=r.canvas.width;this.validateRenderingRegion(u.renderingRegion,d),y=Math.round(d.BlockWidth*h);var F=u.renderingRegion;return f=-1*F.startOffsetY*h,c=this.getDrawingOffsetXForRenderingRegion(d,F)*h,e.clearCanvas(r,d,t.width,t.height,u),e.setTransform(r,1,d.IsRtl,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawGridlinesDurationMs,(function(){return o.drawGridLines(r,d,u)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridlinesMs,(function(){l.trackDuration(l.RenderPerformanceMetric.ClearGridLinesForSpannedCellsMs,(function(){p.clearGridLinesForSpannedCells(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.EmptyPivotTable,d)&&l.trackDuration(l.RenderPerformanceMetric.ClearGridLinesForEmptyPivot,(function(){p.clearGridLinesForEmptyPivotTables(r,d,u)}))})),e.setTransform(r,1,!1,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawBackgroundFillMs,(function(){return g.drawBackgroundFill(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.EmptyPivotTable,d)&&l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableTitleContainers,(function(){return b.drawEmptyPivotTableTitleContainers(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.EmptyPivotTable,d)&&l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableImages,(function(){return b.drawEmptyPivotTableImages(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.DataBars,d)&&l.trackDuration(l.RenderPerformanceMetric.DrawDataBarsMs,(function(){return I.drawDataBars(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.CFIcons,d)&&l.trackDuration(l.RenderPerformanceMetric.DrawCFIconsMs,(function(){return T.drawConditionalFormattingIcons(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.Sparklines,d)&&!u.modelFromCache&&l.trackDuration(l.RenderPerformanceMetric.DrawSparklines,(function(){return A.drawSparklines(r,d,u)})),l.trackDuration(l.RenderPerformanceMetric.ClearGridlinesForBorderMs,(function(){C.clearGridLinesForBorder(r,d,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawBordersMs,(function(){return C.drawBorders(r,d,u)})),u.debugMode&&a.addWatermark(r,u),e.setTransform(r,h,!1,c,f,y),l.trackDuration(l.RenderPerformanceMetric.DrawTextDurationMs,(function(){return s.drawCellsText(r,d,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawEmptyPivotTableTitleText,(function(){return b.drawEmptyPivotTableTitleText(r,d,u)})),e.setTransform(r,1,!1,c,f,y),u.skeletonMode&&l.trackDuration(l.RenderPerformanceMetric.DrawSkeletonMs,(function(){return i.drawSkeleton(r,d,u)})),l.trackDuration(l.RenderPerformanceMetric.DrawTextDecoration,(function(){return v.drawTextDecoration(r,d,u)})),e.setTransform(r,1,d.IsRtl,c,f,y),u.renderPageLayout&&(m.isRenderFlagEnabled(n.RenderFlags.PrintArea,d)&&l.trackDuration(l.RenderPerformanceMetric.DrawPrintAreasDurationMs,(function(){return x.drawPrintAreas(r,d,u)})),m.isRenderFlagEnabled(n.RenderFlags.PageBreaks,d)&&l.trackDuration(l.RenderPerformanceMetric.DrawPageBreaksDurationMs,(function(){return R.drawPageBreaks(r,d,u)}))),l.createRenderResult(!0,"finished rendering.")}catch(e){return l.createRenderResult(!1,"exception caught in renderBlockInternal: message: "+e.message+" name: "+e.name+" stack: "+e.stack+" error: "+e)}},e.clearCanvas=function(e,t,r,o,i){i.subPixelRenderingEnabled||f.hasWorkbookBackgroundColor(t.BackgroundColor,m.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t))?l.trackDuration(l.RenderPerformanceMetric.FillRectDurationMs,(function(){e.fillStyle=f.getWorkbookBackgroundColor(i.highContrastScheme,t.BackgroundColor,m.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),e.fillRect(0,0,r,o)})):l.trackDuration(l.RenderPerformanceMetric.ClearRectDurationMs,(function(){e.clearRect(0,0,r,o)}))},e.setTransform=function(e,t,r,n,o,i){r?e.setTransform(-t,0,0,t,i+n,o):e.setTransform(t,0,0,t,n,o)},e.prototype.initializeCachedObjects=function(e){f.verifyArgumentNotNull(e.Cells,"cells","GridBlockRenderer.initializeCachedObjects"),f.verifyArgumentNotNull(e.Styles,"styles","GridBlockRenderer.initializeCachedObjects"),f.verifyArgumentNotNull(e.Fonts,"fonts","GridBlockRenderer.initializeCachedObjects");for(var t=!h.isNullOrUndefined(e.BorderStyles),r=0;r<e.Cells.length;r++){var o=e.Cells[r];if(o.CachedStyle=u.getReferencedObjectById(o.StyleID,e.Styles),t&&!h.isNullOrUndefined(o.BorderStyleID)&&(o.CachedBorderStyle=u.getReferencedObjectById(o.BorderStyleID,e.BorderStyles)),o.CachedFont=u.getReferencedObjectById(o.CachedStyle.FontID,e.Fonts),o.CachedDrawingLayout={UnderlineRuns:[],StrikethroughRuns:[],CellTextLayout:{}},m.isRenderFlagEnabled(n.RenderFlags.RichTextFormat,e)&&!h.isNullOrUndefined(o.TextRuns))for(var i=0;i<o.TextRuns.length;i++){var a=o.TextRuns[i];a.CachedFont=u.getReferencedObjectById(a.FontID,e.Fonts)}o.CachedDisplayText=void 0}},e.prototype.updateCellsBeforeDrawing=function(e,t,r){var o=t.Cells;f.verifyArgumentNotNull(o,"cells","GridBlockRenderer.updateCellsBeforeDrawing");for(var i=0;i<o.length;i++){var a=o[i],l=a.CachedFont.Italic,d=a.CachedFont.FontName!==w.DefaultFontName,s=a.TextRuns&&m.isRenderFlagEnabled(n.RenderFlags.RichTextFormat,t),u=a.CachedFont.Underline!==n.FontUnderline.None||a.CachedFont.StrikeThrough;a.Text&&(a.CachedDisplayText=f.getDisplayText(a,t)),m.isRenderFlagEnabled(n.RenderFlags.MeasureTextRefactor,t)?(a.Text&&f.cellHasShrinkToFit(a)&&F.updateCellShrinkToFit(e,t,a),(l||d||u||s)&&y.updateCellSpill(e,t,a)):((l||d||u||s)&&y.updateCellSpill(e,t,a),a.Text&&f.cellHasShrinkToFit(a)&&F.updateCellShrinkToFit(e,t,a)),a.Merge&&this.updateCellMergeInformation(t,a,r)}},e.prototype.createOffsetsForDrawing=function(e,t){var r=e.RowHeights,n=e.ColumnWidths,o=e.RowOffsets,i=e.ColumnOffsets;f.verifyArgumentNotNull(r,"rowHeights","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(n,"colWidths","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(o,"rowOffsets","GridBlockRenderer.createOffsetsForDrawing"),f.verifyArgumentNotNull(i,"colOffsets","GridBlockRenderer.createOffsetsForDrawing"),e.RowOffsetsAdjustedForDrawing=[];for(var a=0;a<o.length;a++){var l=o[a];e.RowOffsetsAdjustedForDrawing.push(Math.round(l*t))}e.ColOffsetsAdjustedForDrawing=[];for(a=0;a<i.length;a++){l=i[a];e.ColOffsetsAdjustedForDrawing.push(Math.round(l*t))}e.RowOffsetsAdjustedForDrawing.push(c.getBlockDimensionsAdjustedForDrawing(e.BlockHeight,t)),e.ColOffsetsAdjustedForDrawing.push(c.getBlockDimensionsAdjustedForDrawing(e.BlockWidth,t))},e.prototype.updateCellMergeInformation=function(e,t,r){var n=t.Merge;if(n.SpansBlocks){n.HeightAdjustedForDrawing=Math.round(n.Height*r),n.WidthAdjustedForDrawing=Math.round(n.Width*r),n.OriginDeltaXAdjustedForDrawing=Math.round(n.OriginDeltaX*r),n.OriginDeltaYAdjustedForDrawing=Math.round(n.OriginDeltaY*r);var o=e.RowOffsets[t.Row]-n.OriginDeltaY;n.SpansNextBlockVertically=o+n.Height>e.BlockHeight;var i=e.ColumnOffsets[t.Col]-n.OriginDeltaX;n.SpansNextBlockHorizontally=i+n.Width>e.BlockWidth}},e.prototype.updatePivotTablesInformationBeforeDrawing=function(e,t){if(e&&0!==e.length)for(var r=0;r<e.length;r++){var n=e[r];n.DeltaXFromOriginPTAdjustedForDrawing=Math.round(n.DeltaXFromOriginPT*t),n.DeltaYFromOriginPTAdjustedForDrawing=Math.round(n.DeltaYFromOriginPT*t),n.OriginPTHeightAdjustedForDrawing=Math.round(n.OriginPTHeight*t),n.OriginPTWidthAdjustedForDrawing=Math.round(n.OriginPTWidth*t)}},e.prototype.getDrawingOffsetXForRenderingRegion=function(e,t){return e.IsRtl?t.endOffsetX-e.BlockWidth:-1*t.startOffsetX},e.prototype.validateRenderingRegion=function(e,t){f.verifyArgumentNotNull(e,"renderingRegion","validateRenderingRegion");var r=t.RowOffsets[e.startRow],n=t.RowOffsets[e.endRow]+t.RowHeights[e.endRow],o=t.ColumnOffsets[e.startColumn],i=t.ColumnOffsets[e.endColumn]+t.ColumnWidths[e.endColumn];if(r>e.startOffsetY||n<e.endOffsetY)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetY= "+e.startOffsetY+", endOffsetY = "+e.endOffsetY+", firstRowStartOffset= "+r+", lastRowEndOffset= "+n);if(o>e.startOffsetX||i<e.endOffsetX)throw Error("validateRenderingRegion: Invalid renderingRegion. startOffsetX= "+e.startOffsetX+", endOffsetX = "+e.endOffsetX+", firstColumnStartOffset= "+o+", lastColumnEndOffset= "+i)},e}();t.GridBlockRenderer=D},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(4);t.updateNumFmtFromCell=function(e){var t,r,i,a,l,d;if(n.verifyArgumentNotNull(e.Text,"cell.Text","updateNumFmt"),n.verifyArgumentNotNull(e.NumFmt,"cell.NumFmt","updateNumFmt"),!o.isNullOrUndefined(e.NumFmt.End)&&!o.isNullOrUndefined(e.NumFmt.Separator)){var s=function(e,t){for(var r=0,n=0;n<e.length&&e[n]===t;n++)r++;return r}(e.NumFmt.End,e.NumFmt.Separator),u=function(e,t){for(var r=0,n=e.length-1;n>0&&e[n]===t;n++)r++;return r}(e.NumFmt.End,e.NumFmt.Separator),c=function(e,t,r){var n=e.length-t,o=e.substring(0,n),i=o.lastIndexOf(r);if(-1===i)return o;return o.substr(i+1)}(e.Text,u,e.NumFmt.Separator);e.NumFmt.End=function(e,t,r,n){return t.repeat(r)+e+t.repeat(n)}(c,e.NumFmt.Separator,s,u),(null===(r=null===(t=e)||void 0===t?void 0:t.Text)||void 0===r?void 0:r.endsWith((null===(i=e.NumFmt)||void 0===i?void 0:i.Separator)+e.NumFmt.End))&&(null===(l=null===(a=e)||void 0===a?void 0:a.Text)||void 0===l?void 0:l.startsWith((null===(d=e.NumFmt)||void 0===d?void 0:d.Start)||""))||(e.NumFmt=void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(14),o=r(3),i=r(19);t.fillTextUnclipped=function(e,t,r,n,o,a,l,d){e.fillText(t,r,n,o),i.measureAndCacheTextDecorationLayout(e,l,a,{dpr:d,textPositionX:r,textPositionY:n})},t.fillTextClipped=function(e,t,r,a,l,d,s,u,c,g){o.applyClipping(e,d),!g||c?(e.fillText(r,a,l),i.measureAndCacheTextDecorationLayout(e,u,s,{dpr:t.devicePixelRatio,textPositionX:a,textPositionY:l,clipRect:d})):n.fillRichTextFormat(e,t,u,s,g,a,l,d),o.restoreClipping(e,d)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(13);t.approximateValue=function(e,t){var r=Math.round(e);if(r<n.MinAllowedFontSize&&r>0&&(r=n.MinAllowedFontSize),r>n.MaxAllowedFontSize&&(r=n.MaxAllowedFontSize),r<0)throw Error("TextLayout.approximateValue: "+r+" in Excel must be between 1pt and 409pt");var o=t[r];if(o)return o;for(var i=r;i>n.MinAllowedFontSize&&!t[i];)i--;for(var a=r;a<n.MaxAllowedFontSize&&!t[a];)a++;return o=function(e,t,r,n,o){var i=(r-n)/(o-n)*(e-t);return Math.round(t+i)}(t[a],t[i],r,i,a),t[r]=o,o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalibriItalicPadding={1:1,2:1,3:1,4:1,5:2,6:3,7:3,8:4,9:4,10:5,11:5,12:6,13:5,14:7,16:8,18:9,20:11,22:11,24:11,26:13,28:13,36:17,48:23,72:35,100:49,150:74,200:97,300:145,409:194},t.CalibriRegularPadding={1:1,2:1,3:1,4:1,5:1,6:2,7:2,8:2,9:2,10:2,11:2,12:2,13:3,14:3,15:3,16:3,17:3,18:3,19:4,20:4,21:4,22:4,23:4,24:4,25:5,26:5,27:5,28:5,29:5,30:5,31:6,32:6,33:6,34:6,35:6,36:6,37:7,38:7,39:7,40:7,41:7,42:7,43:8,44:8,45:8,46:8,47:8,48:8,49:9,50:9,51:9,52:9,53:9,54:10,55:10,56:10,57:10,58:10,59:10,60:11,61:11,62:11,63:11,64:11,65:11,66:12,67:12,68:12,69:12,70:12,71:12,72:13,73:13,74:13,75:13,76:13,77:13,78:13,79:14,80:14,81:14,82:14,83:14,84:15,85:15,86:15,87:15,88:15,89:15,90:16,91:16,92:16,93:16,94:16,95:16,96:17,97:17,98:17,99:17,100:17,101:17,102:17,103:17,104:17,105:17,106:17,107:17,108:18,150:25,200:33,300:85,409:115},t.CalibriTextDecorationLineWidth={5:0,6:1,11:1,17:1,18:2,35:2,36:3,47:3,48:4,64:5,72:6,100:8,200:17,300:26,409:37},t.FontSizeToIconSize={1:3,3:5,4:6,5:8,8:12,10:12,11:16,12:16,14:20,16:22,18:22,20:26,22:26,24:28,26:32,28:34,36:42,48:57,72:85,100:118,200:234,300:351,400:468,409:478},t.IconHorizontalPadding={1:1,3:1,4:1,5:1,8:1,10:1,11:1,12:1,14:2,16:2,18:2,20:3,22:3,24:4,26:5,28:5,36:7,48:10,72:16,100:22,200:44,300:67,400:89,409:90}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(4),a=r(5),l=r(0),d=r(26),s=r(2),u=r(38),c=r(6),g={},f={};function h(e){l.verifyArgumentNotNull(e,"model","validateModel"),l.verifyArgumentNotNull(e.Cells,"model.Cells","validateModel"),l.verifyArgumentNotNull(e.RowOffsets,"model.RowOffsets","validateModel"),l.verifyArgumentNotNull(e.ColumnOffsets,"model.ColumnOffsets","validateModel"),l.verifyArgumentNotNull(e.RowHeights,"model.RowHeights","validateModel"),l.verifyArgumentNotNull(e.ColumnWidths,"model.ColumnWidths","validateModel")}function m(e,t){return{BorderLineStyle:n.BorderLineType.Thin,Color:t,Weight:a.ThinBorderWeight,BorderPosition:e}}function C(e,t,r,n,o,i){var a=v(e,t,r.BorderPosition,n),l=x(r);l in i||(o.push(r),i[l]=[]),i[l].push(a)}function p(e,t,r,n,o){var i=[],l="",s=a.ThinBorderWeight;!function(e){e.strokeStyle="#000000",e.setLineDash([]),e.lineWidth=a.ThinBorderWeight}(e),e.beginPath();for(var u=0;u<t.length;u++){var c=t[u],g=o||R(c.Color),f=b(c.BorderLineStyle),h=s!==c.Weight*n,m=l!==g,C=!d.areArraysEqual(i,f,[]).isEqual;(h||m||C)&&(e.stroke(),e.beginPath(),h&&(s=c.Weight*n,e.lineWidth=s),m&&(l=g,e.strokeStyle=g),C&&(e.setLineDash(f),i=f));for(var p=r[x(c)],v=0;v<p.length;v++){var F=p[v];y(e,c.Weight,F,n)}}e.stroke()}function y(e,t,r,n){!function(e){return e.Y1===e.Y2}(r)?o.drawLine(e,S(r.X1,t,n),r.Y1-n,S(r.X2,t,n),r.Y2):o.drawLine(e,r.X1-n,S(r.Y1,t,n),r.X2,S(r.Y2,t,n))}function v(e,t,r,o){if(!e.IsRtl)return F(r,{X:c.getCellLeftAdjustedForDrawing(e,t,!1),Y:c.getCellTopAdjustedForDrawing(e,t)},{X:c.getCellRightAdjustedForDrawing(e,t)+o,Y:c.getCellBottomAdjustedForDrawing(e,t)});var i=F(r,{X:c.getCellRightAdjustedForDrawing(e,t)+o,Y:c.getCellTopAdjustedForDrawing(e,t)},{X:c.getCellLeftAdjustedForDrawing(e,t,!1),Y:c.getCellBottomAdjustedForDrawing(e,t)});if(r===n.BorderPositionType.Top||r===n.BorderPositionType.Bottom){var a=i.X2;i.X2=i.X1,i.X1=a}return i}function F(e,t,r){switch(e){case n.BorderPositionType.Top:return{X1:t.X,Y1:t.Y,X2:r.X,Y2:t.Y};case n.BorderPositionType.Bottom:return{X1:t.X,Y1:r.Y,X2:r.X,Y2:r.Y};case n.BorderPositionType.Right:return{X1:r.X,Y1:t.Y,X2:r.X,Y2:r.Y};case n.BorderPositionType.Left:return{X1:t.X,Y1:t.Y,X2:t.X,Y2:r.Y};default:throw Error("borders::getLineCoordinates Encountered non default BorderPositionType value="+e)}}function w(e){switch(e){case n.BorderLineType.Thin:case n.BorderLineType.Medium:case n.BorderLineType.Hair:case n.BorderLineType.Thick:return!0;default:return!1}}function T(e,t,r){var o;if(r.Row===t.RowNumbers.length-1||r.Col===t.ColumnNumbers.length-1)return!0;if(r.Merge||l.isCellAdjacentToMergedCell(r.Row,r.Col,t))return A(e);if(s.isRenderFlagEnabled(n.RenderFlags.HasErrorRefactoring,t)){if(r.HasError)return A(e)}else if(null===(o=r.FormulaInfo)||void 0===o?void 0:o.HasError)return A(e);return e===n.BorderPositionType.Top||e===n.BorderPositionType.Left}function S(e,t,r){var n=l.getLinePixelTranslation(r);return t===a.MediumBorderWeight&&r%2==1?e:e-n}function R(e){var t=e.Red+"_"+e.Green+"_"+e.Blue,r=g[t];return i.isNullOrUndefined(r)?(r="rgb("+e.Red+","+e.Green+","+e.Blue+")",g[t]=r,r):r}function x(e){return R(e.Color)+"-"+e.Weight+"-"+e.BorderLineStyle}function b(e){var t=f[e];if(!i.isNullOrUndefined(t))return t;switch(e){case n.BorderLineType.Dotted:t=a.DottedLineDash;break;case n.BorderLineType.DashDot:case n.BorderLineType.MediumDashDot:t=a.DashedDotLineDash;break;case n.BorderLineType.DashDotDot:case n.BorderLineType.MediumDashDotDot:t=a.DashedDotDotLineDash;break;case n.BorderLineType.MediumDashed:t=a.MediumDashedLineDash;break;case n.BorderLineType.SlantDashDot:case n.BorderLineType.Dashed:t=a.DashedLineDash;break;default:t=[]}return f[e]=t,t}function I(e,t){var r;if(s.isRenderFlagEnabled(n.RenderFlags.HasErrorRefactoring,t)){if(e.HasError)return a.FormulaErrorBorderStyle}else if(null===(r=e.FormulaInfo)||void 0===r?void 0:r.HasError)return a.FormulaErrorBorderStyle;return e.CachedBorderStyle}function A(e){return e<=n.BorderPositionType.Right}t.clearGridLinesForBorder=function(e,t,r){if(t.ShowGridLines&&o.shouldRenderGridLines(l.isHighContrastMode(r),l.hasWorkbookBackgroundColor(t.BackgroundColor,s.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))){h(t),u.setContextForClearingGridLine(e,r,t.BackgroundColor,s.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t));var i=t.Cells;e.beginPath();for(var d=0;d<i.length;d++){var c=i[d],g=I(c,t);if(o.cellIntersectsRenderingRegion(c,r.renderingRegion)&&(g&&g.Borders&&0!==g.Borders.length&&!c.CachedStyle.BackgroundColor))for(var f=g.Borders,m=0;m<f.length;m++){var C=f[m];C.BorderLineStyle!==n.BorderLineType.None&&(w(C.BorderLineStyle)||T(C.BorderPosition,t,c)&&y(e,a.ThinBorderWeight,v(t,c,C.BorderPosition,a.GridLineWidthPx),a.GridLineWidthPx))}}e.stroke()}},t.drawBorders=function(e,t,r){h(t);var i,a,d=o.getDefaultBorderLineWidth(r.devicePixelRatio),u=l.getWorkbookBackgroundColor(r.highContrastScheme,t.BackgroundColor,s.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),c=function(e,t,r,i){for(var a={},l=[],d=[],s={},u=e.Cells,c=0;c<u.length;c++){var g=u[c],f=I(g,e);if((o.cellIntersectsRenderingRegion(g,i.renderingRegion)||(w=g,S=i.renderingRegion,R=void 0,x=void 0,R=w.Col===S.endColumn+1&&w.Row>=S.startRow&&w.Row<=S.endRow,x=w.Row===S.endRow+1&&w.Col>=S.startColumn&&w.Col<=S.endColumn,R||x))&&(f&&f.Borders&&0!==f.Borders.length))for(var h=f.Borders,p=0;p<h.length;p++){var y=h[p];if(y.BorderLineStyle!==n.BorderLineType.None&&T(y.BorderPosition,e,g)){if(y.BorderLineStyle===n.BorderLineType.Double){var v=g.CachedStyle.BackgroundColor?o.hexToRgb(g.CachedStyle.BackgroundColor):r,F=m(y.BorderPosition,v);C(e,g,F,t,d,s)}C(e,g,y,t,l,a)}}}var w,S,R,x;return{distinctBorderTypes:l,borderTypeToLineMap:a,distinctClearingDoubleBorderTypes:d,clearingDoubleBordersToLineMap:s}}(t,d,o.hexToRgb(u),r);r.highContrastScheme?(a=o.rgbToColorHex(r.highContrastScheme.TextColor),i=o.rgbToColorHex(r.highContrastScheme.BackgroundColor),p(e,c.distinctBorderTypes,c.borderTypeToLineMap,d,a),p(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,d,i)):(p(e,c.distinctBorderTypes,c.borderTypeToLineMap,d,void 0),p(e,c.distinctClearingDoubleBorderTypes,c.clearingDoubleBordersToLineMap,d,void 0))},t.getBorderPriorityByLineStyle=function(e){switch(e){case n.BorderLineType.Thick:return 1;case n.BorderLineType.Medium:return 2;case n.BorderLineType.MediumDashed:return 3;case n.BorderLineType.MediumDashDot:return 4;case n.BorderLineType.Thin:return 5;case n.BorderLineType.Dashed:return 6;case n.BorderLineType.Dotted:return 7;case n.BorderLineType.DashDot:return 9;case n.BorderLineType.DashDotDot:return 10;case n.BorderLineType.Hair:return 11;case n.BorderLineType.Double:default:return 12}},t.cellHasBottomDoubleBorder=function(e,t){l.verifyArgumentNotNull(e,"cell","cellHasBottomDoubleBorder");var r=l.getCell(e.Row+1,e.Col,t);if(i.isNullOrUndefined(r)||i.isNullOrUndefined(r.CachedBorderStyle)||i.isNullOrUndefined(r.CachedBorderStyle.Borders))return!1;for(var o=r.CachedBorderStyle.Borders,a=0;a<o.length;a++){var d=o[a];if(d.BorderPosition===n.BorderPositionType.Top&&d.BorderLineStyle===n.BorderLineType.Double)return!0}return!1}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(3),a=r(17),l=r(2),d=r(4),s=r(6),u=r(5),c=r(39);function g(e,t,r,n){var i=o.getWorkbookBackgroundColor(t.highContrastScheme,r,n);e.strokeStyle=i,e.lineWidth=u.GridLineWidthPx,e.setLineDash(u.DefaultDash)}function f(e,t,r,n,o){var l=e.Col,d=e.Col,c=r.ColOffsetsAdjustedForDrawing;e.Merge?(d+=e.Merge.Columns,e.Merge.SpansNextBlockHorizontally&&(d=c.length-1)):e.Spill&&(l-=e.Spill.SpanToStart,d+=e.Spill.SpanToEnd),l=Math.max(0,l),d=Math.min(r.ColumnNumbers.length,d);for(var g=s.getCellHeightAdjustedForDrawing(r,e),f=s.getCellTopAdjustedForDrawing(r,e),h=g-u.GridLineWidthPx,m=l;m<d;m++){var C=a.getAdjustedDrawingOffset(c[m],i.getColWidthFromOffsets(m,c),n,o);i.drawLine(t,C,f,C,f+h)}}function h(e,t,r,n,o){var l=e.Row,d=e.Row+e.Merge.Rows,c=r.RowOffsetsAdjustedForDrawing;l=Math.max(0,l),d=Math.min(r.RowNumbers.length,d),e.Merge.SpansNextBlockVertically&&(d=c.length-1);for(var g=s.getCellLeftAdjustedForDrawing(r,e,r.IsRtl),f=s.getCellWidthAdjustedForDrawing(r,e)-u.GridLineWidthPx,h=l;h<d;h++){var m=a.getAdjustedDrawingOffset(c[h],i.getRowHeightFromOffsets(h,c),n,o);i.drawLine(t,g,m,g+f,m)}}t.clearGridLinesForSpannedCells=function(e,t,r){if(o.verifyArgumentNotNull(t,"model","clearGridLinesForText"),o.verifyArgumentNotNull(t.Cells,"model.Cells","clearGridLinesForText"),o.verifyArgumentNotNull(e,"ctx","clearGridLinesForText"),o.verifyArgumentNotNull(r,"context","clearGridLinesForText"),t.ShowGridLines&&i.shouldRenderGridLines(o.isHighContrastMode(r),o.hasWorkbookBackgroundColor(t.BackgroundColor,l.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))){var c=t.Cells,m=o.getLinePixelTranslation(u.GridLineWidthPx),C=a.getMaxLineOffset(t.BlockWidth,r.devicePixelRatio,!1),p=a.getMaxLineOffset(t.BlockHeight,r.devicePixelRatio,!0);g(e,r,t.BackgroundColor,l.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),e.beginPath();for(var y=0;y<c.length;y++){var v=c[y],F=!d.isNullOrUndefined(v)&&!d.isNullOrUndefined(v.Spill),w=!d.isNullOrUndefined(v)&&!d.isNullOrUndefined(v.Merge)&&(d.isNullOrUndefined(v.CachedStyle.BackgroundColor)||!d.isNullOrUndefined(r.highContrastScheme));i.cellIntersectsRenderingRegion(v,r.renderingRegion)&&((F||w)&&(f(v,e,t,m,C),w&&s.isCellSpansMultipleRowsOrBlocks(v)&&h(v,e,t,m,p)))}e.stroke()}},t.setContextForClearingGridLine=g,t.clearGridLinesForEmptyPivotTables=function(e,t,r){if(o.verifyArgumentNotNull(t,"model","clearGridLinesForEmptyPivotTables"),o.verifyArgumentNotNull(e,"ctx","clearGridLinesForEmptyPivotTables"),o.verifyArgumentNotNull(r,"context","clearGridLinesForEmptyPivotTables"),t.ShowGridLines&&i.shouldRenderGridLines(o.isHighContrastMode(r),o.hasWorkbookBackgroundColor(t.BackgroundColor,l.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)))&&t.PivotTables&&0!==t.PivotTables.length){for(var a=!1,d=0;d<t.PivotTables.length;d++){var s=t.PivotTables[d];s.IsEmptyPivot&&s.HideGridLines&&(c.isPivotIntersectsRenderingRegion(s,r.renderingRegion)&&(a||(e.fillStyle=o.getWorkbookBackgroundColor(r.highContrastScheme,t.BackgroundColor,l.isRenderFlagEnabled(n.RenderFlags.WorkbookBackgroundColor,t)),e.beginPath(),a=!0),e.rect(c.getPivotTableLeftAdjustedForDrawing(t,s,t.IsRtl),c.getPivotTableTopAdjustedForDrawing(t,s),s.OriginPTWidthAdjustedForDrawing,s.OriginPTHeightAdjustedForDrawing)))}a&&e.fill()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2);t.getPivotTableTopAdjustedForDrawing=function(e,t){return n.verifyArgumentNotNull(e,"model","getPivotTableTopAdjustedForDrawing"),n.verifyArgumentNotNull(e.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","getPivotTableTopAdjustedForDrawing"),n.verifyArgumentNotNull(t,"pivotTable","getPivotTableTopAdjustedForDrawing"),e.RowOffsetsAdjustedForDrawing[t.FirstRowIndex]+t.DeltaYFromOriginPTAdjustedForDrawing},t.getPivotTableLeftAdjustedForDrawing=function(e,t,r){n.verifyArgumentNotNull(e,"model","getPivotTableLeftAdjustedForDrawing"),n.verifyArgumentNotNull(e.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","getPivotTableLeftAdjustedForDrawing"),n.verifyArgumentNotNull(t,"pivotTable","getPivotTableLeftAdjustedForDrawing");var o=e.ColOffsetsAdjustedForDrawing;return r||!e.IsRtl?o[t.FirstColIndex]+t.DeltaXFromOriginPTAdjustedForDrawing:o[o.length-1]-t.DeltaXFromOriginPTAdjustedForDrawing-o[t.FirstColIndex]-t.OriginPTWidthAdjustedForDrawing},t.isPivotIntersectsRenderingRegion=function(e,t){return n.verifyArgumentNotNull(e,"pivotTable","isPivotIntersectsRenderingRegion"),n.verifyArgumentNotNull(t,"renderingRegion","isPivotIntersectsRenderingRegion"),!(e.LastRowIndex<t.startRow)&&(!(e.FirstRowIndex>t.endRow)&&(!(e.FirstColIndex<t.startColumn)&&!(e.LastColIndex>t.endColumn)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4),o=r(28),i=r(5),a=r(1),l=r(7),d=r(15);function s(e,t,r,a){if(e.isProcessingLastLine&&e.breakType===o.BreakType.Justify)return function(e,t,r){void 0===r&&(r=0);for(var n="",o=0,a=0;a<e.length;a++)n+=e[a].text,o+=e[a].width,a!==e.length-1&&(n+=i.Whitespace,o+=t);return{Start:{OffsetX:r,Text:n,Width:o},SpaceWidthBetweenWords:t}}(t,e.singleSpaceWidth);if(e.isProcessingLastLine&&e.breakType===o.BreakType.Distributed&&1===a&&e.isCompleteTextVisible)return function(e,t,r){var n=t[0];return{Start:{OffsetX:(e.maxWidth-n.width)/2,Text:n.text,Width:n.width},SpaceWidthBetweenWords:r}}(e,t,r);if(t.length>0){var l=0,d=0,s=t[d],u={Start:{OffsetX:l,Text:s.text,Width:s.width},SpaceWidthBetweenWords:r};l+=s.width+r,d++;var c=Math.floor(r/e.singleSpaceWidth);c<1&&(c=1);for(var g="",f=l,h=0;d<t.length-1;d++)g+=(s=t[d]).text,h+=s.width,d!==t.length-2&&(g+=i.Whitespace.repeat(c),h+=e.singleSpaceWidth*c);if(""!==g&&(u.Middle={OffsetX:f,Text:g,Width:h}),t.length>1){var m=t[t.length-1],C=n.isNullOrUndefined(u.Middle)?l:f+h+r;u.End={OffsetX:C,Text:m.text,Width:m.width}}return u}}function u(e,t){var r=e;if(r.length<=1)return 0;if(t.breakType===o.BreakType.Justify&&t.isProcessingLastLine)return t.singleSpaceWidth;for(var n=0,i=0;i<r.length;i++){n+=r[i].width}var a=(t.maxWidth-n)/(r.length-1);return a<t.singleSpaceWidth?t.singleSpaceWidth:a}function c(e,t,r,n){for(var o=[],i=0,a=!1,l=0;l<t.length;l++){var d=t[l];if(f(d,r,n))if(h(d,r,n))o.push(d),i+=d.width;else{var s=m(e,d,r,n);a=!0,o.push(s),i+=s.width}}return{currentTextTokens:o,currentTokenWidthPx:i,hasPartialToken:a}}function g(e){if(e.Start&&e.End){var t={Start:{OffsetX:e.Start.OffsetX,Text:e.End.Text,Width:e.End.Width},SpaceWidthBetweenWords:e.SpaceWidthBetweenWords,HasPartialText:e.HasPartialText},r=t.Start.OffsetX;return e.Middle&&(t.Middle=e.Middle,r=t.Start.OffsetX+t.Start.Width+t.SpaceWidthBetweenWords,t.Middle.OffsetX=r,t.Middle.Text=e.Middle.Text.split(" ").reverse().join(" "),r=t.Middle.OffsetX+t.Middle.Width),t.End={Text:e.Start.Text,Width:e.Start.Width,OffsetX:r+t.SpaceWidthBetweenWords},t}return e}function f(e,t,r){return e.start<r&&e.start+e.text.length>t}function h(e,t,r){return t<=e.start&&e.start+e.text.length<=r}function m(e,t,r,n){var o=t.start<r?r-t.start:0,i=o+(n-t.start),a=t.text.substring(o,i);return{text:a,start:t.start>r?t.start:r,width:l.measureTextWidth(e,a,!0)}}function C(e){return!!e&&d.analyzeBidiText(e,a.ReadingOrderType.LeftToRight).HasRtl}t.getJustifyDistributedLine=s,t.getSpaceWidthBetweenWords=u,t.prepareTextRunsForJustifyAndDistributed=function(e,t,r,i){if(0===i.length)throw Error("prepareTextRunsForJustifyAndDistributed: At least one textRun expected");if(1===i.length){var a=i[0],l=s(t,r,u(r,t),r.length);C(a.Text)&&!n.isNullOrUndefined(l)&&(l=g(l)),a.JustifyDistributedLine=l,a.WidthPx=function(e,t){var r,n,i,a,l,d=0;if(t&&e.breakType===o.BreakType.Justify)return d+=null===(r=t)||void 0===r?void 0:r.Start.Width,(null===(n=t)||void 0===n?void 0:n.Middle)&&(d+=null===(i=t)||void 0===i?void 0:i.Middle.Width),(null===(a=t)||void 0===a?void 0:a.End)&&(d+=null===(l=t)||void 0===l?void 0:l.End.Width),d;return e.maxWidth}(t,l)}else!function(e,t,r,o){for(var i=u(t,r),a=function(e){for(var t=e[0].start,r=1;r<e.length;r++)e[r].start<t&&(t=e[r].start);return t}(t),l=0;l<o.length;l++){var d=o[l],f=d.StartIndex+a,h=f+(void 0!==d.Text?d.Text.length:0),m=c(e,t,f,h),p=m.currentTextTokens,y=m.currentTokenWidthPx,v=m.hasPartialToken;if(0!==p.length){var F=s(r,p,i,t.length);n.isNullOrUndefined(F)||(F.HasPartialText=v,C(d.Text)&&(F=g(F))),d.JustifyDistributedLine=F,d.WidthPx=y+i*(p.length-1)}}}(e,r,t,i)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(25),i=r(64);!function(e){e[e.Pending=0]="Pending",e[e.Loaded=1]="Loaded",e[e.Failed=2]="Failed"}(n||(n={}));var a={},l=document.createElement("div");l.innerText=".",l.style.visibility="hidden",document.body.appendChild(l),t.registerActionOnFontLoadIfRequired=function(e,t,r){i.fontFaceSetSupported()&&function(e){if(!e.Fonts||0===e.Fonts.length)return!1;for(var t=0;t<e.Fonts.length;t++){var r=e.Fonts[t].FontName;if(!a[r]||a[r]===n.Pending)return!0}return!1}(e)&&(t(0),function(e){for(var t=0;t<e.Fonts.length;t++){var r=e.Fonts[t].FontName;a[r]||(i.setFontLoadDivWithFontFamily(l,r),a[r]=n.Pending)}}(e),function(e,t,r){i.getFontFaceSetReady().then((function(){(function(e,t){if(!e.Fonts)return!1;for(var r=!1,l=0;l<e.Fonts.length;l++){var d=e.Fonts[l].FontName;i.isFontLoaded(d)?(a[d]!==n.Loaded&&(o.recalculateFontHeights(d),a[d]=n.Loaded),r=!0):(a[d]=n.Failed,t(d))}return r})(e,r)&&(!function(e){e.IsDirty=!0}(e),t(1)),t(2)}),(function(){r("API_Failure"),t(2)}))}(e,t,r))},t.isFontLoadPending=function(e){return a[e]===n.Pending},t.resetFontList=function(){a={}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(2),a=r(29),l=r(0),d=r(7);function s(e,t,r){if(l.verifyArgumentNotNull(r,"cell","spillCell.updateCellSpill"),l.verifyArgumentNotNull(t,"model","spillCell.updateCellSpill"),!(!r.Text||r.WrapText||r.Merge||l.cellHasShrinkToFit(r)||i.isRenderFlagEnabled(o.RenderFlags.NumFmtAccountingAndCustom,t)&&r.ValueType===o.CellValueType.Number)){i.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,t)&&(e.font=l.getFontCssStringFromCell(r));var s=i.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,t)?d.getTextWidth(e,t,r):a.GridBlockRendererGlobals.measureTextWidth(r.Text,l.getFontCssStringFromCell(r),i.isRenderFlagEnabled(o.RenderFlags.AdvancedTextMetrics,t)),c=u(r,t,s,n.End),h=c.spilledOverCellsCount,m=c.isSpillingOutsideOfBlock,C=u(r,t,s,n.Start),p=C.spilledOverCellsCount,y=C.isSpillingOutsideOfBlock,v=m||y;if(0!==h||0!==p){var F=g(r,t,n.Start),w=g(r,t,n.End),T=f(F,r,t,n.Start),S=f(w,r,t,n.End);r.Spill={SpanToStart:Math.min(p,T),SpanToEnd:Math.min(h,S),IsSpillBlocked:v||p>T||h>S}}else v&&(r.Spill={SpanToStart:0,SpanToEnd:0,IsSpillBlocked:!0})}}function u(e,t,r,n){var i=e.Col,a=function(e,t,r,n){var i=l.getCellStyle(t,e);l.verifyArgumentNotNull(i,"cell.CachedStyle","spillCell.getNumberOfSpilledPixels");var a=i.HorizontalAlignment,s=l.getColumnWidth(t.Col,e),u=d.getCellTextHorizontalPadding(t,e)+r-s;if(u<=0)return 0;if(a===o.HorizontalAlignment.Center)return u/2;var c=e.IsRtl;if(!C(a,n,c))return 0;return u}(t,e,r,n),s=0,u=!1;if(0===a)return{spilledOverCellsCount:s,isSpillingOutsideOfBlock:u};var g=t.ColumnNumbers.length;for(i+=n;c(i,g)&&a>0;)s++,a-=l.getColumnWidth(i,t),i+=n;return{spilledOverCellsCount:s,isSpillingOutsideOfBlock:u=!c(i,g)&&a>0}}function c(e,t){return e>=0&&e<t}function g(e,t,r){for(var n=e.Row,o=e.Col+r;c(o,t.ColumnNumbers.length);){var i=l.getCell(n,o,t);if(i&&h(i))return i;o+=r}return null}function f(e,t,r,o){return e?Math.abs(e.Col-t.Col)-1:o===n.End?r.ColumnNumbers.length-t.Col:t.Col}function h(e){var t;return!(!e||!e.Text&&!(null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula))}function m(e,t,r,o,i){var a=f(t,r,o,i);if(t&&t.Spill){var d=l.getCellStyle(t,o);if(l.verifyArgumentNotNull(d,"blockingCellStyle","spillCell.updateClosestNonEmptyCell"),C(d.HorizontalAlignment,-i,o.IsRtl))if(r&&r.Text){var u=i===n.End?t.Spill.SpanToStart:t.Spill.SpanToEnd;t.Spill.IsSpillBlocked=a<=u,i===n.End?t.Spill.SpanToStart=Math.min(u,a):t.Spill.SpanToEnd=Math.min(u,a)}else s(e,o,r)}return a}function C(e,t,r){return e===o.HorizontalAlignment.Center||(t===n.Start?r?e===o.HorizontalAlignment.Left:e===o.HorizontalAlignment.Right:t===n.End&&(e===o.HorizontalAlignment.Automatic||(r?e===o.HorizontalAlignment.Right:e===o.HorizontalAlignment.Left)))}t.updateCellSpill=s,t.updateClosestNonEmptyCellsSpill=function(e,t,r){var o=g(t,r,n.Start),i=g(t,r,n.End);m(e,o,t,r,n.Start),m(e,i,t,r,n.End)},function(e){e[e.Start=-1]="Start",e[e.End=1]="End"}(n||(n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.drawTriangle=function(e,t,r,o,i){n.verifyArgumentNotNull(e,"ctx","drawTriangle"),n.verifyArgumentNotNull(t,"model","drawTriangle"),n.verifyArgumentNotNull(r,"cell","drawTriangle"),n.verifyArgumentNotNull(o,"drawingContext","drawTriangle");var a=o.innerColor,l=o.outerColor,d=o.left,s=o.bottom,u=o.height,c=o.width,g=d+c/2,f=i?s+u:s-u;e.strokeStyle=l,e.beginPath(),e.moveTo(d,s),e.lineTo(d+c,s),e.lineTo(g,f),e.closePath(),a&&(e.fillStyle=a,e.fill()),l&&(e.strokeStyle=l,e.stroke())}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(12),a=r(9),l=r(23),d=r(22);function s(e,t,r,n,o,a,l,d,s,u){var c={left:n,bottom:o-(a-l),outerColor:u,height:l,width:d,innerColor:s};i.drawRectangleIcon(e,t,r,c)}t.drawSymbols=function(e,t,r,u){n.verifyArgumentNotNull(e,"ctx","drawSymbols"),n.verifyArgumentNotNull(t,"model","drawSymbols"),n.verifyArgumentNotNull(r,"cell","drawSymbols"),n.verifyArgumentNotNull(u,"drawingContext","drawSymbols");var c=u.image,g=function(e){switch(e){case o.CFIconImage.SymbolHigh:return a.SymbolHighInnerColor;case o.CFIconImage.SymbolMedium:return a.SymbolMediumInnerColor;case o.CFIconImage.SymbolLow:return a.SymbolLowInnerColor;case o.CFIconImage.CircleSymbolHigh:case o.CFIconImage.CircleSymbolMedium:case o.CFIconImage.CircleSymbolLow:return a.CircleSymbolInnerShapeInnerColor;default:throw Error("getSymbolInnerColor: unsupported image type = "+e)}}(c),f=function(e){switch(e){case o.CFIconImage.SymbolHigh:case o.CFIconImage.CircleSymbolHigh:return a.SymbolHighOuterColor;case o.CFIconImage.SymbolMedium:case o.CFIconImage.CircleSymbolMedium:return a.SymbolMediumOuterColor;case o.CFIconImage.SymbolLow:case o.CFIconImage.CircleSymbolLow:return a.SymbolLowOuterColor;default:throw Error("getSymbolOuterColor: unsupported image type = "+e)}}(c);switch(c){case o.CFIconImage.SymbolHigh:case o.CFIconImage.CircleSymbolHigh:!function(e,t,r,n){var i,a=t.size,d=t.left,s=t.bottom,u=t.image;switch(u){case o.CFIconImage.SymbolHigh:i=function(e,t,r){var n=t-r,i=e+o.CheckMarkMiddleXRatio*r,a={x:e+o.CheckMarkTopLeftXRatio*r,y:o.CheckMarkTopLeftYRatio*r+n},l={x:e+o.CheckMarkTopMiddleXRatio*r,y:o.CheckMarkTopMiddleYRatio*r+n},d={x:i,y:o.CheckMarkBottomYRatio*r+n},s={x:e+r,y:o.CheckMarkMiddleRightYRatio*r+n},u={x:e+o.CheckMarkTopRightXRatio*r,y:o.CheckMarkTopRightYRatio*r+n},c={x:i,y:o.CheckMarkMiddleYRatio*r+n};return[a,l,d,s,u,c,a]}(d,s,a);break;case o.CFIconImage.CircleSymbolHigh:i=function(e,t,r){var n=t-r,i=e+o.CircledCheckMarkMiddleXRatio*r,a={x:e+o.CircledCheckMarkTopLeftXRatio*r,y:o.CircledCheckMarkTopLeftYRatio*r+n},l={x:e+o.CircledCheckMarkTopMiddleXRatio*r,y:o.CircledCheckMarkTopMiddleYRatio*r+n},d={x:i,y:o.CircledCheckMarkBottomYRatio*r+n},s={x:e+o.CircledCheckMarkMiddleRightXRatio*r,y:o.CircledCheckMarkMiddleRightYRatio*r+n},u={x:e+o.CircledCheckMarkTopRightXRatio*r,y:o.CircledCheckMarkTopRightYRatio*r+n},c={x:i,y:o.CircledCheckMarkMiddleYRatio*r+n};return[a,l,d,s,u,c,a]}(d,s,a);break;default:throw Error("drawCheckMark: unsupported image type = "+u)}l.drawIconFromPoints(e,r,n,i)}(e,u,g,f);break;case o.CFIconImage.SymbolMedium:case o.CFIconImage.CircleSymbolMedium:!function(e,t,r,n,a,l){var u=n.image;switch(u){case o.CFIconImage.SymbolMedium:!function(e,t,r,n,a,l){var d=n.size,u=n.left,c=n.bottom,g=Math.floor(d*o.ExclamationMarkTopRectHeightSizeRatio),f=Math.floor(d*o.ExclamationMarkBottomRectHeightSizeRatio),h=Math.floor(d*o.ExclamationMarkWidthRectSizeRatio),m=g+Math.max(o.ExclamationMarkMinSpaceBetweenRectangels,Math.floor(o.ExclamationMarkSpaceBetweenRectanglesRatio*d)),C=Math.floor(o.ExclamationMarkLeftRectanglePaddingRatio*d),p=u+C;s(e,t,r,p,c,d,g,h,a,l),function(e,t,r,n,o,a,l,d,s,u,c){var g={left:n,bottom:o-(a-c-l),outerColor:u,height:l,width:d,innerColor:s};i.drawRectangleIcon(e,t,r,g)}(e,t,r,p,c,d,f,h,a,l,m)}(e,t,r,n,a,l);break;case o.CFIconImage.CircleSymbolMedium:!function(e,t,r,n,i,a){var l=n.size,u=n.left,c=n.bottom,g=Math.floor(l*o.CircledExclamationMarkTopRectHeightSizeRatio),f=Math.floor(l*o.CircledExclamationMarkWidthRectSizeRatio),h=o.CircledExclamationMarkTopPadding*l,m=Math.floor(c+h),C=f%2==0?f-1:f,p=u+l/2,y=Math.round(p-C/2);s(e,t,r,y,m,l,g,C,i,a);var v=Math.round(l*o.CircledExclamationMarkLeftCircleSizeRatio),F=v%2==0?v:v-1,w=y+o.IconLinesAdjustment-(F-C)/2,T={image:n.image,bottom:n.bottom,highContrastScheme:n.highContrastScheme,left:w,size:F};d.drawCircle(e,T,a,i)}(e,t,r,n,a,l);break;default:throw Error("drawExclamationMark: unsupported image type = "+u)}}(e,t,r,u,g,f);break;case o.CFIconImage.SymbolLow:case o.CFIconImage.CircleSymbolLow:!function(e,t,r,n){var i,a=t.size,d=t.left,s=t.bottom,u=t.image;switch(u){case o.CFIconImage.SymbolLow:i=function(e,t,r){var n=t-r,i=o.CrossMarkOuterSmallPaddingRatio*r,a=i+e,l=i+n,d=o.CrossMarkOuterBigPaddingRatio*r,s=d+e,u=d+n,c=o.CrossMarkInnerSmallPaddingRatio*r,g=c+e,f=c+n,h=o.CrossMarkInnerCenterRatio*r,m=h+e,C=h+n,p=o.CrossMarkInnerBigPaddingRatio*r,y={x:a,y:n};return[y,{x:e,y:l},{x:g,y:C},{x:e,y:u},{x:a,y:r+n},{x:m,y:p+n},{x:s,y:r+n},{x:e+r,y:u},{x:e+p,y:C},{x:e+r,y:l},{x:s,y:n},{x:m,y:f},y]}(d,s,a);break;case o.CFIconImage.CircleSymbolLow:i=function(e,t,r){var n=t-r,i=o.CircledCrossMarkOuterSmallPaddingRatio*r,a=i+e,l=i+n,d=o.CircledCrossMarkOuterBigPaddingRatio*r,s=d+e,u=d+n,c=o.CircledCrossMarkInnerSmallPaddingRatio*r,g=c+e,f=c+n,h=o.CircledCrossMarkInnerCenterRatio*r,m=h+e,C=h+n,p=o.CircledCrossMarkInnerBigPaddingRatio*r,y=o.CircledCrossMarkPaddingFromCircleRatio*r,v={x:a,y:n+y};return[v,{x:e+y,y:l},{x:g,y:C},{x:e+y,y:u},{x:a,y:r+n-y},{x:m,y:p+n},{x:s,y:r+n-y},{x:e+r-y,y:u},{x:e+p,y:C},{x:e+r-y,y:l},{x:s,y:n+y},{x:m,y:f},v]}(d,s,a);break;default:throw Error("drawCrossMark: unsupported image type = "+u)}l.drawIconFromPoints(e,r,n,i)}(e,u,g,f);break;default:throw Error("drawSymbols: unsupported image type = "+c)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(4),i=r(3);t.setPageLayoutLine=function(e,t){e.lineWidth=n.GridLineWidthPx,e.setLineDash(n.DefaultDash),e.strokeStyle=o.isNullOrUndefined(t.highContrastScheme)?n.PageLayoutLineColor:""+i.rgbToColorHex(t.highContrastScheme.TextColor)}},function(e,t,r){"use strict";var n=function(){function e(e,t,r,n){this.elementsMargin=n?"margin-left: 8px;":"margin-right: 8px;",this.toastElement=this.createToastContainer(t,r),e.appendChild(this.toastElement)}return e.prototype.setVisibility=function(e){this.toastElement.style.visibility=e?"visible":"hidden"},e.prototype.dispose=function(){var e;null===(e=this.toastElement.parentNode)||void 0===e||e.removeChild(this.toastElement)},e.prototype.createToastContainer=function(e,t){var r=document.createElement("div");return r.id="UnavailabilityToast",r.setAttribute("role","alert"),r.setAttribute("style",'display: flex;\n      visibility: hidden;\n      padding: 12px 16px;\n      background-color: #FFF4CE;\n      color: #484644;\n      font-size: 14px;\n      line-height: 20px;\n      box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2), 0 6px 10px 0 rgba(0, 0, 0, 0.19);\n      border-radius: 4px;\n      font-family: "Segoe UI", "Segoe UI Web (West European)", "Segoe UI", -apple-system, BlinkMacSystemFont, Roboto, "Helvetica Neue", sans-serif;\n      -webkit-touch-callout: none;\n      -webkit-user-select: none;\n      -moz-user-select: none;\n      -ms-user-select: none;\n      user-select: none;'),r.appendChild(this.createToastIcon()),r.appendChild(this.createToastTitle(e)),r.appendChild(this.createToastText(t)),r},e.prototype.createToastIcon=function(){var e=document.createElement("span");e.id="UnavailabilityToastIcon";return e.setAttribute("style",'display: inline-block;\n      height: 20px;\n      width: 20px;\n      background-repeat: no-repeat;\n      background-image: url("data:image/svg+xml;charset=utf8,%3Csvg%20width%3D%2220%22%20height%3D%2218%22%20viewBox%3D%220%200%2020%2018%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0D%0A%3Cpath%20d%3D%22M8.17383%207.24219C8.02409%207.48307%207.84831%207.70443%207.64648%207.90625C7.45117%208.10156%207.23307%208.27409%206.99219%208.42383L7.49023%209.63477L6.33789%2010.1035L5.83984%208.90234C5.57943%208.96745%205.29948%209%205%209C4.70052%209%204.42057%208.96745%204.16016%208.90234L3.66211%2010.1035L2.50977%209.63477L3.00781%208.42383C2.76693%208.27409%202.54557%208.10156%202.34375%207.90625C2.14844%207.70443%201.97591%207.48307%201.82617%207.24219L0.615234%207.74023L0.146484%206.58789L1.34766%206.08984C1.28255%205.82943%201.25%205.54948%201.25%205.25C1.25%204.95052%201.28255%204.67057%201.34766%204.41016L0.146484%203.91211L0.615234%202.75977L1.82617%203.25781C2.12565%202.76953%202.51953%202.37565%203.00781%202.07617L2.50977%200.865234L3.66211%200.396484L4.16016%201.59766C4.42057%201.53255%204.70052%201.5%205%201.5C5.29948%201.5%205.57943%201.53255%205.83984%201.59766L6.33789%200.396484L7.49023%200.865234L6.99219%202.07617C7.48047%202.37565%207.87435%202.76953%208.17383%203.25781L9.38477%202.75977L9.85352%203.91211L8.65234%204.41016C8.71745%204.67057%208.75%204.95052%208.75%205.25C8.75%205.54948%208.71745%205.82943%208.65234%206.08984L9.85352%206.58789L9.38477%207.74023L8.17383%207.24219ZM5%207.75C5.34505%207.75%205.66732%207.6849%205.9668%207.55469C6.27279%207.42448%206.53971%207.24544%206.76758%207.01758C6.99544%206.78971%207.17448%206.52604%207.30469%206.22656C7.4349%205.92057%207.5%205.59505%207.5%205.25C7.5%204.90495%207.4349%204.58268%207.30469%204.2832C7.17448%203.97721%206.99544%203.71029%206.76758%203.48242C6.53971%203.25456%206.27279%203.07552%205.9668%202.94531C5.66732%202.8151%205.34505%202.75%205%202.75C4.65495%202.75%204.32943%202.8151%204.02344%202.94531C3.72396%203.07552%203.46029%203.25456%203.23242%203.48242C3.00456%203.71029%202.82552%203.97721%202.69531%204.2832C2.5651%204.58268%202.5%204.90495%202.5%205.25C2.5%205.59505%202.5651%205.92057%202.69531%206.22656C2.82552%206.52604%203.00456%206.78971%203.23242%207.01758C3.46029%207.24544%203.72396%207.42448%204.02344%207.55469C4.32943%207.6849%204.65495%207.75%205%207.75ZM18.75%2012.125C18.75%2012.4831%2018.7044%2012.8444%2018.6133%2013.209L19.9512%2013.7559L19.4824%2014.918L18.1348%2014.3613C17.7507%2014.9993%2017.2428%2015.5072%2016.6113%2015.8848L17.168%2017.2227L16.0059%2017.7012L15.459%2016.3633C15.0944%2016.4544%2014.7331%2016.5%2014.375%2016.5C14.0169%2016.5%2013.6556%2016.4544%2013.291%2016.3633L12.7441%2017.7012L11.582%2017.2227L12.1387%2015.8848C11.5007%2015.5072%2010.9928%2014.9993%2010.6152%2014.3613L9.26758%2014.918L8.79883%2013.7559L10.1367%2013.209C10.0456%2012.8444%2010%2012.4831%2010%2012.125C10%2011.7669%2010.0456%2011.4056%2010.1367%2011.041L8.79883%2010.4941L9.26758%209.33203L10.6152%209.88867C10.9928%209.25716%2011.5007%208.74935%2012.1387%208.36523L11.582%207.01758L12.7441%206.54883L13.291%207.88672C13.6556%207.79557%2014.0169%207.75%2014.375%207.75C14.7331%207.75%2015.0944%207.79557%2015.459%207.88672L16.0059%206.54883L17.168%207.01758L16.6113%208.36523C17.2428%208.74935%2017.7507%209.25716%2018.1348%209.88867L19.4824%209.33203L19.9512%2010.4941L18.6133%2011.041C18.7044%2011.4056%2018.75%2011.7669%2018.75%2012.125ZM14.375%2015.25C14.8047%2015.25%2015.2083%2015.1686%2015.5859%2015.0059C15.9635%2014.8431%2016.2923%2014.6217%2016.5723%2014.3418C16.8587%2014.0553%2017.0833%2013.7233%2017.2461%2013.3457C17.4154%2012.9616%2017.5%2012.5547%2017.5%2012.125C17.5%2011.6953%2017.4154%2011.2917%2017.2461%2010.9141C17.0833%2010.5365%2016.8587%2010.2077%2016.5723%209.92773C16.2923%209.64128%2015.9635%209.41667%2015.5859%209.25391C15.2083%209.08464%2014.8047%209%2014.375%209C13.9453%209%2013.5384%209.08464%2013.1543%209.25391C12.7767%209.41667%2012.4447%209.64128%2012.1582%209.92773C11.8783%2010.2077%2011.6569%2010.5365%2011.4941%2010.9141C11.3314%2011.2917%2011.25%2011.6953%2011.25%2012.125C11.25%2012.5547%2011.3314%2012.9616%2011.4941%2013.3457C11.6569%2013.7233%2011.8783%2014.0553%2012.1582%2014.3418C12.4447%2014.6217%2012.7767%2014.8431%2013.1543%2015.0059C13.5384%2015.1686%2013.9453%2015.25%2014.375%2015.25Z%22%20fill%3D%22%23797775%22%2F%3E%0D%0A%3C%2Fsvg%3E");'+this.elementsMargin),e},e.prototype.createToastTitle=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastTitle",t.innerText=e,t.setAttribute("style","font-weight: 600;"+this.elementsMargin),t},e.prototype.createToastText=function(e){var t=document.createElement("span");return t.id="UnavailabilityToastText",t.innerText=e,t},e}(),o=function(){function e(){}return e.createInstance=function(e,t,r,o){return new n(e,t,r,o)},e}();r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return o}))},function(e,t,r){"use strict";r.r(t);var n=r(30);for(var o in n)"default"!==o&&function(e){r.d(t,e,(function(){return n[e]}))}(o);var i=r(46);r.d(t,"UnavailabilityToast",(function(){return i.a})),r.d(t,"UnavailabilityToastFactory",(function(){return i.b}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(31);t.GridBlockRendererFactoryGlobal=new n.GridBlockRendererFactory},function(e,t){var r,n,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function l(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:i}catch(e){r=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var d,s=[],u=!1,c=-1;function g(){u&&d&&(u=!1,d.length?s=d.concat(s):c=-1,s.length&&f())}function f(){if(!u){var e=l(g);u=!0;for(var t=s.length;t;){for(d=s,s=[];++c<t;)d&&d[c].run();c=-1,t=s.length}d=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];s.push(new h(e,t)),1!==s.length||u||l(f)},h.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=m,o.addListener=m,o.once=m,o.off=m,o.removeListener=m,o.removeAllListeners=m,o.emit=m,o.prependListener=m,o.prependOnceListener=m,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumFmtAccountingStartIndex=32},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(5),o=r(3),i=r(0);function a(e,t,r,n,o){var i=Math.min(n/4,16),a=Math.min(o/4,8),l=t+n/2-i/2,d=r+o/2-a/2;e.fillRect(l,d,i,a)}t.drawSkeleton=function(e,t,r){if(i.verifyArgumentNotNull(e,"ctx","drawSkeleton"),i.verifyArgumentNotNull(t,"model","drawSkeleton"),i.verifyArgumentNotNull(r,"context","drawSkeleton"),i.verifyArgumentNotNull(t.RowOffsetsAdjustedForDrawing,"RowOffsetsAdjustedForDrawing","drawSkeleton"),i.verifyArgumentNotNull(t.ColOffsetsAdjustedForDrawing,"ColOffsetsAdjustedForDrawing","drawSkeleton"),i.verifyArgumentNotNull(t.RowHeights,"RowHeights","drawSkeleton"),i.verifyArgumentNotNull(t.ColumnWidths,"ColumnWidths","drawSkeleton"),!(r.devicePixelRatio<n.MinimalDprForGridlinesRendering)&&t.ShowGridLines){e.fillStyle=n.SkeletonColor;for(var l=0;l<t.RowOffsetsAdjustedForDrawing.length-1;l++)for(var d=t.RowOffsetsAdjustedForDrawing[l],s=o.getRowHeightFromOffsets(l,t.RowOffsetsAdjustedForDrawing),u=0;u<t.ColOffsetsAdjustedForDrawing.length-1;u++){a(e,o.getColOffsetsAdjustedForDrawing(u,t),d,o.getColWidthFromOffsets(u,t.ColOffsetsAdjustedForDrawing),s)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addWatermark=function(e,t){e.beginPath(),e.strokeStyle=t.modelFromCache?"blue":"red",e.lineWidth=1,e.setLineDash([]);var r=1*t.devicePixelRatio,n=5*t.devicePixelRatio;e.rect(r,r,n,n),e.stroke()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isCanvasElement=function(e){return e instanceof HTMLCanvasElement}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(34),a=r(5),l=r(57),d=r(0),s=r(58),u=r(2),c=r(7),g=r(6),f=r(63),h=r(18),m=r(65);function C(e,t,r,C,y,v,F){var w=function(e,t){var r=h.getEffectiveHorizontalAlignment(e,t),o=c.getCellTextHorizontalPadding(t,e);switch(r){case n.HorizontalAlignment.Right:return g.getCellRight(e,t,e.BlockWidth)-o;case n.HorizontalAlignment.Center:return c.getCellTextCenterX(e,t);case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:return g.getCellLeft(e,t,e.BlockWidth)+o;case n.HorizontalAlignment.CenterAcrossSelection:return u.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)?c.getTextCenterForCenterAcrossSelection(e,t):c.getCellTextCenterX(e,t);default:throw Error("getTextHorizontalPosition: unsupported horizontalAlignment: "+r)}}(r,C),T=c.getTextVerticalPosition(C,r,c.getTextLineHeight(C,r),F,void 0);!function(e,t,r,i,l){var s=h.getTextAlignment(i,r);t.textAlign!==s&&(t.textAlign=s,e.textAlign=s);var g=r.CachedStyle.VerticalAlignment,f=c.getTextBaseline(g,u.isRenderFlagEnabled(n.RenderFlags.TextBaselineRefactor,i));f!==t.textBaseline&&(e.textBaseline=f,t.textBaseline=f);var m=d.getFontCssStringFromCell(r);t.fontProperties===m&&e.font===m||(t.fontProperties=m,e.font=m);var C=function(e,t,r){var i;if(r)return o.getHighContrastTextColor(e,t,r);if(u.isRenderFlagEnabled(n.RenderFlags.HasErrorRefactoring,e)){if(t.HasError)return a.FormulaErrorFontColor}else if(null===(i=t.FormulaInfo)||void 0===i?void 0:i.HasError)return a.FormulaErrorFontColor;return t.CachedFont.Color}(i,r,l);t.fontColor!==C&&(t.fontColor=C,e.fillStyle=C);var y=function(e,t){switch(e){case n.ReadingOrderType.RightToLeft:return"rtl";case n.ReadingOrderType.LeftToRight:return"ltr";case n.ReadingOrderType.Context:return p(t);default:throw Error("getCanvasDirection: unsupported readingOrder: "+e)}}(r.CachedStyle.ReadingOrder,i.IsRtl);y!==t.direction&&(t.direction=y,e.direction=y)}(e,y,C,r,t.highContrastScheme);var S=g.getCellWidth(r,C,!1),R=c.getTextIconPadding(r,C),x=o.getTextDrawingMaxWidth(S,c.getCellTextHorizontalPaddingWithoutIcons(r,C),R);if(u.doesNumFmtOverrideText(C,r)){var b=x;f.updateNumberFormattingInformation(e,r,C,b)}var I=m.isHorizontalAlignmentFillInCell(r,C);m.isHorizontalAlignmentFillInCell(r,C)&&m.updateCachedDisplayTextForFill(e,r,C);var A=d.getDisplayText(C,r),D=d.getFormattedText(A,C,r);if(C.WrapText&&function(e,t){if(h.isHorizontalAlignmentJustifiedAndDistributed(e,t))return!(t.CachedIsTextWidthExceedsCellWidth&&t.ValueType===n.CellValueType.Number);return!(u.isRenderFlagEnabled(n.RenderFlags.NumFmtAndWrapText,e)&&t.ValueType===n.CellValueType.Number)}(r,C)&&!I){var M=g.getCellLeft(r,C,r.BlockWidth),k=o.getContainerClipMaskWidth(S),L=g.isCellSpansMultipleRowsOrBlocks(C);s.drawWrapText(e,t,r,C,A,w,x,M,k,v,F,L,c.getTextLineHeight(C,r),D)}else if(C.Merge)!function(e,t,r,n,a,l,d,s,u,f){if(n.Merge.Rows>0||a||c.getTextWidth(e,r,n)>=f){var h={x:g.getCellLeft(r,n,r.BlockWidth),y:g.getCellTop(r,n),width:o.getContainerClipMaskWidth(d),height:g.getCellHeight(r,n,!1)};i.fillTextClipped(e,t,l,s,u,h,n,r,m.isHorizontalAlignmentFillInCell(r,n),a)}else i.fillTextUnclipped(e,l,s,u,f,n,r,t.devicePixelRatio)}(e,t,r,C,D,A,S,w,T,x);else if(C.Spill)l.drawSpillCellText(e,t,r,C,A,w,T,v,F,I,D);else if(D||I||h.isHorizontalAlignmentCenteredAcrossSelection(r,C)){var P={x:g.getCellLeft(r,C,r.BlockWidth),y:g.getCellTop(r,C),width:o.getContainerClipMaskWidth(S),height:F};i.fillTextClipped(e,t,A,w,T,P,C,r,I,D)}else i.fillTextUnclipped(e,A,w,T,x,C,r,t.devicePixelRatio)}function p(e){return e?"rtl":"ltr"}function y(e,t,r,n){return o.restoreClipping(r,n),v(e,t)}function v(e,t){return{fontColor:e?o.rgbToColorHex(e.TextColor):a.DefaultCellFontColor,fontProperties:"",direction:p(t),textBaseline:"bottom",textAlign:"start"}}t.drawCellsText=function(e,t,r){var i,l,s;d.verifyArgumentNotNull(e,"ctx","drawCellsText"),d.verifyArgumentNotNull(t,"model","drawCellsText"),d.verifyArgumentNotNull(r,"context","drawCellsText"),d.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawCellsText"),d.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawCellsText"),d.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawCellsText"),d.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawCellsText"),d.verifyArgumentNotNull(t.Cells,"model.Cells","drawCellsText"),d.verifyArgumentNotNull(t.Styles,"model.Styles","drawCellsText");for(var c=t.Cells,f=t.BlockWidth,h=[],m=function(e,t,r){var n=v(t,r.IsRtl);return e.direction=n.direction,e.fillStyle=n.fontColor,e.textBaseline="bottom",e.strokeStyle="transparent",function(e){e.getLineDash()!==[]&&e.setLineDash([])}(e),n}(e,r.highContrastScheme,t),p=void 0,F=-1,w=0;w<c.length;w++){if((R=c[w])&&R.Text&&(o.cellIntersectsRenderingRegion(R,r.renderingRegion)&&!(u.isRenderFlagEnabled(n.RenderFlags.CFIcons,t)&&R.CondFormat&&(null===(i=R.CondFormat)||void 0===i?void 0:i.Icon)&&(null===(s=null===(l=R.CondFormat)||void 0===l?void 0:l.Icon)||void 0===s?void 0:s.IconOnly)))){var T=t.RowHeights[R.Row]-a.GridLineWidthPx,S=t.RowOffsets[R.Row];R.Row!==F&&(-1!==F&&(m=y(r.highContrastScheme,t.IsRtl,e,p)),p={x:0,y:S,width:f,height:T},o.applyClipping(e,p),F=R.Row),g.isCellSpansMultipleRowsOrBlocks(R)?h.push(R):C(e,r,t,R,m,S,T)}}for(o.restoreClipping(e,p),m=v(r.highContrastScheme,t.IsRtl),w=0;w<h.length;w++){var R=h[w],x=g.getCellHeight(t,R,!1)-a.GridLineWidthPx;C(e,r,t,R,m,g.getCellTop(t,R),x)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(34),a=r(0),l=r(7),d=r(2),s=r(6);t.drawSpillCellText=function(e,t,r,u,c,g,f,h,m,C,p){var y;a.verifyArgumentNotNull(u.Spill,"cell.Spill","spillCells.drawSpillCellText");var v=s.getSpillCellWidth(u,r),F=d.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentFillAndCAS,r)&&(null===(y=u.CachedStyle)||void 0===y?void 0:y.HorizontalAlignment)===n.HorizontalAlignment.CenterAcrossSelection;if(u.Spill.IsSpillBlocked||p||F){var w=o.getContainerClipMaskWidth(v),T={x:s.getSpillCellStartOffset(u,r),y:h,width:w,height:m};i.fillTextClipped(e,t,c,g,f,T,u,r,C,p)}else{var S=o.getTextDrawingMaxWidth(v,l.getCellTextHorizontalPadding(u,r),l.getTextIconPadding(r,u));i.fillTextUnclipped(e,c,g,f,S,u,r,t.devicePixelRatio)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(28),i=r(1),a=r(2),l=r(7),d=r(19),s=r(14),u=r(59),c=r(40),g=r(5),f=r(4);function h(e,t,r,i,a,l,s,u,g,f,h,C,p,y,v,F){var w=a.tokensPerLine[l].tokens;if(C)m(e,t,r,i,g,y,s,f,h,C,p,w,u);else{var T=c.getJustifyDistributedLine(u,w,c.getSpaceWidthBetweenWords(w,u),w.length);if(T){var S=n.isStartLineRtl(y),R=S?s-T.Start.OffsetX:s+T.Start.OffsetX;if(m(e,t,r,i,g,T.Start.Text,R,f,h,C,p),T.Middle){var x=S?s-T.Middle.OffsetX:s+T.Middle.OffsetX;m(e,t,r,i,g,T.Middle.Text,x,f,h,C,p)}if(T.End){var b=S?s-T.End.OffsetX:s+T.End.OffsetX;m(e,t,r,i,g,T.End.Text,b,f,h,C,p)}if(!F){var I=a.textLines[l],A=function(e,t,r,n,i){switch(e){case o.BreakType.Justify:return n?t.underlineWidth:r;case o.BreakType.Distributed:return n&&1===i?t.underlineWidth:r;case o.BreakType.Wrap:default:return t.underlineWidth}}(u.breakType,I,u.maxWidth,u.isProcessingLastLine,w.length);d.cacheTextDecorationLayout(r,i,{textPositionX:R,textPositionY:v,dpr:t.devicePixelRatio,textWidth:A,clipRect:p},i.CachedFont)}}}}function m(e,t,r,n,o,i,a,l,d,u,c,g,f){u?s.fillRichTextFormat(e,t,r,n,u,a,l,c,g,f):o?e.fillText(i,a,l):e.fillText(i,a,l,d)}t.drawWrapText=function(e,t,r,c,C,p,y,v,F,w,T,S,R,x){if(!(y<=0)){var b=e.measureText(g.Whitespace).width,I=a.isRenderFlagEnabled(i.RenderFlags.ThaiLineBreaking,r)?c.WrapText:{},A=function(e,t){var r;if(a.isRenderFlagEnabled(i.RenderFlags.AdvHorizontalAlignmentJustifyAndDistributed,e))switch(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment){case i.HorizontalAlignment.Justify:return o.BreakType.Justify;case i.HorizontalAlignment.JustifyDistributed:case i.HorizontalAlignment.Distributed:return o.BreakType.Distributed;default:return o.BreakType.Wrap}return o.BreakType.Wrap}(r,c),D=y-l.getWrapTextAdditionalPadding(r,c);A===o.BreakType.Distributed&&(D-=l.getIndentationPaddingPx(c.CachedStyle.Indentation||0));var M=u.breakTextToLines(e,C,D,A,b,x,I),k=M.textLines,L=function(e,t,r,n){var o=[],i=[],a=[];i=[0],a=[0];var d=0;if(r)for(var u=0;u<t.length;u++){var c=t.length-1-u,g=t[c],f=s.substringFormattedText(r,g.startIndex,g.endIndex);o[u]=f;var h=l.getFormattedTextLineFontMetrics(e,f);a[u]=h.baseline;var m=l.getFormattedTextLineHeight(e,f);i[u+1]=i[u]+m,d+=m}else i=function(e,t){for(var r=[],n=0;n<e;n++)r.push(n*t);return r}(t.length,n),d=n*t.length;return{rowsBottomY:i,rowsAlphabeticY:a,textHeight:d,formattedLines:o}}(r,k,x,R),P=L.rowsBottomY,O=L.rowsAlphabeticY,N=L.textHeight,B=L.formattedLines,E=M.requireClipping||S,H={x:v,y:w,width:F,height:T},W=void 0;E&&(W=H),function(e,t){t&&n.applyClipping(e,t)}(e,W);for(var j=O[0],z=l.getTextVerticalPosition(c,r,N,T,j),G=t.devicePixelRatio,U=0;U<k.length;U++){var _=k.length-1-U,V=k[_],X=V.text,Y=z+j-P[U],q=x?Y-O[U]:z-P[U];if(A===o.BreakType.Wrap)m(e,t,r,c,E,X,p,q,y,B[U],H),x||d.cacheTextDecorationLayout(r,c,{textPositionX:p,textPositionY:q,dpr:G,textWidth:V.underlineWidth,clipRect:H},c.CachedFont);else h(e,t,r,c,M,_,p,{breakType:A,singleSpaceWidth:b,maxWidth:D,isProcessingLastLine:_===k.length-1,isCompleteTextVisible:N<T},E,q,y,B[U],H,X,q,!f.isNullOrUndefined(x))}!function(e,t){n.restoreClipping(e,t)}(e,W)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(24),o=r(0),i=r(60),a=r(61),l=r(5),d=r(14),s=r(20),u=r(28);function c(e,t){(e.curLineWidth+=t.width,e.curLineWidth>e.maxWidth)&&(I(e,t.width),e.curLineStart=t.start,e.curLineWidth=t.width);e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(t),e.lastFittingToken=t}function g(e,t,r,n,o){if(t.type!==i.BreakOpTokenType.Space){void 0!==e.lastFittingToken&&(e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(e.lastFittingToken),I(e));for(var l=o?d.substringFormattedText(o,t.start,t.start+t.len):void 0,s=a.breakWideWord(n,t.value,e.maxWidth,l),u=t.start,c=0;c<s.length-1;c++){var g=s[c],f={text:g.value,width:g.width,underlineWidth:g.width,startIndex:u,endIndex:u+g.value.length};u+=g.value.length,e.textLines.push(f),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push({tokens:[{text:g.value,width:g.width,start:u}]}),e.isSingleCharTooWide=S(f.width,f.text.length,e.maxWidth,e.isSingleCharTooWide)}var h,m,p,y,v,F=(m=t,p=(h=s)[h.length-1],y=m.start+m.len-p.value.length,v=p.width,{start:y,len:p.value.length,value:p.value,type:i.BreakOpTokenType.Word,width:v});e.lastFittingToken=F,e.isBreakTypeJustifyOrDistributed&&e.unprocessedTokens.push(F),e.curLineWidth=e.lastFittingToken.width,e.curLineStart=e.lastFittingToken.start}else C(e,t,r)}function f(e,t,r){void 0!==e.lastFittingToken&&I(e);var n=function(e){switch(e.type){case i.BreakOpTokenType.HardBreak:return e.len;case i.BreakOpTokenType.HardBreakCRLF:return e.len/2;default:throw"breakToLines - this token should be hardBreak token"}}(t);0!==r&&r!==e.tokens.length-1&&n--;for(var o=0;o<n;o++)e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.textLines.push(h(o,t));e.curLineStart=t.start+t.len,e.curLineWidth=0,e.lastFittingToken=void 0}function h(e,t){var r=t.start+e;return{text:"",width:0,underlineWidth:0,startIndex:r,endIndex:r+function(e){return e.type===i.BreakOpTokenType.HardBreakCRLF?l.HardBreakCRLF.length:l.HardBreak.length}(t)}}function m(e,t,r){if(x(t),1===t.len)return e.curLineWidth+=t.width,void(e.lastFittingToken=t);!function(e,t,r){if(T(e.tokens,r),!v(e,r))return!1;return r===e.tokens.length-1||e.curLineWidth+t.width>e.maxWidth||w(e,t,r)}(e,t,r)?e.curLineWidth+t.width>e.maxWidth||w(e,t,r)?C(e,t,r):(e.curLineWidth+=t.width,e.lastFittingToken=t):F(e,t)}function C(e,t,r){x(t);var n=t.width/t.len,o=e.maxWidth-e.curLineWidth;if(!(o<0)){var i=Math.floor(o/n);t.width=n*i,e.curLineWidth+=t.width,e.lastFittingToken=t,(y(e.tokens,r)||v(e,r))&&F(e,t)}}function p(e,t){if(T(e,t),!e[t])throw"breakTextToLines - validateToken - tokens[index] is undefined"}function y(e,t){return T(e,t),p(e,t),0===t&&e[t].type===i.BreakOpTokenType.Space}function v(e,t){var r=e.tokens;return T(r,t),t>0&&r[t].type===i.BreakOpTokenType.Space&&b(r[t-1])&&void 0===e.lastFittingToken}function F(e,t){if(t.type!==i.BreakOpTokenType.Space)throw"breakTextToLines - addEmptyLineToTextLines - wrong token type, this function should get only spaces token";var r=n.__assign({},l.EmptyLine),o=t.start+t.len;r.underlineWidth=t.width,r.startIndex=t.start,r.endIndex=o,e.textLines.push(r),e.isBreakTypeJustifyOrDistributed&&e.tokensPerLine.push(l.EmptyLineTextToken),e.curLineStart=o,e.curLineWidth=0,e.lastFittingToken=void 0}function w(e,t,r){if(x(t),r>=e.tokens.length-1)return!1;var n=e.tokens[r+1];return e.curLineWidth+t.width+n.width>e.maxWidth}function T(e,t){if(t<0||t>=e.length)throw"breakTextToLines - invalid token index"}function S(e,t,r,n){if(n)return!0;if(e>r){if(1!==t)throw"breakTextToLines - non single char line is too wide!";return!0}return n}function R(e,t){return e.width<t}function x(e){if(e.type!==i.BreakOpTokenType.Space)throw"breakTextToLines - wrong token type, expected spaces token!"}function b(e){return e.type===i.BreakOpTokenType.HardBreak||e.type===i.BreakOpTokenType.HardBreakCRLF}function I(e,t){void 0===t&&(t=0),o.verifyArgumentNotNull(e.lastFittingToken,"lineBreakCtx.lastFittingToken","createCurrentFittingLine");var r=e.curLineWidth-t,n=r;e.lastFittingToken.type===i.BreakOpTokenType.Space&&(n-=e.lastFittingToken.width),e.isBreakTypeJustifyOrDistributed&&(e.tokensPerLine.push(function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];t.push({text:n.value,width:n.width,start:n.start})}return{tokens:t}}(e.unprocessedTokens)),e.unprocessedTokens=[]);var a=function(e){if(void 0===e.lastFittingToken)throw"breakTextToLines -invalid lastFittingToken - no token was set";var t=e.lastFittingToken.start+e.lastFittingToken.len;return{text:e.text.substring(e.curLineStart,t).trimRight(),start:e.curLineStart,end:t}}(e),l=a.text,d=a.start,s=a.end;e.textLines.push({text:l,underlineWidth:r,width:n,startIndex:d,endIndex:s})}t.breakTextToLines=function(e,t,r,n,a,l,d){if(o.verifyArgumentNotNull(e,"canvas2dCtx","breakTextToLines"),""===t)return{textLines:[],tokensPerLine:[],requireClipping:!1};for(var h,C=i.tokenizeTextToWrap(e,t,a,l,d),v={text:t,tokens:C,maxWidth:r,unprocessedTokens:[],isSingleCharTooWide:!1,textLines:[],tokensPerLine:[],curLineStart:0,curLineWidth:0,lastFittingToken:void 0,isBreakTypeJustifyOrDistributed:(h=n,h===u.BreakType.Justify||h===u.BreakType.Distributed)},F=0;F<C.length;F++){var w=C[F];if(p(C,F),b(w))f(v,w,F);else if(R(w,r)){if(w.type===i.BreakOpTokenType.Space&&!y(C,F)){m(v,w,F);continue}c(v,w)}else g(v,w,F,e,l)}if(void 0!==v.lastFittingToken&&function(e){I(e),e.isSingleCharTooWide=S(e.lastFittingToken.width,e.lastFittingToken.len,e.maxWidth,e.isSingleCharTooWide)}(v),v.isBreakTypeJustifyOrDistributed&&v.textLines.length!==v.tokensPerLine.length)throw new Error("breakTextToLines::breakTextToLines Mismatch in textLines and textTokenLines.\n      textTokenLines = "+v.tokensPerLine.length+", textLineLength = "+v.textLines.length+", MaxWidth = "+r+", Text = "+s.annonymize(v.text));return{textLines:v.textLines,tokensPerLine:v.tokensPerLine,requireClipping:v.isSingleCharTooWide}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(5),i=r(14);!function(e){e[e.Space=0]="Space",e[e.Word=1]="Word",e[e.HardBreak=2]="HardBreak",e[e.HardBreakCRLF=3]="HardBreakCRLF"}(n=t.BreakOpTokenType||(t.BreakOpTokenType={}));var a="1".charCodeAt(0);function l(e){switch(e){case o.Whitespace:return n.Space;case o.HardBreak:return n.HardBreak;case o.HardBreakCRLF:return n.HardBreakCRLF}return n.Word}function d(e,t){return"\r"===e[t]&&t<e.length-1&&"\n"===e[t+1]?o.HardBreakCRLF:e[t]}function s(e,t){return t===n.HardBreakCRLF?e+2:e+1}function u(e,t,r){return!(!t||r!==n.Word||e>t.length-1)&&t.charCodeAt(e)===a}t.tokenizeTextToWrap=function(e,t,r,o,a){for(var c,g=[],f=0,h=r,m=null===(c=a)||void 0===c?void 0:c.BreakOp;f<t.length;){for(var C=l(d(t,f)),p=s(f,C),y=d(t,p),v=l(y);p<t.length&&C===v&&!u(p,m,C);)v=l(y=d(t,p=s(p,C)));var F=p-f,w=t.substring(f,p),T=o?i.substringFormattedText(o,f,p):void 0,S=0;switch(C){case n.Space:S=T?i.measureFormattedTextWidth(e,T):h*w.length;break;case n.Word:S=T?i.measureFormattedTextWidth(e,T):e.measureText(w).width;break;case n.HardBreak:case n.HardBreakCRLF:break;default:throw"breakToTextLines - textTokenizer - unexpected run type"}g.push({start:f,len:F,value:w,type:C,width:S}),f=p}return g}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(14),i=function(){function e(e,t,r,n){this.cachedWidth=-1,this.ctx=e,this.word=t,this.prefixLength=r,this.wordFormattedText=n}return Object.defineProperty(e.prototype,"width",{get:function(){if(-1===this.cachedWidth)if(this.wordFormattedText){if(!this.formattedValue)throw Error("expected formattedValue to be set");this.cachedWidth=o.measureFormattedTextWidth(this.ctx,this.formattedValue)}else this.cachedWidth=this.ctx.measureText(this.value).width;return this.cachedWidth},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.cachedValue||(this.cachedValue=this.word.substring(0,this.prefixLength)),this.cachedValue},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"formattedValue",{get:function(){return this.wordFormattedText&&(this.cachedFormattedValue=o.substringFormattedText(this.wordFormattedText,0,this.prefixLength)),this.cachedFormattedValue},enumerable:!0,configurable:!0}),e}(),a=function(){function e(e,t,r){this.cachedItems=[],this.ctx=e,this.word=t,this.formattedText=r}return e.prototype.item=function(e){var t=this.cachedItems[e];return t||(t=new i(this.ctx,this.word,e+1,this.formattedText),this.cachedItems[e]=t),t},e}();function l(e,t,r,i){if(0!==t.length){var l=new a(e,t,i),d={width:r,value:"IGNORED"},s=n.binarySearch(l,0,t.length,d,(function(e,t){return e.width-t.width}));s<0&&0!==(s=~s)&&(s-=1);var u=l.item(s);return{width:u.width,value:u.value,remaining:t.substring(u.value.length),formattedRemaining:i?o.substringFormattedText(i,u.value.length):void 0}}}t.breakWideWord=function(e,t,r,n){for(var o=[],i=l(e,t,r,n);i;)o.push({value:i.value,width:i.width}),i=l(e,i.remaining,r,i.formattedRemaining);return o}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CurrencySymbols="$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹",t.SetCellOfInterestSymbols='=\\[\\]\\./%#\\-\\+,;\\(\\):?""&<>\'!{}~\\^\\*'+t.CurrencySymbols,t.AllowedCharactersToLog=t.SetCellOfInterestSymbols+"\\sꃂ",t.DigitReplaceValue="d",t.DigitPattern="[0-9]",t.CharacterReplaceValue="w",t.ValueAnnonymizerRegex=new RegExp("[^"+t.AllowedCharactersToLog+t.DigitReplaceValue+"]","gm"),t.Digit=new RegExp(t.DigitPattern,"gm")},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=r(20),l=r(7),d=r(4),s=r(15),u=r(0),c=r(41);function g(e,t,r){var n=l.getNumFmtHashesWidth(e,t),o=Math.floor(r/n),i="";return i+="#".repeat(o)}t.updateNumberFormattingInformation=function(e,t,r,f){var h,m,C,p;o.verifyArgumentNotNull(r,"cell","updateNumberFormattingInformation"),o.verifyArgumentNotNull(r.CachedFont,"cell.CachedFont","updateNumberFormattingInformation"),o.verifyArgumentNotNull(t,"model","updateNumberFormattingInformation");var y=r.CachedFont.FontName;if(!c.isFontLoadPending(y)||!i.isRenderFlagEnabled(n.RenderFlags.MeasureTextAfterFontDownload,t)){var v=i.isRenderFlagEnabled(n.RenderFlags.AdvancedTextMetrics,t);if(d.isNullOrUndefined(r.NumFmt)||d.isNullOrUndefined(r.NumFmt.Separator)||""===r.NumFmt.Separator){if(l.getTextWidth(e,t,r)>f&&!u.cellHasShrinkToFit(r)){S=g(e,r,f);i.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentJustifyAndDistributed,t)&&(r.CachedIsTextWidthExceedsCellWidth=!0),o.setCellCachedDisplayText(r,S)}}else{var F=void 0;!d.isNullOrUndefined(r.Text)&&d.isNullOrUndefined(null===(h=r.CachedStyle)||void 0===h?void 0:h.ReadingOrder)&&s.analyzeBidiText(r.Text,null===(m=r.CachedStyle)||void 0===m?void 0:m.ReadingOrder).HasRtl&&(F=e.direction,e.direction="rtl");var w=l.measureTextWidth(e,null===(C=r.NumFmt)||void 0===C?void 0:C.Start,v),T=l.measureTextWidth(e,null===(p=r.NumFmt)||void 0===p?void 0:p.End,v);if(w+T>f&&!u.cellHasShrinkToFit(r)){var S=g(e,r,f);o.setCellCachedDisplayText(r,S)}else{var R=l.getNumFmtSeparatorWidth(e,r),x=Math.floor((f-w-T)/R);if(x===1/0)throw Error("updateNumberFormattingInformation:: Invalid SeparatorWidth. SeparatorValue: "+a.annonymize(r.NumFmt.Separator)+" CachedWidth: "+R+" MeasuredWidth: "+e.measureText(r.NumFmt.Separator).width+", IsSpace: "+(" "===r.NumFmt.Separator)+" NaN"+r.NumFmt.Separator.length);var S=function(e,t){var r=t>0?t:0,n=e.Start||"";return n+=e.Separator.repeat(r),n+=e.End||""}(r.NumFmt,x);o.setCellCachedDisplayText(r,S)}F&&(e.direction=F)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fontFaceSetSupported=function(){return void 0!==document.fonts},t.getFontFaceSetReady=function(){return document.fonts.ready},t.isFontLoaded=function(e){for(var t=document.fonts.values(),r=t.next();!r.done;){if(r.value&&r.value.family.replace(/[\""]/g,"").toLowerCase()===e.toLowerCase()&&"loaded"===r.value.status)return!0;r=t.next()}return!1},t.setFontLoadDivWithFontFamily=function(e,t){e.style.fontFamily=t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(3),i=r(2),a=r(0),l=r(7),d=r(6),s=r(4),u=r(15);t.isHorizontalAlignmentFillInCell=function(e,t){var r;return i.isRenderFlagEnabled(n.RenderFlags.AdvHorizontalAlignmentFillAndCAS,e)&&(null===(r=t.CachedStyle)||void 0===r?void 0:r.HorizontalAlignment)===n.HorizontalAlignment.Fill},t.updateCachedDisplayTextForFill=function(e,t,r){var n,i,c=r.Text;if(c){var g=void 0;if(!s.isNullOrUndefined(r.Text)&&s.isNullOrUndefined(null===(n=r.CachedStyle)||void 0===n?void 0:n.ReadingOrder))u.analyzeBidiText(r.Text,null===(i=r.CachedStyle)||void 0===i?void 0:i.ReadingOrder).HasRtl&&(g=e.direction,e.direction="rtl");var f=function(e,t){var r=t.Spill?d.getSpillCellWidth(t,e):d.getCellWidth(e,t,!1);return o.getTextDrawingMaxWidth(r,l.getCellTextHorizontalPadding(t,e),l.getTextIconPadding(e,t))}(t,r),h=l.measureTextWidth(e,c,!1),m=Math.floor(f/h);m<1&&(m=1);var C=c.repeat(m);a.setCellCachedDisplayText(r,C),g&&(e.direction=g)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=r(1),i=r(3),a=r(6),l=r(2),d=r(0),s=r(4),u=r(5),c=r(67);function g(e,t,r,o,i){var l=a.getCellDimensionsAdjustedForDrawing(t,r,!1);if(o===n.Gradient)return c.fillCellWithGradientBackground(e,r.CachedStyle.Gradient,l,i);var d=function(e,t){if(t===n.FormulaParseError)return u.FormulaErrorBackgroundColor;return e.CachedStyle.BackgroundColor}(r,o);return i!==d&&(e.fillStyle=d),e.fillRect(l.x,l.y,l.width,l.height),d}function f(e,t,r){var n=a.getCellLeftAdjustedForDrawing(t,r,!1)-u.GridLineWidthPx,o=a.getCellTopAdjustedForDrawing(t,r)-u.GridLineWidthPx,i=a.getCellWidthAdjustedForDrawing(t,r)+u.GridLineWidthPx,l=a.getCellHeightAdjustedForDrawing(t,r)+u.GridLineWidthPx;e.fillRect(n,o,i,l)}function h(e,t){var r;if(l.isRenderFlagEnabled(o.RenderFlags.HasErrorRefactoring,t)){if(e.HasError)return u.FormulaErrorBackgroundColor}else if(null===(r=e.FormulaInfo)||void 0===r?void 0:r.HasError)return u.FormulaErrorBackgroundColor;return e.CachedStyle.BackgroundColor}function m(e,t){var r;if(l.isRenderFlagEnabled(o.RenderFlags.HasErrorRefactoring,e)){if(t.HasError)return n.FormulaParseError}else if(null===(r=t.FormulaInfo)||void 0===r?void 0:r.HasError)return n.FormulaParseError;return l.isRenderFlagEnabled(o.RenderFlags.GradientFill,e)&&!s.isNullOrUndefined(t.CachedStyle.Gradient)?n.Gradient:s.isNullOrUndefined(t.CachedStyle.BackgroundColor)?n.None:n.Solid}t.drawBackgroundFill=function(e,t,r){if(d.verifyArgumentNotNull(t.RowOffsets,"model.RowOffsets","drawBackgroundFill"),d.verifyArgumentNotNull(t.ColumnOffsets,"model.ColumnOffsets","drawBackgroundFill"),d.verifyArgumentNotNull(t.RowHeights,"model.RowHeights","drawBackgroundFill"),d.verifyArgumentNotNull(t.ColumnWidths,"model.ColumnWidths","drawBackgroundFill"),d.verifyArgumentNotNull(t.Cells,"model.Cells","drawBackgroundFill"),d.verifyArgumentNotNull(t.Styles,"model.Styles","drawBackgroundFill"),!r.highContrastScheme)if(l.isRenderFlagEnabled(o.RenderFlags.GradientFill,t)){for(var s=t.Cells,u=void 0,c=[],C=0;C<s.length;C++){(y=m(t,p=s[C]))!==n.None&&(i.cellIntersectsRenderingRegion(p,r.renderingRegion)&&(a.isCellSpansMultipleRowsOrBlocks(p)?c.push([p,y]):u=g(e,t,p,y,u)))}for(C=0;C<c.length;C++){var p,y,v=c[C];u=g(e,t,p=v[0],y=v[1],u)}}else!function(e,t,r){for(var n,o=t.Cells,l=[],d=0;d<o.length;d++){var s=o[d];(u=h(s,t))&&(i.cellIntersectsRenderingRegion(s,r.renderingRegion)&&(a.isCellSpansMultipleRowsOrBlocks(s)&&u?l.push(s):(n!==u&&(e.fillStyle=u,n=u),f(e,t,s))))}for(d=0;d<l.length;d++){var u=h(s=l[d],t);n!==u&&(e.fillStyle=u,n=u),f(e,t,s)}}(e,t,r)},function(e){e[e.None=0]="None",e[e.Solid=1]="Solid",e[e.FormulaParseError=2]="FormulaParseError",e[e.Gradient=3]="Gradient"}(n||(n={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0);function i(e,t,r,i){o.verifyArgumentNotNull(r,"cell.CachedStyle.Gradient.Stops","createGradientFill");for(var a=function(e,t){var r=t.x,o=t.y,i=t.width,a=t.height;switch(e){case n.GradientShadingStyle.Vertical:case n.GradientShadingStyle.Center:case n.GradientShadingStyle.TopRightCorner:return{x0:r,y0:0,x1:r+i,y1:0};case n.GradientShadingStyle.ReversedVertical:case n.GradientShadingStyle.TopLeftCorner:return{x0:r+i,y0:0,x1:r,y1:0};case n.GradientShadingStyle.Horizontal:case n.GradientShadingStyle.BottomRightCorner:case n.GradientShadingStyle.BottomLeftCorner:return{x0:0,y0:o,x1:0,y1:o+a};case n.GradientShadingStyle.ReversedHorizontal:return{x0:0,y0:o+a,x1:0,y1:o};case n.GradientShadingStyle.DiagonalUp:case n.GradientShadingStyle.DiagonalDown:case n.GradientShadingStyle.ReversedDiagonalUp:case n.GradientShadingStyle.ReversedDiagonalDown:return function(e,t){var r=t.width*t.width,o=t.height*t.height,i=r+o,a=t.x+t.width/2,l=t.y+t.height/2,d=t.width*o/i,s=r*t.height/i;switch(e){case n.GradientShadingStyle.DiagonalUp:break;case n.GradientShadingStyle.DiagonalDown:d=-d;break;case n.GradientShadingStyle.ReversedDiagonalUp:s=-s;break;case n.GradientShadingStyle.ReversedDiagonalDown:d=-d,s=-s;break;default:throw Error("getDiagonalGradientLine:: Gradient shading style is not diagonal.")}return{x0:a-d,y0:l-s,x1:a+d,y1:l+s}}(e,t);default:throw Error("getGradientLine:: Gradient not supported")}}(t,i),l=e.createLinearGradient(a.x0,a.y0,a.x1,a.y1),d=0;d<r.length;d++)l.addColorStop(r[d].Position,r[d].Color);return l}t.fillCellWithGradientBackground=function(e,t,r,o){var a=i(e,t.ShadingStyle,t.Stops,r);return a!==o&&(e.fillStyle=a),e.fillRect(r.x,r.y,r.width,r.height),function(e){switch(e){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.TopRightCorner:case n.GradientShadingStyle.BottomLeftCorner:case n.GradientShadingStyle.BottomRightCorner:case n.GradientShadingStyle.Center:return!0;default:return!1}}(t.ShadingStyle)&&(a=e.fillStyle=i(e,function(e){switch(e){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.TopRightCorner:return n.GradientShadingStyle.ReversedHorizontal;case n.GradientShadingStyle.BottomLeftCorner:return n.GradientShadingStyle.ReversedVertical;case n.GradientShadingStyle.BottomRightCorner:return n.GradientShadingStyle.Vertical;case n.GradientShadingStyle.Center:return n.GradientShadingStyle.Horizontal;default:throw Error("getSecondPassShadingStyle:: Gradient shading style does not have a second pass.")}}(t.ShadingStyle),t.Stops,r),function(e,t,r){var o=r.x,i=r.y,a=r.width,l=r.height;switch(e.beginPath(),e.moveTo(o,i),e.lineTo(o+a,i),t){case n.GradientShadingStyle.TopLeftCorner:case n.GradientShadingStyle.BottomRightCorner:e.lineTo(o+a,i+l);break;case n.GradientShadingStyle.TopRightCorner:case n.GradientShadingStyle.BottomLeftCorner:e.lineTo(o,i+l);break;case n.GradientShadingStyle.Center:e.lineTo(o,i+l),e.lineTo(o+a,i+l);break;default:throw Error("setSecondPassStencil:: Gradient shading style does not have a second pass.")}e.lineTo(o,i)}(e,t.ShadingStyle,r),e.fill()),a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(27),o=r(2),i=r(4);function a(e,t){for(var r=Object.getOwnPropertyNames(e),o=0;o<r.length;o++){var i=r[o];d(e,n.SerializationProperties[m(t,i)],i)&&l(e,i)}}function l(e,t){h(e,t,void 0)}function d(e,t,r){if(i.isNullOrUndefined(t))return!1;if(t.tsOnly)return!0;switch(t.type){case"number":return 0===f(e,r);case"boolean":return!1===f(e,r);case"object":return null===f(e,r)}return!1}t.cleanModelBeforeSerialization=function(e){o.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),a(e,"GridBlockModel"),function(e){var t=e.Cells;if(t)for(var r=0;r<t.length;r++){a(t[r],"Cell")}}(e)},t.restoreModelAfterSerialization=function(e){o.verifyArgumentNotNull(e,"model","cleanModelBeforeSerialization"),u(e,"GridBlockModel"),function(e){if(e.Cells)for(var t=e.Cells,r=0;r<t.length;r++){u(t[r],"Cell")}}(e)};var s={};function u(e,t){for(var r=function(e){var t=s[e];t||(t=Object.keys(n.SerializationProperties).filter((function(t){return t.startsWith(e)})),s[e]=t);return t}(t),o=0;o<r.length;o++){var i=r[o],a=i.substring(i.indexOf(".")+1),l=n.SerializationProperties[m(t,a)];c(e,l,a)&&g(e,l,a)}}function c(e,t,r){return t&&!t.tsOnly&&void 0===f(e,r)}function g(e,t,r){switch(t.type){case"number":h(e,r,0);break;case"boolean":h(e,r,!1)}}function f(e,t){return e[t]}function h(e,t,r){e[t]=r}function m(e,t){return n.SerializationPropertyKey.replace("{className}",e).replace("{propertyName}",t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(29),o=r(7),i=r(6),a=r(3),l=r(1),d=r(0),s=r(2),u=r(11),c=r(16);t.updateCellShrinkToFit=function(e,t,r){var g,f=d.getFontCssStringFromFont(r.CachedFont,void 0);s.isRenderFlagEnabled(l.RenderFlags.MeasureTextRefactor,t)&&(e.font=f);var h,m=s.isRenderFlagEnabled(l.RenderFlags.MeasureTextRefactor,t)?o.getTextWidthNoCaching(e,t,r):n.GridBlockRendererGlobals.measureTextWidth(r.Text,f,s.isRenderFlagEnabled(l.RenderFlags.AdvancedTextMetrics,t)),C=i.getCellWidth(t,r,!1),p=r.CachedStyle.Indentation||0,y=r.CachedFont.Size;h=o.getHorizontalPadding(y,r.CachedStyle.HorizontalAlignment,r.CachedFont.Italic,p,!0,0);var v=r.CondFormat&&(null===(g=r.CondFormat)||void 0===g?void 0:g.Icon),F=v?c.getIconSize(y,1):0,w=v?c.getIconHorizontalPadding(y,1):0,T=a.getTextDrawingMaxWidth(C,h,0);r.ShrunkSize=function(e,t,r,n){if(e<t)return r;return r*(t/(e+n))}(m+w+F,T,y,h),r.ShrunkSize<0&&u.setActualFontSizeWarning("\n    ShrinkSize was calculated to be negative: "+r.ShrunkSize+",\n    textWidth: "+m+",\n    cellWidth: "+C+",\n    cellIndentation "+p+",\n    maxTextWidth: "+T+",\n    originalFontSize: "+y+",\n    padding: "+h+"\n    ")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(0),i=r(2),a=r(3),l=r(8),d=r(6),s=r(22),u=r(5),c=r(71),g=r(72),f=r(16),h=r(73),m=r(74),C=r(75),p=r(76),y=r(77),v=r(78),F=r(44),w=r(79),T=r(80);function S(e,t,r,n,i){var S=function(e,t,r,n){var i=t.CondFormat.Icon.IconOnly?t.CachedFont.Size:o.getActualFontSize(t),a=f.getIconSize(i,r),d=t.CondFormat.Icon,s=l.IconImageLookup[d.Set][d.Index],u=g.getIconLeftPosition(e,t,a,i,r),c=g.getIconVerticalPosition(e,t,r,a);return{size:a,image:s,left:u,bottom:c,highContrastScheme:n}}(t,r,n,i),R=function(e,t,r){if(function(e,t,r){var n=d.getCellBottomAdjustedForDrawing(e,t)-u.GridLineWidthPx;if(r.bottom>=n)return!0;var o=d.getCellTopAdjustedForDrawing(e,t);if(r.bottom-r.size<=o)return!0;var i=d.getCellLeftAdjustedForDrawing(e,t,!1);if(r.left<=i)return!0;var a=d.getCellRightAdjustedForDrawing(e,t)-u.GridLineWidthPx;if(r.left+r.size>=a)return!0;return!1}(e,t,r))return{x:d.getCellLeftAdjustedForDrawing(e,t,!1),y:d.getCellTopAdjustedForDrawing(e,t),width:d.getCellWidthAdjustedForDrawing(e,t)-u.GridLineWidthPx,height:d.getCellHeightAdjustedForDrawing(e,t)-u.GridLineWidthPx};return}(t,r,S);switch(a.applyClipping(e,R),S.image){case l.CFIconImage.CircleLow:case l.CFIconImage.CircleMedium:case l.CFIconImage.CircleHigh:case l.CFIconImage.CircleEmpty:case l.CFIconImage.CircleFilled:case l.CFIconImage.FourCircleHigh:case l.CFIconImage.FourCircleLow:case l.CFIconImage.FourCircleMedium1:case l.CFIconImage.FourCircleMedium2:case l.CFIconImage.Circle25:case l.CFIconImage.CircleHalf:case l.CFIconImage.Circle75:s.drawCircleIcon(e,t,r,S);break;case l.CFIconImage.CircleSymbolHigh:case l.CFIconImage.CircleSymbolMedium:case l.CFIconImage.CircleSymbolLow:T.drawCircledSymbols(e,t,r,S);break;case l.CFIconImage.TrafficHigh:case l.CFIconImage.TrafficMedium:case l.CFIconImage.TrafficLow:c.drawTrafficLightRimmed(e,t,r,S);break;case l.CFIconImage.SignalBarEmpty:case l.CFIconImage.SignalBarLow:case l.CFIconImage.SignalBarMedium1:case l.CFIconImage.SignalBarMedium2:case l.CFIconImage.SignalBarHigh:h.drawSignalBar(e,t,r,S);break;case l.CFIconImage.QuadrantEmpty:case l.CFIconImage.Quadrant25:case l.CFIconImage.QuadrantHalf:case l.CFIconImage.Quadrant75:case l.CFIconImage.QuadrantFull:m.drawQuadrantBoxes(e,t,r,S);break;case l.CFIconImage.FlagHigh:case l.CFIconImage.FlagMedium:case l.CFIconImage.FlagLow:C.drawFlag(e,t,r,S);break;case l.CFIconImage.TriangleHigh:case l.CFIconImage.TriangleMedium:case l.CFIconImage.TriangleLow:p.drawTriangleSet(e,t,r,S);break;case l.CFIconImage.StarHigh:case l.CFIconImage.StarMedium:case l.CFIconImage.StarLow:y.drawStarIcon(e,t,r,S);break;case l.CFIconImage.SignLow:case l.CFIconImage.SignMedium:v.drawSigns(e,t,r,S);break;case l.CFIconImage.SymbolHigh:case l.CFIconImage.SymbolMedium:case l.CFIconImage.SymbolLow:F.drawSymbols(e,t,r,S);break;case l.CFIconImage.ColoredArrowDown:case l.CFIconImage.ColoredArrowDownRight:case l.CFIconImage.ColoredArrowRight:case l.CFIconImage.ColoredArrowUp:case l.CFIconImage.ColoredArrowUpRight:case l.CFIconImage.GrayArrowDown:case l.CFIconImage.GrayArrowDownRight:case l.CFIconImage.GrayArrowRight:case l.CFIconImage.GrayArrowUp:case l.CFIconImage.GrayArrowUpRight:w.drawArrows(e,t,r,S);break;default:throw Error("drawConditionalFormattingIcon: imageType: "+S.image+" not supported")}a.restoreClipping(e,R)}t.drawConditionalFormattingIcons=function(e,t,r){var d,s;o.verifyArgumentNotNull(e,"ctx","drawConditionalFormattingIcons"),o.verifyArgumentNotNull(t,"model","drawConditionalFormattingIcons"),o.verifyArgumentNotNull(r,"context","drawConditionalFormattingIcons");var c=t.Cells;c.length>0&&(e.lineWidth=l.IconOutlineWidthPx,e.setLineDash(u.DefaultDash));for(var g=i.isRenderFlagEnabled(n.RenderFlags.CFIconsHighContrast,t)&&r.highContrastScheme?r.highContrastScheme:void 0,f=0;f<c.length;f++){var h=c[f];(null===(s=null===(d=h)||void 0===d?void 0:d.CondFormat)||void 0===s?void 0:s.Icon)&&(a.cellIntersectsRenderingRegion(h,r.renderingRegion)&&S(e,t,h,r.devicePixelRatio,g))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(12),a=r(22),l=r(9);t.drawTrafficLightRimmed=function(e,t,r,d){n.verifyArgumentNotNull(e,"ctx","drawTrafficLightRimmed"),n.verifyArgumentNotNull(t,"model","drawTrafficLightRimmed"),n.verifyArgumentNotNull(r,"cell","drawTrafficLightRimmed"),n.verifyArgumentNotNull(d,"drawingContext","drawTrafficLightRimmed");var s=d.size,u=s;s%2==0&&(u=s-1);var c={left:d.left,bottom:d.bottom,outerColor:l.TrafficHighRimmedRectColor,height:u,width:u,innerColor:void 0};i.drawRectangleIcon(e,t,r,c),d.size=u;var g=function(e){var t=e.image,r=e.left,n=e.bottom,i=e.highContrastScheme,a=e.size-2*o.CirclePaddingFromBoundariesPx,l=r+o.CirclePaddingFromBoundariesPx+.5,d=n-o.CirclePaddingFromBoundariesPx-.5;return{size:a,left:l,bottom:d,image:t,highContrastScheme:i}}(d);a.drawCircleIcon(e,t,r,g)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(7),i=r(6),a=r(16),l=r(8),d=r(0);t.getIconVerticalPosition=function(e,t,r,a){var s=t.CachedStyle.VerticalAlignment,u=function(e,t,r,n){var a=o.getTextVerticalPosition(t,e,o.getTextLineHeight(t,e),i.getCellHeight(e,t,!1),void 0),l=o.getMiddleBaseline(a,t.CachedFont,d.getActualFontSize(t))*r+.5*n;return Math.round(l)}(e,t,r,a);switch(s){case n.VerticalAlignment.Bottom:var c=i.getCellBottomAdjustedForDrawing(e,t);return Math.min(u,c-l.MinimalIconPadding);case n.VerticalAlignment.Top:var g=i.getCellTopAdjustedForDrawing(e,t);return Math.max(u,g+l.MinimalIconPadding+a);case n.VerticalAlignment.Center:case n.VerticalAlignment.Justify:case n.VerticalAlignment.Distributed:return function(e,t,r,n){if(i.getCellBottomAdjustedForDrawing(e,t)-l.MinimalIconPadding<r)return!0;if(i.getCellTopAdjustedForDrawing(e,t)+l.MinimalIconPadding>r+n)return!0;return!1}(e,t,u,a)?Math.floor(i.getCellCenterYAdjustedForDrawing(e,t)+a/2):u;default:throw Error("getIconVerticalPosition: Vertical alignment type not supported!")}},t.getIconLeftPosition=function(e,t,r,o,l){var d,s;return(null===(s=null===(d=t.CondFormat)||void 0===d?void 0:d.Icon)||void 0===s?void 0:s.IconOnly)?function(e,t,r,o,l){var d=t.CondFormat.Icon.CFIconHorizontalAlignment;switch(d){case n.HorizontalAlignment.Right:return i.getCellRightAdjustedForDrawing(e,t)-a.getIconHorizontalPadding(o,l)-r;case n.HorizontalAlignment.Fill:case n.HorizontalAlignment.Justify:case n.HorizontalAlignment.CenterAcrossSelection:case n.HorizontalAlignment.Distributed:case n.HorizontalAlignment.JustifyDistributed:case n.HorizontalAlignment.Automatic:case n.HorizontalAlignment.Left:return i.getCellLeftAdjustedForDrawing(e,t,!1)+a.getIconHorizontalPadding(o,l);case n.HorizontalAlignment.Center:return Math.floor(i.getCellCenterXAdjustedForDrawing(e,t)-r/2);default:throw Error("getIconLeftOnlyPosition: unsupported horizontalAlignment: "+d)}}(e,t,r,o,l):i.getCellLeftAdjustedForDrawing(e,t,!1)+a.getIconHorizontalPadding(o,l)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(12),i=r(8),a=r(9),l=r(3);function d(e,t,r,n){var o=n.left,i=n.bottom;return{innerColor:t,outerColor:function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(n.highContrastScheme),bottom:i,left:o+r*(e+1),height:r*(e+2),width:r}}t.drawSignalBar=function(e,t,r,s){n.verifyArgumentNotNull(e,"ctx","drawSignalBar"),n.verifyArgumentNotNull(t,"model","drawSignalBar"),n.verifyArgumentNotNull(r,"cell","drawSignalBar"),n.verifyArgumentNotNull(s,"drawingContext","drawSignalBar");for(var u=s.image,c=s.size,g=s.highContrastScheme,f=Math.floor(c/5),h=function(e,t){var r=function(e){if(e)return l.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t),n=function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t);switch(e){case i.CFIconImage.SignalBarEmpty:return[r,r,r,r];case i.CFIconImage.SignalBarLow:return[n,r,r,r];case i.CFIconImage.SignalBarMedium1:return[n,n,r,r];case i.CFIconImage.SignalBarMedium2:return[n,n,n,r];case i.CFIconImage.SignalBarHigh:return[n,n,n,n];default:throw Error("getBarsColors: image: "+e+" not supported")}}(u,g),m=0;m<h.length;m++){var C=d(m,h[m],f,s);o.drawRectangleIcon(e,t,r,C)}g&&function(e,t,r,n){var o=r.left,a=r.bottom,d=r.highContrastScheme,s=function(e,t,r,n){for(var o=function(e){switch(e){case i.CFIconImage.SignalBarEmpty:case i.CFIconImage.SignalBarLow:return 0;case i.CFIconImage.SignalBarMedium1:return 1;case i.CFIconImage.SignalBarMedium2:return 2;case i.CFIconImage.SignalBarHigh:return 3;default:throw Error("getSeperators: image: "+e+" not supported")}}(e),a=[],l=r-2*n+i.IconLinesAdjustment,d=t+2*n+i.IconLinesAdjustment,s=0;s<o;s++)a.push({X:d,startY:l,endY:r-1.5}),l-=n,d+=n;return a}(e,o,a,n);t.strokeStyle=l.rgbToColorHex(d.BackgroundColor),t.beginPath();for(var u=0;u<s.length;u++)l.drawLine(t,s[u].X,s[u].startY,s[u].X,s[u].endY);t.stroke()}(u,e,s,f)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(12),i=r(8),a=r(9),l=r(3);function d(e,t,r,n,o){var i=o.left,d=o.bottom;return{innerColor:r,outerColor:function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarOutlineColor}(o.highContrastScheme),bottom:d-e*n,left:i+t*n,height:n,width:n}}t.drawQuadrantBoxes=function(e,t,r,s){n.verifyArgumentNotNull(e,"ctx","drawQuadrantBoxes"),n.verifyArgumentNotNull(t,"model","drawQuadrantBoxes"),n.verifyArgumentNotNull(r,"cell","drawQuadrantBoxes"),n.verifyArgumentNotNull(s,"drawingContext","drawQuadrantBoxes");for(var u=s.image,c=s.size,g=s.highContrastScheme,f=Math.floor(c/2),h=function(e,t){var r=function(e){if(e)return l.rgbToColorHex(e.TextColor);return a.SignalBarFilledColor}(t),n=function(e){if(e)return l.rgbToColorHex(e.BackgroundColor);return a.SignalBarEmptyColor}(t);switch(e){case i.CFIconImage.QuadrantEmpty:return[[n,n],[n,n]];case i.CFIconImage.Quadrant25:return[[r,n],[n,n]];case i.CFIconImage.QuadrantHalf:return[[r,r],[n,n]];case i.CFIconImage.Quadrant75:return[[r,r],[r,n]];case i.CFIconImage.QuadrantFull:return[[r,r],[r,r]];default:throw Error("getBoxesColors: image: "+e+" not supported")}}(u,g),m=0;m<h.length;m++)for(var C=0;C<h.length;C++){var p=d(m,C,h[m][C],f,s);o.drawRectangleIcon(e,t,r,p)}g&&function(e,t,r,n){var o=t.left,a=t.bottom,d=t.highContrastScheme,s=o+r+i.IconLinesAdjustment,u=a-r-i.IconLinesAdjustment,c=function(e,t,r,n){switch(e){case i.CFIconImage.QuadrantEmpty:return[];case i.CFIconImage.Quadrant25:return[{x:t,y:r+n-i.IconLinesAdjustment},{x:t-n+i.IconLinesAdjustment,y:r}];case i.CFIconImage.QuadrantHalf:return[{x:t+n,y:r},{x:t,y:r+n-i.IconLinesAdjustment},{x:t-n+i.IconLinesAdjustment,y:r}];case i.CFIconImage.Quadrant75:case i.CFIconImage.QuadrantFull:return[{x:t,y:r-n+i.IconLinesAdjustment},{x:t+n-i.IconLinesAdjustment,y:r},{x:t,y:r+n-i.IconLinesAdjustment},{x:t-n+i.IconLinesAdjustment,y:r}];default:throw Error("getSeperatorsCoordinates: image: "+e+" not supported")}}(n,s,u,r);e.strokeStyle=l.rgbToColorHex(d.BackgroundColor),e.beginPath();for(var g=0;g<c.length;g++)l.drawLine(e,s,u,c[g].x,c[g].y);e.stroke()}(e,s,f,u)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(12),a=r(9),l=r(3),d=r(5);t.drawFlag=function(e,t,r,s){n.verifyArgumentNotNull(e,"ctx","drawFlags"),n.verifyArgumentNotNull(t,"model","drawFlags"),n.verifyArgumentNotNull(r,"cell","drawFlags"),n.verifyArgumentNotNull(s,"drawingContext","drawFlags");var u=s.image,c=s.size,g=s.left,f=s.bottom,h=Math.floor(c/2),m=Math.floor(c/3),C=function(e){switch(e){case o.CFIconImage.FlagHigh:return a.FlagHighInnerColor;case o.CFIconImage.FlagMedium:return a.FlagMediumInnerColor;case o.CFIconImage.FlagLow:return a.FlagLowInnerColor;default:throw Error("getFlagInnerColor: unsupported image type = "+e)}}(u),p=function(e){switch(e){case o.CFIconImage.FlagHigh:return a.FlagHighOuterColor;case o.CFIconImage.FlagMedium:return a.FlagMediumOuterColor;case o.CFIconImage.FlagLow:return a.FlagLowOuterColor;default:throw Error("getFlagOuterColor: unsupported image type = "+e)}}(u);!function(e,t,r,n,o,a,l,d,s){var u={left:n,bottom:o-a,outerColor:s,height:a,width:l,innerColor:d};i.drawRectangleIcon(e,t,r,u)}(e,t,r,g,f,h,m,C,p),function(e,t,r,n,o,a,l,d,s,u){var c=Math.floor(n/8),g={left:o+d,bottom:a-l+c,outerColor:u,height:l,width:d,innerColor:s};i.drawRectangleIcon(e,t,r,g)}(e,t,r,c,g,f,h,m,C,p),function(e,t,r,n){var i=n-o.IconLinesAdjustment,s=i-r,u=t+o.IconLinesAdjustment;e.lineWidth=o.FlagPoleWidth,e.setLineDash(d.DefaultDash),e.strokeStyle=a.FlagStickColor,e.beginPath(),l.drawLine(e,u,i,u,s),e.stroke()}(e,g,2*h,f)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(12),a=r(9),l=r(43);t.drawTriangleSet=function(e,t,r,d){n.verifyArgumentNotNull(e,"ctx","drawTriangleSet"),n.verifyArgumentNotNull(t,"model","drawTriangleSet"),n.verifyArgumentNotNull(r,"cell","drawTriangleSet"),n.verifyArgumentNotNull(d,"drawingContext","drawTriangleSet");var s=d.image,u=d.size,c=d.left,g=d.bottom;switch(s){case o.CFIconImage.TriangleHigh:case o.CFIconImage.TriangleLow:var f=function(e){var t=e.image,r=e.left,n=e.bottom,i=e.size,l=Math.floor(i/2),d=Math.floor(i/4),s=n-d-o.IconLinesAdjustment,u=r+o.IconLinesAdjustment;switch(t){case o.CFIconImage.TriangleHigh:return{outerColor:a.TriangleHighOuterColor,innerColor:a.TriangleHighInnerColor,left:u,bottom:s,height:l,width:i};case o.CFIconImage.TriangleLow:return{outerColor:a.TriangleLowOuterColor,innerColor:a.TriangleLowInnerColor,left:r+o.IconLinesAdjustment,bottom:n-d-l-o.IconLinesAdjustment,height:l,width:i};default:throw Error("getTriangleDrawingContext: unsupported image type = "+t)}}(d);l.drawTriangle(e,t,r,f,s===o.CFIconImage.TriangleLow);break;case o.CFIconImage.TriangleMedium:var h=Math.floor(u/3),m={left:c,outerColor:a.TriangleMediumOuterColor,innerColor:a.TriangleMediumInnerColor,bottom:g-h,height:h,width:u};i.drawRectangleIcon(e,t,r,m);break;default:throw Error("drawTriangleSet: unsupported image type = "+s)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(9),a=r(23);t.drawStarIcon=function(e,t,r,l){n.verifyArgumentNotNull(e,"ctx","drawStarIcon"),n.verifyArgumentNotNull(t,"model","drawStarIcon"),n.verifyArgumentNotNull(r,"cell","drawStarIcon"),n.verifyArgumentNotNull(l,"drawingContext","drawStarIcon");var d=l.image,s=l.size,u=l.left,c=l.bottom,g=Math.floor(s/2);if(!(g<=1)){var f=function(e,t,r){var n=r*o.StarInset,i=e+r+.5,a=t-r,l=n*o.StarRotationSin,d=n*o.StarRotationCos,s=r*o.StarRotation2Sin,u=n*o.StarRotation2Sin,c=n*o.StarRotation2Cos,g=r*o.StarRotationSin,f=r*o.StarRotationCos,h=Math.floor(d)+o.IconLinesAdjustment,m=a+(d-h),C=m-d,p=m+c,y=m+f;return{topOuter:{x:i,y:m-r},topRightInner:{x:i+l,y:C},topRightOuter:{x:i+s,y:C},middleRightInner:{x:i+u,y:p},bottomRightOuter:{x:i+g,y:y},bottomInner:{x:i,y:m+n},bottomLeftOuter:{x:i-g,y:y},middleLeftInner:{x:i-u,y:p},topLeftOuter:{x:i-s,y:C},topLeftInner:{x:i-l,y:C}}}(u,c,g),h=function(e){switch(e){case o.CFIconImage.StarHigh:case o.CFIconImage.StarMedium:return i.StarFilledInnerColor;case o.CFIconImage.StarLow:return i.StarEmptyInnerColor;default:throw Error("getStarLeftInnerColor: unsupported image type = "+e)}}(d),m=function(e){switch(e){case o.CFIconImage.StarHigh:case o.CFIconImage.StarMedium:return i.StarFilledOuterColor;case o.CFIconImage.StarLow:return i.StarEmptyOuterColor;default:throw Error("getStarLeftOuterColor: unsupported image type = "+e)}}(d),C=function(e){switch(e){case o.CFIconImage.StarHigh:return i.StarFilledInnerColor;case o.CFIconImage.StarMedium:case o.CFIconImage.StarLow:return i.StarEmptyInnerColor;default:throw Error("getStarRightInnerColor: unsupported image type = "+e)}}(d),p=function(e){switch(e){case o.CFIconImage.StarHigh:return i.StarFilledOuterColor;case o.CFIconImage.StarMedium:case o.CFIconImage.StarLow:return i.StarEmptyOuterColor;default:throw Error("getStarRightOuterColor: unsupported image type = "+e)}}(d),y=d===o.CFIconImage.StarMedium;e.beginPath(),function(e,t){e.moveTo(t.topOuter.x,t.topOuter.y),e.lineTo(t.topRightInner.x,t.topRightInner.y),e.lineTo(t.topRightOuter.x,t.topRightOuter.y),e.lineTo(t.middleRightInner.x,t.middleRightInner.y),e.lineTo(t.bottomRightOuter.x,t.bottomRightOuter.y),e.lineTo(t.bottomInner.x,t.bottomInner.y)}(e,f),y&&(a.fillAndStroke(e,C,p),e.beginPath()),function(e,t){e.moveTo(t.bottomInner.x,t.bottomInner.y),e.lineTo(t.bottomLeftOuter.x,t.bottomLeftOuter.y),e.lineTo(t.middleLeftInner.x,t.middleLeftInner.y),e.lineTo(t.topLeftOuter.x,t.topLeftOuter.y),e.lineTo(t.topLeftInner.x,t.topLeftInner.y),e.lineTo(t.topOuter.x,t.topOuter.y)}(e,f),a.fillAndStroke(e,h,m)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(8),i=r(9),a=r(43),l=r(23);t.drawSigns=function(e,t,r,d){n.verifyArgumentNotNull(e,"ctx","drawSigns"),n.verifyArgumentNotNull(t,"model","drawSigns"),n.verifyArgumentNotNull(r,"cell","drawSigns"),n.verifyArgumentNotNull(d,"drawingContext","drawSigns");var s=d.image;switch(s){case o.CFIconImage.SignLow:!function(e,t){var r=function(e){var t=e.size,r=e.left,n=e.bottom,i=Math.floor(t/2),a=r+i+o.IconLinesAdjustment,l=n-i-o.IconLinesAdjustment;return{top:{x:a,y:l-i},right:{x:a+i,y:l},bottom:{x:a,y:l+i},left:{x:a-i,y:l}}}(t);e.beginPath(),e.moveTo(r.top.x,r.top.y),e.lineTo(r.right.x,r.right.y),e.lineTo(r.bottom.x,r.bottom.y),e.lineTo(r.left.x,r.left.y),e.lineTo(r.top.x,r.top.y),l.fillAndStroke(e,i.SignLowInnerColor,i.SignLowOuterColor)}(e,d);break;case o.CFIconImage.SignMedium:var u=function(e){var t=e.left,r=e.bottom,n=e.size,a=t+o.IconLinesAdjustment,l=r-o.IconLinesAdjustment;return{outerColor:i.SignMediumOuterColor,innerColor:i.SignMediumInnerColor,left:a,bottom:l,height:n,width:n}}(d);a.drawTriangle(e,t,r,u,!1);break;default:throw Error("drawSigns: unsupported image type = "+s)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(9),i=r(8),a=r(23);function l(e,t,r,n){var o=r?i.IconLinesAdjustment:0,a=n?i.IconLinesAdjustment:0;return{x:Math.round(e)+o,y:Math.round(t)+a}}t.drawArrows=function(e,t,r,d){n.verifyArgumentNotNull(e,"ctx","drawArrows"),n.verifyArgumentNotNull(t,"model","drawArrows"),n.verifyArgumentNotNull(r,"cell","drawArrows"),n.verifyArgumentNotNull(d,"drawingContext","drawArrows");var s=d.image,u=d.size,c=d.left,g=d.bottom,f=function(e){switch(e){case i.CFIconImage.GrayArrowDown:case i.CFIconImage.GrayArrowDownRight:case i.CFIconImage.GrayArrowRight:case i.CFIconImage.GrayArrowUp:case i.CFIconImage.GrayArrowUpRight:return o.ArrowGrayOuterColor;case i.CFIconImage.ColoredArrowUp:return o.ArrowUpOuterColor;case i.CFIconImage.ColoredArrowDown:return o.ArrowDownOuterColor;case i.CFIconImage.ColoredArrowUpRight:case i.CFIconImage.ColoredArrowRight:case i.CFIconImage.ColoredArrowDownRight:return o.ArrowRightOuterColor;default:throw Error("getArroweOuterColor: unsupported image type = "+e)}}(s),h=function(e){switch(e){case i.CFIconImage.GrayArrowDown:case i.CFIconImage.GrayArrowDownRight:case i.CFIconImage.GrayArrowRight:case i.CFIconImage.GrayArrowUp:case i.CFIconImage.GrayArrowUpRight:return o.ArrowGrayInnerColor;case i.CFIconImage.ColoredArrowUp:return o.ArrowUpInnerColor;case i.CFIconImage.ColoredArrowDown:return o.ArrowDownInnerColor;case i.CFIconImage.ColoredArrowUpRight:case i.CFIconImage.ColoredArrowRight:case i.CFIconImage.ColoredArrowDownRight:return o.ArrowRightInnerColor;default:throw Error("getArroweInnerColor: unsupported image type = "+e)}}(s),m=[];switch(s){case i.CFIconImage.GrayArrowDown:case i.CFIconImage.ColoredArrowDown:m=function(e,t,r){var n=i.ArrowHeightRatio*r,o=i.ArrowWidthRatio*r,a=r/2+e,d=t,s=a+n*Math.cos(-3*i.ArrowAngle),u=d+n*Math.sin(-3*i.ArrowAngle),c=s+o*Math.cos(-i.ArrowAngle),g=u+o*Math.sin(-i.ArrowAngle),f=c+n/2*Math.cos(i.ArrowAngle),h=g+n/2*Math.sin(i.ArrowAngle),m=f,C=h-n,p=m+o,y=C,v=p,F=y+n,w=v+n/2*Math.cos(-i.ArrowAngle),T=F+n/2*Math.sin(-i.ArrowAngle),S=w+o*Math.cos(i.ArrowAngle),R=T+o*Math.sin(i.ArrowAngle),x=l(a,d,!1,!1),b=l(s,u,!1,!1),I=l(c,g,!1,!1),A=l(f,h,!0,!1),D=l(m,C,!0,!0),M=l(p,y,!0,!0),k=l(v,F,!0,!1),L=l(w,T,!1,!1),P=l(S,R,!1,!1);return[x,b,I,A,D,M,k,L,P,x]}(c,g,u);break;case i.CFIconImage.GrayArrowUp:case i.CFIconImage.ColoredArrowUp:m=function(e,t,r){var n=t-r,o=i.ArrowHeightRatio*r,a=i.ArrowWidthRatio*r,d=r/2+e,s=n,u=d+o*Math.cos(3*i.ArrowAngle),c=s+o*Math.sin(3*i.ArrowAngle),g=u+a*Math.cos(i.ArrowAngle),f=c+a*Math.sin(i.ArrowAngle),h=g+o/2*Math.cos(-i.ArrowAngle),m=f+o/2*Math.sin(-i.ArrowAngle),C=h,p=m+o,y=C+a,v=p,F=y,w=v-o,T=F+o/2*Math.cos(i.ArrowAngle),S=w+o/2*Math.sin(i.ArrowAngle),R=T+a*Math.cos(-i.ArrowAngle),x=S+a*Math.sin(-i.ArrowAngle),b=l(d,s,!1,!1),I=l(u,c,!1,!1),A=l(g,f,!1,!1),D=l(h,m,!0,!1),M=l(C,p,!0,!0),k=l(y,v,!0,!0),L=l(F,w,!0,!1),P=l(T,S,!1,!1),O=l(R,x,!1,!1);return[b,I,A,D,M,k,L,P,O,b]}(c,g,u);break;case i.CFIconImage.GrayArrowRight:case i.CFIconImage.ColoredArrowRight:m=function(e,t,r){var n=t-r,o=i.ArrowHeightRatio*r,a=i.ArrowWidthRatio*r,d=e+r,s=r/2+n,u=d+o*Math.cos(-3*i.ArrowAngle),c=s+o*Math.sin(-3*i.ArrowAngle),g=u+a*Math.cos(3*i.ArrowAngle),f=c+a*Math.sin(3*i.ArrowAngle),h=g+o/2*Math.cos(i.ArrowAngle),m=f+o/2*Math.sin(i.ArrowAngle),C=h-o,p=m,y=C,v=p+a,F=y+o,w=v,T=F+o/2*Math.cos(3*i.ArrowAngle),S=w+o/2*Math.sin(3*i.ArrowAngle),R=T+a*Math.cos(i.ArrowAngle),x=S+a*Math.sin(i.ArrowAngle),b=l(d,s,!1,!1),I=l(u,c,!1,!1),A=l(g,f,!1,!1),D=l(h,m,!1,!0),M=l(C,p,!0,!0),k=l(y,v,!0,!0),L=l(F,w,!1,!0),P=l(T,S,!1,!1),O=l(R,x,!1,!1);return[b,I,A,D,M,k,L,P,O,b]}(c,g,u);break;case i.CFIconImage.GrayArrowDownRight:case i.CFIconImage.ColoredArrowDownRight:m=function(e,t,r){var n=i.ArrowWidthRatio*r,o=i.ArrowHeightRatio*r,a=t-r,d=i.ArrowDownRightTipXRatio*r+e,s=i.ArrowDownRightTipYRatio*r+a,u=d,c=s-o,g=u-n,f=c,h=g,m=f+o/2,C=h+o*Math.cos(-3*i.ArrowAngle),p=m+o*Math.sin(-3*i.ArrowAngle),y=C+n*Math.cos(3*i.ArrowAngle),v=p+n*Math.sin(3*i.ArrowAngle),F=y+o*Math.cos(i.ArrowAngle),w=v+o*Math.sin(i.ArrowAngle),T=F-o/2,S=w,R=T,x=S+n,b=l(d,s,!0,!0),I=l(u,c,!0,!0),A=l(g,f,!0,!0),D=l(h,m,!0,!1),M=l(C,p,!1,!1),k=l(y,v,!1,!1),L=l(F,w,!1,!0),P=l(T,S,!0,!0),O=l(R,x,!0,!0);return[b,I,A,D,M,k,L,P,O,b]}(c,g,u);break;case i.CFIconImage.GrayArrowUpRight:case i.CFIconImage.ColoredArrowUpRight:m=function(e,t,r){var n=i.ArrowWidthRatio*r,o=i.ArrowHeightRatio*r,a=t-r,d=i.ArrowUpRightTipXRatio*r+e,s=i.ArrowUpRightTipYRatio*r+a,u=d-o,c=s,g=u,f=c+n,h=g+o/2,m=f,C=h+o*Math.cos(3*i.ArrowAngle),p=m+o*Math.sin(3*i.ArrowAngle),y=C+n*Math.cos(i.ArrowAngle),v=p+n*Math.sin(i.ArrowAngle),F=y+o*Math.cos(-i.ArrowAngle),w=v+o*Math.sin(-i.ArrowAngle),T=F,S=w+o/2,R=T+n,x=S,b=l(d,s,!0,!0),I=l(u,c,!0,!0),A=l(g,f,!0,!0),D=l(h,m,!1,!0),M=l(C,p,!1,!1),k=l(y,v,!1,!1),L=l(F,w,!0,!1),P=l(T,S,!0,!0),O=l(R,x,!0,!0);return[b,I,A,D,M,k,L,P,O,b]}(c,g,u);break;default:throw Error("drawArrows: unsupported image type = "+s)}a.drawIconFromPoints(e,h,f,m)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(22),i=r(44);t.drawCircledSymbols=function(e,t,r,a){n.verifyArgumentNotNull(e,"ctx","drawCircleSymbols"),n.verifyArgumentNotNull(t,"model","drawCircleSymbols"),n.verifyArgumentNotNull(r,"cell","drawCircleSymbols"),n.verifyArgumentNotNull(a,"drawingContext","drawCircleSymbols"),a.size>0&&(o.drawCircleIcon(e,t,r,a),i.drawSymbols(e,t,r,function(e){var t=e.left,r=e.bottom,n=e.image,o=e.highContrastScheme,i=e.size,a=Math.round(t),l=Math.round(r);return{size:Math.round(i),left:a,bottom:l,image:n,highContrastScheme:o}}(a)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(82),o=r(83),i=!1;t.loadPolyFills=function(){i||(n.loadStringRepeat(),o.loadStringTrimRight(),i=!0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(4);t.loadStringRepeat=function(){String.prototype.repeat||(String.prototype.repeat=function(e){if(null==this)throw new TypeError("can't convert "+this+" to object");var t=""+this,r=0;if(n.isNullOrUndefined(e)&&(r=0),e<0)throw new RangeError("repeat count must be non-negative");if(e===1/0)throw new RangeError("repeat count must be less than infinity");if(r=Math.floor(e),0===t.length||0===r)return"";if(t.length*r>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var o=t.length*r;for(r=Math.floor(Math.log(r)/Math.log(2));r;)t+=t,r--;return t+=t.substring(0,o-t.length)})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.loadStringTrimRight=function(){var e=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]*$/;String.prototype.trimRight||(String.prototype.trimRight=function(){return this.replace(e,"")})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(3),o=r(17),i=r(0),a=r(5),l=r(45);function d(e,t,r,o,i,a,l){var d=o.Index,s=o.Min,f=o.Max;if(u(d,s,f,r.renderingRegion,!0)){var h=g(t.RowOffsetsAdjustedForDrawing,d,i,l),m=-1===o.Min?0:c(t.ColOffsetsAdjustedForDrawing,s,i,a),C=-1===o.Max?t.BlockWidth*r.devicePixelRatio:c(t.ColOffsetsAdjustedForDrawing,f,i,a);n.drawLine(e,m,h,C,h)}}function s(e,t,r,o,i,a,l){var d=o.Index,s=o.Min,f=o.Max;if(u(d,s,f,r.renderingRegion,!1)){var h=c(t.ColOffsetsAdjustedForDrawing,d,i,a),m=-1===o.Min?0:g(t.RowOffsetsAdjustedForDrawing,s,i,l),C=-1===o.Max?t.BlockHeight*r.devicePixelRatio:g(t.RowOffsetsAdjustedForDrawing,f,i,l);n.drawLine(e,h,m,h,C)}}function u(e,t,r,n,o){var i,a,l=o?n.startRow:n.startColumn,d=o?n.endRow:n.endColumn;return a=d,l<=(i=e)&&i<=a&&(d=o?n.endColumn:n.endRow,!(-1!==t&&t>d)&&(l=o?n.startColumn:n.startRow,!(-1!==r&&r<l)))}function c(e,t,r,i){return t>=0?o.getAdjustedDrawingOffset(e[t],n.getColWidthFromOffsets(t,e),r,i):0}function g(e,t,r,i){return t>=0?o.getAdjustedDrawingOffset(e[t],n.getRowHeightFromOffsets(t,e),r,i):0}t.drawPageBreaks=function(e,t,r){if(null!=t.PageBreaks){l.setPageLayoutLine(e,r);var n=i.getLinePixelTranslation(a.GridLineWidthPx),u=o.getMaxLineOffset(t.BlockWidth,r.devicePixelRatio,!1),c=o.getMaxLineOffset(t.BlockHeight,r.devicePixelRatio,!0);e.beginPath(),function(e,t,r,n,o,i){var a,l=null===(a=t.PageBreaks)||void 0===a?void 0:a.Row;if(null==l)return;for(var s=0;s<l.length;++s)d(e,t,r,l[s],n,o,i)}(e,t,r,n,u,c),function(e,t,r,n,o,i){var a,l=null===(a=t.PageBreaks)||void 0===a?void 0:a.Col;if(null==l)return;for(var d=0;d<l.length;++d)s(e,t,r,l[d],n,o,i)}(e,t,r,n,u,c),e.stroke()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(17),o=r(5),i=r(0),a=r(45),l=r(3);function d(e,t){return!(e.startRow>t.LastRow)&&(!(e.startColumn>t.LastColumn)&&(!(e.endRow+1<t.FirstRow)&&(!(e.endColumn+1<t.FirstColumn)&&!(e.startRow>t.FirstRow&&e.startColumn>t.FirstColumn&&e.endRow<t.LastRow&&e.endColumn<t.LastColumn))))}function s(e,t,r,o,i,a,d){var s=d.FirstColumn<=0?-1:n.getAdjustedDrawingOffset(t.ColOffsetsAdjustedForDrawing[d.FirstColumn],0,o,a),u=d.FirstRow<=0?-1:n.getAdjustedDrawingOffset(t.RowOffsetsAdjustedForDrawing[d.FirstRow],0,o,i),c=d.LastColumn>=t.ColumnNumbers.length?t.BlockWidth*r.devicePixelRatio+1:n.getAdjustedDrawingOffset(t.ColOffsetsAdjustedForDrawing[d.LastColumn],l.getColWidthFromOffsets(d.LastColumn,t.ColOffsetsAdjustedForDrawing),o,a),g=d.LastRow>=t.RowNumbers.length?t.BlockHeight*r.devicePixelRatio+1:n.getAdjustedDrawingOffset(t.RowOffsetsAdjustedForDrawing[d.LastRow],l.getRowHeightFromOffsets(d.LastRow,t.RowOffsetsAdjustedForDrawing),o,i);e.rect(s,u,c-s,g-u)}t.drawPrintAreas=function(e,t,r){var l;if(function(e){i.verifyArgumentNotNull(e.BlockWidth,"model.BlockWidth","drawPrintAreas"),i.verifyArgumentNotNull(e.BlockHeight,"model.BlockHeight","drawPrintAreas"),i.verifyArgumentNotNull(e.RowNumbers,"model.RowNumbers","drawPrintAreas"),i.verifyArgumentNotNull(e.ColumnNumbers,"model.ColumnNumbers","drawPrintAreas"),i.verifyArgumentNotNull(e.RowOffsetsAdjustedForDrawing,"model.RowOffsetsAdjustedForDrawing","drawPrintAreas"),i.verifyArgumentNotNull(e.ColOffsetsAdjustedForDrawing,"model.ColOffsetsAdjustedForDrawing","drawPrintAreas")}(t),t.PrintAreas){a.setPageLayoutLine(e,r);var u=i.getLinePixelTranslation(o.GridLineWidthPx),c=n.getMaxLineOffset(t.BlockWidth,r.devicePixelRatio,!1),g=n.getMaxLineOffset(t.BlockHeight,r.devicePixelRatio,!0);e.beginPath();for(var f=0;f<(null===(l=t.PrintAreas)||void 0===l?void 0:l.length);f++)d(r.renderingRegion,t.PrintAreas[f])&&s(e,t,r,u,g,c,t.PrintAreas[f]);e.stroke()}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(1),i=r(3),a=r(5),l=r(87),d=r(39),s=r(0),u=r(21),c=r(10),g=r(7);function f(e,t,r){var n=l.EmptyPivotTableImagePlaceholderThicknessPx,o=s.getLinePixelTranslation(n);e.lineWidth=n,e.fillStyle=e.strokeStyle=r?i.rgbToColorHex(r.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.strokeRect(t.x+o,t.y+o,t.width,t.height)}function h(e,t,r,n){var a=r?i.rgbToColorHex(r.TextColor):l.EmptyPivotTableTitleTextColor;e.font=s.getFontCssStringFromFont(t,void 0),e.fillStyle=a,e.textBaseline=g.getTextBaseline(o.VerticalAlignment.Center,n),e.textAlign="center"}function m(e,t,r){var n=C(e,t,r),o=d.getPivotTableLeftAdjustedForDrawing(e,t,!1),i=d.getPivotTableTopAdjustedForDrawing(e,t),a=t.OriginPTWidthAdjustedForDrawing,s=t.OriginPTHeightAdjustedForDrawing,u=n.y+n.height,c=i+s,g=n.width,f=c-u-2*l.EmptyPivotTableImageMinimalPaddingYPx*r,h=Math.min(g,l.EmptyPivotTableImageWidthHeightRatio*f),m=Math.min(f,g/l.EmptyPivotTableImageWidthHeightRatio),p=(u+c)/2;return{x:o+Math.round((a-h)/2),y:Math.round(p-m/2),width:h,height:m}}function C(e,t,r){var n=Math.round(t.OriginPTWidthAdjustedForDrawing*l.EmptyPivotTableTitleContainerWidthRatio);return{x:F(e,t,n),y:y(e,t,r),width:n,height:Math.round(l.EmptyPivotTableTitleContainerHeightPx*r)}}function p(e,t){var r=Math.round(t.OriginPTWidth*l.EmptyPivotTableTitleContainerWidthRatio);return{x:w(e,t,r),y:v(e,t),width:r-l.EmptyPivotTableTitleContainerBorderThicknessPx,height:l.EmptyPivotTableTitleContainerHeightPx-l.EmptyPivotTableTitleContainerBorderThicknessPx}}function y(e,t,r){return d.getPivotTableTopAdjustedForDrawing(e,t)+Math.round(l.EmptyPivotTableTitleContainerTopPaddingPx*r)}function v(e,t){return e.RowOffsets[t.FirstRowIndex]+t.DeltaYFromOriginPT+l.EmptyPivotTableTitleContainerTopPaddingPx+l.EmptyPivotTableTitleContainerBorderThicknessPx}function F(e,t,r){var n=Math.floor((t.OriginPTWidthAdjustedForDrawing-r)/2);return d.getPivotTableLeftAdjustedForDrawing(e,t,!1)+n}function w(e,t,r){var n=(t.OriginPTWidth-r)/2+l.EmptyPivotTableTitleContainerBorderThicknessPx;return function(e,t){var r=e.ColumnOffsets;return e.IsRtl?e.BlockWidth-t.DeltaXFromOriginPT-r[t.FirstColIndex]-t.OriginPTWidth:r[t.FirstColIndex]+t.DeltaXFromOriginPT}(e,t)+n}t.drawEmptyPivotTableTitleContainers=function(e,t,r){if(n.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleContainers"),n.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleContainers"),n.verifyArgumentNotNull(r,"context","drawEmptyPivotTableTitleContainers"),t.PivotTables&&0!==t.PivotTables.length){for(var o=Math.max(Math.round(l.EmptyPivotTableTitleContainerBorderThicknessPx*r.devicePixelRatio),1),u=s.getLinePixelTranslation(o),c=!1,g=0;g<t.PivotTables.length;g++){var f=t.PivotTables[g];if(f.IsEmptyPivot&&(!(f.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)&&d.isPivotIntersectsRenderingRegion(f,r.renderingRegion))){c||(e.strokeStyle=r.highContrastScheme?i.rgbToColorHex(r.highContrastScheme.TextColor):l.EmptyPivotTableTitleContainerBorderColor,e.lineWidth=o,e.setLineDash(a.DefaultDash),e.beginPath(),c=!0);var h=C(t,f,r.devicePixelRatio);e.rect(u+h.x,u+h.y,h.width,h.height)}}c&&e.stroke()}},t.drawEmptyPivotTableImages=function(e,t,r){if(n.verifyArgumentNotNull(t,"model","drawEmptyPivotTableImages"),n.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableImages"),n.verifyArgumentNotNull(r,"context","drawEmptyPivotTableImages"),t.PivotTables&&0!==t.PivotTables.length)for(var o=0;o<t.PivotTables.length;o++){var i=t.PivotTables[o];if(i.IsEmptyPivot&&(!(i.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingImage)&&d.isPivotIntersectsRenderingRegion(i,r.renderingRegion))){var a=m(t,i,r.devicePixelRatio);if(!(a.width<l.EmptyPivotTableMinimalImageWidthPx)){var s=u.getOrLoadStaticImage(0,r.blockIdentifier);s?e.drawImage(s,a.x,a.y,a.width,a.height):f(e,a,r.highContrastScheme)}}}},t.drawEmptyPivotTableTitleText=function(e,t,r){if(n.verifyArgumentNotNull(t,"model","drawEmptyPivotTableTitleText"),n.verifyArgumentNotNull(e,"ctx","drawEmptyPivotTableTitleText"),n.verifyArgumentNotNull(r,"context","drawEmptyPivotTableTitleText"),t.PivotTables&&0!==t.PivotTables.length)for(var a=!1,s=void 0,u=n.isRenderFlagEnabled(o.RenderFlags.TextBaselineRefactor,t),f=0;f<t.PivotTables.length;f++){var m=t.PivotTables[f];if(m.IsEmptyPivot&&(!(m.OriginPTHeight<l.EmptyPivotTableMinimalHeightForDrawingTitle)&&d.isPivotIntersectsRenderingRegion(m,r.renderingRegion)&&m.PivotTableName)){if(!a){var C=c.getReferencedObjectById(o.UniqueStyleID.Default,t.Styles);h(e,s=c.getReferencedObjectById(C.FontID,t.Fonts),r.highContrastScheme,u),a=!0}var y=p(t,m),v=y.x+y.width/2,F=g.getTextOffsetYAlphabeticBaseline(y.y+y.height,y.height,s.Size,s.FontName,o.VerticalAlignment.Center,u);i.applyClipping(e,y),e.fillText(m.PivotTableName,v,F),i.restoreClipping(e,y)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.EmptyPivotTableTitleContainerBorderColor="#969696",t.EmptyPivotTableTitleTextColor="#969696",t.EmptyPivotTableTitleContainerBorderThicknessPx=2,t.EmptyPivotTableImagePlaceholderThicknessPx=1,t.EmptyPivotTableTitleContainerTopPaddingPx=32,t.EmptyPivotTableTitleContainerHeightPx=19,t.EmptyPivotTableMinimalHeightForDrawingTitle=t.EmptyPivotTableTitleContainerTopPaddingPx+t.EmptyPivotTableTitleContainerHeightPx,t.EmptyPivotTableTitleContainerWidthRatio=.75,t.EmptyPivotTableImageMinimalPaddingYPx=24,t.EmptyPivotTableMinimalHeightForDrawingImage=t.EmptyPivotTableMinimalHeightForDrawingTitle+t.EmptyPivotTableTitleContainerHeightPx+t.EmptyPivotTableImageMinimalPaddingYPx,t.EmptyPivotTableMinimalImageWidthPx=80,t.EmptyPivotTableImageWidthHeightRatio=184/164},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=r(2),i=r(6),a=r(3),l=r(89),d=r(5),s=r(0),u=r(4);function c(e,t,r){return function(e,t,r){if(e<0||e>t)throw Error("adjustCellCoordinateIfRtl: coordinate is outside of the data bar bounds.");return r?t-e:e}(Math.round(t*e/100),t,r)}function g(e,t,r,n){if(function(e){return e>0&&e<100}(e))return{X:t+r-s.getLinePixelTranslation(d.GridLineWidthPx),startY:n.y+d.GridLineWidthPx,endY:n.y+n.height-d.GridLineWidthPx}}function f(e,t,r,n){var o=Math.round(t.width*e/100);n&&(o=-o);var i=Math.min(r,r+o),a=t.x+i,d=Math.max(Math.abs(o)-l.DataBarAxisWidth,0);return{x:a,y:t.y,width:d,height:t.height}}function h(e){return e.information.GradientColor?e.information.GradientColor:e.information.Color}function m(e){return{x:e.x+l.DataBarHorizontalPadding+d.GridLineWidthPx,y:e.y+l.DataBarHorizontalPadding+d.GridLineWidthPx,width:e.width-2*l.DataBarHorizontalPadding-2*d.GridLineWidthPx,height:e.height-l.DataBarTopPadding-l.DataBarBottomPadding-2*d.GridLineWidthPx}}t.drawDataBars=function(e,t,r){o.verifyArgumentNotNull(t,"model","drawDataBars"),o.verifyArgumentNotNull(e,"ctx","drawDataBars"),o.verifyArgumentNotNull(r,"context","drawDataBars"),o.verifyArgumentNotNull(t.Cells,"model.Cells","drawDataBars");var d=function(e,t){for(var r,o=e.Cells,l=[],d=0;d<o.length;d++){var s=o[d];if(a.cellIntersectsRenderingRegion(s,t.renderingRegion)){var u=null===(r=s.CondFormat)||void 0===r?void 0:r.DataBar;if(u){var h=u.Direction===n.ReadingOrderType.RightToLeft||e.IsRtl&&u.Direction===n.ReadingOrderType.Context,C=i.getCellDimensionsAdjustedForDrawing(e,s,!1),p=m(C),y=c(u.AxisPostion,p.width,h),v=g(u.AxisPostion,p.x,y,C),F=f(u.Length,p,y,h);l.push({information:u,axis:v,bar:F})}}}return l}(t,r);!function(e,t,r){for(var o,i=!1,d=0;d<t.length;d++){var s=t[d].axis;if(!u.isNullOrUndefined(s)){if(i||(e.setLineDash(l.DataBarAxisLineDash),e.lineWidth=n.BorderLineType.Thin,e.beginPath(),i=!0,u.isNullOrUndefined(r)||(e.strokeStyle=""+a.rgbToColorHex(r.TextColor))),u.isNullOrUndefined(r)){var c=t[d].information.AxisColor;o!==c&&(e.stroke(),e.beginPath(),e.strokeStyle=c,o=c)}a.drawLine(e,s.X,s.startY,s.X,s.endY)}}i&&e.stroke()}(e,d,r.highContrastScheme),u.isNullOrUndefined(r.highContrastScheme)&&function(e,t){for(var r,n=0;n<t.length;n++){var o=t[n],i=o.bar,a=h(o);r!==a&&(e.fillStyle=a,r=a),e.fillRect(i.x,i.y,i.width,i.height)}}(e,d)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DataBarHorizontalPadding=1,t.DataBarTopPadding=1,t.DataBarBottomPadding=2,t.DataBarAxisWidth=1,t.DataBarAxisLineDash=[3,1]},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(3),i=r(21),a=r(6);function l(e,t,r,n){var o=r.Sparkline.ClusterOffsetX,i=r.Sparkline.ClusterOffsetY,l=a.getCellWidth(t,r,!1),d=a.getCellHeight(t,r,!1),s=a.getCellLeftAdjustedForDrawing(t,r,!1),u=a.getCellTopAdjustedForDrawing(t,r),c=a.getCellWidthAdjustedForDrawing(t,r),g=a.getCellHeightAdjustedForDrawing(t,r);e.drawImage(n,o,i,l,d,s,u,c,g)}t.drawSparklines=function(e,t,r){var a;if(n.verifyArgumentNotNull(e,"ctx","drawSparklines"),n.verifyArgumentNotNull(t,"model","drawSparklines"),n.verifyArgumentNotNull(r,"context","drawSparklines"),t.Sparklines){var d=t.Cells,s=i.getOrLoadVersionedImage(i.ImageType.Sparkline,t.Sparklines.Version,t.Sparklines.ImageUrl,r.blockIdentifier,r.blockIdentifier);if(s)for(var u=0;u<d.length;u++){var c=d[u];(null===(a=c)||void 0===a?void 0:a.Sparkline)&&(o.cellIntersectsRenderingRegion(c,r.renderingRegion)&&l(e,t,c,s))}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0),o=r(1),i=r(10),a=r(42),l=r(2),d=r(92),s=r(4),u=r(20),c=r(26),g=r(6),f=r(33),h=r(21),m=function(){function e(t){this.canvasInstance=null,e.verifyArgumentNotNull(t,"model","constructor"),this.model=t}return e.prototype.getOrCreateCanvasContext=function(){this.canvasInstance||(this.canvasInstance=document.createElement("canvas"));var e=this.canvasInstance.getContext("2d");if(!e)throw Error("GetOrCreateCanvasContext: ctx is undefined");return e},e.prototype.getCell=function(e,t){return n.getCell(e,t,this.model)},e.prototype.getOrCreateCell=function(t,r){var o=this.getCell(t,r);return o||(e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getOrCreateCell"),e.verifyArgumentNotNull(this.model.Styles,"Styles","getOrCreateCell"),(t<0||r<0||t>=this.model.RowNumbers.length||r>=this.model.ColumnNumbers.length)&&this.throwErrorWrapper("cell requested for a cell which is not in range of the model. rowIndex:  "+t+", RowNumbers.length: "+this.model.RowNumbers.length+",  colIndex:  "+r+", ColumnNumbers.length: "+this.model.ColumnNumbers.length,"getOrCreateCell"),n.getDefaultCell(t,r,this.model.Styles,this.model.Fonts))},e.prototype.getColumnWidth=function(e){return n.getColumnWidth(e,this.model)},e.prototype.getRowHeight=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowHeight"),e.verifyArgumentNotNull(this.model.RowHeights,"RowHeights","getRowHeight"),(t>this.model.RowHeights.length-1||t<0)&&this.throwErrorWrapper("row height requested for a cell which is not in range of the model","getRowHeight"),this.model.RowHeights[t]},e.prototype.getColumnOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnOffset"),e.verifyArgumentNotNull(this.model.ColumnOffsets,"ColumnOffsets","getColumnOffset"),(t>this.model.ColumnOffsets.length-1||t<0)&&this.throwErrorWrapper("column offset requested for a cell which is not in range of the model","getColumnOffset"),this.model.ColumnOffsets[t]},e.prototype.getRowOffset=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowOffset"),e.verifyArgumentNotNull(this.model.RowOffsets,"RowOffsets","getRowOffset"),(t>this.model.RowOffsets.length-1||t<0)&&this.throwErrorWrapper("row offset requested for a cell which is not in range of the model","getRowOffset"),this.model.RowOffsets[t]},e.prototype.getRowNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getRowNumber"),e.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowNumber"),this.model.RowNumbers[t]},e.prototype.getColumnNumber=function(t){return e.verifyArgumentNotNull(this.model,"model","getColumnNumber"),e.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnNumber"),this.model.ColumnNumbers[t]},e.prototype.getCellStyle=function(e){return n.getCellStyle(e,this.model)},e.prototype.getCellFont=function(e){return n.getCellFont(e,this.model)},e.prototype.hasRichText=function(t){var r;return e.verifyArgumentNotNull(t,"cell","hasRichText"),!s.isNullOrUndefined(null===(r=t)||void 0===r?void 0:r.TextRuns)},e.prototype.cloneCellFont=function(e){var t=n.getCellFont(e,this.model);return t?this.duplicateFont(t,t.ID,t.RefCount):t},e.prototype.getBorderStyle=function(t){return e.verifyArgumentNotNull(t,"cell","getBorderStyle"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","getBorderStyle"),s.isNullOrUndefined(t.CachedBorderStyle)&&(t.CachedBorderStyle=i.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)),t.CachedBorderStyle},e.prototype.removeBorder=function(t){e.verifyArgumentNotNull(t,"cell","removeBorder"),e.verifyArgumentNotNull(this.model.BorderStyles,"this.model.BorderStyles","removeBorder"),t.BorderStyleID=o.UniqueStyleID.DefaultBorder,t.CachedBorderStyle=i.getReferencedObjectById(t.BorderStyleID,this.model.BorderStyles)},e.prototype.getNumberOfBlockColumns=function(){return this.model.ColumnNumbers.length},e.prototype.isRtl=function(){return this.model.IsRtl},e.prototype.replaceCellInModel=function(t,r){e.verifyArgumentNotNull(t,"cell","replaceCellInModel"),e.verifyArgumentNotNull(r,"immediateModel","replaceCellInModel"),e.verifyArgumentNotNull(r.Styles,"immediateModel!.Styles","replaceCellInModel");var i=r.Styles[0];if(e.verifyArgumentNotNull(i,"style","replaceCellInModel"),e.verifyArgumentNotNull(r.Fonts,"immediateModel!.Fonts","replaceCellInModel"),l.isRenderFlagEnabled(o.RenderFlags.FixImmediateSetRichTextCell,this.model)){var a=this.duplicateAndSetFontsInModel(r.Fonts);t.TextRuns&&(t.TextRuns=this.duplicateTextRuns(t.TextRuns,a)),i.FontID=a[i.FontID],t.CachedFont=this.model.Fonts[i.FontID]}else{var d=r.Fonts[0];e.verifyArgumentNotNull(d,"font","replaceCellInModel");var u=this.getLastFontID()+1;d.ID=u,this.model.Fonts.splice(u,0,d),i.FontID=u,t.CachedFont=d,d.RefCount=1}var c=this.getLastNonUniqueStyleID()+1;if(i.ID=c,this.model.Styles.splice(c,0,i),t.StyleID=c,t.CachedStyle=i,!s.isNullOrUndefined(r.BorderStyles)){var g=r.BorderStyles[0];!s.isNullOrUndefined(g)&&!s.isNullOrUndefined(g.Borders)&&g.Borders.length>0&&(g.RefCount=1,this.setBorders(t,g))}if(this.getCell(t.Row,t.Col)){var f=n.getCellPositionInArray(t,this.model.Cells);this.model.Cells[f]=t,this.model.CellLookup[l.cellLookupKey(t.Row,t.Col)]=t}else this.attachCellToModel(t);i.RefCount=1},e.prototype.attachCellToModel=function(t){if(e.verifyArgumentNotNull(t,"cell","attachCellToModel"),e.verifyArgumentNotNull(this.model.Cells,"this.model.Cells","attachCellToModel"),!this.getCell(t.Row,t.Col)){var r=n.getCellPositionInArray(t,this.model.Cells);this.model.Cells.splice(r,0,t),this.model.CellLookup[l.cellLookupKey(t.Row,t.Col)]=t;var o=this.getCellStyle(t);e.verifyArgumentNotNull(o,"style","attachCellToModel"),o.RefCount++;var i=this.getBorderStyle(t);e.verifyArgumentNotNull(i,"borderStyle","attachCellToModel"),i.RefCount++,t.CachedBorderStyle=i}},e.prototype.prepareCellStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareCellStyleForEdit");var r=this.getCellStyle(t);if(!this.isStyleUnique(r.ID)&&r.RefCount<=1)return!0;var n=this.getLastNonUniqueStyleID()+1,o=this.duplicateStyle(r,n,1);return r.RefCount=Math.max(0,r.RefCount-1),this.model.Styles.splice(n,0,o),t.CachedStyle=o,t.StyleID=n,!1},e.prototype.setDefaultHyperlinkStyleOnCell=function(t){e.verifyArgumentNotNull(t,"cell","setDefaultHyperlinkStyleOnCell");var r=i.getReferencedObjectById(o.UniqueStyleID.Hyperlink,this.model.Styles);r||this.throwErrorWrapper("default hyperlink style is not present in the model.","setDefaultHyperlinkStyleOnCell"),t.StyleID=o.UniqueStyleID.Hyperlink,t.CachedStyle=r,r.RefCount+=1},e.prototype.editCellFontAttributes=function(t,r){if(e.verifyArgumentNotNull(t,"cell","editFont"),e.verifyArgumentNotNull(t,"editFontAction","editFont"),this.attachCellToModel(t),this.prepareFontForEdit(t),l.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,this.model)&&t.TextRuns)for(var n=0;n<t.TextRuns.length;n++){var a=t.TextRuns[n];s.isNullOrUndefined(a.CachedFont)&&(a.CachedFont=i.getReferencedObjectById(a.FontID,this.model.Fonts)),r(a.CachedFont)}r(t.CachedFont)},e.prototype.prepareFontForEdit=function(e){var t;if(l.isRenderFlagEnabled(o.RenderFlags.RichTextFormat,this.model)&&(null===(t=e)||void 0===t?void 0:t.TextRuns))for(var r=0;r<e.TextRuns.length;r++){var n=e.TextRuns[r],a=s.isNullOrUndefined(n.CachedFont)?i.getReferencedObjectById(n.FontID,this.model.Fonts):n.CachedFont;this.prepareTextRunFontForEdit(a,n)}this.prepareCellFontForEdit(e)},e.prototype.prepareTextRunFontForEdit=function(e,t){e.RefCount<=1||this.duplicateAndSetNewFontOnTextRun(e,t)},e.prototype.prepareCellFontForEdit=function(e){var t=this.getCellFont(e);this.prepareCellStyleForEdit(e)&&t.RefCount<=1||this.duplicateAndSetNewFontOnCell(t,e)},e.prototype.prepareBorderStyleForEdit=function(t){e.verifyArgumentNotNull(t,"cell","prepareBorderStyleForEdit");var r=this.getBorderStyle(t);if(!(r.ID!==o.UniqueStyleID.DefaultBorder&&r.RefCount<=1)){var n=this.duplicateBorderStyle(r,0,1);this.setBorders(t,n)}},e.prototype.cloneBorderStyle=function(t){e.verifyArgumentNotNull(t,"cell","cloneBorderStyle");var r=this.getBorderStyle(t);return this.duplicateBorderStyle(r,r.ID,1)},e.prototype.setBorders=function(t,r){e.verifyArgumentNotNull(t,"cell","setBorders"),e.verifyArgumentNotNull(r,"BorderStyle","setBorders");var n=this.getBorderStyle(t),o=this.getLastBorderStyleID()+1;r.ID=o,n.RefCount=Math.max(0,n.RefCount-1),this.model.BorderStyles.splice(o,0,r),t.BorderStyleID=o,t.CachedBorderStyle=r},e.prototype.getCellCssFont=function(e){return this.verifyCellStyleAndFont(e,"getCellCssFont"),n.getFontCssStringFromCell(e)},e.prototype.isDirty=function(){return!!this.model.IsDirty&&this.model.IsDirty},e.prototype.setDirty=function(){this.model.IsDirty||(this.model.DirtyTimestamp=Date.now()),this.model.IsDirty=!0},e.prototype.getCalcBlockModel=function(){var e=new d.CalcBlockModel,t=this.model.RowNumbers.slice(),r=this.model.ColumnNumbers.slice();e.addHeaders(t,r);for(var n=0;n<this.model.Cells.length;n++){var o=this.model.Cells[n],i=e.createCell(o);e.addCell(i)}return e},e.prototype.getDirtyTimestamp=function(){return this.model.DirtyTimestamp?this.model.DirtyTimestamp:-1},e.prototype.updateCellSpillInformation=function(e){var t,r,n,i;if(this.verifyCellStyleAndFont(e,"updateCellSpillInformation"),s.isNullOrUndefined(null===(r=null===(t=e)||void 0===t?void 0:t.CachedDrawingLayout)||void 0===r?void 0:r.CellTextLayout)||(e.CachedDrawingLayout.CellTextLayout={}),!(e.Merge||l.isRenderFlagEnabled(o.RenderFlags.AdvHorizontalAlignmentFillAndCAS,this.model)&&(null===(i=null===(n=e)||void 0===n?void 0:n.CachedStyle)||void 0===i?void 0:i.HorizontalAlignment)===o.HorizontalAlignment.CenterAcrossSelection)){e.Spill=void 0;var d=null;l.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,this.model)&&(d=this.getOrCreateCanvasContext(),this.setContextCellFont(d,e)),a.updateCellSpill(d,this.model,e)}},e.prototype.updateClosestNonEmptyCellsSpillInformation=function(t){e.verifyArgumentNotNull(t,"cell","updateClosestNonEmptyCellsSpillInformation");var r=null;l.isRenderFlagEnabled(o.RenderFlags.MeasureTextRefactor,this.model)&&(r=this.getOrCreateCanvasContext(),this.setContextCellFont(r,t)),a.updateClosestNonEmptyCellsSpill(r,t,this.model)},e.prototype.getUserInput=function(t){return e.verifyArgumentNotNull(t,"cell","getUserInput"),t.UserInput},e.prototype.setUserInput=function(t,r){e.verifyArgumentNotNull(t,"cell","setUserInput"),e.verifyArgumentNotNull(r,"userInput","setUserInput"),t.UserInput=r},e.prototype.clearCellFormat=function(e){var t=i.getReferencedObjectById(o.UniqueStyleID.Default,this.model.Styles);e.StyleID=o.UniqueStyleID.Default,e.CachedStyle=t,e.CachedFont=i.getReferencedObjectById(t.FontID,this.model.Fonts),e.BorderStyleID=o.UniqueStyleID.DefaultBorder,e.CachedBorderStyle=i.getReferencedObjectById(o.UniqueStyleID.DefaultBorder,this.model.BorderStyles)},e.prototype.getRowIndex=function(e){return n.verifyArgumentNotNull(this.model,"model","getRowIndex"),n.verifyArgumentNotNull(this.model.RowNumbers,"RowNumbers","getRowIndex"),n.binarySearch(this.model.RowNumbers,0,this.model.RowNumbers.length,e,n.numbersComparer)},e.prototype.getColumnIndex=function(e){return n.verifyArgumentNotNull(this.model,"model","getColumnIndex"),n.verifyArgumentNotNull(this.model.ColumnNumbers,"ColumnNumbers","getColumnIndex"),n.binarySearch(this.model.ColumnNumbers,0,this.model.ColumnNumbers.length,e,n.numbersComparer)},e.prototype.getCellWidth=function(e){return n.verifyArgumentNotNull(this.model,"model","getCellWidth"),n.verifyArgumentNotNull(e,"cell","getCellWidth"),g.getCellWidth(this.model,e,!0)},e.prototype.getCellHeight=function(e){return n.verifyArgumentNotNull(this.model,"model","getCellHeight"),n.verifyArgumentNotNull(e,"cell","getCellHeight"),g.getCellHeight(this.model,e,!0)},e.prototype.getFormattedText=function(t){var r=this;e.verifyArgumentNotNull(t,"cell","getFormattedText"),e.verifyArgumentNotNull(this.model.Fonts,"this.model.Fonts","getFormattedText");var n=new Set,o=[];if(t.TextRuns)t.TextRuns.forEach((function(e){n.add(e.FontID),o.push(r.duplicateTextRun(e))}));else{var i=t.CachedStyle?t.CachedStyle:this.getCellStyle(t),a={FontID:i.FontID,StartIndex:0};n.add(i.FontID),o.push(a)}var l=[];return n.forEach((function(e){if(e<r.model.Fonts.length){var t=r.model.Fonts[e];l[e]=r.duplicateFont(t,t.ID,t.RefCount)}else r.throwErrorWrapper("Font "+e+" does not exist","getFormattedText")})),{Text:t.Text||"",TextRuns:o,Fonts:l}},e.prototype.setFormattedText=function(t,r){if(e.verifyArgumentNotNull(t,"cell","setFormattedText"),e.verifyArgumentNotNull(r,"formattedText","setFormattedText"),e.verifyArgumentNotNull(r.TextRuns,"formattedText.TextRuns","setFormattedText"),e.verifyArgumentNotNull(r.Fonts,"formattedText.Fonts","setFormattedText"),this.attachCellToModel(t),l.isRenderFlagEnabled(o.RenderFlags.FixImmediateSetRichTextCell,this.model)){t.Text=r.Text;var n=this.duplicateAndSetFontsInModel(r.Fonts);t.TextRuns=this.duplicateTextRuns(r.TextRuns,n)}else{t.TextRuns=[];for(var a=0;a<r.TextRuns.length;a++){var d=r.TextRuns[a];t.TextRuns[a]=this.duplicateTextRun(d);var s=i.getReferencedObjectById(d.FontID,r.Fonts);this.duplicateAndSetNewFontOnTextRun(s,t.TextRuns[a])}}},e.prototype.serializeCell=function(e){return u.serializeCell(e,this.model)},e.prototype.getOutlineState=function(e,t){var r=e?this.model.RowOutlines:this.model.ColumnOutlines;return r?r[t]:o.OutlineState.None},e.prototype.compareCells=function(e,t,r){return c.areCellsEqual(e,t,r,this.model)},e.prototype.updateNumFmt=function(t){e.verifyArgumentNotNull(t,"cell","updateNumFmt"),l.isAccAndCustomNumFmtApplicable(t,this.model)?f.updateNumFmtFromCell(t):t.NumFmt=void 0},e.prototype.updateCellText=function(t,r){e.verifyArgumentNotNull(t,"cell","updateCellText"),e.verifyArgumentNotNull(r,"text","updateCellText"),n.updateCellText(this.model,t,r)},e.prototype.hasPageLayout=function(){return null!=this.model.PageBreaks||null!=this.model.PrintAreas},e.prototype.getPivotTableRanges=function(){return this.duplicatePivotTableRangeInformations(this.model.PivotTables)},e.prototype.getSparklineRanges=function(){var e;return this.duplicateSparklineRangeInformations(null===(e=this.model.Sparklines)||void 0===e?void 0:e.Ranges)},e.prototype.getSparklinesUrl=function(){var e,t;return null!=(t=null===(e=this.model.Sparklines)||void 0===e?void 0:e.ImageUrl)?t:""},e.prototype.disposeBlock=function(e){s.isNullOrUndefined(e)||""===e||h.clearImageFromCache(h.ImageType.Sparkline,e)},e.prototype.isStyleUnique=function(e){return e===o.UniqueStyleID.Default||e===o.UniqueStyleID.Hyperlink},e.prototype.getLastNonUniqueStyleID=function(){return this.model.Styles.length-2-1},e.prototype.getLastFontID=function(){return this.model.Fonts.length-1},e.prototype.getLastBorderStyleID=function(){return this.model.BorderStyles.length-1},e.prototype.duplicateStyle=function(e,t,r){var n={BackgroundColor:e.BackgroundColor,HorizontalAlignment:e.HorizontalAlignment,ID:t,NamedStyleId:e.NamedStyleId,RefCount:r,VerticalAlignment:e.VerticalAlignment,Indentation:e.Indentation,IsUnlocked:e.IsUnlocked,IsHidden:e.IsHidden,ReadingOrder:e.ReadingOrder,FontID:e.FontID,ShrinkToFit:e.ShrinkToFit,Gradient:e.Gradient};this.model.Fonts&&i.getReferencedObjectById(e.FontID,this.model.Fonts).RefCount++;return n},e.prototype.duplicateBorderStyle=function(e,t,r){for(var n=[],o=0;o<e.Borders.length;o++){var i=e.Borders[o],a={BorderLineStyle:i.BorderLineStyle,BorderPosition:i.BorderPosition,Weight:i.Weight,Color:{Red:i.Color.Red,Blue:i.Color.Blue,Green:i.Color.Green}};n.push(a)}return{Borders:n,ID:t,RefCount:r}},e.prototype.duplicateFont=function(e,t,r){return{Bold:e.Bold,Color:e.Color,FontName:e.FontName,ID:t,Italic:e.Italic,RefCount:r,Size:e.Size,StrikeThrough:e.StrikeThrough,Underline:e.Underline,VerticalAlign:e.VerticalAlign}},e.prototype.duplicateTextRun=function(e,t){return{FontID:null!=t?t:e.FontID,StartIndex:e.StartIndex,CachedFont:e.CachedFont}},e.prototype.duplicateAndSetNewFontOnTextRun=function(e,t){var r=this.duplicateAndSetNewFontInModel(e,!1);t.FontID=r.newFontId,t.CachedFont=r.newFont},e.prototype.duplicateAndSetNewFontOnCell=function(e,t){var r=this.duplicateAndSetNewFontInModel(e,!1),n=r.newFontId,o=r.newFont;t.CachedFont=o,t.CachedStyle.FontID=n},e.prototype.duplicateAndSetFontsInModel=function(e){for(var t=[],r=0;r<e.length;r++){var n=e[r],o=this.duplicateAndSetNewFontInModel(n,!0).newFontId;t[n.ID]=o}return t},e.prototype.duplicateTextRuns=function(e,t){for(var r=[],n=0;n<e.length;n++){var o=e[n];r[n]=this.duplicateTextRun(o,t[o.FontID])}return r},e.prototype.duplicatePivotTableRangeInformations=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicatePivotTableRangeInformation(e[r]));return t}},e.prototype.duplicatePivotTableRangeInformation=function(e){return{AltText:e.AltText,AltTextSummary:e.AltTextSummary,AutoFormatOnUpdate:e.AutoFormatOnUpdate,ColGrandTotalOn:e.ColGrandTotalOn,ColumnAreaFields:this.duplicatePivotTableFieldInfos(e.ColumnAreaFields),ColumnHeaderRange:this.duplicateRangeInformation(e.ColumnHeaderRange),ColumnMemberPropIndexes:e.ColumnMemberPropIndexes,ColumnTotalIndexes:e.ColumnTotalIndexes,ConfirmationRequiredForDataOps:e.ConfirmationRequiredForDataOps,ConnectionName:e.ConnectionName,CurrentStyleName:e.CurrentStyleName,DataPivotFieldCaption:e.DataPivotFieldCaption,DataPivotFieldIndex:e.DataPivotFieldIndex,DataSource:e.DataSource,DeltaXFromOriginPT:e.DeltaXFromOriginPT,DeltaXFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DeltaYFromOriginPT:e.DeltaYFromOriginPT,DeltaYFromOriginPTAdjustedForDrawing:e.DeltaYFromOriginPTAdjustedForDrawing,DisplayErrorString:e.DisplayErrorString,DisplayNullString:e.DisplayNullString,ErrorString:e.ErrorString,ExternalSourceIndex:e.ExternalSourceIndex,FieldListVersion:e.FieldListVersion,FieldWellVersion:e.FieldWellVersion,FirstColIndex:e.FirstColIndex,FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,FirstRowIndex:e.FirstRowIndex,HasActiveFilter:e.HasActiveFilter,HideGridLines:e.HideGridLines,IndentIncrement:e.IndentIncrement,IsActionable:e.IsActionable,IsEmptyPivot:e.IsEmptyPivot,IsOlap:e.IsOlap,IsPageArea:e.IsPageArea,LastColIndex:e.LastRowIndex,LastColumn:e.LastColumn,LastRow:e.LastRow,LastRowIndex:e.LastRowIndex,NullString:e.NullString,OriginPTHeight:e.OriginPTHeight,OriginPTHeightAdjustedForDrawing:e.OriginPTHeightAdjustedForDrawing,OriginPTWidth:e.OriginPTWidth,OriginPTWidthAdjustedForDrawing:e.OriginPTWidthAdjustedForDrawing,PageAreaFields:this.duplicatePivotTableFieldInfos(e.PageAreaFields),PivotTableName:e.PivotTableName,RangeType:e.RangeType,RefreshOnLoad:e.RefreshOnLoad,RowAreaCaptions:e.RowAreaCaptions,RowAreaFields:this.duplicatePivotTableFieldInfos(e.RowAreaFields),RowHeaderRange:this.duplicateRangeInformation(e.RowHeaderRange),RowLocation:e.RowLocation,RowMemberPropIndexes:e.RowMemberPropIndexes,RowTotalIndexes:e.RowTotalIndexes,RwGrandTotalOn:e.RwGrandTotalOn,SaveSourceDataWithFile:e.SaveSourceDataWithFile,ShowColumnHeaders:e.ShowColumnHeaders,ShowColumnStripes:e.ShowColumnStripes,ShowDrillIndicators:e.ShowDrillIndicators,ShowItemsWithNoDataOnCol:e.ShowItemsWithNoDataOnCol,ShowItemsWithNoDataOnRw:e.ShowItemsWithNoDataOnRw,ShowRowHeaders:e.ShowRowHeaders,ShowRowStripes:e.ShowRowStripes,SupportsBIExplore:e.SupportsBIExplore,ValueAreaFields:this.duplicatePivotTableFieldInfos(e.ValueAreaFields),Xluid:e.Xluid}},e.prototype.duplicateRangeInformation=function(e){if(e)return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,RangeType:e.RangeType}},e.prototype.duplicatePivotTableFieldInfos=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicatePivotTableFieldInfo(e[r]));return t}},e.prototype.duplicatePivotTableFieldInfo=function(e){return{BaseFieldIndex:e.BaseFieldIndex,Caption:e.Caption,DataFieldAggregationType:e.DataFieldAggregationType,DataFieldFormatType:e.DataFieldFormatType,Index:e.Index,IsCompactLayout:e.IsCompactLayout,RepeatItemLabels:e.RepeatItemLabels,ShowBlankLineAfterEachItem:e.ShowBlankLineAfterEachItem,ShowItemsWithNoData:e.ShowItemsWithNoData,ShowSubtotal:e.ShowSubtotal,ShowSubtotalAtTop:e.ShowSubtotalAtTop}},e.prototype.duplicateAndSetNewFontInModel=function(e,t){var r=this.model.Fonts.length,n=t?e.RefCount:1,o=this.duplicateFont(e,r,n);return t||(e.RefCount=Math.max(0,e.RefCount-1)),this.model.Fonts.splice(r,0,o),{newFontId:r,newFont:o}},e.prototype.throwErrorWrapper=function(e,t){n.throwError(e,"GridBlockModelAccessor."+t)},e.verifyArgumentNotNull=function(e,t,r){n.verifyArgumentNotNull(e,t,"GridBlockModelAccessor."+r)},e.prototype.duplicateSparklineRangeInformations=function(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(this.duplicateSparklineRangeInformation(e[r]));return t}},e.prototype.duplicateSparklineRangeInformation=function(e){return{FirstColumn:e.FirstColumn,FirstRow:e.FirstRow,LastColumn:e.LastColumn,LastRow:e.LastRow,LocationColumn:e.LocationColumn,LocationRow:e.LocationRow,RangeType:e.RangeType,SparklineType:e.SparklineType}},e.prototype.verifyCellStyleAndFont=function(e,t){n.verifyArgumentNotNull(e,"cell",t),e.CachedStyle||n.getCellStyle(e,this.model),e.CachedFont||n.getCellFont(e,this.model)},e.prototype.setContextCellFont=function(e,t){e.font=n.getFontCssStringFromCell(t)},e}();t.GridBlockModelAccessor=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(2),o=r(4),i=r(1),a=function(){function e(){this.RowNumbers=[],this.ColumnNumbers=[],this.Cells={},this.index=-1,this.keys=null}return e.prototype.createCell=function(e){var t,r={col:e.Col,row:e.Row,text:e.Text,formula:null===(t=e.FormulaInfo)||void 0===t?void 0:t.Formula,value:e.Value,ifmt:e.Ifmt,formulaType:e.FormulaInfo?e.FormulaInfo.FormulaType:i.CellFormulaType.Value};return r.valueType=e.ValueType,r},e.prototype.addCell=function(e){if(-1!==this.index)throw"cannot add cell after iterating cells";this.Cells[n.cellLookupKey(e.row,e.col)]=e,this.keys=null},e.prototype.addHeaders=function(e,t){this.RowNumbers=e,this.ColumnNumbers=t},e.prototype.getRowNumbers=function(){return this.RowNumbers},e.prototype.getColumnNumbers=function(){return this.ColumnNumbers},e.prototype.getCell=function(e,t){return o.isNullOrUndefined(this.Cells)?null:this.Cells[n.cellLookupKey(e,t)]},e.prototype.reset=function(){this.index=0,o.isNullOrUndefined(this.keys)&&(this.keys=Object.keys(this.Cells))},e.prototype.getNextCell=function(){if(o.isNullOrUndefined(this.Cells)||o.isNullOrUndefined(this.keys))return null;if(-1===this.index)return null;if(this.index>=this.keys.length)return null;var e=this.Cells[this.keys[this.index]];return this.index++,e},e}();t.CalcBlockModel=a}]);
//# sourceMappingURL=gridRenderer.min.js.map