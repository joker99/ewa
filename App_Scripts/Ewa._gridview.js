var $$t_0;Type.registerNamespace("_Ewa");_Ewa.rl=function(){};_Ewa.rl.a=function(n,t,i){var r=0;return(n&4||n&8||i)&&(r|=(t&2)?0:2,r|=(t&1)?0:1),(n&2||n&1||i)&&(r|=(t&8)?0:8,r|=(t&4)?0:4),r};_Ewa.rl.b=function(n,t,i,r){var u=0;return u|=n?4:0,u|=t?8:0,u|=r?1:0,u|(i?2:0)};_Ewa.bcE=function(){};_Ewa.wi=function(n){_Ewa.wi.initializeBase(this,[n,null]);this.a(n)||this.dispose()};_Ewa.wi.a=function(n){return!!n&&n.startsWith("_Ewa.Gim.")};_Ewa.wi.prototype={a:function(n){var t=n.getAttribute("onclick"),i,r;return(!t&&n.parentNode&&(n=n.parentNode,t=n.getAttribute("onclick")),_Ewa.wi.a(t))?(n.onclick=null,i=new Function("event",t),r=this,this.dK().a("click",function(n){i.call(n.target,n.rawEvent)},!1),!0):!1}};_Ewa.eW=function(){};_Ewa.eW.d=function(n,t,i){switch(t.a){case 0:t.d===3&&_Ewa.r.c(48,4,!1,!1,0,0);n.b().a(_Ewa.iD,70,!1).a(t,i);break;case 2:case 1:case 4:case 3:n.b().a(_Ewa.iD,70,!1).a(t,i);break;case 5:t.d===5&&_Ewa.eW.a(5);n.b().a(_Ewa.iD,70,!1).a(t,i);break;case 8:_Ewa.eW.a(8);n.b().a(_Ewa.iD,70,!1).a(t,i)}};_Ewa.eW.a=function(n){switch(n){case 8:return _Ewa.eW.c?_Ewa.eW.c:_Ewa.eW.c=_Ewa.r.c(56,4,!1,!1,0,0);default:return _Ewa.eW.b?_Ewa.eW.b:_Ewa.eW.b=_Ewa.r.c(57,4,!1,!1,0,0)}};_Ewa.tK=function(n){this.c=Function.createDelegate(this,this.e);_Ewa.tK.initializeBase(this);this.a=n;_Ewa.b.a(this.a).b().c(this.c)};_Ewa.tK.prototype={a:null,b:null,dispose:function(){this.a&&_Ewa.b.a(this.a).b().b(this.c);this.a=null;this.b=null;_Ewa.baY.prototype.dispose.call(this)},e:function(n,t){var f=t.a,o=!!(f.a.q&1),e=o?f.a.n:null,i=e?e.CustomFunctionsObjects:null,r,u;i&&(this.b?this.d(i):(r=_Ewa.l.a(_Ewa.bD,this.a.b(),106,this.dF(),0),u=this,_Ewa.g.cw(r,function(){u.b=r.a();u.d(i)},this.dF(),3)))},d:function(n){this.b.x(n)}};_Ewa.Gv=function(n,t,i,r,u,f,e,o){this.C=Function.createDelegate(this,this.bl);_Ewa.Gv.initializeBase(this,["ExtendedRangeCellEnumerator",n,i,r,u]);this.l=t;this.w=e;this.K=o;this.s=!1;this.v=!1;this.W=new _Ewa.bP(n.c().f());this.D=!1;this.V=f;this.U=this.f.c().isChangeGateEnabled("OfficeVSO:4214881_HandleAfterAllBlocksUpdatedSuccessLog")};_Ewa.Gv.prototype={l:null,w:!1,K:!1,s:!1,v:!1,W:null,u:null,D:!1,V:null,U:!1,$$mn:function(){var t,n,e,o,s,h;if(this.s)return Diag.a.a(23614735,1,50,"ExtendedRangeCellEnumerator.MoveNext: operation is canceled because blocks are not updated yet"),!1;var i=this.h()?this.g.b:this.g.c,u=this.h()?this.g.c:this.g.b,r=this.h()?this.g.a:this.g.d,f=this.h()?this.g.d:this.g.a;if(!this.a()){if(this.T(this.l.b()))return!1;if(this.L(this.l.b()),!this.a())return Diag.a.a(23614736,1,15,"ExtendedRangeCellEnumerator:MoveNext CurrentCell is null after RefreshLoadedRange"),!1}if(t=this.a().a(!1).n(this.g),this.m(),this.p()){if(!(o=this.bn(t,i,u,f,e={val:n}),n=e.val,o))return!1}else if(n=this.i.a[this.j].a,this.t()===2?this.bc(t,u):this.bb(t,f)){if(this.K&&this.bk(n),this.t()===2){if(!this.bp(n,i))return s=new _Ewa.o(n.a,i,n.a,i,!0,!0),this.I(s),!1}else if(!this.bo(n,r))return h=new _Ewa.o(r,n.b,r,n.b,!0,!0),this.I(h),!1}else if((this.t()===2?t.a!==n.a:t.b!==n.b)&&(this.L(t),this.m(),n=this.i.a[this.j].a,this.t()===2?t.a!==n.a:t.b!==n.b))return n=t,this.t()===2?n.b=n.c=this.h()?n.c+1:n.b-1:n.a=n.d=this.h()?n.d+1:n.a-1,this.S(n),Diag.a.a(23614737,1,50,"ExtendedRangeCellEnumerator.MoveNext: prevented premature row change, awaiting blocks to be updated"),!1;return Diag.a.a(23614738,1,50,"ExtendedRangeCellEnumerator.MoveNext: Performing tab Navigation within table or selection with range {0} from {1} to {2}",this.g,t,n),this.q=n,!0},b:function(n){return n?this.T(n)?(Diag.a.a(24413063,1,50,"ExtendedRangeCellEnumerator.MoveClosest: MoveClosest failed on hidden range: {0}, activeCell: {1}",n,this.l.b()),!1):_Ewa.dB.prototype.b.call(this,n,!1)?!0:(this.E(n,!0)?Diag.a.b(592495956,1,!1,"ExtendedRangeCellEnumerator.MoveClosest: MoveClosest failed when range is loaded, on range: {0}, activeCell: {1}, enumeratorRange: {2}, visibleArea: {3}, loadedRange: {4}",n,this.l.b(),this.g,this.f.bo(),this.f.O()):(Diag.a.a(23908511,1,50,"ExtendedRangeCellEnumerator.MoveClosest: MoveClosest failed on range: {0}, activeCell: {1}, enumeratorRange: {2}, visibleArea: {3}, loadedRange: {4}, performing AsyncGoTo",n,this.l.b(),this.g,this.f.bo(),this.f.O()),this.I(n)),!1):(Diag.a.a(591681299,1,50,"ExtendedRangeCellEnumerator.MoveClosest: range is null"),!1)},dispose:function(){this.D||(this.D=!0,this.f&&(this.s=!1,this.f.T(this.C)),_Ewa.dB.prototype.dispose.call(this))},$$rst:function(){this.s&&(this.v=!1,this.s=!1,this.f.T(this.C),this.u=null);_Ewa.jH.prototype.$$rst.call(this)},I:function(n){var i,r,t;Diag.a.a(23614740,0,50,"ExtendedRangeCellEnumerator.AsyncMoveToNewBlock: Performing tab navigation within table or selection with range: {0}, Active Cell: {1} to a new block at range {2}",this.g,this.l.b(),n);n===this.l.b()&&(this.v=!0);i=this.E(n,!1);i||this.S(n);r=this.w?_Ewa.f.a(n,this.f.c()):_Ewa.f.a(this.g,this.f.c());this.f.o(r,n,null,null,60,_Ewa.C.c,3,!0,!1,n,!1,!1);i&&(t=this.f.b().e(n,!1),Diag.a.a(23666758,0,15,"ExtendedRangeCellEnumerator.AsyncMoveToNewBlock: called AsyncMoveToNewBlock on a cell that was already in loaded range. Cell hidden?: {0}, Cell null? {1}, ActiveCell: {2}, Range: {3}, enumeratorRange: {4}, visibleArea: {5}, loadedRange: {6}",this.T(n),!!t,this.l.b(),n,this.g,this.f.bo(),this.f.O()),t&&this.l.b().g(n)&&this.b(t.b().n(this.g),!0))},L:function(n){this.z();this.b(n,!0)},J:function(n,t,i){var o,s,f=!!(this.h()^t),h,r,u,e,c;for(i?(h=f?this.g.c:this.g.b,r=f?n.c:n.b,u=new _Ewa.o(n.a,r,n.a,r,!0,!0)):(h=f?this.g.d:this.g.a,r=f?n.d:n.a,u=new _Ewa.o(r,n.b,r,n.b,!0,!0));f?r<h:r>h;)if(o=r+(f?1:-1),i?u.b=u.c=o:u.a=u.d=o,this.E(u,!1)){if(s=this.f.b().e(u,!1),!s){r=o;continue}if(e=s.b().n(this.g),c=s.k()&&(i?e.a!==n.a:e.b!==n.b),c)r=i?f?e.c:e.b:f?e.d:e.a;else return!1}else return Diag.a.a(23666759,0,50,"ExtendedRangeCellEnumerator.CheckIfSkippedMergedOrHiddenCells: while checking if skipped merged cells, reached outside of loaded range. suspectedMergedCellRange = {0}",u),!1;return!0},bn:function(n,t,i,r,u){if(u.val=null,this.bc(n,i)&&this.bb(n,r)){if(this.h()&&this.w&&n.d!==1048576&&!this.f.c().B()){var f=new _Ewa.o(this.g.d+1,t,this.g.d+1,t,!0,!0);return this.f.o(_Ewa.f.a(f,this.f.c()),f,null,null,60,_Ewa.C.e,3,!0,!1,null,!1,!1),Diag.a.a(23614739,1,50,"ExtendedRangeCellEnumerator.MoveNext: During Tab navigation within table, moved from last cell to a new line starting at: {0}",f),!1}return this.w?this.bm(t,u):this.V()}return(this.L(n),this.m(),this.p())?(this.S(n),!1):(u.val=this.i.a[this.j].a,!0)},bm:function(n,t){this.$$rst();this.m();t.val=this.i.a[this.j].a;var i=this.h()?this.g.a:this.g.d,r=new _Ewa.o(i,n,i,n,!0,!0);return t.val.g(r)?!0:(this.I(r),!1)},bl:function(n,t){var r,f;if(!this.D){if(t.a){Diag.a.a(23614741,1,50,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: GotoRange is not completed yet. Keep waiting");return}this.f.T(this.C);this.s=!1;var i=this.u,e=i.f(),u=this.f.b().e(i,!1);if(u?(r=u.b().n(this.g),i=r.e()!==i.e()?this.bq(i):r):(this.U&&Diag.a.a(591681298,1,15,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: nextCell is null, nextCellRange is {0}",i?i.toString():"null"),i=null),!this.b(i,!0)){Diag.a.b(23614742,1,!1,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: MoveClosest failed to find cell after all blocks have been updated");return}while(!this.W.e(i,this.f)){if(this.m(),this.p())return;if(i=this.i.a[this.j].a,i.g(this.u)){Diag.a.a(23614743,1,50,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: while skipping locked cells returned original cell, tab navigation will be cenceled");break}}i.g(e)||(f=this.w?_Ewa.f.a(i,this.f.c()):_Ewa.f.a(this.g,this.f.c()),this.f.o(f,i,null,null,60,_Ewa.C.d,3,!0,!1,i,!1,!1),Diag.a.a(23614744,0,50,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: during tab navigation within table or selection tried moving to a locked cell on {0} so enumerator skipped to {1}",this.u,i));this.v&&(this.v=!1,this.l.R(0,this.h()?1:-1))}},bk:function(n){var t;(t=this.g).a=t.a+1;this.L(n);this.K=!1},S:function(n){if(this.E(n,!0)){Diag.a.a(592495955,0,50,"ExtendedRangeCellEnumerator.AwaitUpdatedBlocks: nextCell ({0}) is already loaded, not waiting",n);return}this.s||(this.u=n,this.s=!0,this.f.W(this.C))},bp:function(n,t){var i=this.h()?n.b:n.c;return i===t||this.J(n,!0,!0)},bc:function(n,t){var i=this.h()?n.c:n.b;return i===t||this.J(n,!1,!0)},bo:function(n,t){var i=this.h()?n.a:n.d;return i===t||this.J(n,!0,!1)},bb:function(n,t){var i=this.h()?n.d:n.a;return i===t||this.J(n,!1,!1)},bq:function(n){for(var i=null,t=n,u,r,f;this.h()?t.c<this.g.c:t.b>this.g.b;){if(!this.E(t,!1)){Diag.a.a(23666760,0,50,"ExtendedRangeCellEnumerator.SkipMergedAndHiddenCells: while skipping merged cells, reached outside of loaded range. currRange = {0}",t);break}if(i=this.f.b().e(t,!1),!i){if(u=_Ewa.f.t(this.f.X().k(t,this.h())),!this.g.i(u))return null;t=u;continue}if(r=i.b().n(this.g),f=i.k()&&r.a!==n.a,f)t.b=t.c=this.h()?r.c+1:r.b-1;else break}return i?i.b().n(this.g):t},T:function(n){return this.f.X().h(n)},E:function(n,t){return this.f.bF(n,t?4:1)}};_Ewa.Gw=function(n,t,i,r,u,f){this.C=Function.createDelegate(this,this.bb);_Ewa.Gw.initializeBase(this,["ExtendedRangeCellEnumeratorDeprecated",n,t,i,r]);this.w=u;this.D=f;this.l=!1;this.v=!1;this.S=new _Ewa.bP(n.c().f());this.s=!1};_Ewa.Gw.prototype={w:!1,D:!1,l:!1,v:!1,S:null,u:null,s:!1,$$mn:function(){var i,r,t,n,u,f,e;if(this.l)return Diag.a.a(592495954,1,50,"ExtendedRangeCellEnumerator.MoveNext: operation is canceled because blocks are not updated yet"),!1;if(i=this.h()?this.g.b:this.g.c,r=this.h()?this.g.c:this.g.b,!this.a()){if(this.L(this.f.a().b()))return!1;if(this.I(this.f.a().b()),!this.a())return Diag.a.a(592495953,1,15,"ExtendedRangeCellEnumerator:MoveNext CurrentCell is null after RefreshLoadedRange"),!1}if(t=this.a().a(!1),this.m(),this.p()){if(!(f=this.bc(t,i,r,u={val:n}),n=u.val,f))return!1}else if(n=this.i.a[this.j].a,this.t()===2&&this.U(t,r)){if(this.D&&this.V(n),!this.bk(n,i))return e=new _Ewa.o(n.a,i,n.a,i,!0,!0),this.J(e),!1}else if(t.a!==n.a&&this.t()===2&&(this.I(t),this.m(),n=this.i.a[this.j].a,n.a!==t.a))return n=t,n.b=n.c=this.h()?n.c+1:n.b-1,this.K(n),Diag.a.a(592495952,1,50,"ExtendedRangeCellEnumerator.MoveNext: prevented premature row change, awaiting blocks to be updated"),!1;return Diag.a.a(592495951,1,50,"ExtendedRangeCellEnumerator.MoveNext: Performing tab Navigation within table or selection with range {0} from {1} to {2}",this.g,t,n),this.q=n,!0},b:function(n){return this.L(n)?(Diag.a.a(592495950,1,50,"ExtendedRangeCellEnumerator.MoveClosest: MoveClosest failed on hidden range: {0}, activeCell: {1}",n,this.f.a().b()),!1):_Ewa.dB.prototype.b.call(this,n,!1)?!0:(Diag.a.a(592495949,1,50,"ExtendedRangeCellEnumerator.MoveClosest: MoveClosest failed on range: {0}, activeCell: {1}, enumeratorRange: {2}, visibleArea: {3}, loadedRange: {4}, performing AsyncGoTo",n,this.f.a().b(),this.g,this.f.bo(),this.f.O()),this.J(n),!1)},dispose:function(){this.s||(this.s=!0,this.f&&this.f.T(this.C),_Ewa.dB.prototype.dispose.call(this))},J:function(n){var i,r,t;Diag.a.a(592495948,0,50,"ExtendedRangeCellEnumerator.AsyncMoveToNewBlock: Performing tab navigation within table or selection with range: {0}, Active Cell: {1} to a new block at range {2}",this.g,this.f.a().b(),n);n===this.f.a().b()&&(this.v=!0);i=this.E(n);i||this.K(n);r=this.w?_Ewa.f.a(n,this.f.c()):_Ewa.f.a(this.g,this.f.c());this.f.o(r,n,null,null,60,_Ewa.C.c,3,!0,!1,n,!1,!1);i&&(t=this.f.b().e(n,!1),Diag.a.a(592495947,0,15,"ExtendedRangeCellEnumerator.AsyncMoveToNewBlock: called AsyncMoveToNewBlock on a cell that was already in loaded range. Cell hidden?: {0}, Cell null? {1}, ActiveCell: {2}, Range: {3}, enumeratorRange: {4}, visibleArea: {5}, loadedRange: {6}",this.L(n),!!t,this.f.a().b(),n,this.g,this.f.bo(),this.f.O()),t&&this.f.a().b().g(n)&&this.b(t.b(),!0))},I:function(n){this.z();this.b(n,!0)},T:function(n,t){for(var e,r,u=!!(this.h()^t),o=u?this.g.c:this.g.b,i=u?n.c:n.b,f=new _Ewa.o(n.a,i,n.a,i,!0,!0),s;u?i<o:i>o;)if(e=i+(u?1:-1),f.b=f.c=e,this.E(f)){if(r=this.f.b().e(f,!1),!r){i=e;continue}if(s=r.k()&&r.b().a!==n.a,s)i=u?r.b().c:r.b().b;else return!1}else return Diag.a.a(592495946,0,50,"ExtendedRangeCellEnumerator.CheckIfSkippedMergedOrHiddenCells: while checking if skipped merged cells, reached outside of loaded range. suspectedMergedCellRange = {0}",f),!1;return!0},bc:function(n,t,i,r){var u,f,e;if(r.val=null,this.U(n,i)&&(this.h()?n.d===this.g.d:n.a===this.g.a)){if(this.h()&&this.w&&n.d!==1048576&&!this.f.c().B())return u=new _Ewa.o(this.g.d+1,t,this.g.d+1,t,!0,!0),this.f.o(_Ewa.f.a(u,this.f.c()),u,null,null,60,_Ewa.C.e,3,!0,!0,null,!1,!1),Diag.a.a(592495945,1,50,"ExtendedRangeCellEnumerator.MoveNext: During Tab navigation within table, moved from last cell to a new line starting at: {0}",u),!1;if(this.$$rst(),this.m(),r.val=this.i.a[this.j].a,f=this.h()?this.g.a:this.g.d,e=new _Ewa.o(f,t,f,t,!0,!0),!r.val.g(e))return this.J(e),!1}else{if(this.I(n),this.m(),this.p())return this.K(n),!1;r.val=this.i.a[this.j].a}return!0},bb:function(n,t){var u;if(t.a)Diag.a.a(592495944,1,50,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: GotoRange is not completed yet. Keep waiting");else if(!this.s){this.f.T(this.C);this.l=!1;var i=this.u,f=i.f(),r=this.f.b().e(i,!1);if(i=r&&r.b().a===i.a?r.b():this.bl(i),!this.b(i,!0)){Diag.a.b(592495943,1,!1,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: MoveClosest failed to find cell after all blocks have been updated");return}while(!this.S.e(i,this.f)){if(this.m(),this.p())return;if(i=this.i.a[this.j].a,i.g(this.u)){Diag.a.a(592495942,1,50,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: while skipping locked cells returned original cell, tab navigation will be cenceled");break}}i.g(f)||(u=this.w?_Ewa.f.a(i,this.f.c()):_Ewa.f.a(this.g,this.f.c()),this.f.o(u,i,null,null,60,_Ewa.C.d,3,!0,!1,i,!1,!1),Diag.a.a(592495941,0,50,"ExtendedRangeCellEnumerator.HandleAfterAllBlocksUpdatedSuccess: during tab navigation within table or selection tried moving to a locked cell on {0} so enumerator skipped to {1}",this.u,i));this.v&&(this.v=!1,this.f.a().R(0,this.h()?1:-1))}},V:function(n){var t;(t=this.g).a=t.a+1;this.I(n);this.D=!1},K:function(n){this.u=n;this.l=!0;this.f.W(this.C)},bk:function(n,t){var i=this.h()?n.b:n.c;return i===t||this.T(n,!0)},U:function(n,t){var i=this.h()?n.c:n.b;return i===t||this.T(n,!1)},bl:function(n){for(var i=null,t=n,r;this.h()?t.c<this.g.c:t.b>this.g.b;){if(!this.E(t)){Diag.a.a(592495940,0,50,"ExtendedRangeCellEnumerator.SkipMergedAndHiddenCells: while skipping merged cells, reached outside of loaded range. currRange = {0}",t);break}if(i=this.f.b().e(t,!1),!i){t.b=t.c=this.h()?t.c+1:t.b-1;continue}if(r=i.k()&&i.b().a!==n.a,r)t.b=t.c=this.h()?i.b().c+1:i.b().b-1;else break}return i?i.b():t},W:function(n){var i=this.f.bd(n),t;return i&&(t=this.f.b().a(i.a()),t)?t.n.Content:null},L:function(n){var t=this.W(n);return!t||!this.E(n)?!1:!(Array.contains(t.ColumnNumbers,n.b)&&Array.contains(t.RowNumbers,n.a))},E:function(n){return this.f.bF(n,1)}};_Ewa.eX=function(n,t){this.m=Function.createDelegate(this,this.t);this.n=Function.createDelegate(this,this.u);this.j=Function.createDelegate(this,this.r);this.i=Function.createDelegate(this,this.q);this.k=Function.createDelegate(this,this.s);this.g=new($$sc.v.$$(_Ewa.fi));this.d=new($$sc.v.$$(_Ewa.fi));this.b=n;this.h=n.c();this.a=t;this.a.x(this.k);this.a.d(this.i);this.a.Y(this.j)};_Ewa.eX.b=function(n,t,i,r){var f=!_Ewa.L.r(t,i),u=!1;return n.a(727)?(u=!!(_Ewa.b.a(n).j().e()^(!!_Ewa.O.a(n)&&_Ewa.O.a(n).u())),Diag.a.a(595096611,5,50,"FloatingObjectGridBlockManager::LatestFloatingObjectsCached InFreezePanesMode : {0}, freezePanesStateFlipped : {1}",_Ewa.b.a(n).j().e(),u)):u=_Ewa.b.a(n).j().e()||!!_Ewa.O.a(n)&&_Ewa.O.a(n).u(),n.a(270)&&!u&&!f&&!!r&&t.MaxTimestamp<=r};_Ewa.eX.a=function(n,t){if(n.a(233)&&t){var i=n.a(464)&&t.ShapesCount>0,r=n.a(464)&&t.GroupsCount>0,u=_Ewa.p.r(n)&&t.ChartPlayerChartsCount>0,f=n.a(271)&&t.ImagesCount>0;return u||i||r||f}return!1};_Ewa.eX.prototype={b:null,h:null,a:null,f:null,c:function(){return this.f||(this.f=_Ewa.O.a(this.b)),this.f},e:!1,l:function(n,t){var i;if(this.g.c(n.b)){Diag.a.a(42322083,5,50,"FloatingObjectGridBlockManager.SendGetFloatingObjectsRequest - Already sent GFO request, skip sending again. Block [{0}]",n.b);return}if((i=n.a,t&&(Diag.a.a(42322112,5,15,"FloatingObjectGridBlockManager.SendGetFloatingObjectsRequest - reset GFO request timestamp. Block [{0}]",n.b),i.G=0),i.B!==2&&i.n&&i.n.FloatingObjectsMetaData)&&i.q&1&&i.r){if(_Ewa.b.a(this.b).Y()){Diag.a.a(38933461,5,100,"SendGetFloatingObjectsRequest, Block [X={0}, Y={1}], Panetype: {2}, Block.FloatingObjects.Count: {3}, blockItem.State: {4}.",n.a.n.Information.BlockCachePosition.X,n.a.n.Information.BlockCachePosition.Y,n.a.n.Information.BlockCachePosition.PaneType,n.a.x().a.a.length,i.q);this.d.b(n.b,n);return}var u=_Ewa.eX.b(this.b,i.n.FloatingObjectsMetaData,i.K,i.G),f=_Ewa.eX.a(this.b,i.n.FloatingObjectsMetaData),r=f&&!u;if(f&&u&&Diag.a.a(51663694,5,50,"FloatingObjectGridBlockManager.SendGetFloatingObjectsRequest - No need of calling GetfloatingObjects as we have all the floating objects already cached, InFreezePanesMode : {0}",_Ewa.b.a(this.b).j().e()),r&&this.g.g(n.b,n),!t&&!isNullOrUndefined(this.c())&&((!r||this.c().A(i))&&(i.M.a("ProcessingExistingFOs"),this.c().g(n,!0)),!r)){this.a.p(i,!0);return}this.a.p(i,!1);i.M.a("SendGetFloatingObjectsRequest");this.p(this.b.d().a(),i,this.n,this.m,n.b)}},dispose:function(){this.a&&(this.a.M(this.k),this.a.f(this.i),this.a.bt(this.j));this.a=null;this.h=null;this.b=null},q:function(){this.v()},r:function(n,t){isNullOrUndefined(this.c())||this.f.H(n,t)},s:function(n,t){this.l(t.a,!1)},t:function(n,t){var i=t,r;this.g.d(i);r=this.a.a(i);r&&r.M.a("GetFloatingObjectRequestFailed");Diag.a.a(39944845,5,10,"FloatingObjectGridBlockManager.OnWebServiceFailure - GetFloatingObjects request failed, blockHash: {0}, httpStatus: {1}.",i,n.b.c);this.c().f("GetFloatingObjects HTTP failure",!1)},u:function(n,t){var r=n.Result,u=t,i,f,e,o,s;if(this.g.d(u),i=this.a.a(u),!i){Diag.a.a(41824463,5,15,"GetFloatingObjects request for {0} returned but block is null.",u);return}if(!r){i.M.a("GetFloatingObjectRequestFailed");this.c().f("GetFloatingObjects result is null",!1);Diag.a.a(37889354,5,10,"GetFloatingObjects request returned with error: {0}, GetFloatingObjects response processing aborted. BlockHash: {1}",Sys.Serialization.JavaScriptSerializer.serialize(n.Errors),u);return}if(_Ewa.h.e(n.Errors)?(i.M.a("GetFloatingObjectRequestSuccessWithErrors"),f=_Ewa.h.g(n.Errors,[-1100324317],"FloatingObjectGridBlockManager: OnWebServiceSuccess"),this.h.q(f),this.c().f("GetFloatingObjects HTTP success with server error",!0),Diag.a.a(40777233,5,15,"GetFloatingObjects request returned with error: {0}, trying to process response anyway. BlockHash: {1}",Sys.Serialization.JavaScriptSerializer.serialize(n.Errors),u)):i.M.a("GetFloatingObjectRequestSuccess"),this.b.a(270)&&(e=_Ewa.L.z(r.FloatingObjects),o=r.FloatingObjects?r.FloatingObjects.length:0,Diag.a.a(51663695,5,50,"GetFloatingObjects response info : lastRequestTimestamp : {0}, currentRequestTimestamp :{1}, FloatingObjectsMetadata: {2}, ResponseFOMEqualsCachedFOM : {3}, InFreezePanesMode : {4}, TotalFOsInBlock : {5}, FOsWithContentHtmlCount : {6}",i.G,r.TimeStamp,r.FloatingObjectsMetadata,_Ewa.L.r(i.K,r.FloatingObjectsMetadata),_Ewa.b.a(this.b).j().e(),o,e)),this.b.isChangeGateEnabled("OfficeVSO:3953094_InfinitePlaceholders")&&this.o(i,r),i.G=r.TimeStamp,i.bl=n.ServerCorrelationId,i.K=r.FloatingObjectsMetadata,i.be=r.FloatingObjects,i.W=_Ewa.jS.a(i.n.FloatingObjects),i.x().c(r.FloatingObjects),Diag.a.a(38318346,5,50,"GetFloatingObjects request pre-process, request time since GetRange request received [{0}], AllFloatingObjectsCount [{1}], FloatingObjectMetadata [{2}], RequestTiming [{3}]",i.bz(),i.x().a.a.length,r.FloatingObjectsMetadata,n.RequestTelemetryData),isNullOrUndefined(this.c())){Diag.a.a(38344925,5,10,"GetFloatingObjects: OnWebServiceSuccess: FloatingObjectManager should not be null after getFloatingObjectsResponse! BlockHash: {0}",u);return}this.c().g(new _Ewa.fi(i,u),!0);s=this;this.b.b().c(_Ewa.iD,70,function(){s.a.p(i,!0)})},o:function(n,t){for(var i,o,r,s=this.b.p().a("Task","CopyOmittedDataIntoResponse"),u=0,e=t.FloatingObjects,h=e.length,f=0;f<h;++f)i=e[f],!i.Type&&i.RenderType===3&&i.ChartMetaData&&_Ewa.e.a(i.ChartMetaData.SceneGraphJSON)&&(o=i.Type+"_"+i.Id,r=n.x().g(o),r&&r.g&&!_Ewa.e.a(r.g.SceneGraphJSON)&&(i.ChartMetaData=r.g,u++));u>0&&Diag.a.a(593831171,5,50,"FloatingObjectGridBlockManager.OnWebServiceSuccess - Restoring a previous SceneGraph, count: {0}",u);s.a()},v:function(){var n,r,t,i;if(!_Ewa.b.a(this.b).Y()&&this.d.e>0){for(n=this.d.i(),r=this,n=$$sc.b.l(String,String,n,function(n){return n}),t=n.$$ge();t.$$mn();)i=t.$$cu(),this.l(this.d.a(i),!1);this.d=new($$sc.v.$$(_Ewa.fi))}},p:function(n,t,i,r,u){var e=this.b,f=t.bm(),a=f.b.Y*28,v=f.b.X*30,y=f.g()*28,p=f.f()*30,s=_Ewa.b.a(e).j().e(),l,o;if(s)this.e=!0,Diag.a.a(38541462,5,50,"GetFloatingObjects request inFreezenPanes TopLeft={0}, BottomRight={1}, PaneType={2}",f.b,f.a,f.b.PaneType);else if(this.e){for(var c=this.a.r(),w=c.length,h=0;h<w;++h)l=c[h],l.G=0;this.e=!1}return o=0,o=e.a(727)?t.G:s?0:t.G,Diag.a.a(40132929,5,50,"GetFloatingObjects: Issuing request for block [{0}] in inFreezePanes mode : [{1}] with timestamp [{2}]",u,s,o),_Ewa.Hg.a(n,_Ewa.B.h(t.v,this.h),a,v,y,p,o,f.b,t.L,-1,null,e.e().RenderingOptions,2,e.bp(),i,r,u,n.b(!1))}};_Ewa.eG=function(n,t){this.bt=Function.createDelegate(this,this.v);this.br=Function.createDelegate(this,this.bR);this.bg=Function.createDelegate(this,this.bT);this.bp=Function.createDelegate(this,this.bP);this.bs=Function.createDelegate(this,this.bS);this.bq=Function.createDelegate(this,this.bQ);this.bv=Function.createDelegate(this,this.bV);this.bu=Function.createDelegate(this,this.bU);this.bw=Function.createDelegate(this,this.bW);this.bo=Function.createDelegate(this,this.bO);this.bn=Function.createDelegate(this,this.bN);this.bm=Function.createDelegate(this,this.bL);this.be=Function.createDelegate(this,this.bM);this.bx=Function.createDelegate(this,this.bX);this.P=new _Ewa.v(!1);this.U=new _Ewa.v(!1);_Ewa.eG.initializeBase(this,[!1]);this.Q=n;this.S=t.a();this.X=this.Q.c();this.ba={};this.V=new _Ewa.v(!1);this.R=t;this.Q.a(233)&&!this.Q.c().b()&&(this.Z=new _Ewa.eX(this.Q,this.R.b()));this.R.cI(this.bx);this.R.b().j(this.be);this.R.b().q(this.bm);var i=_Ewa.by.a(this.Q).b();i.j(this.be);i.c(this.bn);this.Q.R(this.bo);this.X.g(this.bw);this.X.G(this.bu);this.Q.bl()&&this.X.C(this.bv);this.s(this.bq);this.i(this.bs);this.T=new _Ewa.Qt(n);Common.bh.a().b()&&Common.bh.a().c(this.bp)};_Ewa.eG.prototype={X:null,bc:null,bb:null,bd:!1,bj:!1,bl:0,Q:null,R:null,S:null,Z:null,bf:null,V:null,Y:0,bi:0,T:null,i:function(n){this.dG("ekfocr",n)},p:function(n){this.dH("ekfocr",n)},s:function(n){this.dG("ekfoca",n)},w:function(n){this.dH("ekfoca",n)},y:function(n){this.dG("eksfocc",n)},I:function(n){this.dH("eksfocc",n)},b:function(){return this.P.a},x:function(n){return this.bj=n,n},n:function(){return this.bl},u:function(){return!!this.Z&&this.Z.e},by:!1,m:function(){return this.by},M:function(n){return this.by=n,n},ba:null,e:function(){return this.ba},W:null,bK:function(){isNullOrUndefined(this.bf)&&(this.bf=new UlsExternalLogger,chartPlayer.ChartPlayerFactoryGlobal.initializeLogger(this.bf))},E:function(){return!!this.bf},F:function(){var n=_Ewa.r.c(48,4,!1,!1,0,-1),t=this;return _Ewa.g.cw(n,function(){t.bK()},this.Q.b().d(),11),n},G:function(n){return _Ewa.eW.a(n)},dispose:function(){var n=this.Q,t,i,r,u;n&&(this.R.de(this.bx),this.R.b().l(this.be),this.R.b().q(this.bm),t=_Ewa.by.a(n).b(),t.l(this.be),t.b(this.bn),n.S(this.bo),this.X.h(this.bw),this.X.H(this.bu),n.bl()&&this.X.I(this.bv));this.w(this.bq);this.p(this.bs);this.Z&&(this.Z.dispose(),this.Z=null);this.S=null;this.Q=null;this.R=null;_Ewa.eG.b=null;_Ewa.eG.a=null;System.a.b(this.P.a);this.P=null;System.a.b(this.U.a);this.U=null;this.bc=null;this.T=null;i=this.ba;for(r in i)u={key:r,value:i[r]},u.value.dispose();this.ba=null;Common.bh.a().b()&&Common.bh.a().d(this.bp);_Ewa.cs.prototype.dispose.call(this)},j:function(n,t){var i=n.a().h();this.P.c(i,n);this.Q.a(85)&&(t?this.T.n(n.a()):(this.T.h(n.a(),!0),this.T.i(n.a())));this.bF("ekfoca",n);n.D(this.bg)},c:function(n,t,i){if(n&&this.P.d(n.a().h())){var r=n.a().h();i&&n.bA();this.bk(n,r,t)}},d:function(n,t,i){this.bb=n+"_"+t;this.bd=i;this.bC()},C:function(){for(var n,r=this.P?this.P.a.length:0,t=r-1;t>=0;t--)if(n=this.P.a[t],n&&n.a().a===5){var i=n.a().c,u=i?i.Rotation:0,f=this.bc?this.bc.b[n.a().b]||null:null;_Ewa.L.w(n.j(),u,n.a().i,n.a().m,f)}},N:function(n,t,i){var c=this.P?this.P.a.length:0,h=_Ewa.t.a(this.Q).e(31),f,r,o,e,u,s;for(t.val=null,i.val=null,f=c-1;f>=0;f--)if(r=this.P.a[f],r&&r.n()&&r.n().e.length>0)for(o=r.n().$$lge();o.$$mn();)e=o.$$cu(),e&&(u=e.b(this.R.d(),this.R.j().e()),s=Math.sqrt((u.x-n.a)*(u.x-n.a)+(u.y-n.b)*(u.y-n.b)),s<h&&(h=s,t.val=r,i.val=e));return!!i.val},J:function(){var i,t,n;for(this.bc=new _Ewa.v(!1),i=this.P?this.P.a.length:0,t=i-1;t>=0;t--)n=this.P.a[t],n&&n.s()&&n.J()&&this.bc.c(n.a().b,n.J())},B:function(){this.bc=null},bX:function(){this.bB()},g:function(n,t){if(this.Q.a(244)){var i=_Ewa.r.c(39,4,!1,!1,0,-1),r=this;_Ewa.g.cw(i,function(){r.bI(n,t)},this.dF(),3)}else this.bI(n,t)},A:function(n){for(var i,t=0;t<n.x().a.a.length;t++)if(i=n.x().a.a[t],this.U.d(i.h()))return!0;return!1},bI:function(n,t){var o=!!(n.a.q&1),r=o?n.a:null,u=r?r.x():null,l=u?u.a.a.length:0,a=_Ewa.bY.a(this.Q),s,f,h,e,i,c,p,v,y;if(o&&a&&_Ewa.bY.h(u,this.Q)&&this.bE(),s=!this.X.W()||this.Q.j().e===3,this.Q.c().b()&&s&&o)for(this.bl=0,f=0;f<l;f++)u.a.a[f].a===2&&this.bl++;for(h=!1,e=0;e<l;e++)if(i=u.a.a[e],i.a!==2||s){if(i.a===3){if(Common.a.X)continue;if(this.Q.a(244)&&i.w.PrimaryMarketplace.MarketplaceType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()){h||(h=!0,c=_Ewa.l.b(_Ewa.cR,this.Q.b(),5,4,0),p=this,_Ewa.g.cw(c,function(){c.a().a(29,null)},this.dF(),3));continue}if(Common.bh.a().a()){_Ewa.eG.b[i.b]=i;_Ewa.eG.a.b(i.b,n);continue}}if(v=i.a===5,y=!i.a||i.a===1,_Ewa.bq.a(this.Q)&&!y&&!v)continue;this.k(i,n)}a||this.bJ(n,t);r&&r.n&&this.ca(r.n)},a:function(n,t){if(!n)return null;var i=this.P.b[n]||null;return this.Q.a(233)&&!i&&t&&(i=this.U.b[n]||null,i&&(Diag.a.a(38344353,5,50,"FloatingObjectManager.GetFloatingObjectControl: control was not in the list but was in the cache [{0}]",n),this.j(i,!1),i.bg(t,!0),i.cj(!0,!1,!0),this.U.e(n))),i},D:function(n){var t,i;if(!n||!n.localeCompare("")||!this.P)return null;for(t=0;t<this.P.a.length;t++)if(i=this.P.a[t],i.a()&&!i.a().b.localeCompare(n))return i;return null},o:function(n){var t,i;if(!n||!n.localeCompare("")||!this.P)return null;for(t=0;t<this.P.a.length;t++)if(i=this.P.a[t],i.L()&&!i.L().localeCompare(n))return i;return null},t:function(){_Ewa.vc.a(this.Q)},K:function(){if(!this.W)return!1;var n=this.a(this.W.t+"_"+this.W.w,null);return n&&n.g()?(Diag.a.a(22836623,5,50,"FloatingObjectManager.SelectFirstFloatingObject: first floating object [{0}] is within the loaded range (no need to GotoRange)",this.W.q()),this.S.c().i(n)):(Diag.a.a(22836624,5,50,"FloatingObjectManager.SelectFirstFloatingObject: first floating object [{0}] is outside the loaded range",this.W.q()),this.bA(this.W,0)),!0},q:function(n,t){var i,r;if(!n){Diag.a.b(22349194,5,!1,"FloatingObjectManager.SelectNextFloatingObject: current floating object control cannot be null");return}if(this.S.c().o()){Diag.a.a(22577730,5,50,"FloatingObjectManager.SelectNextFloatingObject: Waiting for previous floating object selection task to complete. Aborting current operation.");return}i=t?n.a().R:n.a().S;i&&(r=this.a(i.t+"_"+i.w,null),r&&r.g()?(Diag.a.a(23122012,5,50,"FloatingObjectManager.SelectNextFloatingObject: Next object [{0}] is within the loaded range (no need to GotoRange)",i.q()),this.S.c().i(r)):(Diag.a.a(22349453,5,50,"FloatingObjectManager.SelectNextFloatingObject: Next object [{0}] is outside the loaded range.",i.q()),this.bZ(i)))},bZ:function(n){var t=_Ewa.f.a(n,this.Q),i=this.S.c().j(t,n.w,n.t),r=this;i.CW(function(t){var i=t.a();i?Diag.a.a(22349196,5,50,"FloatingObjectManager.SelectNextFloatingObjectAsync: Selection succeeded [{0}].",n.q()):(Diag.a.a(22349197,5,50,"FloatingObjectManager.SelectNextFloatingObjectAsync: Selection Failed [{0}]. Falling back to first floating object selection.",n.q()),r.K())})},bA:function(n,t){if(t>1){Diag.a.a(22349198,5,50,"FloatingObjectManager.SelectFirstFloatingObjectAsync: Selection failed after reaching max retries [id {0}]. Aborting.",n.q());this.R.c().isChangeGateEnabled("OfficeVSO:4217268_SetFocusKeepCurrentViewport")?this.R.bj():this.R.C(!0,!1);return}var r=_Ewa.f.a(n,this.Q),u=this.S.c().j(r,n.w,n.t),i=this;u.CW(function(r){var f=r.a(),u;f?Diag.a.a(22349199,5,50,"FloatingObjectManager.SelectFirstFloatingObjectAsync: Selection succeeded on try #{0} [id {1}]",t+1,n.q()):(u=i.W,u?n.g(u)?(Diag.a.b(22349201,5,!1,"FloatingObjectManager.SelectFirstFloatingObjectAsync: Selection failed on try #{0}: unknown reason. [id {1}]",t+1,n.q()),i.bA(n,++t)):(Diag.a.a(22349202,5,50,"FloatingObjectManager.SelectFirstFloatingObjectAsync: Selection failed on try #{0}: first floating object [{1}] was changed [{2}]. Retrying.",t+1,n.q(),u.q()),i.bA(u,++t)):(Diag.a.a(22349200,5,50,"FloatingObjectManager.SelectFirstFloatingObjectAsync: Selection aborted on try #{0}: No floating objects on sheet. [id {1}]",t+1,n.q()),i.R.c().isChangeGateEnabled("OfficeVSO:4217268_SetFocusKeepCurrentViewport")?i.R.bj():i.R.C(!0,!1)))})},k:function(n,t){_Ewa.eW.d(this.Q,n,t)},H:function(n,t){var r=t.a,e,f,s;if(!isNullOrUndefined(r)&&!isNullOrUndefined(r.a)&&!isNullOrUndefined(r.a.x())){for(e=r.a.x(),f=0;f<e.a.a.length;++f){var u=e.a.a[f],o=u.h(),i=this.P.b[o]||null;i||(i=this.U.b[o]||null);i?(i.bM(r),i.bL(r),s=!i.bJ(),s&&(Diag.a.a(40957981,5,50,"FloatingObjectManager.OnBlockCacheItemDeleted: FloatingObject was deleted from cache, control: {0}",i.a().e()),this.bk(i,o,8))):(_Ewa.L.j(this.ba?this.ba[u.b]:null,u.e(),!1,!0),_Ewa.L.k(u.b,u.e(),this),Diag.a.a(41986048,5,50,"FloatingObjectManager.OnBlockCacheItemDeleted: FloatingObjectControl is not supposed to be null. Id: {0}, Type: {1}, Block: {2} ",u.e(),u.a,r.b))}Diag.a.a(38344355,5,50,"FloatingObjectManager.OnBlockCacheItemDeleted: cachedFloatingObjectControls size = {0} controls",this.U.a.length)}},f:function(n,t){this.T.l(n,t)},O:function(n){this.T.q(n)},L:function(n,t){this.Z.l(n,t)},z:function(){return!this.V.a.length},h:function(n){this.T.o(n)},l:function(n){return n+"_LightweightPlaceholder"},v:function(n){var t=n,i=t.a().h();this.bD(t,!0);this.bh()},bJ:function(n,t){var r,i,u;if(t)for(r=this.P?this.P.a.length:0,i=r-1;i>=0;i--)u=this.P.a[i],u.bv(n,!0);this.bB();this.bC()},bL:function(n,t){var i=t.a.a,r=i.n.FloatingObjectsMetaData,u=!_Ewa.eX.a(this.Q,r)||_Ewa.eX.b(this.Q,r,i.K,i.G);this.g(t.a,u);u&&this.R.b().p(i,!0)},bM:function(n,t){var u=t.a,f=u.a,e=f.x(),s=e?e.a.a.length:0,h=this.P?this.P.a.length:0,o,i,r,l;if(!h){s>0;return}if(o=_Ewa.bY.a(this.Q),!o)if(this.Q.a(233)||(f.G=0),f.q&1)for(i=0;i<s;i++){var a=e.a.a[i],v=a.h(),c=this.a(v,null);c&&c.Z(u,!0)}else for(r=h-1;r>=0;r--)l=this.P.a[r],l.Z(u,!0);o||this.R.b().bg()||this.bz(!1);this.bj&&(this.bE(),this.bj=!1)},bU:function(){this.bH()},bW:function(n,t){t.b&&!t.c?this.bH():t&&t.a||this.bz(!1)},bH:function(){this.bY(!0)},bY:function(n){for(var t,r,i=this.P.a.length-1;i>=0;i--)t=this.P.a[i],t.o(-1),r=t.a(),r&&(r.f=-1),n&&t.a().a===2&&this.bk(t,t.a().h(),10)},bz:function(n){for(var t,i=this.P.a.length-1;i>=0;i--)t=this.P.a[i],n&&t.a().a!==2||this.bk(t,t.a().h(),t.a().a===3?1:8)},bE:function(){this.bz(!0);this.dE("eksfocc",null,null)},bB:function(){var n,i,t;if(this.P&&!_Ewa.bY.a(this.Q))for(n=0,i=this.P.a.length;n<i;n++)t=this.P.a[n],t.bE()&&t.bV()},bF:function(n,t){this.dE(n,new _Ewa.GY(t),null)},bk:function(n,t,i){if(i&1&&(n.a().a===3&&n.br(null),n.p(!1),this.S.c().d(n,!0)),n&&n.bp(),this.Q.a(233)&&i&16){if(!_Ewa.a.g(n.b()))return;this.S.c().d(n,!1);n.B(this.bg);this.U.c(t,n);this.P.e(t);this.Q.a(85)&&(this.T.j(n.a()),this.T.m(n.a()));Diag.a.a(38344385,5,50,"FloatingObjectManager.RemoveFloatingObjectControl: FloatingObject was cached, control: {0}",n.a().e())}i&2&&this.bF("ekfocr",n);i&8&&!(i&16)&&(this.Q.a(85)?this.P.e(t)?this.T.j(n.a()):this.U.e(t)&&this.T.i(n.a()):(this.P.e(t),this.U.e(t)),n.B(this.bg),System.a.a(n),n=null)},bO:function(){this.bB()},bN:function(n,t){this.X.b()&&this.Q.l().NovMode===1&&this.g(t.a,!0)},bC:function(){var n=this.a(this.bb,null),i,t;n&&(n.d()?(this.bd?this.S.c().i(n):this.S.c().b(n),this.bb=null,this.bd=!1):(i=null,t=this,i=function(){(t.R.J()&&_Ewa.L.t(n.a().a)&&t.bb===n.a().b||t.bb===n.a().h())&&(t.bd?t.S.c().i(n):t.S.c().b(n),t.bb=null,t.bd=!1);n.Y(i)},n.N(i)))},bT:function(n){var t,i;(this.bC(),t=$$as(_Ewa.dW,n),t)&&(i=this.S.c().c(),i&&t.a().b===i&&(this.Q.isChangeGateEnabled("OfficeVSO:3236096_EnablePreventFocusShiftWhenFloatingObjectLoaded")?this.S.c().b(t):this.S.c().w(t)))},ca:function(n){n.FirstFloatingObject?(this.W||this.t(),this.W=_Ewa.ed.a(n.FirstFloatingObject)):this.W=null},bP:function(){for(var n,r,i=Object.keys(_Ewa.eG.b),u=i.length,t=0;t<u;++t)n=i[t],_Ewa.eG.a.a(n).a.v.k()&&_Ewa.eG.a.a(n).a.r&&(this.k(_Ewa.eG.b[n],_Ewa.eG.a.a(n)),r=_Ewa.bY.a(this.Q),r||this.bJ(_Ewa.eG.a.a(n),!1))},bG:function(n){var t=n.a().a,i=n.a().h();t!==5&&t&&t!==1&&t!==2||(this.V.d(i)?(this.V.e(i),this.bi++,Diag.a.a(42349254,5,50,"FloatingObjectManager.RemoveControlFromLoadingList: Removing {0} from floatingObjectsToLoad list, list size is {1}",n.a().e(),this.V.a.length)):Diag.a.a(42349255,5,50,"FloatingObjectManager.RemoveControlFromLoadingList: {0} is not in floatingObjectsToLoad list.",n.a().e()))},bD:function(n,t){var i=n.a().a,r=n.a().h();if(i===5||!i||i===1||i===2){if(n.bC()){Diag.a.b(51505111,5,!this.V.d(r),"FloatingObjectManager.AddControlToLoadingList: FloatingObject shouldn't exist in dictionary!");this.Y=t?this.Y:this.Y+1;this.bi++;Diag.a.a(51505112,5,50,"FloatingObjectManager.AddControlToLoadingList: FloatingObject's image has already been loaded. ID [{0}], Type [{1}], RenderType [{2}]",n.a().e(),_Ewa.L.a(n.a()),_Ewa.L.d(n.a().d));return}this.V.d(r)?Diag.a.a(42349257,5,50,"FloatingObjectManager.AddControlToLoadingList: {0} is already in floatingObjectsToLoad list.",n.a().e()):(this.V.c(r,n),this.Y=t?this.Y:this.Y+1,n.D(this.br),Diag.a.a(42349256,5,50,"FloatingObjectManager.AddControlToLoadingList: Added {0} to floatingObjectsToLoad list, list size is {1}",n.a().e(),this.V.a.length))}},bQ:function(n,t){if(t.a.a().a!==3){var r=t.a.a().h(),i=t.a;Diag.a.a(42349258,5,50,"FloatingObjectManager.OnFloatingObjectControlAdded: New FloatingObjectControl {0} is added.",i.a().e(),this.V.a.length);this.bD(i,!1);t.a.bf(this.bt);this.bh()}},bS:function(n,t){if(t.a.a().a!==3){var r=t.a.a().h(),i=t.a;t.a.bK(this.bt);Diag.a.a(42349259,5,50,"FloatingObjectManager.OnFloatingObjectControlRemoving: FloatingObjectControl {0} is being removed, detached from VersionChanged event.",i.a().e());this.bG(i);this.bh()}},bR:function(n){var t=n,i=t.a().h();t.B(this.br);this.bG(t);this.bh();Diag.a.a(42349260,5,50,"FloatingObjectManager.OnFloatingObjectControlImageLoaded: {0} is loaded and removed from floatingObjectsToLoadList, list size is {1}",t.a().e(),this.V.a.length)},bh:function(){this.T.k(!this.V.a.length,this.Y,this.bi)},bV:function(){for(var i,t,r,n=0;n<this.P.a.length;n++)i=this.P.a[n],i.O();for(t=0;t<this.U.a.length;t++)r=this.U.a[t],r.O()}};_Ewa.gt=function(n,t,i,r,u){this.bb=Function.createDelegate(this,this.bA);this.bc=Function.createDelegate(this,this.bE);this.ba=Function.createDelegate(this,this.bo);this.O=Function.createDelegate(this,this.bw);this.R=Function.createDelegate(this,this.bz);this.D=Function.createDelegate(this,this.bt);this.N=Function.createDelegate(this,this.bu);this.Q=Function.createDelegate(this,this.by);this.E=Function.createDelegate(this,this.bv);this.P=Function.createDelegate(this,this.bx);this.Z=Function.createDelegate(this,this.bn);this.H={};this.M=[0,1,2,7,8,9,10];this.U=[0,1,2,7,8,9,10,17,20,19,18];_Ewa.gt.initializeBase(this,[t.i(),null]);this.L=new _Ewa.IK(this.Z);this.w=new _Ewa.Nh(this.L);this.s=t;this.S=i;this.T=u||n.m()+"selectionHighlight";this.t=n;this.x=r;this.x&&this.s.M(this.P);this.s.b().j(this.E);this.s.b().c(this.E);this.s.h().c(this.Q);this.s.bO(this.N);this.t.n().c(this.D);this.t.f().c(this.D);this.t.f().w(this.R);this.s.b().d(this.O)};_Ewa.gt.f=function(){return _Ewa.gt.c||(_Ewa.gt.c=["ewr-cell-selection-highlight-all","ewr-cell-selection-highlight-rows","ewr-cell-selection-highlight-cols","ewr-marquee-selection-highlight","ewr-cut-selection-highlight-dashed","ewr-copy-selection-highlight-dashed","ewr-selection-filldragborder","ewr-cell-selection-highlight-center","ewr-cell-selection-highlight-center","ewr-cell-selection-highlight-center","ewr-cell-selection-highlight-center","ewr_selection-rearrangeborder","ewr_selection-rearrangeborder","ewa-rowresizer","ewa-colresizer","ewr-cell-selection-highlight-center","ewr-rangepicker-selection-highlight-dashed","ewr-discontinuous-selection","ewr-deselection","ewr-discontinuous-selection-active-range-border","ewr-discontinuous-selection-active-cell","ewr-array-highlight-spill","ewr-array-highlight-nospill","ewa-vhr-highlight","ewr-catch-up-activity-highlight","ewr-findall-highlight","ewr-table-resize-fade","ewr-table-resize-handle","ewr-conditionalformatting-highlight","ewr-linkeddatatype-autodetect-highlight","ewr-paste-indication-selection"])};_Ewa.gt.e=function(){return _Ewa.gt.b||(_Ewa.gt.b=[1,1,1,2,-1,-1,3,0,0,0,0,3,3,1,1,1,-2,1,1,1,5,1,1,2,2,0,0,0,2,1])};_Ewa.gt.prototype={t:null,w:null,L:null,v:null,J:!1,A:!1,x:!1,g:function(n){this.dG("ghHC",n)},h:function(n){this.dH("ghHC",n)},m:function(n){this.dG("ghSHC",n)},q:function(n){this.dH("ghSHC",n)},l:function(n){this.dG("ghHSAB",n)},p:function(n){this.dH("ghHSAB",n)},s:null,S:!1,T:null,dispose:function(){this.s&&(this.x&&this.s.N(this.P),this.s.b().l(this.E),this.s.b().b(this.E),this.s.h().b(this.Q),this.s.bS(this.N),this.t.n().e(this.D),this.t.f().e(this.D),this.t.f().y(this.R),this.s.b().f(this.O));System.a.a(this.v);this.F(this.ba,null);this.w=null;this.s=null;this.H=null;_Ewa.hD.prototype.dispose.call(this)},d:function(n,t,i,r,u){var f,c,e,s,a;if(!t||!n||!n.length){Diag.a.b(50340612,1,!!t,"GridHighlight.SetHighlightsSheetRanges: which must not be null.");Diag.a.b(39916677,1,!!n,"GridHighlight.SetHighlightsSheetRanges: sheetRanges must not be null.");Diag.a.b(39916678,1,n.length>0,"GridHighlight.SetHighlightsSheetRanges: sheetRanges must not be empty.");return}for(f=0;f<n.length;f++)if(!n[f]){Diag.a.b(39916679,1,!1,"GridHighlight.SetHighlightsSheetRanges: sheetRanges[i] must not be null. i = "+f.toString());return}for(var h=t,l=h.length,o=0;o<l;++o)for(c=h[o],e=1;e<=4;e++)s=new _Ewa.gt.a(c,e),this.w.e(s,n.length),a=this,this.w.a(function(t){var e;t.b=n[t.f].a;t.i=n[t.f].b;i&&(t.g=!0);r&&r(t,t.a);for(var f=t.e,o=f.length,u=0;u<o;++u)e=f[u],e.t(t)},s);u&&this.z(!1,!1)},b:function(n,t,i){this.j(new _Ewa.db(n,_Ewa.B.b(this.t.j())),t,i)},j:function(n,t,i){if(!t||!n){Diag.a.b(42541922,1,!!t,"GridHighlight.SetHighlightsSheetRanges: which must not be null.");Diag.a.b(39916680,1,!1,"GridHighlight.SetHighlightsSheetRange: sheetRange must not be null.");return}this.d([n],t,!1,null,i)},f:function(n,t){this.z(n,t)},c:function(n,t,i){this.bj(!0,t,n,i)},a:function(n){this.bj(!1,null,n,null)},r:function(){this.w.d()},e:function(n,t,i){var r=new _Ewa.gt.a(n,t);return this.w.b(r,i)},n:function(){var n=new Array(0),t=this;return this.F(function(t){t.g&&Array.add(n,t.c)},null),n},i:function(){Diag.a.b(594323400,1,this.x,"GridHighlight.ShowSelectionHighlights: handleGridSelection should be true.");this.t.a(458)?this.c(this.U,null,null):this.c(this.M,null,null)},o:function(){Diag.a.b(594323399,1,this.x,"GridHighlight.HideSelectionHighlights: handleGridSelection should be true.");this.t.a(458)?this.a(this.U):this.a(this.M)},k:function(){var t,u;if(Diag.a.b(594323398,1,this.x,"GridHighlight.UpdateSelectionHighlightRanges: handleGridSelection should be true."),this.t.a(458)){var n=this.s.a().d(),r=n.a().length,f=_Ewa.B.b(this.t.j()),e=new _Ewa.db(n.c(),f),i=new Array(0);for(t=0;t<r;t++)t!==n.f()&&Array.add(i,new _Ewa.db(n.a()[t],f));r>1?this.d(i,[17],!1,null,!1):this.b(null,[17],!1);u=i;Array.add(u,e);i=null;this.d(u,[1,2],!1,null,!1);this.j(e,[7,8,9,10],!1);r===1?(this.b(n.c(),[0],!1),this.b(null,[19,20],!1)):(this.b(null,[0],!1),this.b(n.c(),[19],!1),this.b(this.s.a().u(),[20],!1));this.b(n.j(),[18],!0);n.g()||(this.A=!0);this.z(!1,!1)}else this.b(this.s.a().a(),this.M,!0),this.A=!0},be:function(n,t,i){_Ewa.a.f(i,_Ewa.gt.f()[n],!0);var r=this.s,u=n===2?r.bG(t).i():n===1?r.cZ(t).i():r.n(t).i();u.insertBefore(i,u.firstChild)},bi:function(n,t,i,r){var e=_Ewa.gt.e()[n]|0,u=new _Ewa.hG(i),f=u.a;n===12?u.d(this.s.d(),this.bd(t,r.a.a)+"px"):n!==1&&(u.d(this.s.d(),this.bd(t,r.a.a)+"px"),f.width=Math.max(0,r.c()-e)+"px");n===11?f.top=r.a.b+this.G(t,!1)+"px":n!==2&&(f.top=r.a.b+this.G(t,!1)+"px",f.height=Math.max(0,r.d()-e)+"px");u.b()},G:function(n,t){var i=n.d,r=this.s.j();return!t&&(i===1||i===4)&&r.k(3)||t&&(i===1||i===3)&&r.k(4)?0:this.s.bm()},bf:function(n,t){(n===4||n===5)&&(t.j=!1,System.a.b(t.e),t.e=[],_Ewa.a.g(t.a),t.a=null)},bk:function(n){switch(n){case 0:case 1:case 2:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 12:case 13:case 14:case 15:case 17:case 18:case 19:case 20:case 21:case 22:case 26:case 27:case 30:return!1;case 3:case 16:case 23:case 24:case 25:case 28:case 29:return!0;default:return Diag.a.b(593831569,1,!1,"GridHighlight.ShouldReplaceTopLeftWithMergedCell: HighlightDivIndex {0} was not specified, returning false",n),!1}},bd:function(n,t){return t+this.G(n,!0)+_Ewa.Z.i(n.a.parentNode,this.s.d())},K:function(n,t,i,r){var u=null,f,e;return n&&(r&&(f=this.s.bB(n),f&&f.e()&&f.e().g(n)&&(n=f)),e=n+"-"+t+"-"+i+"-"+r,u=_Ewa.v.a(this.H,e,null),u||(this.H[e]=u=this.s.z(n,t,i,!1)||_Ewa.W.a()),u.g(_Ewa.W.a())&&(u=null)),u},z:function(n,t){n&&(this.H={});!this.J&&this.br()?this.bg(t):(System.a.a(this.v),this.v=null)},bj:function(n,t,i,r){var u,s,f,e;if(!i){Diag.a.b(42541923,1,!!i,"GridHighlight.SetHighlightsVisibility: which must not be null.");return}for(r=r||[1,3,2,4],u=0,s=i.length;u<s;++u)for(var h=r,c=h.length,o=0;o<c;++o)f=h[o],e=this,this.F(function(i){i.g=n&&e.S&&e.s.j().k(f)&&e.bB(i,f);i.k=t},new _Ewa.gt.a(i[u],f));this.z(!1,!1)},bB:function(n,t){if(t===1)return!0;if(!n.b)return!1;var i=this.s.bB(n.b);return this.s.j().v(i||n.b,t)},bD:function(n,t){var f=!1,r,e;this.L.b(n);var i=n,o=this.bC(i),u=!!t&&o;u?(i.j||this.dE("ghHSAB",new _Ewa.IJ(i,i.c,i.b,u,i.d),null),r=i.l,i.m&&(i.c===1||t.a.a===r.a.a&&t.c()===r.c())&&(i.c===2||t.a.b===r.a.b&&t.d()===r.d())||(e=i.a.style,_Ewa.a.b(i.a,!0,!0),this.bi(i.c,i,e,t),i.l=t,f=!0)):i.m&&(this.bs(i.c,i,i.d),f=!0);f&&(i.m=u,i.c&&i.c!==19&&i.c!==16||i.d&&i.d!==1||this.dE("ghHC",new _Ewa.IH(i.c,i.b,u),null),i.c&&i.c!==19&&i.c!==17||(this.A=!0))},bC:function(n){var t=_Ewa.B.b(this.s.c().j());return t?n.i===t&&n.g:n.g},bs:function(n,t){_Ewa.a.b(t.a,!1,!0);this.bf(n,t)},bq:function(n){return n.k?n.k:n.g?n.c>=13&&n.c<=14?null:n.c===7||n.c===8||n.c===9||n.c===10?this.bp(n.c,n.d):this.K(n.b,n.d,!0,this.bk(n.c)):null},bp:function(n,t){var f=this.s.a(),e,o,i,u,r;if(e=f.q()===3?f.n():this.t.a(458)?f.d().c():f.a(),!e)return null;if(o=f.u(),i=this.K(o,t,!0,!1),n===7&&(!o||!i||i.g(_Ewa.W.a())))return this.K(e,t,!0,!1);if(!o||!e.n(o)||!(u=this.K(e,t,!0,!1))||!(i=u.h(i)))return null;r=null;i=new _Ewa.W(i.a.a,i.a.b,i.c()-1,i.d()-1);switch(n){case 7:(r=u.e()).b.b=i.a.b;break;case 8:(r=i.e()).a.a=u.a.a;r.b.a=i.a.a;break;case 9:(r=u.e()).a.b=i.b.b;break;case 10:(r=i.e()).a.a=i.b.a;r.b.a=u.b.a}return r},bo:function(n){n&&(System.a.b(n.e),n.e=[],_Ewa.a.g(n.a),n.a=null)},bE:function(n){n&&this.bD(n,this.bq(n))},F:function(n,t){this.w.a(n,t)},bA:function(){this.F(this.bc,null);System.a.a(this.v);this.v=null;this.A&&(this.dE("ghSHC",null,null),this.A=!1)},bg:function(n){this.v||(this.v=_Ewa.y.a().a(this.bb,50,_Ewa.m.Z,!0,!1));n&&this.v.d()},bv:function(){this.s.Y()||(this.bh(),this.z(!0,!1))},by:function(){this.z(!0,!1)},bw:function(){this.bl()},bz:function(){this.s.Y()||this.bl()},bu:function(){this.J=!0},bt:function(n,t){t.a&&(this.J=!1)},br:function(){var n=this.s,t=!!this.t.j()&&_Ewa.B.d(this.t.j())&&!!n&&!!n.h()&&n.h().g();return isNullOrUndefined(n)?(Diag.a.a(34625092,0,15,"GridHighlight.GridViewDOMFullyInitialized: gridview is null or undefined"),!1):t&&!!n.bN()},bl:function(){var t=this.s.j(),n;this.bh();this.z(!0,!1);n=this;this.F(function(i){i.g=n.w.c(new _Ewa.gt.a(i.c,1))&&t.k(i.d)},null);this.bg(!0)},bh:function(){this.s.a().Y();this.t.a(458)&&this.t.isChangeGateEnabled("OfficeVSO:4166227_MergeCellsMultipleRanges")&&!this.s.F().a()&&this.b(this.s.a().d().b()?null:this.s.a().u(),[20],!1)},bn:function(n){var t=document.createElement("div");return t.id=String.format("{0}{1}-{2}-{3}",this.T,n.c,n.d,n.f),_Ewa.a.b(t,!1,!0),this.be(n.c,n.d,t),t},bx:function(){Diag.a.b(594323397,1,this.x,"GridHighlight.OnCurrentSelectionModeChanged: handleGridSelection should be true.");this.s.a().e()!==1?this.o():this.i()}};_Ewa.gt.a=function(n,t){this.a=n;this.b=t};_Ewa.gt.a.prototype={a:0,b:0,toString:function(){return String.format("{0}-{1}",this.a,this.b)}};_Ewa.IK=function(n){this.a=n};_Ewa.IK.prototype={a:null,c:function(n,t,i){var r=new _Ewa.II(n);return r.f=i,r.d=t,r.m=!1,r.l=new _Ewa.W(-1,-1,0,0),this.b(r),r},b:function(n){n.a||(n.a=this.a(n))}};_Ewa.Nh=function(n){this.f={};this.h=n};_Ewa.Nh.prototype={h:null,b:function(n,t){return this.g(n).f(t)},a:function(n,t){if(t)this.g(t).e(n);else{var i=this;_Ewa.v.d(this.f,function(t){t.value.e(n)})}},c:function(n){var t=n.toString(),i;return(t in this.f)?(i=this.f[t],i.g()):!1},e:function(n,t){this.g(n).d(t)},d:function(){var n=this;_Ewa.v.d(this.f,function(n){n.value.d(0)})},g:function(n){var t=n.toString();return t in this.f||(this.f[t]=new _Ewa.Nh.a(n,this.h)),this.f[t]}};_Ewa.Nh.a=function(n,t){this.a=new Array(0);this.c=n;this.b=t};_Ewa.Nh.a.prototype={b:null,c:null,f:function(n){return(this.a.length||this.d(1),this.a.length<=n)?(Diag.a.b(38594588,0,!1,"HighlightStateCollection.GetSingle: There should be at least (indexInCollection + 1) items in the collection. indexInCollection = {0}, number of highlight states = {1}.",n,this.a.length),this.a[0]):this.a[n]},e:function(n){var t,i;for(this.d(Math.max(this.a.length,1)),t=0;t<this.a.length;t++)i=this.a[t],n(i)},g:function(){return this.a.length>0&&this.a[0].g},d:function(n){for(var e,r,o,u,t,h,i=this.a.length;i<n;i++)e=this.b.c(this.c.a,this.c.b,i),Array.add(this.a,e);for(r=0;r<n;r++)o=this.a[r],this.b.b(o);while(n<this.a.length){if(u=this.a.length-1,t=this.a[u],t.j&&t.e)for(var s=t.e,c=s.length,f=0;f<c;++f)h=s[f],h.dispose();t&&t.a&&t.a.parentNode&&t.a.parentNode.removeChild(t.a);Array.removeAt(this.a,u)}}};_Ewa.IE=function(n){this.a=n};_Ewa.IE.prototype={a:null,dispose:function(){System.a.a(this.a)},b:function(n,t){var i;return this.a.d().h(t)?(i=this.d(n,t,!0),i&&(i=i.h(this.d(n,t,!1)))):i=this.e(n,t),i},d:function(n,t,i){var u,f,r,e,o;return this.a.e(i?2:1),u=null,this.a.c(!0),this.a.b(t.e(),!0)&&(f=n.R(this.a.a()),f&&(r=f.a,this.a.c(!1),this.a.b(t.p(),!0)&&this.a.$$mn()&&(e=n.R(this.a.a()),e&&(o=e.b,u=i?new _Ewa.W(0,r.b,Number.MAX_VALUE,Math.max(o.b-r.b,1)):new _Ewa.W(r.a,0,Math.max(o.a-r.a,1),Number.MAX_VALUE))))),u},e:function(n,t){var r=t.f(),i,u,f;if(r.bL(this.a.d()),i=null,this.a.c(!0),u=this.c(r.e()),f=this.c(r.p()),u&&f&&(i=u.a(!1).g(r.e())||f.a(!1).g(r.p())?n.R(u).n(n.R(f)):this.b(n,r),i)){var e=t.a<=r.d?i.a.b:i.b.b,o=t.b<=r.c?i.a.a:i.b.a,s=t.d>=r.a?i.b.b:i.a.b,h=t.c>=r.b?i.b.a:i.a.a;i=new _Ewa.W(o,e,Math.max(h-o,1),Math.max(s-e,1))}return i},c:function(n){var t=null;return this.a.b(n,!0)&&(t=this.a.a()),t}};_Ewa.IF=function(){};_Ewa.IF.a=function(n,t,i){var r=new _Ewa.IE(i);try{return r.b(t,n)}finally{r&&r.dispose()}};_Ewa.Qj=function(n,t){_Ewa.Qj.initializeBase(this,[!1]);this.a=n;this.d=t;var i=this;this.a.b().c(_Ewa.bT,29,function(n){i.b=n;n.c(i)});this.c=_Ewa.ClientStringManager.a().a(1851)};_Ewa.Qj.prototype={c:null,a:null,d:null,b:null,k:function(n){this.dG("smsc",n)},j:function(n){this.dH("smsc",n)},f:function(){this.h("QuerySelectionModeLabel",null)&&this.dE("smsc",null,null)},e:function(n,t){if(n!=="QuerySelectionModeLabel")return!1;switch(this.d.K()){case 1:case 2:t.Value=this.c;break;default:t.Value=""}return!0},h:function(){return this.a.a(458)},dispose:function(){this.b&&(this.b.b(this),this.b=null);this.a=null;_Ewa.cs.prototype.dispose.call(this)}};_Ewa.LX=function(n,t,i,r,u){this.isExpandOp=t;this.outlineIndex=u;this.isRow=i;this.outlineLevel=r;this.sheetName=n};_Ewa.LX.prototype={isExpandOp:!1,isRow:!1,outlineLevel:0,outlineIndex:0,sheetName:null};_Ewa.vc=function(n){this.a=n;this.b=_Ewa.b.a(n).a();this.c=_Ewa.O.a(n)};_Ewa.vc.a=function(n){var t=_Ewa.bl.a(n).c("FOK");t||_Ewa.bl.a(n).a(new _Ewa.vc(n))};_Ewa.vc.prototype={a:null,b:null,c:null,D:function(){return _Ewa.b.a(this.a).D()},bw:function(){return _Ewa.b.a(this.a).bw()},bf:function(){return"FOK"},C:function(n,t){var i=!1;return t||(i=this.d(),i||(i=this.c.K())),i},dA:function(n){return _Ewa.a.h(this.D(),n)&&!!(this.b.e()&470)||!!_Ewa.cD.a(this.a)&&_Ewa.cD.a(this.a).e(n)},cC:function(){},bL:function(){},d:function(){var n=this.b.c().t();return n&&n.g()?this.b.c().i(n):!1}};_Ewa.Hg=function(){};_Ewa.Hg.a=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b){var k=n.a(5,b);return k.ewaControlId=n.k().q().id,k.currentObject=t.b,k.namedObjectViewData=t.a.a,k.row=i,k.column=r,k.rowCount=u,k.columnCount=f,k.paneType=o.PaneType,k.revision=s,k.previousRevision=h,k.renderingOptions=l,k.colorScheme=v,k.ecsSpreadsheetDigest=c,k.floatingObjectsOptions=a,k.prevCallTimeStamp=e,_Ewa.j.a(n,"GetFloatingObjects",k,y,p,w,132,null)};_Ewa.dj=function(n,t,i,r,u,f,e){var c,y,w,s,k,h,g,o;this.Z=Function.createDelegate(this,this.cc);this.v=Function.createDelegate(this,this.cE);this.u=Function.createDelegate(this,this.cD);this.bp=Function.createDelegate(this,this.cw);this.bq=Function.createDelegate(this,this.cx);this.by=Function.createDelegate(this,this.cG);this.bK=Function.createDelegate(this,this.cS);this.bA=Function.createDelegate(this,this.cI);this.bE=Function.createDelegate(this,this.cM);this.bu=Function.createDelegate(this,this.cA);this.bx=Function.createDelegate(this,this.cF);this.bB=Function.createDelegate(this,this.cJ);this.br=Function.createDelegate(this,this.bZ);this.J=Function.createDelegate(this,this.ca);this.bH=Function.createDelegate(this,this.cP);this.bv=Function.createDelegate(this,this.cB);this.bs=Function.createDelegate(this,this.cy);this.bC=Function.createDelegate(this,this.cK);this.bF=Function.createDelegate(this,this.cN);this.bI=Function.createDelegate(this,this.cQ);this.K=Function.createDelegate(this,this.cT);this.bw=Function.createDelegate(this,this.cC);this.bt=Function.createDelegate(this,this.cz);this.bD=Function.createDelegate(this,this.cL);this.bG=Function.createDelegate(this,this.cO);this.bJ=Function.createDelegate(this,this.cR);this.bz=Function.createDelegate(this,this.cH);this.c=n;this.a=t;this.b=t.dD;this.W=this.b.c();this.bo=r;this.bn=u;this.bm=f;this.bl=e;c=this;this.x=_Ewa.y.a().a(function(){c.c.F(c.q)},400,_Ewa.m.bU,!1,!1);this.G=_Ewa.y.a().a(this.bz,800,_Ewa.m.bT,!1,!1);y=this;_Ewa.bG.b(this.b,function(n){y.D=n.b(_Ewa.bd.b,!0)});this.r=new _Ewa.Fr(this.a,this.c);this.X=_Ewa.i.b(document.documentElement,"setPointerCapture")&&Common.c.g();for(var p=this.a.gA,nt=p.length,l=0;l<nt;++l)w=p[l],s=w.i(),Common.f.a().a("msospPointerUp",s,this.bJ),Common.f.a().a("msospPointerMove",s,this.bG),Common.f.a().a("msospPointerDown",s,this.bD),Common.i.a().a("click",s,this.bt),Common.bg.a().a(s,this.bw),this.b.isChangeGateEnabled("OfficeVSO:4106406_ShowContextualUIOnTouchEnd")&&Common.l.a().a("touchend",s,this.K);for(var b=this.a.gz,tt=b.length,a=0;a<tt;++a)k=b[a],h=k.i(),Common.f.a().a("msospPointerUp",h,this.bI),Common.f.a().a("msospPointerMove",h,this.bF),Common.f.a().a("msospPointerDown",h,this.bC),Common.i.a().a("click",h,this.bs),Common.bg.a().a(h,this.bv),this.b.isChangeGateEnabled("OfficeVSO:4106406_ShowContextualUIOnTouchEnd")&&Common.l.a().a("touchend",h,this.K);for(var d=this.a.eu,it=d.length,v=0;v<it;++v)g=d[v],o=g.i(),Common.l.a().a("touchend",o,this.K),Common.f.a().a("msospPointerUp",o,this.bH),Common.f.a().a("msospPointerMove",o,this.J),Common.i.a().a("click",o,this.br),Common.f.a().a("msospPointerDown",o,this.bB),Common.i.a().a("dblclick",o,this.bx),Common.bg.a().a(o,this.bu);Common.f.a().a("msospPointerLeave",document.documentElement,this.bE);Common.h.a().a("keyup",document.documentElement,this.bA);this.bj(i);this.bi(this.d.e());this.F=!1;this.H=this.w=null;this.W.g(this.bK);this.b.o().bz(this.by);this.a.dJ.j(this.bq);this.b.f().c(this.bp);this.bh=this.b.isChangeGateEnabled("OfficeVSO:4150986_NewSelectionOnRightClick");this.E=this.b.a(972)};_Ewa.dj.e=function(){return _Ewa.dj.b||(_Ewa.dj.b=[0,1,2,7,8,9,10])};_Ewa.dj.a=function(){return _Ewa.dj.c||(_Ewa.dj.c=[6])};_Ewa.dj.h=function(n){return n.m()?2:n.k()?1:0};_Ewa.dj.d=function(n,t){switch(n){case 16:return new _Ewa.o(t.a,1,t.a,16384,!1,!1);case 4:return new _Ewa.o(1,t.b,1048576,t.b,!1,!1);case 32:return new _Ewa.o(t.d,1,t.d,16384,!1,!1);case 8:return new _Ewa.o(1,t.c,1048576,t.c,!1,!1)}return null};_Ewa.dj.g=function(n,t,i){switch(n){case 16:return new _Ewa.o(t.a,i.b,i.d,i.c,!0,!1);case 4:return new _Ewa.o(i.a,t.b,i.d,i.c,!0,!1);case 32:return new _Ewa.o(i.a,i.b,t.d,i.c,!0,!1);case 8:return new _Ewa.o(i.a,i.b,i.d,t.c,!0,!1)}return null};_Ewa.dj.f=function(n,t,i){return t.b!==i.b&&t.c!==i.c||t.a!==i.a&&t.d!==i.d?0:n===8&&t.b!==i.b?4:n===4&&t.c!==i.c?8:n===32&&t.a!==i.a?16:n===16&&t.d!==i.d?32:0};_Ewa.dj.prototype={X:!1,b:null,W:null,x:null,G:null,d:null,e:null,F:!1,H:null,w:null,c:null,a:null,bo:null,bn:null,bm:null,bl:null,be:null,f:null,g:null,o:null,n:null,l:null,k:null,y:null,q:null,B:!1,Q:!1,A:!1,U:!1,i:null,j:null,r:null,C:!1,D:null,S:!1,Y:!1,m:!0,bh:!1,E:!1,bi:function(n){return this.e=n,this.bn(n),n},bj:function(n){return this.d=n,this.bo(n),n},cj:function(){this.d=this.b.a(458)?this.c.bd.c():this.c.a();this.e=this.c.bh;this.bk(0,0,this.e,!0)},cg:function(n,t,i,r,u,f,e,o,s){var h=this.e;this.t(n,t,0,0,r,0,0,u,0,e,o);this.a.gd(n,t,i,!f||!f.length?_Ewa.C.bc:f,h);this.s(s)},ct:function(n,t){var i,r;return this.c.bc===3?!1:(i=n.keyCode,i===16||i===17||i===91||this.a.E()?!this.a.dL.y()&&this.a.E()&&_Ewa.K.b(t,!1,!1)&&(this.c.dE("SS",null,null),this.m=!0):this.ci(),this.a.m()&&!this.a.E())?!1:(r=this.bT(n,t),r&&(this.c.W(),_Ewa.D.a(n,!0)),r)},bT:function(n,t){var f,o;try{var s=!0,i=null,u=0,e=0,h=_Ewa.z.a().b(t);switch(t){case-1470715894:this.h(0,this.a.d()?1:-1,!1);break;case 2039316657:this.p(0,this.a.d()?1:-1,!1);break;case 706199415:this.h(0,-1,!0);break;case 137938150:case-1116072751:this.h(-1,0,t===-1116072751);break;case-31900117:this.p(-1,0,!1);break;case 125627505:this.h(0,1,!0);break;case-1231471547:this.h(0,this.a.d()?-1:1,!1);break;case 589730764:this.p(0,this.a.d()?-1:1,!1);break;case-798660877:this.h(1,0,!1);break;case 267796030:this.h(1,0,!0);this.a.dX.f(!1,!1);break;case-1603798598:this.p(1,0,!1);break;case 742457698:case 747336063:var c=this.e.a,r=this.a.ej,a=c-r;if(this.bf(_Ewa.o.a(a,this.e.b,!1),0,-r)){if(!this.a.ew)return!1;r=c-Math.max(this.a.dI.b,this.a.ew.a)}if(!r)break;t===742457698?this.h(-r,0,!1):this.p(-r,0,!1);break;case 2091832999:this.h(this.a.ej,0,!1);break;case-92466282:this.p(this.a.ej,0,!1);break;case-1394648613:if(!this.a.ew)return!1;i=this.a.jb();u=20;break;case 277878202:i=this.a.eh.p();u=40;break;case-1265335143:case-844983198:return t===-1265335143&&!this.a.ew?!1:(f=t===-1265335143?this.a.jb():this.a.eh.p(),o=this.d.j()?f.f():null,f.F(this.d),e=3,this.a.dM.f(f,null,0,3,!0,"",!1,!0,!0),o&&this.a.I(o,60,h,!0,null),!0);case-653661711:i=new _Ewa.o(this.e.a,this.a.eh.b,this.e.a,this.a.eh.b,!0,!0);u=4;break;case-90551326:i=new _Ewa.o(this.d.a,this.a.eh.b,this.d.d,this.d.c,!0,!0);u=4;e=3;break;case 541421805:Diag.a.a(50665561,0,50,"ActiveRangeConstructor.HandleRibbonCommand: DrillDown");this.bV(n);break;case-569786022:Diag.a.a(50665562,0,50,"ActiveRangeConstructor.HandleRibbonCommand: DrillUp");this.bX(n);break;case 1361180227:this.cv(192,n);break;default:s=!1}return i&&this.a.o(_Ewa.f.a(i,this.b),null,null,null,u,h,e,!0,!0,null,!1,!0),s}catch(l){_Ewa.ULSError.a(l,"ActiveRangeConstructor.HandleRibbonCommand",!1);throw l;}},ck:function(n,t,i){this.c.bn=!0;this.c.bc=this.b.a(806)&&i?3:_Ewa.dj.h(this.d);switch(this.c.bc){case 0:this.i=t?this.d.e():this.d.p();break;case 3:this.i=null;break;case 1:this.i=t?this.d.e():this.d.bT();break;case 2:this.i=!(t^this.a.d())?this.d.V():this.d.e();break;default:this.i=this.d.e()}this.j=n;this.ba();this.c.dE("SS",null,null)},bP:function(n,t){var i=this.bb(n,t,0,!1,!0);return i?new _Ewa.jE(i,this.a):null},V:function(n,t,i,r,u,f){var o=this.bb(n,t,i,r,u),e;return o?(e=$$as(_Ewa.hx,o),f&&e?new _Ewa.o(e.i(),e.h(),e.i(),e.h(),!1,!1):this.cd(o,i)):null},cm:function(n,t,i){var w=new _Ewa.bP(this.b.f()),h,d,g,rt,ut,p,ft,b,r,s,et,a,k,ot;if(!w.f()){var u=null,v=null,o=0;if(t&&(o|=t<0?4:8),n&&(o|=n<0?16:32),i&&(o|=t<0?16:32),this.a.em.a()&&this.m&&(h=this.a.bC(),h)){d=this.b.K()?h.V():h.e();this.a.o(_Ewa.f.a(h,this.b),d,null,null,o,_Ewa.C.k,0,!0,!0,null,!1,!0);this.m=!1;return}var c=w.b()&&!n&&i||!w.a(1024),e=!1,l=null,y=null;i&&this.d.j()&&(l=this.a.eg.a(this.d,!1),g=n===1,e=!!l&&!_Ewa.bV.e(l,this.d)&&!g,e&&(y=this.bR(l),Diag.a.a(50665565,1,50,"ActiveRangeConstructor.Change: Performing tab Navigation within a table, table range is: {0}",y)));var f=i&&!this.d.j(),nt=this.a.dJ.e(this.e,!1),st=nt?this.d.g(nt.b()):!1;if(f=f&&!st,f||e||c){var tt=t===1||n===1,it=n?1:2,ht=!!this.g&&e&&c&&!this.g.g.g(y);!this.g||ht?(rt=f?this.d:e?y:this.a.ew,ut=e?_Ewa.bV.d(l,this.d):!1,this.g=new _Ewa.Gw(this.a,rt,it,tt,e,ut),this.g.b(this.e,!0)):(this.g.c(tt),this.g.e(it));c&&this.g.b(this.e,!0);p=this.g;ft=p.$$cu();do{if(p.$$mn())u=this.g.k();else return;b=p.$$cu()}while(c&&!b.E()&&b!==ft);v=this.g.a()}else if(this.bg(n,t,!1,o)){Diag.a.a(50665567,1,50,"ActiveRangeConstructor.Change: LoadSelectedBlocks - Jump to location vertical={0}, horizontal={1}",n,t);return}if(!f&&!c&&!e&&(r=null,s=0,n?(r=this.n,s=Math.abs(n)):t&&(r=this.o,s=Math.abs(t)),r)){if(et=r,r.c(n>0||t>0),!this.e.g(r.k())){if(!r.b(this.e,!0)){a=this.L(n,t,!1);Diag.a.a(50665569,1,50,"ActiveRangeConstructor.Change: rankOrFileEnumerator.MoveClosest failed (probably because ActiveCellInternal not in Enumerator). Jump to location Left={0}, Top={1}",a.b,a.a);this.a.o(_Ewa.f.a(a,this.b),a.e(),null,null,o,_Ewa.C.a,0,!0,!0,null,!1,!1);return}u=r.k();v=r.a()}for(!r.k()||this.e.g(r.k())||r.k().i(this.e)||this.e.i(r.k())||s--;s>0&&et.$$mn();--s)u=r.k(),v=r.a()}if(!u){Diag.a.a(50665570,1,50,"ActiveRangeConstructor.Change: unable to change by specified amount, selection likely not in loaded blocks");return}k=this.T(u,t,n);f||!k||this.a.eg.d(this.d)||(u=this.bc(n,t));this.bY(n,t,u);f&&(n=t);ot=this.a.Z(u);!ot&&u.h(this.a.O())&&(o=60);var ct=this.e,lt=f?3:0,at=f?0:1;this.t(f?this.d:u,u,n,t,lt,at,0,!e,1,!1,!1);this.a.gE(this.d,u,o,v,ct,_Ewa.C.a,k,!1);this.s(!0)}},h:function(n,t,i){var p,u,s,h,k,g,y,rt,w,r,o,ut,a,b;if(!this.b.a(871)){this.cm(n,t,i);return}if((!i||!(this.a.E()||this.a.et))&&(p=new _Ewa.bP(this.b.f()),!p.f())){if(u=null,s=null,this.a.em.a()&&this.m&&(h=this.a.bC(),h)){k=this.b.K()?h.V():h.e();this.a.o(_Ewa.f.a(h,this.b),k,null,null,60,_Ewa.C.k,0,!0,!0,null,!1,!0);this.m=!1;return}var c=!p.a(1024),f=!1,l=null,v=null,d=this.c.w(),e=i&&!d;if(i&&d&&(l=this.a.eg.a(this.d,!1),g=n===1,f=!!l&&!_Ewa.bV.e(l,this.d)&&!g,f&&(v=this.bR(l),Diag.a.a(592495962,1,50,"ActiveRangeConstructor.Change: Performing tab Navigation within a table, table range is: {0}",v))),e||f||c){var nt=t===1||n===1,tt=n?1:2,ft=!!this.f&&f&&c&&!_Ewa.f.g(this.f.g).g(v);if(!this.f||ft){var it=this.b.a(458),et=e?it?this.c.bd.a():[this.c.a()]:f?[v]:[this.a.ew],ot=e&&it?this.c.bd.f():0,st=f?_Ewa.bV.d(l,this.d):!1;this.f=new _Ewa.Ft(this.a,this.c,et,ot,tt,nt,f,st);this.f.n(this.e,!0)}else this.f.s(nt),this.f.t(tt);c&&this.f.n(this.e,!0);y=this.f;rt=y.$$cu();do{if(y.$$mn())u=this.f.r();else return;w=y.$$cu()}while(c&&!w.E()&&w!==rt);s=this.f.a()}else if(this.bg(n,t,!1,60)){Diag.a.a(592495960,1,50,"ActiveRangeConstructor.Change: LoadSelectedBlocks - Jump to location vertical={0}, horizontal={1}",n,t);return}if(!e&&!c&&!f&&(r=null,o=0,n?(r=this.n,o=Math.abs(n)):t&&(r=this.o,o=Math.abs(t)),r)){if(ut=r,r.c(n>0||t>0),!this.e.g(r.k())){if(!r.g.i(this.e)||!r.b(this.e,!0)){a=this.L(n,t,!1);Diag.a.a(592495958,1,50,"ActiveRangeConstructor.Change: rankOrFileEnumerator.MoveClosest failed (probably because ActiveCellInternal not in Enumerator). Jump to location Left={0}, Top={1}",a.b,a.a);this.a.o(_Ewa.f.a(a,this.b),a.e(),null,null,60,_Ewa.C.a,0,!0,!0,null,!1,!1);return}u=r.k();s=r.a()}for(!r.k()||this.e.g(r.k())||r.k().i(this.e)||this.e.i(r.k())||o--;o>0&&ut.$$mn();--o)u=r.k(),s=r.a()}if(!u){Diag.a.a(592495957,1,50,"ActiveRangeConstructor.Change: unable to change by specified amount, selection likely not in loaded blocks");return}b=this.T(u,t,n);e||!b||this.a.eg.d(this.d)||(u=this.bc(n,t));this.bY(n,t,u);e&&(n=t);var ht=this.e,ct=e?3:0,lt=e?0:1;this.t(e?this.d:u,u,n,t,ct,lt,0,!f,1,!1,!1);this.a.gE(this.d,u,60,s,ht,_Ewa.C.a,b,!1);this.s(!0)}},bL:function(n,t,i){var r=this.V(n,t,i,!1,!0,!1),f,u;return r||(f=this.cp(n),r=this.cU(f,i)),r&&(!this.c.bc||this.c.bc===3)&&(u=this.a.bD(),u&&(i===2?r.d=r.a=u.a:i===1&&(r.c=r.b=u.b))),r},bS:function(n){var i=this.i||this.e,t;t=new _Ewa.o(i.a,i.b,n.d,n.c,!0,!1);t=this.bN(t);this.i?this.I(t,i,!0,!1,3,1,0,0,0):this.I(t,null,!0,!1,3,1,0,0,0)},p:function(n,t,i){var c,s,l,a,p,v,y,w;this.a.dM.O(0);this.S=!0;var r=this.d.f(),h=!1,o=0,u=null,f=0,e=0;if(t?(u=this.l,o=Math.abs(t),e=t<0?4:8):n&&(u=this.k,o=Math.abs(n),e=n<0?16:32),this.bg(n,t,!0,e),u){if(c=u,u.c(n>0||t>0),f=_Ewa.dj.f(e,r,this.e),f&&(s=u.g.n(_Ewa.dj.d(f,r)))&&u.b(s,!0))for(;f&&o>0&&c.$$mn();o--)r=_Ewa.dj.g(f,u.k(),r),f=_Ewa.dj.f(e,r,this.e),h=!0;if((s=u.g.n(_Ewa.dj.d(e,r)))&&u.b(s,!0))for(;o>0&&c.$$mn();o--)r.F(u.k()),h=!0}h||f||(r=this.L(n,t,!0));l=e;a=r;f&&(l=t?12:48,a=_Ewa.dj.d(f,r));p=this.T(r,t,n);r.v();v=this.d.i(r)?2:1;y=this.cr(r);r=this.bN(r);w=this.e;i?this.I(r,null,!0,!1,3,v,y,n,t):this.t(r,null,0,0,3,v,y,!0,1,!1,!1);this.a.gE(a,null,l,null,w,_Ewa.C.Y,p,!0)},bd:function(n){return this.bO(n,1,0)},ci:function(){this.c.dE("SA",null,null);this.c.bc=-1;this.cf()},cI:function(n){return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.a.keyCode===16&&this.S)?(this.S=!1,this.s(!0),!0):!1},bN:function(n){var i,t,r,u,f;return this.c.bc!==3?n:(i=this.c.bo,i.i(n)?i:(t=n.f(),t.d=Math.max(i.d,t.d),t.c=Math.max(i.c,t.c),t.a=Math.min(i.a,t.a),t.b=Math.min(i.b,t.b),r=t.l()-i.l()>t.o()-i.o(),u=r?t.a:t.b,f=r?t.d:t.c,this.a.jO(i,u,f,r,this.F&&!this.a.eg.s(i))))},cr:function(n){return this.d.d!==n.d?2:this.d.a!==n.a?1:this.d.c!==n.c?4:this.d.b!==n.b?3:0},ch:function(n,t){var i=this.a.e(null),r=i?i.f():null;r&&_Ewa.a.f(r,n,t)},bV:function(n){this.bW(n,!1)},bX:function(n){this.bW(n,!0)},bW:function(n,t){var i,r;this.a.m()||(i=this.a.e(null),i&&(System.a.a(this.y),r=t?i.C():i.z(),this.y=_Ewa.eU.b(r?4:8,n,this.a,i.a())))},cv:function(n,t){if(!this.a.m()){var i=this.a.e(null);i&&(System.a.a(this.y),this.y=_Ewa.eU.b(n,t,this.a,i.a()))}},ba:function(){this.A||(Common.c.b()?(Common.f.a().a("msospPointerMove",window.document,this.u),Common.f.a().a("msospPointerUp",window.document,this.v)):(Common.f.a().a("msospPointerMove",document.documentElement,this.u),Common.f.a().a("msospPointerUp",document.documentElement,this.v)),this.A=!0);this.j&&(Common.l.a().a("touchmove",this.j,this.J),Common.l.a().a("touchend",this.j,this.Z));_Ewa.bW.b(this.b,!0)},cf:function(){this.A&&(Common.c.b()?(Common.f.a().b("msospPointerMove",window.document,this.u),Common.f.a().b("msospPointerUp",window.document,this.v)):(Common.f.a().b("msospPointerMove",document.documentElement,this.u),Common.f.a().b("msospPointerUp",document.documentElement,this.v)),this.A=!1);this.j&&(Common.l.a().b("touchmove",this.j,this.J),Common.l.a().b("touchend",this.j,this.Z),this.j=null);_Ewa.bW.b(this.b,!1)},cM:function(n){return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.c.bc>=4)?!1:(this.c.bc!==-1&&(this.X&&this.cV(n.h),this.O(n,this.c.bc)),!1)},cV:function(n){if(this.X&&!this.C)try{this.a.dC.setPointerCapture(n);this.C=!0}catch(t){Diag.a.a(50665603,1,10,"ActiveRangeConstructor.SetCapturePointer: Unable to capturePointer. error message : {0}.",t.message)}},cJ:function(n){return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.c.dE("PD",n,this),this.c.bc>=4)?!1:(this.a.bu(!1),_Ewa.E.b(n.b)===3)?!1:(this.N(n,n.f,this.c.bc===3?3:0),!1)},bZ:function(n){var t,i;if(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.Q)return this.Q=!1,!0;if(_Ewa.G.a(this.b).b()&&(_Ewa.p.l(this.b)||_Ewa.G.a(this.b).d("OnClick","",!1),_Ewa.U.a().q("allowedOpDuringPI",!0)),this.B)return this.ch("ewr-unclickable-hyperlink",!1),this.B=!1,!0;if(t=n.c,Sys.UI.DomElement.containsCssClass(t,"ewr-invalid-hyperlink"))return i=_Ewa.h.b(1,1,0,1282,0,-1654460915,"XLSInvalidUrlFailure"),_Ewa.G.a(this.b).c([i]),!0;if(n.b===3){if(this.P(n,0),this.b.k())return!0;_Ewa.a.n(n.c,"a")&&Common.bb.c(n.a)&&_Ewa.a.Q(n.c,n.a)}return!1},cF:function(n){var r,t,i;return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,r=this.V(n.get_clientPoint(),n.c,0,!1,!0,!1),n.b===3&&r&&!r.g(this.e))?this.bZ(n):_Ewa.G.a(this.b).b()?(Diag.a.a(50665614,1,50,"ActiveRangeConstructor.OnDoubleClick: Ignoring doubleclick event because it is not allowed in partial interactivity mode"),_Ewa.G.a(this.b).d("OnDoubleClick","",!0),!0):(this.c.dE("DC",Sys.EventArgs.Empty,this),this.x.b(),t=n.a,i=this.bP(n.get_clientPoint(),t.target),i&&(i.z()?(Diag.a.a(50665615,1,50,"ActiveRangeConstructor.OnDoubleClick: InvokeDrillDown"),this.bV(t)):i.C()?(Diag.a.a(50665616,1,50,"ActiveRangeConstructor.OnDoubleClick: InvokeDrillUp"),this.bX(t)):(this.U=!0,this.P(n,0),this.x.b(),this.a.bb(!1,1,t,!0))),!0)},cT:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.c.dE("TE",Sys.EventArgs.Empty,this),!1},cA:function(n){return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,_Ewa.G.a(this.b).b())?(Diag.a.a(50665619,1,50,"ActiveRangeConstructor.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),_Ewa.G.a(this.b).d("OnContextMenu","",!0),!0):(_Ewa.p.v(this.b)&&n.b===3&&this.a.dL.x("ActiveRangeConstructor.OnContextMenu",null),this.M(n,2,this.c.bc===3?3:0),this.c.F(this.q),!0)},cP:function(n){if(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.C)try{this.a.dC.releasePointerCapture(n.h);this.C=!1}catch(t){Diag.a.a(50665620,1,10,"ActiveRangeConstructor.OnPointerUp: Unable to releasePointer. error message : {0}.",t.message)}return this.cc(n)},cc:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.c.bc<4&&this.z(n),!1},ca:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.cb(n)},cb:function(n){return this.c.bc>=4?!1:(this.O(n,this.c.bc===3?3:0),this.c.bc!==-1)},cL:function(n){if(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,_Ewa.B.c(this.b.j())){if(n.b===3)return!1;this.N(n,n.a.button,1)}return!1},cz:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.b===3&&this.P(n,1),!1},P:function(n,t){n.b===3&&(this.a.dL.x("ActiveRangeConstructor.HandleTouchClick",null),this.M(n,0,t),_Ewa.p.j(this.a.dD)&&(t===1||t===2)&&this.c.F(_Ewa.kQ.b(n)))},M:function(n,t,i){this.N(n,t,i);this.z(n)},cR:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.b!==3&&this.z(n),!1},cO:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.b!==3&&this.O(n,1),!1},cC:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.M(n,2,1),this.c.F(this.q),!0},cK:function(n){if(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,_Ewa.B.c(this.b.j())){if(n.b===3)return!1;this.N(n,n.a.button,2)}return!1},cy:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.b===3&&this.P(n,2),!1},cB:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.M(n,2,2),this.c.F(this.q),!0},cQ:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.b!==3&&this.z(n),!1},cN:function(n){return n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,n.b!==3&&this.O(n,2),!1},z:function(n){if(this.G.b(),!(this.c.bc>=4)){if(this.c.bc===3){if(this.a.dX.b(this.d,_Ewa.dj.e(),!0),this.a.dX.b(null,_Ewa.dj.a(),!0),this.a.dX.a(_Ewa.dj.a()),!this.c.bo.i(this.d)){var t=_Ewa.e.b(n.a.type,"touchend",!0)?3:2;this.b.C(n.a.ctrlKey?1405660955:-2142700828,t,0,null)}this.a.eX.a();this.a.eX.b("default")}this.c.bc!==-1&&(_Ewa.D.a(n.a,!1),this.s(!0))}},I:function(n,t,i,r,u,f,e,o,s){var c=!n.g(this.d),h;this.t(n,t,o,s,u,f,e,!0,2,!1,!1);h=this.a.dX;this.c.bc===3&&(h.b(this.c.bo,_Ewa.dj.e(),!0),h.b(n,_Ewa.dj.a(),!0),h.c(_Ewa.dj.a(),null,null));i&&(c&&h.f(!1,!0),r&&this.a.dl(!1))},O:function(n,t){if(!(this.c.bc>=4)&&this.c.bc!==-1){var e=n.c,i=this.bL(n.get_clientPoint(),e,t),r,u,f=(u=this.cs(i,r={val:i}),i=r.val,u);f&&this.a.I(i,f,_Ewa.C.Z,!0,null);i&&(this.r.n(n.get_clientPoint()),this.bS(i,t));_Ewa.D.a(n.a,!0)}},N:function(n,t,i){var u=n.c,c=t===2,r,l,a,y,e,v,f,o,s,h,p,w;if(this.c.bk===1&&this.c.O(2),_Ewa.E.i(n),r=this.V(n.get_clientPoint(),u,i,!1,!0,!1),l=_Ewa.E.a===3&&!this.U,this.U=!1,this.B=!1,a=l&&(!this.c.bD()||!this.Y),(c||a)&&(this.q=new Common.bl(n.a,u,n.get_clientPoint(),_Ewa.E.a),r&&(y=!this.c.bG(r,this.bU(n),c,a),y))){this.Y=!0;l&&this.x.a();return}if(_Ewa.a.n(u,"input")||_Ewa.a.n(u,"button")){this.bM(u);return}if(e=_Ewa.a.bc(u,"a",!0),!e||!_Ewa.a.E(e,"onclick")||(this.bM(e),!_Ewa.e.a(e.getAttribute("_link")))){if(this.c.bc===3){this.F=this.a.eg.e(this.d);this.ba();this.a.eX.b("crosshair");return}if(v=!1,r){if(f=!t,f&&(v=!this.c.bn,this.c.bn=!0,this.c.bc=i),this.m=!1,s=null,f&&n.a.shiftKey)if(this.c.bc)if(this.c.bc===1)o=new _Ewa.o(this.e.a,1,r.a,16384,!0,!1);else if(this.c.bc===2)o=new _Ewa.o(1,this.e.b,1048576,r.b,!0,!1);else return;else o=new _Ewa.o(this.e.a,this.e.b,r.a,r.b,!0,!1);else s=o=r;f&&this.a.E()&&(_Ewa.a.f(this.a.dL.a().cm(),"ewa-gridKeyHandler-editing-textlock",!0),this.a.fo=2);_Ewa.D.a(n.a,!1);f&&this.ba();h=this.a.e(s);_Ewa.p.b(this.b)?h&&h.a().n()&&f&&this.G.a():h&&h.f()&&f&&this.G.a();this.c.dE("SS",null,null);p=!(this.a.d()&&_Ewa.a.n(u,"a"));w=s?!this.bU(n)||this.bh&&n.b===2&&n.a.button?0:1:3;this.I(o,s,p,v,w,1,0,0,0);c&&this.s(!0)}}},cH:function(){this.B=!0;this.ch("ewr-unclickable-hyperlink",!0)},s:function(n){var r,u,t,i;this.b.a(458)&&(r=this.a.bB(this.e)||this.e,u=this.bm(r),u&&(t=this.c.bd.c(),this.t(t,t.e(),0,0,5,0,0,!0,0,!1,!1)));n&&this.a.eO();this.c.bc===3&&(this.F=!1);this.r.f();this.i&&(this.b.a(806)&&this.c.bc===3&&(this.c.bc=0),this.I(this.d,this.d.e(),!0,!1,3,1,0,0,0),this.i=null);this.c.bc=-1;this.cf();i=this.E?this.b.p().a("UserAction","SelectionEndedStopwatch"):null;this.c.dE("SE",null,null);i&&i.a();_Ewa.a.f(this.a.dL.a().cm(),"ewa-gridKeyHandler-editing-textlock",!1)},cE:function(n){return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.c.bc>=4)?!1:(this.z(n),!0)},cD:function(n){return(n=_Ewa.t.a(this.b)?_Ewa.t.a(this.b).a(n):n,this.c.bc!==-1)?this.b.isChangeGateEnabled("OfficeVSO:4310476_FixedDoubleClientPointAdjustment")?this.cb(n):this.ca(n):!1},cU:function(n,t){var i=this.cl(n,t);return i?this.cd(i,t):null},cp:function(n){var t=this.a.jX();if(t){var i=Math.ceil(t.x),r=Math.ceil(t.y),u=Math.floor(t.height),f=Math.floor(t.width),e=Math.min(Math.max(i+1,n.x),i+f-1),o=Math.min(Math.max(r+1,n.y),r+u-1);return new Sys.UI.Point(e,o)}return null},cs:function(n,t){var i;if(!n)return t.val=null,0;i=this.a.dI;t.val=n.f();var s=this.a.dI.t(1),r=this.a.bC(),u=!0,f=!0;if(r&&(u=r.a>s.a,f=r.b>s.b),!i.e()||!u&&!f)return 0;var h=i.j(this.d,1),c=i.j(n,1),e=i.j(this.d,4),o=i.j(this.d,3),l=i.j(this.d,2);if(!h&&c){if(l)return t.val.a=t.val.d=i.b,t.val.b=t.val.c=i.d,60;if(e)return t.val.b=t.val.c=i.d,4;if(o)return t.val.a=t.val.d=i.b,16}var a=i.j(n,4),v=i.j(n,3),y=i.j(n,2);if(h&&!c){if(!r)return 0;if(y)return u&&(t.val.a=t.val.d=r.a),f&&(t.val.b=t.val.c=r.b),0;if(v)return u&&(t.val.a=t.val.d=r.a),0;if(a)return f&&(t.val.b=t.val.c=r.b),0}if(y)return r?(e&&u?t.val.a=t.val.d=r.a:o&&f&&(t.val.b=t.val.c=r.b),0):0;if(l){if(!e&&a)return t.val.a=t.val.d=i.b,16;if(!o&&v)return t.val.b=t.val.c=i.d,4}return 0},cl:function(n,t){return this.bb(n,null,t,!0,!0)},bb:function(n,t,i,r,u){for(var h,f,e,o,y,c,s=null,l=this.a,p=i===1?l.gA:i===2?l.gz:l.eu,v=p,w=v.length,a=0;a<w;++a)if(h=v[a],_Ewa.a.h(h.i(),t)&&u||(_Ewa.a.h(this.j,t)||r)&&Common.g.d(_Ewa.a.i(h.i()),n)){s=h;break}return!s||t===s.i()?null:(e=s.bV(n),!e)?null:(f=e.b)?(o=null,y=_Ewa.it.isInstanceOfType(f),!y&&this.a.dJ.h()?(c=this.a.dJ.s(f.a()),Diag.a.b(50665670,1,!!c,"ActiveRangeConstructor.CellFromEvent: blockModelProxy is null, hash: {0}.",f.a()),c&&(o=c.p(e.a))):o=f.i(e.a),!o)?null:o:null},cd:function(n,t){var i,r;if(t===-1||!n||(i=n.a(!1),!i))return null;if(this.c.bc!==-1&&(t=this.c.bc),!t||t===3||t>=4)r=i;else if(t===1)r=new _Ewa.o(i.a,1,i.a,16384,!1,!0);else if(t===2)r=new _Ewa.o(1,i.b,1048576,i.b,!1,!0);else return null;return r},t:function(n,t,i,r,u,f,e,o,s,h,c){var l,p,g,nt,tt,w,b;n||(n=_Ewa.o.a(1,1,!1));n=this.bO(n,f,e);this.c.bi.d(null,!0);l=t&&n.h(t)?t.e():this.e&&n.h(this.e)?null:n.e();var a=n.f(),y=new _Ewa.bP(this.b.f()),v=this.b.j(),k=!1,d=!1;!this.d||this.H!==v||(!this.d.g(a)||this.b.a(458)&&u!==3)&&y.e(a,this.a)?(this.bj(a),this.H=v,this.bl(n,l||this.e,u),this.c.bl=null,this.b.a(871)||o&&(System.a.a(this.g),this.g=null),p=this.d.n(this.a.q())||this.d,g=r<0||i<0?p.e():p.p(),this.bk(i,r,g,!1),this.Y=!1,k=!0,this.D&&(this.b.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions")?(nt=this,this.D(function(){return{SelectedRangeInternal:nt.d.toString(),InputMethod:Common.j.b.toString(s)}})):(tt=this,this.D(function(){return{SelectedRangeInternal:tt.d.toString(),inputMethod:Common.j.b.toString(s)}})))):y.e(a,this.a)||(l=this.d.e());!l||this.e&&this.e.g(t)&&this.w===v||(this.bi(l),this.c.bl=null,this.w=v,this.bk(i,r,this.e,!0),d=!0);(k||c)&&(this.b.a(871)&&o&&(System.a.a(this.f),this.f=null),w=this.E?this.b.p().a("UserAction","SelectionChangedStopwatch"):null,this.c.dE("SC",new _Ewa.yv(h),null),w&&w.a());d&&(b=this.E?this.b.p().a("UserAction","ActiveCellChangedStopwatch"):null,this.c.dE("ACC",null,null),b&&b.a());y.f()&&this.a.cm()},cw:function(){this.m=!0},bk:function(n,t,i,r){var u,f,s;r?(f=this.n,u=this.o):(f=this.k,u=this.l);var o=!n&&!t,h=!!n&&!t,e=f&&h?null:o||t<=0?new _Ewa.o(1,i.b,1048576,i.b,!1,!1):new _Ewa.o(1,i.c,1048576,i.c,!1,!1);f=this.ce(f,e);s=!!t&&!n;e=u&&s?null:o||n<=0?new _Ewa.o(i.a,1,i.a,16384,!1,!1):new _Ewa.o(i.d,1,i.d,16384,!1,!1);u=this.ce(u,e);r?(this.n=f,this.o=u,System.a.a(this.k),System.a.a(this.l),this.k=null,this.l=null):(this.k=f,this.l=u)},bY:function(n,t,i){var u=this.a.dI.n,s=!!i&&i.j()&&u!==1&&u!==2&&this.b.c().z(),r,f,e,o;s&&(r=Math.abs(n)===1&&!t,f=Math.abs(t)===1&&!n,(r||f)&&(r?(e="vertical",o=n>0?"down":"up"):(e="horizontal",o=t>0?"right":"left")))},bg:function(n,t,i,r){var u=this.L(n,t,i),h,e;if(i&&this.bf(u,t,n))return!1;var s=this.a.dI,p=s.c(this.d),f=s.c(u),a=this.a.n(f),o=a.q();if(!o||f===2||n&&f===3||t&&f===4||(h=o.n(u),u.g(h))||(e=this.a.ew,u.b<e.b||u.c>e.c||u.a<e.a||u.d>e.d)||!this.a.dP)return!1;var c=this.a.dP.a,l=this.a.dU.a,v=u.d>o.d,y=u.c>o.c&&f!==2&&f!==4;return this.a.eS&&(n>0&&v&&c.Y===l.Y||t>0&&y&&c.X===l.X)&&this.a.ii(Math.ceil(t/this.a.ei),Math.ceil(n/this.a.ej)),i||this.a.o(_Ewa.f.a(u,this.b),u.e(),null,null,r,_Ewa.C.ba,0,!0,!0,null,!1,!0),!0},L:function(n,t,i){var u=this.a.dI,r,f,e;return i?(r=this.d.f(),r.b=r.b+(t<0?t:0),r.c=r.c+(t>0?t:0),r.a=r.a+(n<0?n:0),r.d=r.d+(n>0?n:0),this.T(r,t,n)?r=this.bc(n,t):(r.b=Math.max(r.b,u.f),r.a=Math.max(r.a,u.g))):(f=this.e.a+n,f>=u.g+u.i&&f<=u.b&&this.a.jg(3,u.g)&&(f=n>0?u.b:u.g+u.i-1),e=this.e.b+t,e>=u.f+u.h&&e<=u.d&&this.a.jg(4,u.f)&&(e=t>0?u.d:u.f+u.h-1),f=Math.max(f,this.a.ja(!0)),e=Math.max(e,this.a.ja(!1)),r=new _Ewa.o(f,e,f,e,!0,!1)),r},cS:function(n,t){this.r.f();this.W.a()||t&&t.a||(this.bj(_Ewa.o.a(1,1,!1)),this.bi(this.d.e()),this.H=this.w=null,this.c.bc=-1,this.a.dX.r(),this.co())},cG:function(){this.r.f()},co:function(){System.a.b([this.f,this.g,this.o,this.n,this.l,this.k]);this.f=null;this.g=null;this.o=this.n=null;this.l=this.k=null},ce:function(n,t){return n&&(!t||t.g(n.g))||(System.a.a(n),n=new _Ewa.dB("ActiveRangeConstructor.RebuildEnumeratorIfChanged",this.a,t,t.k()?1:2,!0)),n},bM:function(n){Common.c.a()&&n&&!_Ewa.hD.a(_Ewa.hD,n)&&(System.a.a(this.be),this.be=new _Ewa.wi(n))},bf:function(n,t,i){var r=this.a.dI;return r.c(this.d.p())!==r.c(n.p())&&r.c(this.d.e())!==r.c(n.e())&&(!!i&&!!this.a.ef()||!!t&&!!this.a.el())},T:function(n,t,i){var r=this.a.dI.c(n.p());return t&&(r===2||r===4)||i&&r===3?!1:this.bf(n,t,i)},bc:function(n,t){var i=n?this.a.dI.b:this.d.d+n,r=t?this.a.dI.d:this.d.c+t,u=this.d.a===this.d.d?i:this.d.a,f=this.d.b===this.d.c?r:this.d.b;return new _Ewa.o(u,f,i,r,!1,!1)},bO:function(n,t,i){if(this.c.bc!==-1&&this.c.bc||!t)return n;var r=n.f();return t===1?r=this.bQ(n):i&&(r=this.cq(n,i)),r.v(),r},bQ:function(n){var i,t=n.f();do i=t,t=this.cu(i);while(!t.g(i));return t},cq:function(n,t){var r,i=n.f();do r=i,i=this.cn(r,t);while(!i.g(r));return i.v(),this.bQ(i)},cu:function(n){var t=n.f();return t=this.R(1,t),t=this.R(3,t),t.a!==t.d&&(t=this.R(2,t)),t.b!==t.c&&(t=this.R(4,t)),t},R:function(n,t){var u=t.f(),r=t.f(),i;r.bH(n,r.C(n));i=new _Ewa.dB("ActiveRangeConstructor.IncreaseMergeCellsSelectionOnEdge",this.a,r,2,!0);try{while(i.$$mn())u.F(i.a().b())}finally{i&&i.dispose()}return u},cn:function(n,t){var u=n.f(),o=t===1||t===3?1:-1,f=n.f(),r,i,e;f.bH(t,f.C(t));r=new _Ewa.dB("ActiveRangeConstructor.DecreaseMergeCellsSelection",this.a,f,2,!0);try{while(r.$$mn())i=r.a().b(),!n.i(i)&&u.h(i)&&(e=Math.min(Math.max(i.bt(t)+o,1),t===3||t===4?i.r:i.s),u.X(t,e))}finally{r&&r.dispose()}return u},bR:function(n){var t=_Ewa.bV.d(n,this.d);return _Ewa.bV.a(n,t)},cx:function(){this.b.a(871)?this.f&&this.f.q():this.g&&this.g.P()},bU:function(n){return n.i()||Common.c.e()&&_Ewa.D.b(n.a)}};_Ewa.Fo=function(n){this.H=Function.createDelegate(this,this.O);this.D=Function.createDelegate(this,this.P);this.A=Function.createDelegate(this,this.M);this.C=Function.createDelegate(this,this.N);this.E=Function.createDelegate(this,this.Q);_Ewa.Fo.initializeBase(this,[n.a().cm(),null]);this.a=n;this.c=this.a.S.c();this.a.c(this.E);this.a.f(this.C);this.a.r(this.A);this.c.a(120)&&this.a.S.b()&&this.a.S.b().y(this.D);this.dK().a("keypress",this.H,!1);this.q=!1;this.v=this.c.isChangeGateEnabled("OfficeVSO:3556055_DirectionFixes1");this.p=this.c.isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled");this.o=_Ewa.p.g(this.c)};_Ewa.Fo.prototype={a:null,c:null,b:null,n:null,F:null,k:!1,m:!1,s:!1,d:0,h:0,f:0,g:0,l:!1,t:null,x:null,i:null,y:!1,z:!1,v:!1,p:!1,o:!1,w:!1,u:0,j:0,e:null,q:!1,r:function(){return this.c.isChangeGateEnabled("OfficeVSO:4310310_UpdateEditedCellProxyOnlyWhenEditedCellIsInViewport")&&this.w&&(this.n&&this.e&&this.a.S&&(this.n=this.a.S.b().e(this.e.p(),!1)),this.w=!1),this.n},dispose:function(){this.a&&(this.a.d(this.E),this.a.g(this.C),this.a.t(this.A),this.c&&this.c.a(120)&&this.a.S&&this.a.S.b()&&this.a.S.b().D(this.D));System.a.a(this.t);_Ewa.a.g(this.b);this.b=null;this.a=null;this.c=null;_Ewa.hD.prototype.dispose.call(this)},I:function(n,t,i){var r=this.a.S,u,nt,a,e,v,tt,y,o,l,f,it,p,ut,c,s,h,b,k,d,g;if(n?this.i=null:(this.n=r.b().e(this.e.p(),!1),this.F=r.bd(this.e.p()),u=this.a.S.e(this.e.p()),Diag.a.b(17880521,0,!!u,"AdjustableDimensionsEditBoxBehavior.CalculateMaximumClippingExtents: Expected editedFormattedCell not to be null."),this.v&&t?(nt=this.a.bu?this.a.bu===3:i,this.m=!!(r.d()^nt),this.k=u.P()):u?(this.m=this.v?u.h()?r.d():u.bl(r.d()):u.bl(r.d()),this.k=u.P(),this.s=_Ewa.e.a(_Ewa.bR.b(u.a(),r.d()))):this.m=this.k=this.s=!1),this.a.U){if(a=r.c().q(),e=r.d(),!this.i||this.q){if(this.c.a(778)&&this.c.isChangeGateEnabled("OfficeVSO:4265763_FixTextBoxMisalignmentInZoomWithRTL")?(this.i=_Ewa.i.d(r.i(),r.i().offsetParent,e,this.p,!1,!1),this.i&&(v=_Ewa.i.d(r.i().offsetParent,this.dC.parentNode,e,this.p,!1,!1),v&&(this.i.y+=v.y))):this.i=_Ewa.i.d(r.i(),a,e,this.p,!1,!1),!this.i){Diag.a.a(18213086,0,10,"sheetContentDivLocation cannot be null");return}tt=e?!r.bc().c():r.bc().c();r.bc().b()&&tt&&(this.i.x-=_Ewa.Z.a());this.q=!1}y=r.h().a();o=r.j();l=this.c.a(778)&&this.c.isChangeGateEnabled("OfficeVSO:4265763_FixTextBoxMisalignmentInZoomWithRTL")?_Ewa.i.d(this.dC,this.dC.offsetParent,e,this.p,!1,this.c.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")):_Ewa.i.d(this.dC,a,e,this.p,!1,this.c.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash"));f=this.dC.currentStyle;this.c.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")&&(Diag.a.b(593807563,0,!!this.i,"AdjustableDimensionsEditBoxBehavior.CalculateMaximumClippingExtents: Expected this.sheetContentDivLocation not to be null."),Diag.a.b(593807562,0,!!l,"AdjustableDimensionsEditBoxBehavior.CalculateMaximumClippingExtents: Expected textBoxLocation not to be null."));var ft=this.i.y,et=l.y,ot=ft+y.d()+r.j().a.b-et-parseInt(f.borderTopWidth)-parseInt(f.borderBottomWidth)-parseInt(f.paddingTop)-parseInt(f.paddingBottom);this.j=Math.max(1,ot);it=this.e.c;p=o.a.a>0;this.l=p&&it<o.d;var rt=this.i.x>o.a.a?this.i.x-o.a.a:this.i.x,w=rt+o.a.a,st=w+y.c();this.h=this.l?w:st;this.d=this.l||!p?rt:w;ut=this.F.bs()-(this.l?0:_Ewa.Z.c(r.i(),r.d(),r.bi()));this.f=this.r().E()+this.d+ut;this.g=this.f+this.r().e();this.c.a(745)&&(c=this.c.v().l(),s=c?c.c():null,s&&s.length>1&&(h=s[r.d()?1:0],b=Common.g.d(new Sys.UI.Bounds(h.x,h.y,h.width,h.height),Common.g.h(this.dC)),c.b()==="DP"?b?(k=Math.min(this.h,h.width),k-this.f>=this.r().e()&&(this.h=k)):(d=Math.max(this.d,s[1].x),this.g-d>=this.r().e()&&(this.d=d)):c.b()==="DL"&&b&&(g=s[1].y+r.j().a.b-l.y-parseInt(f.borderTopWidth)-parseInt(f.borderBottomWidth)-parseInt(f.paddingTop)-parseInt(f.paddingBottom),g>=this.r().g()&&(this.j=g))));this.a.br&&(this.d=Math.max(this.d,this.f),this.h=Math.min(this.h,this.g));this.u=this.K();this.b.parentNode.style.width=this.b.style.maxWidth=this.u+"px";this.b.style.maxHeight=this.j+"px"}},G:function(n,t){var o,rt,ut,st,lt,d,g,nt,at,e,c,f,l,vt,a,yt;if(t?o=t:this.z?(o=this.a.bM,this.z=!1):o=this.a.b(),System.a.a(this.t),this.t=null,n||this.a.U&&this.x!==o){if(!this.b){this.y||Diag.a.a(40777093,0,15,"AdjustableDimensionsEditBoxBehavior.UpdateDimensions UpdateDimensions was called before OnStartEdit");return}this.o?this.b.innerHTML=this.a.a().g().innerHTML:this.b.innerText=this.x=o;var tt=new _Ewa.hG(this.dC.style),s=tt.a,b=this.g-this.f;isNaN(b)&&(b=1);var u=this.a.S,it=0,pt=this.d!==this.f||this.h!==this.g;if(n||pt){it=Math.max(this.a.bn,this.b.offsetWidth+5);var h=it-b,i=this.g,r=this.f;h>0&&(this.k?(i=this.g+h/2,r=this.f-h/2):this.m||this.s&&u.d()?(i=this.g,r=this.f-h):(i=this.g+h,r=this.f));i>this.h&&(rt=i-this.h,i=this.h,this.k&&(r+=rt));r<this.d&&(ut=this.d-r,r=this.d,this.k&&(i-=ut));var v=r,y=i,p=2,ft=this.l?0:_Ewa.Z.c(u.dC,u.d(),u.el());if(this.f!==r&&r!==this.d){var et=new _Ewa.M(r-this.d-p,parseInt(this.dC.style.top)),ot=u.gK(et,!0,this.l),k=u.gC(et,ot,!0);k||Diag.a.a(17880522,0,15,"Expected startCell not to be null.");k&&(st=ot.bs()-ft,v=this.d+k.E()+st,v=Math.max(v,this.d))}if(this.g!==i&&i!==this.h){var ht=new _Ewa.M(i-this.d-p,parseInt(this.dC.style.top)),ct=u.gK(ht,!0,this.l),w=u.gC(ht,ct,!0);w||Diag.a.a(17880523,0,15,"Expected endCell not to be null.");w&&(lt=ct.bs()-ft,y=this.d+w.E()+w.p()+lt,y=Math.min(y,this.h))}d=Math.max(r-v,0);g=Math.max(y-i,0);this.k?(nt=Math.min(d,g),r-=nt,i+=nt):this.m||this.s&&u.d()?r-=d:i+=g;this.f=r;this.g=i;at=Math.max(i-r-1,1);s.width=at+"px";this.dC.style.right?s.right=this.f-p+"px":this.dC.style.left&&(s.left=this.f-p+"px")}if(e=parseInt(this.dC.style.height),isNaN(e)&&(e=1),(n||e!==this.j)&&(c=this.L(),c!==e)){for(f=e;f>c&&this.e.l()>1;){for(l=null;!l&&this.e.l()>1;)l=u.dJ.e(this.e.p(),!1),(vt=this.e).d=vt.d-1;f-=l?l.q():0}while(f<c&&u.q().d>this.e.d){for(a=null;!a&&u.q().d>this.e.d;)(yt=this.e).d=yt.d+1,a=u.dJ.e(this.e.p(),!1);f+=a?a.q():0}f=Math.min(this.j,f);s.height=f+"px";c===this.j&&Common.c.b()&&(s.overflow=this.b.style.overflow="auto")}tt.b();this.a.ds(new Sys.EventArgs)}},L:function(){var n,t,i;return this.o?n=this.b.offsetHeight:(t=_Ewa.a.H(this.b),i=t.endsWith("\n"),i&&_Ewa.a.R(this.b,Common.bC.a(this.b)+"."),n=this.b.offsetHeight,i&&_Ewa.a.R(this.b,t)),Math.min(this.j,Math.max(this.a.bw,n))},K:function(){var n,r=this.a.S.d(),t,i;return this.k?(t=this.f-this.d,i=this.h-this.g,n=Math.min(i,t)*2+this.r().e()):n=this.m||this.s&&r?this.g-this.d:this.h-this.f,this.a.br&&(n=Math.min(this.a.bn,n)),Math.max(n,1)},Q:function(n,t){if(this.y=!0,!this.b){var i=document.createElement("div");i.className="ewa-gridKeyHandlerWidthCalculator";document.body.appendChild(i);this.b=document.createElement("div");this.o||(this.b.className="ewa-gridKeyHandlerWidthCalculatorInner");i.appendChild(this.b)}Common.c.b()&&(this.dC.style.overflow="auto");this.o?this.b.className=this.a.a().g().className:_Ewa.bR.e(t.a.a(),this.b.style).b();this.z=t.b&&t.a.l();this.I(!1,t.b,t.c!=null?t.c:!1)},N:function(){if(this.u=this.j=1,!this.b){this.y||Diag.a.a(40777094,0,15,"AdjustableDimensionsEditBoxBehavior.OnEndEdit OnEndEdit called before OnStartEdit");return}this.o?(this.b.innerHTML="",this.b.className=""):(this.b.innerText=this.x="",this.b.style.cssText="");this.c.isChangeGateEnabled("OfficeVSO:4256006_AdjustableDimensionsAvoidClearingStyle")||(this.dC.style.cssText="")},O:function(){this.J()},M:function(){this.J()},P:function(){this.c.isChangeGateEnabled("OfficeVSO:4310310_UpdateEditedCellProxyOnlyWhenEditedCellIsInViewport")?this.w=!0:this.n&&this.e&&this.a.S&&(this.n=this.a.S.b().e(this.e.p(),!1))},J:function(){if(!this.t){var n=this;this.t=_Ewa.y.a().a(function(){n.G(!1,null);_Ewa.bH.a().g("StartEdit",1)},1,_Ewa.m.l,!0,!1)}}};_Ewa.tW=function(n,t,i){this.g=Function.createDelegate(this,this.m);this.h=Function.createDelegate(this,this.n);this.i=Function.createDelegate(this,this.o);_Ewa.tW.initializeBase(this,[t,i,null]);this.d=n};_Ewa.tW.prototype={d:null,a:function(n){switch(n){case 2:return this.i;case 4:return this.h;case 8:return this.g;default:return _Ewa.fZ.prototype.a.call(this,n)}},o:function(n){this.d.m()&&this.d.bh()!==2?n.stopPropagation():_Ewa.D.a(n,!0)},n:function(n){isNullOrUndefined(n.target.tagName)||n.target.tagName.toUpperCase()!=="IMG"||n.preventDefault()},m:function(n){isNullOrUndefined(n.target.tagName)||n.target.tagName.toUpperCase()!=="A"||n.preventDefault()}};_Ewa.hv=function(n,t){this.p=Function.createDelegate(this,this.T);this.u=Function.createDelegate(this,this.ba);this.t=Function.createDelegate(this,this.Y);this.s=Function.createDelegate(this,this.X);this.o=Function.createDelegate(this,this.S);this.e=n;this.d=t;var i=this;this.d.c().b().c(_Ewa.fe,291,function(n){i.m=n});this.d.c().isChangeGateEnabled("OfficeVSO:4077038_SyntheticSessionsInXLFPSChangeGate")&&Common.a.f&&Common.a.f.IsSynthetic&&(this.r=Common.a.f.IsSynthetic==="True");this.l=t.bQ();this.l.a(this.o)};_Ewa.hv.f=function(n){for(var t=0,i=n.$$lge(),r;i.$$mn();)r=i.$$cu(),t+=r;return t};_Ewa.hv.g=function(n){var i=new _Ewa.xX,u,r,t;for(i.performance=[],i.succeeded=!0,u=n.$$lge();u.$$mn();){for(r=u.$$cu(),t=0;t<r.performance.length;t++)i.performance[t]?i.performance[t]+=r.performance[t]:i.performance[t]=r.performance[t];Diag.a.b(592044625,0,r.succeeded,"GetTotalRenderResultFromList - unexpected failed result. Message: {0}",r.message)}return i};_Ewa.hv.e=function(n){return _Ewa.hv.c(n,_Ewa.hv.b)};_Ewa.hv.c=function(n,t){var i=Math.floor(t.a.a+n.startOffsetX),r=Math.floor(t.a.b+n.startOffsetY),u=Math.ceil(n.endOffsetX-n.startOffsetX),f=Math.ceil(n.endOffsetY-n.startOffsetY);return new _Ewa.W(i,r,u,f)};_Ewa.hv.prototype={d:null,e:null,g:null,f:null,m:null,n:null,l:null,r:!1,q:!1,i:null,h:!1,j:!1,b:function(){return"CanvasGridViewBlockRenderer"},c:function(){this.C(!1);this.d.c().a(843)&&this.V()},a:function(){this.C(!0)},dispose:function(){this.d.c().isChangeGateEnabled("OfficeVSO:4241443_DisposeSkeletonCanvasElements")&&this.q&&this.K();this.k();this.l.b(this.o);this.i=null},K:function(){for(var i=this.i,n=i.getElementsByTagName("canvas"),u=n.length,r,t;n.length>0;)r=n[0],_Ewa.a.U(r,i);t=this.d.b().a(this.e.W);t&&t.bo(u,0)},C:function(n){this.d.c().a(115)&&this.e.dC&&_Ewa.a.I(this.e.dC);this.D(n);this.bh(n)},V:function(){this.d.c().c().i()?this.B():this.d.c().c().n(this.s)},X:function(){this.B()},B:function(){var n=this.d.b().a(this.e.W);if(!n){Diag.a.a(592843147,1,15,"CanvasGridViewBlockRenderer.RegisterActionOnFontLoad: gridBlockCacheItem is null");return}if(!this.g){Diag.a.a(592843146,1,15,"CanvasGridViewBlockRenderer.RegisterActionOnFontLoad: gridBlockModel is null");return}gridRenderer.GridBlockRendererGlobals.registerActionOnFontLoad(this.g,this.t,this.u)},bb:function(){if(this.d.c().isChangeGateEnabled("OfficeVSO:4313937_SetDirtyOnFontLoadingSuccess")){var n=this.d.b().a(this.e.W).a();n&&n.setDirty()}this.d.cl()},ba:function(n){Diag.a.a(592843145,1,15,String.format("CanvasGridViewBlockRenderer.OnFontLoadingFailed: Font Loading failed for '{0}'",_Ewa.i.X(n)))},bc:function(){this.n=this.d.c().p().a("LoadResource","FontLoad");_Ewa.z.a().c(this.n.c(),this.e.bn,_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0)},Z:function(){this.n.a()},Y:function(n){switch(n){case 0:this.bc();break;case 1:this.bb();break;case 2:this.Z()}},D:function(n){var t,r;try{if(isNullOrUndefined(this.d.V()))throw Error.create("CachedDevicePixelRatio is NullOrUndefined");if(isNaN(this.d.V()))throw Error.create("CachedDevicePixelRatio is NaN");if(t=this.d.b().a(this.e.W),t||(n?Diag.a.a(591155847,1,15,"CanvasGridViewBlockRenderer.RenderOnCanvas: gridBlockCacheItem is null"):Diag.a.a(40186186,1,15,"CanvasGridViewBlockRenderer.RenderOnCanvas: gridBlockCacheItem is null")),r=(n?this.e.be:t.n).GridBlockModel,!r)throw Error.invalidOperation(String.format("CanvasGridViewBlockRenderer.RenderOnCanvas: model is null, hash: '{0}', state: '{1}', isSkeletonMode: '{2}'",this.e.W,t.q,n));this.q=n;this.w(t,n)?(this.v(t.w.a),Diag.a.a(41283858,1,50,"Block was rendered in canvas from cache, hash: {0}",this.e.W),this.d.b().u().b()):this.bg(t,n);Diag.a.a(40130705,1,50,"Block was rendered in canvas, hash: {0}",this.e.W);this.d.b().u().a()}catch(i){this.F(i.toString())?this.G():(n?Diag.a.b(591155846,0,!1,"Exception during RenderOnCanvas of block {0}, Falling back to Html. Exception: {1}.",this.e.W,i):(Diag.a.b(40413318,0,!1,"Exception during RenderOnCanvas of block {0}, RenderingState = {1}, Falling back to Html. Exception: {2}.",this.e.W,this.d.b().i(),i),this.d.b().i()||_Ewa.U.a().a("CanvasRenderFailed")),this.d.b().k("CanvasGridViewBlockRenderer:RenderOnCanvas(): rendering exception",!1));this.d.b().u().c()}},w:function(n,t){var u,f,e,i,o,s,h,c,r,l;return t?!1:(u=!!n&&!!n.w&&!!n.w.a,!u)?!1:(f=n.w.c,!f)?!1:(e=n.w.d===this.d.V(),!e)?!1:(i=this.d.c(),o=i.a(778)?n.w.h===_Ewa.t.a(this.d.c()).b():!0,!o)?!1:(s=n.q!==5,h=n.q===5&&n.w.g===this.e.o(),!(s||h))?!1:(c=n.bu(),c)?!1:Common.c.a()?!1:i.a(115)&&n.w.e&&(r=this.R(),l=!!r&&n.w.f.f(r),!l)?!1:!0},bg:function(n,t){this.L();var i=this,r=function(r){var e=new($$sc.u.$$(_Ewa.xX)),o=new($$sc.u.$$(Number)),l=(t?i.e.be:n.n).GridBlockModel,s,h,f,c,a,v,y;for(i.be(l),s=i.P(n,r,l),i.bf(t,n.B,n.E),h=s.$$lge();h.$$mn();)if(f=h.$$cu(),!i.h||f.a){var u=null,p=gridRenderer.GridBlockRendererFactoryGlobal.getGridBlockRenderer(),w=f.c;if(i.f.renderingRegion=f.b,c=_Ewa.i.z(function(){u=p.renderBlock(w,i.g,i.f)}),u&&u.succeeded)o.b(c),e.b(u);else{u&&i.F(u.message)?i.G():(t?Diag.a.b(591155845,0,!1,"RenderOnCanvas RenderBlock failed, Falling back to Html. block {0}, Message: {1}.",i.e.W,u?u.message:"renderResult == null"):Diag.a.b(40413317,0,!1,"RenderOnCanvas RenderBlock failed, Falling back to Html. block {0}, Message: {1}.",i.e.W,u?u.message:"renderResult == null"),i.d.b().k("CanvasGridViewBlockRenderer:RenderOnCanvas(): renderResult failure",!1),i.d.c().isChangeGateEnabled("OfficeVSO:4259589_StopRenderingSkeletonBlocksOnError")&&i.bi(u.message)&&(Diag.a.a(590725910,0,15,"Stopping to render skeleton blocks"),i.d.b().bv(!1)));i.d.b().i()||_Ewa.U.a().a("CanvasRenderFailed");i.A(u,c,t?0:n.n.NonEmptyCellsCount,t?0:n.n.TextValueCellsCount,null,null,t);return}}i.v(r);i.d.c().a(115)&&i.U();Common.c.a()||t||(a=i.N(s),i.J(n,a));v=_Ewa.hv.f(o);y=_Ewa.hv.g(e);i.A(y,v,t?0:n.n.NonEmptyCellsCount,t?0:n.n.TextValueCellsCount,o,e,t)};_Ewa.z.a().c(this.e.cb(this.e.W,this.i,r,this.d.c().p(),this.b()),this.e.bn,_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0)},F:function(n){var r;if(!(!n||!n.length)&&this.d.c().isChangeGateEnabled("OfficeVSO:4243868_DisplayErrorDialogOnIERenderingError")&&Common.c.a())for(var i=["Not enough storage","Not enough memory resources are available to","The GPU device instance has been suspended","Unexpected call to method or property access","CachedDevicePixelRatio","Could not complete the operation due to error 887","Object doesn't support property or method","Not enough storage","Out of memory","Det finns inte tillr\u00e4ckligt med utrymme","Otillr\u00e4ckligt med ledigt minne f\u00f6r att slutf\u00f6ra den h\u00e4r \u00e5tg\u00e4rden","Det er ikke nok plass til \u00e5 fullf\u00f8re denne operasjonen","Ikke nok minneressurser tilgjengelig for \u00e5 fullf\u00f8re denne operasjonen","Ei riitt\u00e4v\u00e4sti muistiresursseja toiminnon suorittamisee","S\u00e4il\u00f6 ei riit\u00e4 toiminnon suorittamiseen","Der er ikke tilstr\u00e6kkelig lagerplads til at udf\u00f8re denne handling","Der er ikke tilstr\u00e6kkelig tilg\u00e6ngelig hukommelse til at fuldf\u00f8re denne handling","Onvoldoende opslagruimte beschikbaar om deze bewerking te voltooien","Onvoldoende geheugenbronnen beschikbaar om deze opdracht te voltooien","Onvoldoende geheugen","F\u00fcr diesen Vorgang ist nicht gen\u00fcgend Speicher verf\u00fcgbar","F\u00fcr diesen Vorgang sind nicht gen\u00fcgend Speicherressourcen verf\u00fcgbar","\u3053\u306e\u64cd\u4f5c\u3092\u5b8c\u4e86\u3059\u308b\u306e\u306b\u5341\u5206\u306a\u8a18\u61b6\u57df\u304c\u3042\u308a\u307e\u305b\u3093","\u3053\u306e\u64cd\u4f5c\u3092\u5b8c\u4e86\u3059\u308b\u305f\u3081\u306e\u5341\u5206\u306a\u8a18\u61b6\u57df\u304c\u3042\u308a\u307e\u305b\u3093","\u30e1\u30e2\u30ea \u30ea\u30bd\u30fc\u30b9\u304c\u4e0d\u8db3\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u3053\u306e\u64cd\u4f5c\u3092\u5b8c\u4e86\u3067\u304d\u307e\u305b\u3093","\u5b58\u653e\u88dd\u7f6e\u7a7a\u9593\u4e0d\u8db3\uff0c\u7121\u6cd5\u5b8c\u6210\u6b64\u64cd\u4f5c","\uc0ac\uc6a9 \uac00\ub2a5\ud55c \uc800\uc7a5\uc18c\uac00 \ubd80\uc871\ud558\uc5ec \uc774 \uc791\uc5c5\uc744 \ub9c8\uce60 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","\uba54\ubaa8\ub9ac \ub9ac\uc18c\uc2a4\uac00 \ubd80\uc871\ud558\uae30 \ub54c\ubb38\uc5d0 \uc774 \uc791\uc5c5\uc744 \uc644\ub8cc\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4","Espa\u00e7o insuficiente de armazenamento para concluir a opera\u00e7\u00e3o","Recursos de mem\u00f3ria insuficientes dispon\u00edveis para concluir a opera\u00e7\u00e3o","N\u00e3o existem recursos de mem\u00f3ria suficientes para concluir esta opera\u00e7\u00e3o",'Memoria disponibile insufficiente per completare l"operazione','Le risorse di memoria disponibili insufficienti per completare l"operazione',"Les ressources m\u00e9moire disponibles sont insuffisantes pour ex\u00e9cuter cette op\u00e9ration","M\u00e9moire insuffisante.","M\u00e9moire insuffisante pour cette op\u00e9ration","No hay suficientes recursos de memoria disponibles para completar esta operaci\u00f3n","Memoria insuficiente","Espacio de almacenamiento insuficiente para","\u0394\u03b5\u03bd \u03c5\u03c0\u03ac\u03c1\u03c7\u03b5\u03b9 \u03b1\u03c1\u03ba\u03b5\u03c4\u03cc\u03c2 \u03b4\u03b9\u03b1\u03b8\u03ad\u03c3\u03b9\u03bc\u03bf\u03c2 \u03b1\u03c0\u03bf\u03b8\u03b7\u03ba\u03b5\u03c5\u03c4\u03b9\u03ba\u03cc\u03c2 \u03c7\u03ce\u03c1\u03bf\u03c2 \u03b3\u03b9\u03b1","W magazynie brak miejsca dla wykonania tej operacji","Za ma\u0142o zasob\u00f3w pami\u0119ci, aby mo\u017cna by\u0142o zako\u0144czy\u0107 t\u0119 operacj\u0119","\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u043f\u0430\u043c\u044f\u0442\u0438 \u0434\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438","\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u043e\u0447\u043d\u043e \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043f\u0430\u043c\u044f\u0442\u0438 \u0434\u043b\u044f \u0437\u0430\u0432\u0435\u0440\u0448\u0435\u043d\u0438\u044f \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0438","Pro dokon\u010den\u00ed operace nen\u00ed dostate\u010dn\u00fd prostor","K dokon\u010den\u00ed t\u00e9to operace nen\u00ed dost pam\u011b\u0165ov\u00fdch prost\u0159edk\u016f","operace nen\u00ed dost","N\u00e3o existe mem\u00f3ria suficiente para concluir esta opera\u00e7\u00e3o","Nedostatok ukladacieho priestoru pre vykonanie oper\u00e1cie","Nedostatok ukladacieho priestoru pre vykonanie oper\u00e1cie","Nema dovoljno mjesta za pohranu da bi se dovr\u0161ila ta operacija","Kev\u00e9s a mem\u00f3ria","Nincs el\u00e9g szabad mem\u00f3ria a m\u0171velet befejez\u00e9s\u00e9hez","Bu i\u015flemi tamamlamak i\u00e7in","\u5b58\u50a8\u7a7a\u95f4\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5b8c\u6210\u6b64\u64cd\u4f5c","\u5b58\u50a8\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5b8c\u6210\u6b64\u64cd\u4f5c","\u5185\u5b58\u8d44\u6e90\u4e0d\u8db3\uff0c\u65e0\u6cd5\u5b8c\u6210\u6b64\u64cd\u4f5c","\u30e1\u30e2\u30ea\u304c\u4e0d\u8db3\u3057\u3066\u3044\u307e\u3059","\u041d\u0435\u0434\u043e\u0441\u0442\u0430\u0442\u044a\u0447\u043d\u043e \u043d\u0430\u043b\u0438\u0447\u043d\u0430 \u043f\u0430\u043c\u0435\u0442 \u0437\u0430 \u0438\u0437\u043f\u044a\u043b\u043d\u0435\u043d\u0438\u0435 \u043d\u0430 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u044f\u0442\u0430","fillTextUnclipped","fillTextClipped","t.drawGridLines","t.drawWrapText"],u=i.length,t=0;t<u;++t)if(r=i[t],_Ewa.e.c(n,r,!0))return!0;return!1},bi:function(n){return _Ewa.e.c(n,"ctx is undefined",!0)},G:function(){var n=_Ewa.h.b(12,0,608,607,0,-1802828618,"CanvasRenderingIEFailure");_Ewa.G.a(this.d.c()).c([n])},N:function(n){var t,i,r,u;if(!this.h)return new _Ewa.W(0,0,this.e.Y,this.e.X);for(t=_Ewa.W.a(),i=n.$$lge();i.$$mn();)r=i.$$cu(),r.a&&(u=_Ewa.hv.e(r.b),t=t.g(_Ewa.W.a())?u:t.n(u));return t.a.a=Math.max(0,t.a.a),t.a.b=Math.max(0,t.a.b),t},R:function(){var i=this.e.bO(),t=this.e.br(),n=i.h(t);return n?new _Ewa.W(n.a.a-t.a.a,n.a.b-t.a.b,n.c(),n.d()):null},bh:function(n){var t=this.d.b().a(this.e.W),i;!t;i=(n?this.e.be:t.n).Content.OverlayGridHtml;this.I(i)},A:function(n,t,i,r,u,f,e){var h=this.e.W,o,s;if(!this.d.c().isChangeGateEnabled("OfficeVSO:4077038_SyntheticSessionsInXLFPSChangeGate")||!this.r){if(isNullOrUndefined(n)){Diag.a.b(40147040,0,!1,"RenderResult returned null for block {0}, isSkeletonMode = {1}.",h,e);return}if(o={},o.Block=h,o.DurationMs=t,o.Succeeded=n.succeeded,o.Message=n.message,o.Performance=this.z(n.performance),o.IsHidden=this.m?this.m.a().toString():"Unknown",o.BlockWidth=this.e.Y,o.BlockHeight=this.e.X,o.NonEmptyCellsCount=i,o.TextCellsCount=r,f&&(o.CanvasCount=f.e.length,o.IsPartialRendering=this.h),e?(o.InPartialInteractivity=this.d.c().isChangeGateEnabled("OfficeVSO:4289622_AddPartialInteractivityToCanvasLog")&&_Ewa.G.a(this.d.c()).b(),o.IsHtml=!this.e.bq(),Diag.a.a(592053141,0,50,JSON.stringify(o))):Diag.a.a(40147041,0,50,JSON.stringify(o)),u)for(Diag.a.b(594330304,0,f.e.length===u.e.length,"LogRenderResult: partial results length mismatch, partialResults.Count = {0}, partialRenderDurations.Count = {1}, isSkeletonMode = {2}.",f.e.length,u.e.length,e),s=0;s<u.e.length;s++)o.DurationMs=u.a(s),o.Performance=this.z(f.a(s).performance),o.PartialIndex=s,_Ewa.e.a(f.a(s).message)||(o.PartialMessage=f.a(s).message),e?Diag.a.a(591155844,0,50,JSON.stringify(o)):Diag.a.a(594330275,0,50,JSON.stringify(o))}},z:function(n){for(var i={},t=0;t<n.length;t++)i[gridRenderer.GridBlockRendererGlobals.lookupPerfMetricName(t)]=n[t];return JSON.stringify(i)},bf:function(n,t,i){var u,r;this.f||(this.f=(u={},u));this.d.c().a(799)&&(this.f.skeletonMode=n);this.f.highContrastScheme=this.d.c().bp();this.f.devicePixelRatio=this.d.V();this.d.c().a(778)&&(this.f.devicePixelRatio*=_Ewa.t.a(this.d.c()).b());this.f.subPixelRenderingEnabled=Common.c.f()||Common.c.b();this.f.debugMode=!1;this.f.modelFromCache=_Ewa.p.c(this.d.c())&&t===2;this.d.c().a(888)||this.d.c().a(911)?(r=this.d.c().b().a(_Ewa.xF,384,!1),this.f.renderPageLayout=!!r&&r.a()>0):this.f.renderPageLayout=!1;this.d.c().a(116)&&(this.f.blockIdentifier=i)},be:function(n){if(this.g=n,this.g)this.d.c().isChangeGateEnabled("OfficeVSO:4300343_UseServerFlagsOnCanvasPLTFlagsMismatch")&&!this.d.b().i()&&this.d.b().g()&&this.g.RenderFlags!==this.d.c().e().CanvasRenderFlags&&(this.g.RenderFlags=this.d.c().e().CanvasRenderFlags,Diag.a.a(590136674,0,10,"PrepareGridBlockModel: render flags mismatch found between cached model and BootstrapContext"));else{var t;this.g=(t={},t);Diag.a.a(40400788,0,10,"PrepareGridBlockModel: responseGridBlockModel is null")}},P:function(n,t,i){this.E(t,this.e.Y,this.e.X,!1);var r=this.O(i);return this.M(n,t,this.x(r)),this.H(r,t,i),r},E:function(n,t,i,r){var o=this.d.V(),s=this.d.c().a(778)?_Ewa.t.a(this.d.c()).b():1,u=o*s,f=Math.round(t*u),e=Math.round(i*u);n.style.width=f/u+"px";n.style.height=e/u+"px";r&&(n.setAttribute("Width",f),n.setAttribute("Height",e))},bd:function(n,t,i){this.E(n,t,i,!0);n.style.display="block";n.style.font="normal 11pt "+_Ewa.bR.d(_Ewa.ClientStringManager.a().b(26));n.className="ewr-sheettable"},L:function(){this.i||(this.i=document.createElement("div"))},I:function(n){if(this.e.dC&&!(!n||!n.length)){var t=document.createElement("div");Sys.UI.DomElement.addCssClass(t,"ewr-sheettable");Sys.UI.DomElement.addCssClass(t,"ewr-sheettable-overlay");t.innerHTML=n;this.e.dC.appendChild(t)}},v:function(n){this.e.bc=n;this.e.dC&&(this.d.c().a(115)||_Ewa.a.I(this.e.dC),this.e.dC.appendChild(n))},J:function(n,t){if(n){var i=this.d.c().a(778)?_Ewa.t.a(this.d.c()).b():1;n.bI(this.i,this.d.V(),i,t,this.h)}},O:function(n){var i,t,r;if(this.e.ch()){var e=this.d.V(),o=this.d.c().a(778)?_Ewa.t.a(this.d.c()).b():1,u=e*o,s=this.y(this.g.RowOffsets,this.g.BlockHeight,1024,u),h=this.y(this.g.ColumnOffsets,this.g.BlockWidth,3072,u),f=this.Q(s,h);return this.d.c().a(115)&&(this.h=this.bj(f)),f}return i=new($$sc.u.$$(_Ewa.hv.a)),i.b((r=new _Ewa.hv.a,r.b=(t=new _Ewa.xW,t.startRow=0,t.endRow=n.RowNumbers.length-1,t.startColumn=0,t.endColumn=n.ColumnNumbers.length-1,t.startOffsetY=0,t.endOffsetY=n.BlockHeight,t.startOffsetX=0,t.endOffsetX=n.BlockWidth,t),r)),this.d.c().a(115)&&(this.h=!1),i},U:function(){this.h&&!this.j?(this.d.cb(this.p),this.j=!0):this.j&&!this.h&&this.k()},T:function(){var t=this.e.q(),n,i;if(!this.d.b().h()&&!t){this.k();return}if(!this.e.W){this.k();return}(n=this.d.b().a(this.e.W),this.w(n,t))||(n&&n.a()?(n.a().setDirty(),n.m()):t?(i=this.e.bN(),i&&(i.setDirty(),n.m())):(Diag.a.b(591204809,0,!1,"HandleLargeBlockViewportChanged: unexpected code reached."),this.k()))},k:function(){this.j&&(this.d.cq(this.p),this.j=!1)},bj:function(n){var t;if(n.e.length<=this.d.c().e().CanvasPartialBlockRenderingThreshold&&!Common.c.s()&&!Common.c.F())return!1;for(var i=!1,u=this.e.br(),r=n.$$lge();r.$$mn();)t=r.$$cu(),t.a=this.W(t.b,u),i=!!(i|!t.a);return i},W:function(n,t){var i=_Ewa.hv.c(n,t);return this.e.bO().i(i)},y:function(n,t,i,r){for(var s=new($$sc.u.$$(_Ewa.hv.d)),o=0,e=0,h=0,u=0,l=i/r,f,c;o<t;){for(e=Math.min(o+l,t);n[u+1]<e;)if(u++,u===n.length-1)break;c=(f=new _Ewa.hv.d,f.d=o,f.b=e,f.c=h,f.a=u,f);s.b(c);o=e;h=e===n[u]?u+1:u}return s},Q:function(n,t){for(var r,f,u,i,o,s=new($$sc.u.$$(_Ewa.hv.a)),e=0;e<n.e.length;e++)for(r=n.a(e),f=0;f<t.e.length;f++)u=t.a(f),s.b((o=new _Ewa.hv.a,o.b=(i=new _Ewa.xW,i.startRow=r.c,i.startColumn=u.c,i.endRow=r.a,i.endColumn=u.a,i.startOffsetX=u.d,i.endOffsetX=u.b,i.startOffsetY=r.d,i.endOffsetY=r.b,i),o));return s},M:function(n,t,i){for(var r=t.getElementsByTagName("canvas"),u;i<r.length;)u=r[0],_Ewa.a.U(u,t);if(i>r.length)for(n.bo(r.length,i);i>r.length;)t.appendChild(document.createElement("canvas"))},H:function(n,t,i){var o=t.getElementsByTagName("canvas"),h=this.x(n),s,f,e,r,u,c,l;for(Diag.a.b(594354451,0,o.length===h,"AssignCanvasElementsToRenderingRegions: number of canvas elements doesn't match number of renderingRegions. canvases: {0}, regions: {1}.",o.length,h),s=0,f=0;f<n.e.length;f++)e=n.a(f),(!this.h||e.a)&&(r=e.b,u=o[s],e.c=u,c=r.endOffsetY-r.startOffsetY,l=r.endOffsetX-r.startOffsetX,_Ewa.a.t(u,r.startOffsetX,r.startOffsetY,!1,i.IsRtl),u.style.position="absolute",this.bd(u,l,c),s++)},x:function(n){var t,i,r;if(!this.h)return n.e.length;for(t=0,i=n.$$lge();i.$$mn();)r=i.$$cu(),r.a&&t++;return t},S:function(){var t,i,r,n;if(this.i){for(t=this.i.getElementsByTagName("canvas"),i=t.length;t.length>0;)r=t[0],_Ewa.a.U(r,this.i);n=this.d.b().a(this.e.W);n.w&&(n.w.a=null,n.bo(i,0));n.r>0&&this.D(this.e.q())}}};_Ewa.hv.a=function(){};_Ewa.hv.a.prototype={b:null,c:null,a:!1};_Ewa.hv.d=function(){};_Ewa.hv.d.prototype={c:0,a:0,d:0,b:0};_Ewa.Fp=function(n){var t,i,r;this.t=Function.createDelegate(this,this.F);this.s=Function.createDelegate(this,this.A);this.m=Function.createDelegate(this,this.z);this.l=Function.createDelegate(this,this.y);_Ewa.Fp.initializeBase(this,[!1]);this.k=n;this.c=n.c();this.d=n.b();this.j=_Ewa.bM.m();this.d.d(this.l);this.h=this.c.c().l();this.h.b(this.m);this.q=!0;this.e=(t=new _Ewa.Fp.a,t.b=!1,t.a=!1,t.c="",t);this.f=new _Ewa.Qr;i=this;this.c.b().c(_Ewa.hb,276,function(){_Ewa.gC.a(i.c).b(i.f)});r=this;this.k.c().b().c(_Ewa.fe,291,function(n){r.g=n})};_Ewa.Fp.prototype={k:null,d:null,c:null,j:null,h:null,g:null,r:0,i:0,q:!1,e:null,f:null,a:function(n){this.dG("chmRC",n)},b:function(n){this.dH("chmRC",n)},n:function(){return!!this.g&&this.g.a()},o:function(){return this.h.a()},dispose:function(){this.w();this.d=null;this.c=null;this.k=null;this.h=null;this.g=null;_Ewa.cs.prototype.dispose.call(this)},y:function(){var n=!this.n()&&this.o();this.u(n,"blockCacheConsistent")},z:function(n,t){var i=!(t.b||this.n())&&this.o();this.u(i,t.a)},u:function(n,t){if(this.d.g()){this.e.b||(_Ewa.lH.a(this.s,this.c.i(),50),this.e.b=!0);var i;(i=this.e).a=!!(i.a|n);this.x(t)}else this.d.i()===2&&this.w()},w:function(){this.q&&(this.d.f(this.l),this.h.d(this.m))},v:function(n){switch(n){case 0:return!1;case 2:case 3:return!0;case 1:return!this.c.isChangeGateEnabled("OfficeVSO:4185682_dontFallbackOnCheckFailure")}return!1},A:function(){var n=this.j.a(),t,i;this.v(n)?(t="Unknown",this.g&&(t=this.g.a().toString()),this.E(),i=(this.h.c()/1e3).toString(),Diag.a.a(592446915,0,15,"RecoverUnhealthyCanvasIfNeeded: canvas is not healthy, isVisible: {0}, isSessionActive: {1}, timeFromLastActivitySec: {2}, isDocumentHidden: {3}, triggeringEvents: {4}",t,this.o(),i,this.n(),this.e.c),this.i>3?(this.d.k(String.format("RecoverUnhealthyCanvasIfNeeded: CanvasHealthMonitor.IsHealthy returned false, failure repetitive"),!1),Diag.a.a(592048158,0,10,"RecoverUnhealthyCanvasIfNeeded: Canvas error threshold reached. crashCountDuringUserActivity: {0}, MaxRecoveryCountAllowed: {1}",this.i,3),this.p(n)):this.C()):this.p(n)},C:function(){var t=_Ewa.i.a(),i=this.d.R(),n;this.d.O();this.dE("chmRC",null,null);_Ewa.lH.a(this.t,this.c.i(),50);n=_Ewa.i.a()-t;Diag.a.a(592233611,0,50,"TryRecoveryFromCanvasCrash:: recoveryDurationMs: {0}, canvas count before the crash: {1}, max allowed canvas count: {2}",n,i,_Ewa.bM.k())},E:function(){this.r++;this.e.a&&this.i++},F:function(){var n=this.j.a();n?this.v(n)&&(Diag.a.a(592242441,0,10,"ValidateCanvasHealthRecovery: canvas is not healthy after a recovery attempt"),this.c.isChangeGateEnabled("OfficeVSO:4234091_ReplaceHTMLFallbackWithErrorDialogOnCanvasHealthCheck")?this.B():this.d.k("ValidateCanvasHealthRecovery: CanvasHealthMonitor.IsHealthy returned false",!1)):Diag.a.a(592233610,0,50,"ValidateCanvasHealthRecovery: canvas recovery succeeded. total recovery count: {0}, user impacting recovery count: {1}",this.r,this.i);this.p(n)},B:function(){var n=_Ewa.h.b(12,0,609,607,0,-378683016,"UserOutOfMemoryDuringSession");_Ewa.G.a(this.c).c([n])},p:function(n){this.e.b=!1;this.e.a=!1;this.e.c="";this.D(n)},D:function(n){this.f.lastCheckTime=_Ewa.u.a().a();switch(n){case 0:this.f.successCount++;this.f.lastSuccessfulCheckTime=_Ewa.u.a().a();break;case 2:this.f.blackPixelFailureCount++;break;default:this.f.otherFailureCount++}},x:function(n){this.e.c+=n+";"}};_Ewa.Fp.a=function(){};_Ewa.Fp.a.prototype={b:!1,a:!1,c:null};_Ewa.bM=function(){this.b=_Ewa.bM.b()};_Ewa.bM.m=function(){return _Ewa.bM.d||(_Ewa.bM.d=new _Ewa.bM),_Ewa.bM.d};_Ewa.bM.k=function(){return _Ewa.bM.n()/12};_Ewa.bM.n=function(){return Common.c.c()||Common.c.B()?200:Common.c.s()||Common.c.bA()?30:Common.c.h()||Common.c.F()?100:1024};_Ewa.bM.b=function(){var n,t;try{return(n=document.createElement("canvas"),n.id="CHM",n.style.width="2px",n.style.height="2px",n.setAttribute("Width",2),n.setAttribute("Height",2),n.style.position="absolute",n.style.zIndex=9999,t=n.getContext("2d"),!t)?(Diag.a.a(592446917,0,15,"CreateTestableCanvasElement: unable to get canvas context"),null):(_Ewa.bM.l(t),n)}catch(i){return Diag.a.a(592196449,0,10,"Exception during CreateTestableCanvasElement. Exception: {0}.",i),null}};_Ewa.bM.l=function(n){_Ewa.bM.c(n,_Ewa.bM.i);_Ewa.bM.c(n,_Ewa.bM.h);_Ewa.bM.c(n,_Ewa.bM.g);_Ewa.bM.c(n,_Ewa.bM.j)};_Ewa.bM.c=function(n,t){n.fillStyle=_Ewa.N.b(t.a);n.fillRect(t.b,t.c,1,1)};_Ewa.bM.o=function(n){var t=_Ewa.bM.f(n,_Ewa.bM.i),i=_Ewa.bM.f(n,_Ewa.bM.h),r=_Ewa.bM.f(n,_Ewa.bM.g),u=_Ewa.bM.f(n,_Ewa.bM.j);return!t&&!i&&!r&&!u?0:t===1&&i===1&&r===1&&u===1?1:2};_Ewa.bM.f=function(n,t){var i=4*(n.width*t.c+t.b),r=n.data[i],u=n.data[i+1],f=n.data[i+2],o=n.data[i+3],e,s;return!_Ewa.bM.a(r,t.a.c)||!_Ewa.bM.a(u,t.a.b)||!_Ewa.bM.a(f,t.a.a)||!_Ewa.bM.a(o,255)?(e=new _Ewa.bs(r,u,f),s=e?_Ewa.N.b(e):"Unknown",Diag.a.a(592446916,0,15,"IsPixelValid: values don't match the sample. X: {0}, Y: {1}, expected: {2}, actual: {3}",t.b,t.c,_Ewa.N.b(t.a),s),!r&&!u&&!f&&!o)?1:2:0};_Ewa.bM.a=function(n,t){var i=Math.max(0,n-2),r=Math.min(255,n+2);return t>=i&&t<=r?!0:!1};_Ewa.bM.prototype={b:null,a:function(){var n,t,i;if(!this.b)return this.b=_Ewa.bM.b(),1;try{if(n=this.b.getContext("2d"),!n)return this.b=_Ewa.bM.b(),1;if(t=n.getImageData(0,0,2,2),this.b=_Ewa.bM.b(),!t)return 1;i=_Ewa.bM.o(t);switch(i){case 0:return 0;case 1:return 2;default:return 3}}catch(r){return Diag.a.a(592196450,0,10,"CanvasHealthMonitor: Exception during CheckIfHealthy. Exception: {0}.",r),1}}};_Ewa.bM.e=function(){};_Ewa.bM.e.prototype={b:0,c:0,a:null};_Ewa.eU=function(){};_Ewa.eU.b=function(n,t,i,r){var o,u,f,s,h,c,l,e,a;if((r.I(!1),o=n&4?"dblclick":"click",!_Ewa.eU.a(n,o))||t&&t.button===2||(u=_Ewa.eU.c(n,o,i,r),!u))return null;if(f=u.a,s=null,u.b&64)try{h=f.href;c=!1;i.c().a(199)&&(l=i.c().b().a(Common.App.SafeLinks.a,269,!1),l&&(c=l.a(h)));c||Common.g.f(h)}catch(v){}else _Ewa.eU.a(u.b,"dblclick")?(e=f.getAttribute("ondblclick"),e&&t&&(a=Object.getType(e)===Function?e:new Function("event",e),a.call(f,t.rawEvent),_Ewa.D.a(t,!0))):s=_Ewa.y.a().a(function(){_Ewa.a.Q(f,t)},0,_Ewa.m.Y,!0,!0);return s};_Ewa.eU.c=function(n,t,i,r){var u,f,e,s,h,o;return(r.I(!1),u=null,f=0,n&7&&(n&1&&_Ewa.eU.a(1,t)?(f=1,u=r.bd("di-ex")):n&2&&_Ewa.eU.a(2,t)?(f=2,u=r.bd("di-cl")):n&4&&_Ewa.eU.a(4,t)&&(f=4,u=r.be("di-ex")||r.be("di-cl"))),!u&&n&56&&_Ewa.eU.a(n&56,t)&&(f=n&56,e=i.bz(r.d().e()),s=e?e.d():null,u=r.cm(s)),!u&&n&256&&_Ewa.eU.a(n&256,t)&&(f=n&256,u=r.cn()),!u&&n&192&&_Ewa.eU.a(n&192,t)&&(u=r.T(),_Ewa.p.b(i.c())&&r.n()?r.u()&&!_Ewa.e.a(r.D())&&n&64?f=64:!r.u()&&n&128?f=128:u=null:u&&(h=_Ewa.a.o(u,"_link",""),o=h==="ext"&&!_Ewa.e.a(u.href),o&&n&64?f=64:!o&&n&128?f=128:u=null)),u)?new _Ewa.HZ(f,u):null};_Ewa.eU.a=function(n,t){return t===(n&4?"dblclick":"click")};_Ewa.jF=function(n,t,i,r,u){var f,e;this.G=Function.createDelegate(this,this.ce);this.ba=Function.createDelegate(this,this.cd);this.y=Function.createDelegate(this,this.bZ);this.Y=Function.createDelegate(this,this.ca);this.X=Function.createDelegate(this,this.bY);this.bq=Function.createDelegate(this,this.bW);this.bs=Function.createDelegate(this,this.cg);this.W=Function.createDelegate(this,this.bX);this.bp=Function.createDelegate(this,this.bU);this.Z=Function.createDelegate(this,this.cc);this.br=Function.createDelegate(this,this.cb);this.bd=new _Ewa.jF.g;this.bb=new _Ewa.jF.a;f=n.dD;_Ewa.jF.initializeBase(this,[i,_Ewa.p.e(n.dD),n.dD.a(700),f.bK||(f.bK=Function.createDelegate(f,f.isChangeGateEnabled)),_Ewa.p.g(n.dD)]);this.a=n;this.i=t;this.r=r;this.H=u;this.p=_Ewa.p.x(this.a.dD);this.z=_Ewa.p.v(this.a.dD);_Ewa.bH.a().e=this;this.J=this.cs.a(n.dC);this.J.a("focus",this.br,!1);this.ct().a("keydown",this.Z,!0);this.ct().a("input",this.bp,!0);this.i.h(this.W);this.s(this.bs);this.s(this.bq);this.a.dD.isChangeGateEnabled("OfficeVSO:4185434_AddAriaLabelToGridKeyboardHandler")&&(e=this,this.s(function(){e.g().setAttribute(Common.v.a.a,"grid")}));this.a.jL(this.X)};_Ewa.jF.e=function(n){return!!(n.ctrlKey^n.altKey)||n.rawEvent.metaKey||0===n.rawEvent.charCode};_Ewa.jF.b=function(n,t,i,r){return new _Ewa.jF(n,t,i,n.dD.g(),r)};_Ewa.jF.d=function(n){return n>=65&&n<=90?"Letter":n>=48&&n<=57||n>=96&&n<=105?"Possible number":n===8||n>=106&&n<=111||n>=186&&n<=222?"Editing sign":"Other key"};_Ewa.jF.f=function(n){return Array.contains([37,39,38,40,33,34,9],n)};_Ewa.jF.c=function(n){var t=0;return n.shiftKey&&(t|=4),n.ctrlKey&&(t|=8),n.altKey&&(t|=32),t};_Ewa.jF.prototype={p:!1,z:!1,a:null,L:!1,I:null,K:null,J:null,A:!1,M:!1,i:null,r:null,H:null,bR:function(){return this.I||(this.I=[this.a.dC,this.cm(),this.g()]),this.I},bv:function(){return this.K||(this.K=[this.cm(),this.g()]),this.K},dispose:function(){System.a.a(this.J);this.i&&this.i.j(this.W);this.a&&this.a.kS(this.X);this.cj();this.a=null;this.i=null;this.H=null;_Ewa.Xs.prototype.dispose.call(this)},cG:function(){this.bH()||(this.bw("1px"),_Ewa.bhS.prototype.cG.call(this),this.bw("0"))},bj:function(n){if((!Array.contains(this.bR(),n.target)||this.a.m())&&!this.a.dL.I()){var t=n.rawEvent;t&&Array.contains(this.bv(),t.target)&&Array.contains(this.bv(),t.relatedTarget)||_Ewa.gG.prototype.bj.call(this,n)}},ch:function(n,t,i){var r,f,u,e;_Ewa.cw.f(t);r=this.a.dD;(f=this.a.dL.M(n,t.a))||((f=this.i.E(n,t.a))?r.a(95)&&(u=_Ewa.z.a().b(t.a),u&&u.length||Diag.a.a(40690339,3,50,"GridKeyboardHandler.RouteKeyboardCommand: command name is null or empty. commandName: {0}, command: {1}, commandInfo: {2}",u,t.a,t),r.a(458)?_Ewa.bG.a(r).a(u,{NumberOfSelectedRanges:this.i.d().d(),SelectedRanges:this.i.L(!1,!1)},null):_Ewa.bG.a(r).a(u,{selectedRange:this.i.a().toString()},null)):this.bT(n,t,i));f&&!t.l&&t.f!==1&&(_Ewa.cw.d(t),_Ewa.eL.a(r).a(!1,t,_Ewa.u.a().a()));f&&(e=this,r.b().c(_Ewa.cH,211,function(n){n.f(t.a)}))},bT:function(n,t,i){var r=n.keyCode,o,h,u,s,c,f,e;return(this.L=27===r,o=this.r.j(t.a),this.a.m()&&this.bO(t,o))?(this.bP(r),h=t.a===-287251124||t.a===-1925065947||t.a===1764140053,_Ewa.cz.b()&&h&&n.preventDefault(),!1):(u=_Ewa.bW.a(this.a.dD),this.a.dD.a(867)&&_Ewa.bW.a(this.a.dD)&&OfficeExt.ShortcutKeyDispatchManager.tryDispatchShortcutKey(_Ewa.jF.c(n),r,u.m||(u.m=Function.createDelegate(u,u.M))))?(_Ewa.D.a(n,!0),!0):(t.a===1872288872&&(s=this.a.dD.b().a(_Ewa.cY,254,!1),s&&(c=this,s.e("CancelEdit",!0,!0,!1,0).catch(function(){}))),r!==229&&r?(e=this.r.b(t,this.a.dD.a(707)&&i?_Ewa.cW.a(i,{event:n},!0):{event:n},n),f=!_Ewa.ck.b(e)&&(e.b!==6||e.a())):(f=!1,this.bS(n)),(f||t.a===-1583422759)&&!o.D&&_Ewa.D.a(n,!0),f)},cc:function(n){var r,s,l,u,e;if(this.a.dL.N(),Common.c.c()&&window.focus(),!this.bx()){var t=this.a.dD,f=n.keyCode,o=_Ewa.G.a(t).b();if(!t.isChangeGateEnabled("OfficeVSO:4272746_TelemetryForEditsAfterGFI")||t.c().i()||o||_Ewa.U.a().q("editsAfterGFI",!0),o)if(r=_Ewa.jF.d(f),s=_Ewa.jF.f(f),s)_Ewa.p.l(t)||_Ewa.G.a(t).d("OnKeyDown","KeyCategory: "+r,!1),_Ewa.U.a().q("allowedOpDuringPI",!0);else{_Ewa.G.a(t).d("OnKeyDown","KeyCategory: "+r,!0);Diag.a.a(1735668084,3,50,"GridKeyboardHandler.OnKeyDown: Ignoring keydown event key of category '{0}' because it is not allowed in partial interactivity mode",r);return}if(!this.ci()){var h=this.r,a=h.d(),c=t.J().h(n),i=c.a,v=c.b;if(f===93&&!Common.c.e()||i===1441131127){l=Common.bl.a("contextmenu",n,1);this.i.F(l);return}if(!this.a.dD.isChangeGateEnabled("OfficeVSO:4247407_InkDisableDrawWithTouch")||i!==1872288872||!_Ewa.dm.c(this.a.dD)||!_Ewa.dm.c(this.a.dD).a()){if(u=new _Ewa.P(i,1,t.s(),6,null),e=this.r.j(i),this.a.dD.isChangeGateEnabled("OfficeVSO:4228114_ThrottlePgUpPgDnEnvets")){if(i!==1461300262&&this.bb.e(i,e)){_Ewa.D.a(n,!0);return}}else if(i!==1461300262&&this.bd.e(i,e))return;a===1||_Ewa.K.d(u.a)?this.ch(n,u,v):h.h(n,u)}}}},bt:function(){Diag.a.a(50886862,1,50,"GridKeyboardHandler.EnableVirtualKeyboardForGrid");this.p?window.navigator.virtualKeyboard.show():this.u(!1)},bc:function(){Diag.a.a(50886863,1,50,"GridKeyboardHandler.DisableVirtualKeyboardForGrid");this.p?window.navigator.virtualKeyboard.hide():this.u(!0)},bW:function(){_Ewa.bH.a().c("GridEditorLoaded",-1);this.a.dD.y().ca()},bl:function(n){this.a.dD.isChangeGateEnabled("OfficeVSO:4228114_ThrottlePgUpPgDnEnvets")?this.bb.d():this.bd.c();_Ewa.gG.prototype.bl.call(this,n)},bw:function(n){this.a.m()||(this.cA().height=n,this.cA().width=n)},bX:function(){var t,n;this.a.E()||(t=this.a.e(null),t&&(n=this.H.d(t,this.a,!1),n&&(_Ewa.dq.a(this.get_element().style,this.a.d(),n.x+"px"),this.get_element().style.top=n.y+"px")))},bx:function(){var n=this.a.dD;return _Ewa.G.a(n).o()||n.o().bo()&&!this.a.et},ci:function(){var n=this.a.dD;if(!n.c().a()&&!n.c().O())if(_Ewa.G.a(n).b())Diag.a.a(37783585,3,50,"ShouldIgnoreKeyboardEventsInCurrentSessionState.OnKeyDown: Allowing keydown event key during sessionless state because PLT is in partial interactivity mode");else return!0;return!1},cb:function(n){this.a.eX.c()&&(this.cG(),this.S(n))},S:function(n){_Ewa.gG.prototype.S.call(this,n);this.a.dD.c().K()},bk:function(n){var r=this.a.dD,u,f,t,e,i;if(this.A=this.bI(),this.bF(),!this.bx()){if(_Ewa.G.a(r).b()){Diag.a.a(36313219,3,50,"GridKeyboardHandler.OnKeyPress: Ignoring keypress event key because it is not allowed in partial interactivity mode");return}u=n.charCode;(Common.c.a()||Common.c.b())&&(this.L=27===u);f=_Ewa.jF.e(n);t=!this.a.m()&&!f&&!this.L;t&&n.shiftKey&&Common.c.b()&&r.J().a(n)!==1461300262&&(t=!1);t&&!this.r.o(1)&&(_Ewa.D.a(n,!0),t=!1);e={ShouldLogInTextEditorTelemetry:!0,textRuns:$$sc.a.a(Number,this.a.dL.a().R())};_Ewa.bG.a(r).a(_Ewa.bd.s,null,e);t&&(this.A&&Diag.a.a(42496797,0,100,"GridKeyboardHandler.OnKeyPress: user pressed an input key in order to edit cell when the GridKeyboardHandler is ReadOnly."),this.a.bb(!0,0,n,!0));_Ewa.cz.b()&&this.a.m()&&(i=window.getSelection(),i&&i.rangeCount!==1&&(Diag.a.a(24156162,0,15,"GridKeyboardHandler.OnKeyPress: expecting to have 1 range in selection object, but have {0}.",i.rangeCount),this.o()));_Ewa.gG.prototype.bk.call(this,n)}},ce:function(){this.p||this.a.m()||this.u(!0)},bY:function(){var n=this;this.a.dL.a().s(function(){n.cf()})},cd:function(n,t){this.z&&(t.b!==3||this.a.m()||this.a.et?t.b===2&&this.bt():this.bc())},bV:function(){var n={},t=this.a.dD;n.a=t.e().UserSessionId;_Ewa.z.a().h(27,n)},bP:function(n){this.A&&(n===229||!n)&&(Diag.a.a(42496800,1,50,"GridKeyboardHandler.HandleKeyDown: IME input detected after pressing key in order to enter edit mode."),this.A=!1)},bS:function(){this.bu();this.bV()},bU:function(){if(_Ewa.G.a(this.a.dD).b()){Diag.a.a(40380305,3,50,"GridKeyboardHandles.HandleTextChange: Ignoring HandleTextChange event since we are in partial interactivity state (workbook is not fully loaded yet)");return}this.bQ()},bQ:function(){this.d()&&this.bu()},bu:function(){this.a.m()||this.a.bb(!0,0,null,!0)},ca:function(){(this.p||_Ewa.E.c===3)&&this.bt()},bZ:function(){(this.p||_Ewa.E.c===3)&&this.bc()},bO:function(n){switch(n.a){case-208772570:case-987339782:case 753860909:case 1588554917:case 336544449:return!1;case 542791952:case 1713663844:case-2012742350:case 1324884057:case 105288353:case-1297307319:case-403586027:case 784916030:case-2117762619:case 104573693:case 2110202177:return this.a.E()?!1:!0;default:return!0}},cf:function(){this.p?(Diag.a.a(592316499,3,50,"GridKeyboardHandler.RegisterManageVirtualKeyboardHandlers: using virtualKeyboardPolicy API"),this.u(!1),this.cM("manual"),this.cL("text"),this.a.dL.c(this.Y),this.a.dL.f(this.y)):this.z&&(Diag.a.a(592316498,3,50,"GridKeyboardHandler.RegisterManageVirtualKeyboardHandlers: using readonly"),this.i.H(this.ba),this.a.dL.f(this.y));this.M=!0},cj:function(){this.a&&this.M&&(this.p?(this.a.dL.d(this.Y),this.a.dL.g(this.y)):this.z&&(this.i.N(this.ba),this.a.dL.g(this.y)));this.M=!1},cg:function(){Common.c.h()?(this.i.I(this.G),this.i.T(this.G)):Common.c.F()&&this.i.I(this.G)}};_Ewa.jF.g=function(){};_Ewa.jF.g.prototype={b:null,a:0,c:function(){this.b=null;this.a=0},e:function(n,t){var f=!!t&&t.C,i,r,u;return f?(i=Date.now(),r=this.b!=null&&this.b===n,!r)?(this.d(n,i),!1):(u=i-this.a,u>1e3)?(this.d(n,i),!1):(this.a=i,!0):(this.c(),!1)},d:function(n,t){this.b=n;this.a=t}};_Ewa.jF.a=function(){this.c=_Ewa.u.a()};_Ewa.jF.a.a=function(n){return n.n?40:n.o?150:n.p?1e3:0};_Ewa.jF.a.prototype={b:null,a:0,d:function(){this.b=null;this.a=0},e:function(n,t){var e=!!t&&(t.n||t.o||t.p),i,r,u,f;return e?(i=this.c.a().getTime(),r=this.b!=null&&this.b===n,!r)?(this.b=n,this.a=i,!1):(u=_Ewa.jF.a.a(t),f=i-this.a,f>u)?(this.a=i,!1):!0:(this.d(),!1)}};_Ewa.gh=function(n,t){this.h=Function.createDelegate(this,this.l);this.e=Function.createDelegate(this,this.m);this.g=Function.createDelegate(this,this.k);this.f=Function.createDelegate(this,this.j);_Ewa.gh.initializeBase(this,[n,null]);this.d=null;this.b=t;this.a=this.b.c();_Ewa.bl.a(this.a).a(this);_Ewa.gh.d(_Ewa.a.e(n,"ewr-grdblk",!1));this.ct().a("click",this.f,!1);this.ct().a("contextmenu",this.g,!1);this.a.f().bW(this.e);var i=_Ewa.a.e(n,"ewr-hdrcornerwidget",!1);i&&(this.c=this.cs.a(i),this.c.a("mousedown",this.h,!1))};_Ewa.gh.c=function(){return _Ewa.gh.a||(_Ewa.gh.a=_Ewa.gh.e())};_Ewa.gh.d=function(n){var i=_Ewa.gh.c();for(var r in i){var u={key:r,value:i[r]},f=u.value,t=document.createElement("a");t.href="#";t.innerText=f.a.toString();t.className=u.key;n.appendChild(t)}};_Ewa.gh.e=function(){var n={};return _Ewa.gh.b(["ewrol-cl0","ewrol-cl1","ewrol-cl2","ewrol-cl3","ewrol-cl4","ewrol-cl5","ewrol-cl6","ewrol-cl7"],n,!1),_Ewa.gh.b(["ewrol-rl0","ewrol-rl1","ewrol-rl2","ewrol-rl3","ewrol-rl4","ewrol-rl5","ewrol-rl6","ewrol-rl7"],n,!0),n};_Ewa.gh.b=function(n,t,i){for(var u,r=0;r<n.length;r++)u=r+1,t["ewrol-btn "+n[r]]=new _Ewa.gh.f(i,u)};_Ewa.gh.prototype={b:null,a:null,d:null,c:null,D:function(){return this.cm()},bw:function(){return!!this.d&&this.b.bg().dw()},bf:function(){return"GHC"},dispose:function(){System.a.a(this.c);var n=this.a.f();n&&n.ci(this.e);_Ewa.Xs.prototype.dispose.call(this)},C:function(n,t){return t||_Ewa.a.c(this.d,!1),!t},dA:function(n){return _Ewa.a.h(this.D(),n)},cC:function(){},bL:function(){},i:function(n,t){var i=_Ewa.gh.c()[n.target.className],r;if(i&&!this.b.m()){if(r=new _Ewa.bP(this.a.f()),r.b())Diag.a.a(22639456,0,50,"Can't expand/collapse outlines due to protection-sheet."),this.a.C(927125067,_Ewa.E.a,0,null);else{var e=_Ewa.u.a().a(),u=_Ewa.f.c(this.b.a().b(),this.a),o=this.a.d().a().b(!1),s=this,h=function(n,r){return _Ewa.j.S(s.a.d().a(),u,i.a,t,i.b,n,r,null,o)},f=_Ewa.e.b(n.target.title,_Ewa.ClientStringManager.a().a(1040),!0),l=this,c=function(){return new _Ewa.LX(u.SheetName,f,i.b,i.a,t)};this.a.bs(f?1835910716:1655823823,h,e,_Ewa.E.a,0,174,c)}_Ewa.D.a(n,!0)}},j:function(n){this.i(n,-1)},l:function(){_Ewa.B.c(this.a.j())&&this.a.g().b(new _Ewa.P(-2117762619,2,this.a.s(),30,null),null,null)},k:function(n){var t=!!n.target&&n.target.className==="ewr-hdrcornerwidget",i;t&&(i=this,_Ewa.g.cw(_Ewa.l.b(_Ewa.df,this.a.b(),8,9,0),function(t){var u=Common.bl.a("contextmenu",n,_Ewa.E.a),i=t,r=i?i.a():null;i&&r?(r.b(u,null),Diag.a.a(21561920,0,50,"context menu opened on header corner.")):Diag.a.a(21561921,0,50,"contextMenuManagerTask = {0}, Result = {1}",i,r)},this.a.i(),3));_Ewa.D.a(n,!0);n.stopPropagation()},m:function(){var n=$$as(_Ewa.J,this.a.j());n&&(this.cm().style.visibility=n.G()?"visible":"hidden")}};_Ewa.gh.f=function(n,t){this.b=n;this.a=t};_Ewa.gh.f.prototype={b:!1,a:0};_Ewa.gM=function(){};_Ewa.gM.a=function(n,t){Diag.a.b(50598019,0,!!n,"CssBorderFormatUtility.GetBorderStyleFormat borderFormat is null");var i=0,r="solid",u="#000000";switch(n.LineStyle[t]){case 1:i=_Ewa.i.l(1);r="solid";break;case 3:i=_Ewa.i.l(1);r="dashed";break;case 4:case 9:case 11:i=_Ewa.i.l(1);r="dotted";break;case 2:i=_Ewa.i.l(2);r="solid";break;case 5:i=_Ewa.i.l(3);r="solid";break;case 6:i=_Ewa.i.l(3);r="double"}return u=_Ewa.N.b(_Ewa.bs.a(n.Color[t])),_Ewa.gM.c(i,r,u)};_Ewa.gM.b=function(n,t){Diag.a.b(51468230,0,!!n,"CssBorderFormatUtility.GetBorderStyleFormat borderFormat is null");switch(n.LineStyle[t]){case 1:case 3:case 4:case 9:case 11:return 1;case 2:return 2;case 5:case 6:return 3}return 0};_Ewa.gM.c=function(n,t,i){return String.format("{0}{1} {2} {3}",n,"pt",t,i)};_Ewa.Fr=function(n,t){this.l=Function.createDelegate(this,this.p);this.c=n;this.i=this.c.c();this.d=t;this.e=_Ewa.y.a().b(this.l,40,_Ewa.m.J,!1,!1);var i=this;_Ewa.bG.b(this.i,function(n){i.h=n.b(_Ewa.bd.f,!1)})};_Ewa.Fr.prototype={d:null,c:null,i:null,e:null,b:0,a:0,j:null,k:0,h:null,dispose:function(){System.a.a(this.e)},f:function(){this.e.c()&&(Diag.a.a(23156481,0,50,"CancelAutoScrollIntervalIfRunning: autoScroll finished. duration = {0}s",(Date.now()-this.k)/1e3),this.e.b())},m:function(n,t,i){return n+2>=t+i?1:n-2<=i?-1:0},p:function(){var t=this.c.j().t(1),i=this.c.bC(),u=this.g(),f=!0,e=!0,o=u.c<t.c,s=u.d<t.d,r,n;if(i&&(f=i.a>t.a,e=i.b>t.b),!f&&this.b<0&&(this.b=0),!e&&this.a<0&&(this.a=0),!s&&this.b>0&&(this.b=0),!o&&this.a>0&&(this.a=0),this.h){var h=this.b,c=this.a,l=this;this.h(function(){return{dx:c,dy:h}})}this.b||this.a?(n=this.g().f(),this.b&&(this.d.Q(this.b,0,!0),n.g(this.g())&&Diag.a.a(23614733,0,50,"DragScroll - selection hasn't change when scrolling vertically. selection: {0}, verticalSpeed: {1}.",n,this.b)),this.a&&(this.d.Q(0,this.a,!0),n.g(this.g())&&Diag.a.a(23614734,0,50,"DragScroll - selection hasn't change when scrolling horizontally. selection: {0}, horizontalSpeed: {1}.",n,this.a))):(this.f(),r=this.d.Z(this.j,null,3),r&&this.d.bb(r,3))},n:function(n){var t;(t=_Ewa.a.i(this.c.i()))&&(this.o(n,t),this.b||this.a?(this.j=n,this.e.c()||(this.e.a(),this.e.d(),this.k=Date.now(),Diag.a.a(23466978,0,50,"AutomaticallyUpdateScrollDuringDragSelection: autoScroll started"))):this.f())},o:function(n,t){this.b=this.m(n.y,this.c.h().a().d(),t.y);this.a=this.m(n.x,this.c.h().a().c(),t.x);this.a&&this.c.d()&&(this.a*=-1);var i=this.c.j(),r=this.g(),u=i.e()&&!i.j(r,1);u&&(i.j(r,4)?this.a=0:this.b=i.j(r,3)?0:this.a=0);this.d.q()===2?this.b=0:this.d.q()===1&&(this.a=0)},g:function(){return this.d.ba()}};_Ewa.mA=function(){this.a=0;this.d=0;this.b=0;this.c=0;this.e=0};_Ewa.mA.a=function(n,t,i,r,u){var o=_Ewa.mA.b(),f,h,e,s;if(t&&!_Ewa.bo.b(t,i))for(f=i.b.Y;f<=i.a.Y;f++)if(h=new _Ewa.bo(f,i.b.X,f,i.a.X,i.b.PaneType),!t.i(h))for(e=i.b.X;e<=i.a.X;e++)s=new _Ewa.bo(f,e,f,e,i.b.PaneType),t.i(s)||o.f(s,r,u);o.g()&&o.h(n)};_Ewa.mA.b=function(){return new _Ewa.mA};_Ewa.mA.prototype={a:0,d:0,b:0,c:0,e:0,g:function(){return this.a>0||this.d>0||this.b>0||this.c>0||this.e>0},h:function(n){Diag.a.a(592061209,1,50,"BlocksState: Scenario={0}, Consistent={1}, Stale={2}, Empty={3}, Invalid={4}, UnexpectedState={5}",n,this.a,this.d,this.b,this.c,this.e)},f:function(n,t,i){for(var u,f,r=n.b.X;r<=n.a.X;r++)for(u=n.b.Y;u<=n.a.Y;u++){f=t.bm(t.t(i,_Ewa.bo.a(r,u,1)));switch(f){case 4:case 5:this.a++;break;case 3:case 1:this.d++;break;case 0:case 2:this.b++;break;case 6:case 7:this.c++;break;default:this.e++}}}};_Ewa.mC=function(n,t,i,r,u){this.cL=Function.createDelegate(this,this.dV);this.cG=Function.createDelegate(this,this.dO);this.cJ=Function.createDelegate(this,this.dR);this.cK=Function.createDelegate(this,this.dS);this.cI=Function.createDelegate(this,this.dQ);this.cH=Function.createDelegate(this,this.dP);_Ewa.mC.initializeBase(this,[n,t,i]);this.bI=r;this.bJ=u;n.h().c(this.cH);t.N(this.cI);n.d().n(this.cK);n.d().f(this.cJ);_Ewa.ULSError.i(this.cG);this.bB=new _Ewa.CU(n);this.co=_Ewa.bM.k();this.bG=0};_Ewa.mC.a=function(n){return n.b().b(_Ewa.mC,176,new _Ewa.mC(n,n.c(),n.d().b(),30,28))};_Ewa.mC.c=function(n){n.Content.RowOffsets=n.Content.RowOffsets||_Ewa.i.v(n.Content.RowHeights);n.Content.ColumnOffsets=n.Content.ColumnOffsets||_Ewa.i.v(n.Content.ColumnWidths)};_Ewa.mC.prototype={bN:0,cN:0,bM:null,co:0,bI:0,bJ:0,cm:!1,P:function(){return this.cm},cn:!1,Q:function(){return this.cn},bZ:!1,F:function(){return this.bZ},bG:0,R:function(){return this.bG},bz:null,ch:function(){return 50},N:function(n){var t=n.n.Autofilters;return n.q===5&&!!t&&t.length>0},dispose:function(){var n=this.bw,t;n&&(n.h().e(this.cH),n.d().t(this.cK),n.d().g(this.cJ),this.bz&&this.bz.df(this.cL));_Ewa.ULSError.f(this.cG);t=this.by;t&&t.Q(this.cI);this.bC.b=!1;this.bB&&(System.a.a(this.bB),this.bB=null);_Ewa.fY.prototype.dispose.call(this)},S:function(n){var i=null,s=this.bw,h=8,c=this.bx,e,o,t,r,u,f,l;for(e in c)(o={key:e,value:c[e]},t=o.value,n&&n!==t.v)||(r=this.by,t.r>0&&(i||(u=_Ewa.B.h(t.v,r),i=[s.q().id,s.e().RenderingOptions,r.d()+1,u.b,u.a.a.Settings,u.a.a.Mode,this.bJ,this.bI]),f=t.n.Information.BlockCachePosition,l=[f.X,f.Y,o.key,f.PaneType],i[h]=l,t.L=r.d()+1,h++));return i},E:function(){var t=this.bx,n,i;for(n in t)if(i={key:n,value:t[n]},this.N(i.value))return!0;return!1},T:function(n){var t,i,r,f,u;if(!n.j()||!this.bw.j())return null;if(t=this.Z(n,this.bw.j().a),t)return t.i(n);i=this.bx;for(r in i)if(f={key:r,value:i[r]},u=f.value.i(n),u)return u;return null},p:function(n,t){var i,r,u,e,f;if(!t||!n.ba){if(n.ba=t,!t){this.cc=!1;return}i=!0;r=this.bx;for(u in r)if(e={key:u,value:r[u]},f=e.value,f.r>0&&!f.ba){i=!1;break}i&&(this.cc=!0,this.dE("afor",null,null),this.bz.dq())}},ck:function(n){var t=n;t&&(t.F=null)},bo:function(){var r=this.by.Z(),v=!!this.bw.v()&&!!this.bw.v().bb()&&this.bw.v().bb().a(),i,h,t,u,o;if(_Ewa.B.d(r)&&!v)if(i=this.dN(),isNullOrUndefined(i))Diag.a.a(38098641,0,15,"GridBlockManager.PrimeCacheItemsFromPrefetchedGridBlocks: getRangeResponses is undefined");else try{this.dT(i);for(var s=i,y=s.length,f=0;f<y;++f){h=s[f];_Ewa.U.a().f("PrefetchGetRange");var c=h.b.BlockPosition,l=this.t(r,c),n=_Ewa.v.a(this.bx,l,null);n||(n=this.bR(r,c),this.cx(l,n));n.B=1;n.L=this.by.f().InitialStateId;n.O(n.n.Information,this.by.f().InitialStateId,!1)}for(var a=i,p=a.length,e=0;e<p;++e)t=a[e],u=this.t(r,t.b.BlockPosition),this.bw.c().bN(t.a(),!0,"GetRangeContent"),this.bw.a(120)&&(o=t.a().Result,o&&Diag.a.b(42541919,1,!!o.GridBlockModel,"PrimeCacheItemsFromPrefetchedGridBlocks: unexpected response, model is null, hash: {0}",u)),this.bV(u,t.a(),t.a().Errors,2,!1),_Ewa.U.a().V(u),_Ewa.U.a().e("PrefetchGetRange")}catch(w){this.bX(!0,!0,!1);_Ewa.U.a().a("PrimePrefecthedBlocksFailed");_Ewa.ULSError.a(w,"GridBlockManager.PrimeCacheItemsFromPrefetchedGridBlocks",!1)}finally{window._ewaPrefetchGetRanges=null}},bp:function(n,t){var r=this.by.Z(),i,a,y,w,f;if(!this.bw.isChangeGateEnabled("OfficeVSO:3728703_WorkBookCacheActiveItemNullFix")&&!r){Diag.a.a(25290761,0,50,"GridBlockManager.PrimeCacheItemsFromWorkbookCache: initialActiveItem shouldn't be null");return}if(_Ewa.B.d(r))for(var c=n,b=c.length,e=0;e<b;++e){var u=c[e],l=u.Information.BlockCachePosition,o=this.bR(r,l);if(o.B=2,i=this.t(r,l),_Ewa.U.a().X(i),t&&i in t){a=t[i];for(var v=a,k=v.length,s=0;s<k;++s)y=v[s],o.x().b(new _Ewa.go(y))}if(u.FloatingObjects)for(var p=u.FloatingObjects,d=p.length,h=0;h<d;++h)w=p[h],w.IsFromWorkbookCache=!0;this.cx(i,o);f={};f.Result=u;f.clientStopwatchId="0";this.bV(i,f,null,2,!1)}},ba:function(){var f=Object.keys(this.bx).length,e=this.bx,t,n,i,r,u;for(t in e)n={key:t,value:e[t]},i=n.value,this.bw.f().f(i.v.c())||(this.bW(i,n.key,!0),System.a.a(_Ewa.b.f(this.bz,n.key)));r=Object.keys(this.bx).length;u=f-r;u>0&&(Diag.a.a(595149459,0,50,"GridBlockManager.ClearInvalidBlockCacheItems: blocksInCacheBeforeRemoval = {0}, blocksInCacheAfterRemoval = {1}, blocksRemoved = {2}",f,r,u),this.bz.dg())},Z:function(n,t){var i=this.cz(n,t,!0);return i?$$sc.b.j(i):null},bn:function(n,t,i){var r=this.ci(n);return r.a()?new _Ewa.eg(r,this.bH,t,i,this.bw,!0):(Diag.a.b(594019905,0,!1,"GetModelCell called before block model exist. blockHash: {0}",n),null)},K:function(n,t){var i=t?this.ci(t):this.Z(n,this.bw.j().a);if(i&&i.a()){var r=i.n,u=_Ewa.i.q(r.Content.RowNumbers,n.a),f=_Ewa.i.q(r.Content.ColumnNumbers,n.b);return new _Ewa.eg(i,this.bH,u,f,this.bw,!0)}return Diag.a.b(593249427,0,!1,"GetModelCellFromRange called before block model exist. BlockHash: {0} Cell: {1} BlockCachItem is null: {2}",t,n,!i),null},C:function(n,t){return this.h()?this.Z(n,t):_Ewa.b.a(this.bw).bd(n)},bR:function(n,t){var r=this.t(n,t),i=new _Ewa.em(n,this.bw.p(),r,this.bH,this,this.bw,null,_Ewa.fY.c);return this.bT(i,t,!0),i},bT:function(n,t,i){_Ewa.fY.prototype.bT.call(this,n,t,i);var r=_Ewa.b.d(new _Ewa.bo(t.Y,t.X,t.Y,t.X,t.PaneType),this.bI,this.bJ);n.n.Information.RangeInformation=r.u()},cy:function(n,t,i,r,u){var o=t.bm(),e=this.bw,f=e.e().RenderingOptions;return this.bw.a(517)&&(t.n.Information.HighPriority?f|=8:f&=-9),_Ewa.p.f(this.bw)?f|=16:f&=-17,_Ewa.jI.d(n,this.bJ,this.bI,_Ewa.B.h(t.v,this.by),o,t.L,t.n.Information.Revision,t.N,t.P,f,e.bp(),i,r,u,n.b(!1),t.I.c(),this.bl(t))},bY:function(n,t){var r=n,rt=_Ewa.h.d(t.Errors,[-356977682]),i,s,e,l,o,a,u,v,y,b,h,tt,it,k,c;if(rt)return r.O(r.n.Information,r.L,!1),r.n.Information.BlockTypes=0,r.X=null,r.W=new _Ewa.jS,r.bh=new _Ewa.lZ,r.Z=new _Ewa.kw,2;if(i=t.Result,i&&!n.n.Information.HighPriority&&n.r>0&&(s=i.LatestClientInstantaneousChangeRequestId,e=this.bD,!(!e||!e.length)))if(_Ewa.e.b(s,e,!1))this.bM&&(this.bM.a(),this.bM=null);else return this.bN++,l=this.dc(),Diag.a.a(595195089,0,50,"GridBlockManager.UpdateStateFromSuccessfulResponse - block content does not include last instantaneous operation performed by client - don't render. BlockHash = {0}, latestClientInstantaneousChangeRequestIdByServer={1}, latestClientInstantaneousChangeRequestIdByClient={2}, GetRangeContent stateid={3}, LatestStateId={4}, numberOfGetRangeMissesDueToInstantaneousRequestIdCheck = {5}, numberOfReferencedBlocks = {6}",r.E,s,e,t.StateId,this.bw.c().d(),this.bN,l),this.bN===this.cN&&Diag.a.a(595195088,0,15,"GridBlockManager.UpdateStateFromSuccessfulResponse - suspected long loop of GetRange misses due to instantaneous request id check. BlockHash = {0}, latestClientInstantaneousChangeRequestIdByServer={1}, latestClientInstantaneousChangeRequestIdByClient={2}, GetRangeContent stateid={3}, LatestStateId={4}, numberOfGetRangeMissesDueToInstantaneousRequestIdCheck = {5}, numberOfReferencedBlocks = {6}",r.E,s,e,t.StateId,this.bw.c().d(),this.bN,l),r.O(r.n.Information,-1,!1),1;if(r.n.Information.Revision===t.StateId&&r.L===-1)return o={},o.a=this.bw.e().UserSessionId,o.b=t.clientStopwatchId,o.c=t.StateId,_Ewa.z.a().a(12,o,!0),r.O(r.n.Information,-1,!1),1;if(t.StateId!==-1&&t.StateId<this.bw.c().d())return Diag.a.a(34944866,0,50,"GridBlockManager.UpdateStateFromSuccessfulResponse - outdated content. ClientStopwatchId = {0}, GetRangeContent stateid = {1}, LatestStateId = {2}",t.clientStopwatchId,t.StateId,this.bw.c().d()),1;if(_Ewa.h.d(t.Errors,[1007290786]))return 3;if(!n.n.Information.HighPriority&&t.ReportCalcState&&!t.CalcComplete)return this.bw.isChangeGateEnabled("OfficeVSO:3858246_ReissueGetRangeIfCalcPending")&&r.O(r.n.Information,-1,!1),1;if(i)if(this.bw.a(120)&&(Diag.a.a(42772301,0,50,"UpdateStateFromSuccessfulResponse: blockHash: {0}, IsRenderingCellsFromModel: {1}, response.IsCanvasRenderingSupported: {2}, model is null: {3}, Digest: {4}, ecsDigest = {5}, Revision: {6}, contentSource: {7}",r.E,this.h(),i.IsCanvasRenderingSupported,!i.GridBlockModel,i.Digest,i.EcsSpreadsheetDigest,i.Information.Revision,_Ewa.gb.toString(r.B)),a=!this.bA&&r.B!==2,a&&Diag.a.b(50976215,0,!!i.GridBlockModel,"Got block from server with null model, blockHash: {0}, contentSource = {1}, digest {2}, ecsDigest {3}",r.E,_Ewa.gb.toString(r.B),r.N,r.P),a&&i.GridBlockModel&&(i.IsCanvasRenderingSupported?this.cl(1):this.cl(2),this.cw=i.GridBlockModel.RenderFlags)),u=r.n,i.Digest||n.B===2){_Ewa.mC.c(i);v=_Ewa.B.r(r.v,_Ewa.ed.a(i.UsedRangeOnSheetOrNamedObject),i.Information.BlockCachePosition.PaneType===1,i.Information.Revision,t.clientStopwatchId);y=this.bw.p().a("UserAction","ClientBlockUpdatesValidation");v&&this.dM(r,i);this.cF(r);var p=!!u.GridBlockModel&&r.bu(),ut=this.h()?!!r.w:!!r.F,f=!1,w=!!u&&ut,ft=!this.bA&&r.B===2;if(this.h()&&i.IsCanvasRenderingSupported&&!ft?(i.GridBlockModel.CellsEncoding&&_Ewa.mD.b(i.GridBlockModel,this.bw),!p&&w&&(b=gridRenderer.GridBlockRendererGlobals.compareGridBlockModels(i.GridBlockModel,u.GridBlockModel),f=b.isEqual,Diag.a.a(51386444,1,50,"GridBlockManager.UpdateStateFromSuccessfulResponse: models equal = {0}. RenderingState = {1}, isGridBlockModelDirty = {2}, ewaResult.ClientStopwatchId = {3}, message = {4}",f,this.bA,p,t.clientStopwatchId,b.message),f?(f=this.cM(i.Content.ColumnHeaderHtml,u.Content.ColumnHeaderHtml)&&this.cM(i.Content.RowHeaderHtml,u.Content.RowHeaderHtml),f&&(f=this.cM(i.Content.OverlayGridHtml,u.Content.OverlayGridHtml))):r.w&&(r.w.c=!1))):(h=null,w&&(h=this.di(u,r.E)),this.dg(r,i)&&h&&(tt=r.F.getElementsByClassName("ewrcp"),tt.length||(it=this.di(i,r.E),_Ewa.e.b(h,it,!1)&&(f=!0)))),y.a(),_Ewa.z.a().c(y.c(),t.clientStopwatchId,_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0),Diag.a.a(21063698,1,50,"GridBlockManager.UpdateStateFromSuccessfulResponse: renderingContentUnchanged = {0}. RenderingState = {1}, isGridBlockModelDirty = {2}, canUseCache = {3}, ewaResult.ClientStopwatchId = {4}, IsBlockCanvasRenderingSupported = {5}, ",f,this.bA,p,w,t.clientStopwatchId,i.IsCanvasRenderingSupported),f)return(r.O(r.n.Information,t.StateId,!1),this.bw.isChangeGateEnabled("OfficeVSO:4024429_refactor_code_duplication")||(r.N=i.Digest,r.P=i.EcsSpreadsheetDigest),u.Information.HighPriority=i.Information.HighPriority,u.Content.StyleMapColumnsNew=i.Content.StyleMapColumnsNew,u.Content.StyleMapSpansNew=i.Content.StyleMapSpansNew,u.Content.StyleMapIdxsNew=i.Content.StyleMapIdxsNew,u.Content.StyleMapHtml=i.Content.StyleMapHtml,u.Content.Ifmt=i.Content.Ifmt,u.Content.RichValueFieldIndexes=i.Content.RichValueFieldIndexes,u.Content.FormulaValues=i.Content.FormulaValues,u.Content.RichValueDomains=i.Content.RichValueDomains,u.LatestClientInstantaneousChangeRequestId=i.LatestClientInstantaneousChangeRequestId,u.FloatingObjectsMetaData=i.FloatingObjectsMetaData,u.FloatingObjects=i.FloatingObjects,u.FirstFloatingObject=i.FirstFloatingObject,u.Autofilters=i.Autofilters,this.bw.isChangeGateEnabled("OfficeVSO:4024429_refactor_code_duplication")||this.cQ(r,i),this.bw.a(120)&&(u.GridBlockModel=i.GridBlockModel),k=this.h()&&i.IsCanvasRenderingSupported,k&&(u.Content.GridHtml=i.Content.GridHtml,this.bw.isChangeGateEnabled("OfficeVSO:4024429_refactor_code_duplication")||(this.cP(r,i),this.cO(r,i),r.bh=_Ewa.lZ.a(i.CustomFunctionsObjects),r.Z=_Ewa.kw.a(i.RichValueFields))),u.NonEmptyCellsCount=i.NonEmptyCellsCount,u.TextValueCellsCount=i.TextValueCellsCount,this.df(this.bw,i,r,k),v)?(u.UsedRangeOnSheetOrNamedObject=i.UsedRangeOnSheetOrNamedObject,5):4}else return n.O(n.n.Information,t.StateId,!1),n.P=i.EcsSpreadsheetDigest,u.LatestClientInstantaneousChangeRequestId=i.LatestClientInstantaneousChangeRequestId,6;else return 2;var d=2,et=_Ewa.p.c(this.bw)&&!this.bA&&r.B===2,g=!isNullOrUndefined(i.GridBlockModel)&&(this.g()||et),nt=!_Ewa.e.a(i.Content.GridHtml);return Diag.a.b(591204824,1,nt||g,"GridBlockManager.UpdateStateFromSuccessfulResponse: unexpected rendering - canRenderinHtml({0}) || canRenderInCanvas({1})",nt,g),!_Ewa.fY.prototype.bY.call(this,r,t)&&i.Content&&(nt||g)&&(d=0,this.bw.isChangeGateEnabled("OfficeVSO:3858246_ReissueGetRangeIfCalcPending")&&t.ReportCalcState&&!t.CalcComplete&&r.O(r.n.Information,-1,!1)),d||(this.bw.isChangeGateEnabled("OfficeVSO:4024429_refactor_code_duplication")||(r.N=i.Digest,r.P=i.EcsSpreadsheetDigest),_Ewa.uA.a(r.v,i.PaneViewData,r.n.Information.Revision,t.clientStopwatchId,!1),this.bw.isChangeGateEnabled("OfficeVSO:4024429_refactor_code_duplication")||(this.cP(r,i),this.cO(r,i),this.cQ(r,i),r.bh=_Ewa.lZ.a(i.CustomFunctionsObjects),r.Z=_Ewa.kw.a(i.RichValueFields)),this.df(this.bw,i,r,!0)),c=!!t&&!!t.RequestTelemetryData,_Ewa.b.a(this.bw).w().j(n.n.Information.Revision,_Ewa.bj.b,c?t.RequestTelemetryData.EcsOperationDuration:0,c?t.RequestTelemetryData.EcsRequestDuration:0,c?t.RequestTelemetryData.WfeRequestDuration:0),d},cF:function(n){var t=n,i;if(t&&t.F&&!t.N&&(i=t.n,i&&i.Content))try{i.Content.GridHtml=t.F.innerHTML}catch(r){Diag.a.a(42566751,0,15,"GridBlockManager.UpdateBlockContentFromCurrentState InnerHTML len: {0}, Exception: {1} ",t.F.innerHTML.length,r.toString());throw r;}},cB:function(){this.ca("")},cA:function(n){var t=this.dL();t&&this.dE("ekbbe",t,null);_Ewa.fY.prototype.cA.call(this,n)},ci:function(n){return this.a(n)},cz:function(n,t,i){var u=new($$sc.u.$$(_Ewa.em)),f=this.bx;for(var e in f){var o={key:e,value:f[e]},r=o.value,s=!!r.q&&r.q!==2;if(s&&r.b()&&r.b().h(n)&&_Ewa.e.b(r.v.a,t,!1)&&(u.b(r),i))break}return u.e.length>0?u:null},cj:function(n,t){_Ewa.fY.prototype.cj.call(this,n,t);Diag.a.a(595096281,0,50,"GridBlockManager.OnSessionIdChanged: resetting ClientInstantaneous state for LatestClientInstantaneousChangeRequestId = {0}",this.bD);this.ca("")},bW:function(n,t,i){this.bw.a(117)&&n.dispose();_Ewa.fY.prototype.bW.call(this,n,t,i)},dS:function(n,t){t.a&&t.a.MakeInstantaneousChange&&!_Ewa.e.b(t.a.ClientRequestId,this.bD,!1)&&this.ca(t.a.ClientRequestId)},dR:function(n,t){t.a&&t.a.g&&t.a.g.length&&!_Ewa.e.b(t.a.g,this.bD,!1)||(Diag.a.a(595096280,0,50,"GridBlockManager.OnWebMethodError: resetting ClientInstantaneous state for LatestClientInstantaneousChangeRequestId = {0}",this.bD),this.ca(""))},dO:function(){Diag.a.a(595096279,0,50,"GridBlockManager.OnJsCrash: resetting ClientInstantaneous state for LatestClientInstantaneousChangeRequestId = {0}",this.bD);this.ca("")},ca:function(n){this.bD=n;this.bN=0;_Ewa.e.a(this.bD)||(this.cN=(this.bw.h().b()+1)*this.dc()*4,this.bM=this.bw.p().a("ModelUpdate","BlocksUpdateUponClientInstantaneousChangeRequestId"),_Ewa.z.a().c(this.bM.c(),this.bD,_Ewa.bb.toString(0),_Ewa.bb.toString(30),!0))},dg:function(n,t){try{return t&&t.Content&&t.Content.GridHtml?(n.F=document.createElement("div"),_Ewa.a.k(n.F,t.Content.GridHtml),t.Content.GridHtml=n.F.innerHTML,!0):!1}catch(i){return Diag.a.a(21627984,0,10,"GridBlockManager.CanonizeResponseGridHtml failed: {0}",i.message),this.ck(n),!1}},cQ:function(n,t){var i=t.FloatingObjectsMetaData,u=_Ewa.eX.b(this.bw,i,n.K,n.G),r=_Ewa.eX.a(this.bw,i),f=!r||u;f?(n.W=_Ewa.jS.a(t.FloatingObjects),this.bw.a(270)&&(r?n.x().c(n.be):(n.be=null,n.K=null))):n.x().c(t.FloatingObjects)},cM:function(n,t){if(!n&&!t)return!0;if(!n||!t)return!1;var i=_Ewa.F.f(n,null),r=_Ewa.F.f(t,null);return _Ewa.e.b(i,r,!1)},bc:function(){this.bE=1;this.dh(!0);this.bB.c();Diag.a.a(595091800,0,50,"Session forced fallback to Canvas")},k:function(n,t){var i=!1;return this.g()&&(t&&(this.bE=2,this.bB.c()),(this.bA!==2&&this.bE!==1||this.bE===2)&&(this.dh(t),t||this.cl(2),Diag.a.a(39982420,0,50,"Session fallback to HTML, reason: {0}",n),i=!0),this.cY(this.g()),this.cZ(this.g())),i},dV:function(){Diag.a.a(591684898,0,50,"GridBlockManager.ScavengeCacheAfterMetadataChange: clearing the blocks' cache after metadata change operation");this.bX(!0,!1,!0)},dh:function(n){for(var t,u,i,f=this.r(),e=_Ewa.b.a(this.bw),r=0;r<f.length;r++)(t=f[r],t.r<=0)||(this.dg(t,t.n),u=this.bl(t),u&&(i=_Ewa.b.f(e,u),i&&(this.bE===1?i.E():i.F(n))))},di:function(n){var h=n.Information.Revision,t,i,o,s;n.Information.Revision=-1;var c=n.Digest,l=n.EcsSpreadsheetDigest,a=n.Information.HighPriority,v=n.Content.StyleMapColumnsNew,y=n.Content.StyleMapSpansNew,p=n.Content.StyleMapIdxsNew,w=n.Content.StyleMapHtml,b=n.Content.Ifmt,k=n.UsedRangeOnSheetOrNamedObject,d=n.Content.RichValueFieldIndexes,it=n.Content.RichValueTypes,g=n.Content.FormulaValues,nt=n.Content.RichValueDomains,r=null;this.bw.a(120)&&(r=n.GridBlockModel);var tt=n.LatestClientInstantaneousChangeRequestId,u=null,f=null,e=null;u=n.FloatingObjects;f=n.FloatingObjectsMetaData;e=n.FirstFloatingObject;t=0;i=0;t=n.NonEmptyCellsCount;i=n.TextValueCellsCount;o=n.SheetAutoFilterRange;delete n.Digest;delete n.EcsSpreadsheetDigest;delete n.Information.HighPriority;delete n.Content.StyleMapColumnsNew;delete n.Content.StyleMapSpansNew;delete n.Content.StyleMapIdxsNew;delete n.Content.StyleMapHtml;delete n.Content.Ifmt;delete n.UsedRangeOnSheetOrNamedObject;delete n.Content.RichValueFieldIndexes;delete n.Content.FormulaValues;delete n.Content.RichValueDomains;this.bw.a(120)&&(this.bA||!n.IsCanvasRenderingSupported)&&delete n.GridBlockModel;delete n.LatestClientInstantaneousChangeRequestId;delete n.Content.FloatingObjects;delete n.Content.FloatingObjectsMetaData;delete n.Content.FirstFloatingObject;delete n.NonEmptyCellsCount;delete n.TextValueCellsCount;delete n.SheetAutoFilterRange;try{s=Sys.Serialization.JavaScriptSerializer.serialize(n)}finally{n.Information.Revision=h;n.Digest=c;n.EcsSpreadsheetDigest=l;n.Information.HighPriority=a;n.Content.StyleMapColumnsNew=v;n.Content.StyleMapSpansNew=y;n.Content.StyleMapIdxsNew=p;n.Content.StyleMapHtml=w;n.Content.Ifmt=b;n.UsedRangeOnSheetOrNamedObject=k;n.Content.RichValueFieldIndexes=d;n.Content.FormulaValues=g;n.Content.RichValueDomains=nt;this.bw.a(120)&&(n.GridBlockModel=r);n.LatestClientInstantaneousChangeRequestId=tt;n.FloatingObjects=u;n.FloatingObjectsMetaData=f;n.FirstFloatingObject=e;n.NonEmptyCellsCount=t;n.TextValueCellsCount=i;n.SheetAutoFilterRange=o}return s},G:function(){this.bz.cl()},U:function(n,t){var i=t-n;this.bG+=i;this.bG>this.co&&this.O()},O:function(){var o=this.bG,i=0,r=this.bx,t,u,n;for(t in r)u={key:t,value:r[t]},n=u.value,n.r>0?i++:n.w&&(this.bG-=n.w.b,n.bC());var f=this.bz.V(),e=this.bz.c().a(778)?_Ewa.t.a(this.bz.c()).b():1,s=f*e;Diag.a.a(592737730,0,50,"GridBlockManager.NotifyCanvasElementCountChange: cleared canvas cache. previousCacheCount = {0}, newCacheCount = {1}, limit = {2}, visibleBlocks = {3}, DPR = {4}, zoom = {5}, scaleFactor = {6}",o,this.bG,this.co,i,f,e,s)},dM:function(n,t){var r=this.bl(n),u=this.db(n),f,e,i;if(!r||!r.length||!u||!u.length){Diag.a.a(21112140,0,10,"GridBlockManager.CopyUsedRangeToOtherBlocks: invalid blockCacheItem {0}",r);return}if(t.UsedRangeOnSheetOrNamedObject&&t.UsedRangeOnSheetOrNamedObject.RangeType===1){f=this.bx;for(e in f){var o={key:e,value:f[e]},s=o.value,h=o.key,c=this.db(s);_Ewa.e.b(u,c,!1)&&!_Ewa.e.b(r,h,!1)&&(i=s.n,i&&i.UsedRangeOnSheetOrNamedObject&&i.UsedRangeOnSheetOrNamedObject.RangeType===1&&(i.UsedRangeOnSheetOrNamedObject=_Ewa.Pm.a(t.UsedRangeOnSheetOrNamedObject)))}}},dU:function(n,t){if(this.bw.a(120)){var i=n.Result;i&&Diag.a.b(42541921,1,!!i.GridBlockModel,"ProcessCompleteAggregateBlockRequest: unexpected response, model is null, hash: {0}",t)}this.bV(t,n,n.Errors,2,!0)},dP:function(n,t){var i,r,f,u;if(t.b===1&&(i=t.a.a.a(),i&&i.GridBlockResponsePairs))for(r=0,f=i.GridBlockResponsePairs.length;r<f;r++)u=i.GridBlockResponsePairs[r].EwaResult,u&&this.dU(u,i.GridBlockResponsePairs[r].HashCode)},dL:function(){var i,h,l,f,n;if(!this.bz||!(i=this.bz.bY()))return null;var o=i.a.X,s=i.a.Y,e=!1,u=null,t=null,c=this.bx;for(h in c)if(l={key:h,value:c[h]},f=l.value,f.r&&f.v===this.by.o()&&f.n.Information.BlockCachePosition.PaneType===this.bz.G()){n=f.n.Information.BlockCachePosition;switch(f.q){case 4:o=Math.min(o,n.X);s=Math.min(s,n.Y);e=!0;break;case 5:t?t.h(n):t=new _Ewa.bo(n.Y,n.X,n.Y,n.X,n.PaneType);break;default:return Diag.a.a(36975695,0,50,"GridBlockManager.BuildBlockBoundaryEventArgs: invalid blockCacheItem state {0}",f.q),null}u?u.h(n):u=new _Ewa.bo(n.Y,n.X,n.Y,n.X,n.PaneType)}if(!u||!t||!e&&u.a.X!==i.a.X&&u.a.Y!==i.a.Y)return null;var r=0,a=t.a,v=i.a;if(e&&o===t.b.X?r|=4:a.Y===v.Y&&(r|=1),e&&s===t.b.Y?r|=8:a.X===v.X&&(r|=2),!r)return null;var y=!!(r&5),p=!!(r&10),w=new _Ewa.bo(0,0,y?t.a.Y:i.a.Y,p?t.a.X:i.a.X,1);return new _Ewa.Cx(w,u,r)},cO:function(n,t){var r,i,u;this.bw.c().b()||(r=$$as(_Ewa.cC,this.bw.n()),r&&(i=n.n.Information.BlockCachePosition,u=_Ewa.b.d(new _Ewa.bo(i.Y,i.X,i.Y,i.X,i.PaneType),this.bI,this.bJ),r.bn(u,n.v.c(),t.NamedObjects,!0)))},cP:function(n,t){var i,r,o,f,u,s,e;if(n.X=null,this.bZ=!1,i=t.Ranges,r=this.bw.a(116)?_Ewa.i.P(t):null,i||r){if(o=i?i.length:0,this.bw.a(116)&&r&&(o+=r.length),f=new Array(o),i)for(u=i.length-1;u>=0;--u)f[u]=_Ewa.ed.a(i[u]),!this.cm&&_Ewa.kT.isInstanceOfType(f[u])&&(this.cm=!0),!this.cn&&_Ewa.fH.isInstanceOfType(f[u])&&(this.cn=!0),!this.bZ&&_Ewa.id.isInstanceOfType(f[u])&&(this.bZ=!0);if(this.bw.a(116)&&r&&r.length>0)for(s=i?i.length:0,e=s;e<r.length;e++)f[e]=_Ewa.ed.a(r[e]);n.X=f}},dQ:function(n,t){this.bC.b=t.a>1?!0:!1},dN:function(){var t=null,i=window._ewaPrefetchGetRanges,n;if(!isNullOrUndefined(i))for(t=[],n=0;n<i.length;n++)Array.add(t,new _Ewa.mC.b(i[n]));return t},dT:function(n){var r,t,i;if(this.bw.e().IsGridCanvasRenderingSupported){r=!1;for(var e=n,s=e.length,u=0;u<s;++u)if(t=e[u],!isNullOrUndefined(t)&&!isNullOrUndefined(t.a())&&!isNullOrUndefined(t.a().Result)&&!t.a().Result.IsCanvasRenderingSupported){Diag.a.a(40251853,1,50,"GridBlockManager.PrimeCacheItemsFromPrefetchedGridBlocks: Prefetch fallback to HTML");r=!0;break}if(r)for(var o=n,h=o.length,f=0;f<h;++f)i=o[f],isNullOrUndefined(i)||isNullOrUndefined(i.a())||isNullOrUndefined(i.a().Result)||(i.a().Result.IsCanvasRenderingSupported=!1)}},df:function(n,t,i,r){n.isChangeGateEnabled("OfficeVSO:4024429_refactor_code_duplication")&&(i.N=t.Digest,i.P=t.EcsSpreadsheetDigest,this.cQ(i,t),r&&(this.cP(i,t),this.cO(i,t),i.bh=_Ewa.lZ.a(t.CustomFunctionsObjects),i.Z=_Ewa.kw.a(t.RichValueFields)));i.bH(this.bw)}};_Ewa.mC.b=function(n){this.b=n};_Ewa.mC.b.prototype={c:null,b:null,a:function(){return isNullOrUndefined(this.c)&&(this.c=_Ewa.F.b(this.b.EwaResultJson)),this.c}};_Ewa.FA=function(n,t,i,r,u,f){this.ig=Function.createDelegate(this,this.lk);this.ih=Function.createDelegate(this,this.ll);_Ewa.FA.initializeBase(this,[n,t,i,r,u,f]);this.ep=new _Ewa.uf(this);this.dJ.d(this.ih);this.dJ.W(this.ig);this.fx=0;this.jv()};_Ewa.FA.b=function(n,t,i){var r,u,f;for(i(n),r=n.dC.nextSibling,u=t.dC;r&&r!==u;r=r.nextSibling)f=_Ewa.gN.b(r),i(f);n!==t&&i(t)};_Ewa.FA.prototype={gV:null,ep:null,dP:null,fy:null,fM:null,dW:null,er:null,eR:0,eS:!1,gY:!1,gZ:!1,fz:null,gO:null,gQ:0,gR:0,gM:0,gN:0,fL:null,fK:null,gP:null,dU:null,bY:function(){return this.dU},gS:!1,cf:function(){return this.gS},gk:function(n){var t,u,f,i,r;return _Ewa.bo.b(n,this.fy)||(this.fy=n?n.c():null,n?(t=this.fk(n.a).b,u=this.io(n.a,!0),t.a=t.a+u.b(),f=this.io(n.a,!1),t.b=t.b+f.b()):t=null,t&&(i=this.es,r=new _Ewa.kX,r.a=new _Ewa.M(i.b?t.a:i.a.a,i.c?t.b:i.a.b),r.b=i.b,r.c=i.c,this.es=r),this.go(t,null,!0)),n},hd:function(n){return _Ewa.bo.b(n,this.dW)||(this.dW=n?n.c():null),n},gW:function(){return this.fM||(this.fM=new _Ewa.bo(0,0,0,0,this.dN))},gl:function(n){return _Ewa.bo.b(n,this.fM)||(this.fM=n?n.c():null),n},fx:0,h:function(){return this.ep},cy:function(){return _Ewa.mE.prototype.cy.call(this)},eU:function(n){var t,i;for(_Ewa.mE.prototype.eU.call(this,n),t=this.$$ge();t.$$mn();)i=t.$$cu(),i.t(n);return n},ln:function(n){return this.eS!==n&&(this.eS=n,!n),n},cE:function(){return this.d()&&(Common.c.i()||Common.c.be()||Common.c.f())&&this.bc().b()?_Ewa.Z.a():0},bc:function(){return this.fz||(this.fz=new _Ewa.Qg(this.dC,this.d()))},bN:function(){return this.dP},fA:function(n){if(n){if(!this.dD.j())return Diag.a.a(42075938,1,10,"GridViewBase.LoadedBlockArea.set: setting a non-null loaded block area when activeItem is null"),n;var t=this.dD.j().j;t&&(t.a=n.c())}return this.dP=n,n},ij:function(){return!0},dR:function(){return this.dD.j()&&this.dD.f()&&!_Ewa.e.a(this.dD.j().c())?$$as(_Ewa.cd,this.dD.f()).ca(this.dD.j().c()):null},jy:function(){return this.gV||(this.gV=_Ewa.dP.b()),this.gV},X:function(){return this.dR()?this.dR():this.jy()},jz:function(){return this.dD.a(822)&&!this.dD.c().S()?this.dD.e().HorizontalBufferPixelsDuringBoot:480},jA:function(){return this.dD.a(822)&&!this.dD.c().S()?this.dD.e().VerticalBufferPixelsDuringBoot:140},jC:function(n){return n!==this.eR&&(this.eR=n),n},it:function(n,t,i){var s,f,r,u,e,o,c,h;if(this.dP){for(s=0,f=[],r=this.fl.firstChild;r;r=r.nextSibling){if(u=_Ewa.gN.b(r),isNullOrUndefined(u)){Diag.a.a(42492830,1,15,"viewBlockFlow is null flow is continued, this.EwaControl is null={0}",!this.dD);continue}(e=u.l,e>=n&&e<=t)||(e<n&&(s+=u.e()),Array.add(f,u))}for(i&&this.eL(this.cz()+s),o=0,c=f.length;o<c;++o)h=f[o],this.hb(h),this.hi(h);this.hg()}},jD:function(n,t){if(Diag.a.a(42271320,1,50,"GridViewBase.SetActiveSheetProcessedDataFromResult: setting SheetProcessedData with {0} value",t?"non-null":"null"),this.dD.isChangeGateEnabled("OfficeVSO:4295083_UseSheetNamefromSpdResult"))if(t&&t.N){var i=!t.R||!t.C;i&&Diag.a.a(589969152,1,50,"GridViewBase.SetActiveSheetProcessedDataFromResult: partial SheetProcessedDataResult, SheetProcessedDataResult.R={0}, SheetProcessedDataResult.C={1}",t.R?"not null":"null",t.C?"not null":"null");$$as(_Ewa.cd,this.dD.f()).bt(t.N,i?null:t)}else Diag.a.a(590136669,1,15,"GridViewBase.SetActiveSheetProcessedDataFromResult: SheetProcessedDataResult returned unexpectedly null"),!n||!n.length||$$as(_Ewa.cd,this.dD.f()).bt(n,null);else!n||!n.length||$$as(_Ewa.cd,this.dD.f()).bt(n,t)},jw:function(n){this.fy=null;this.gk(n)},dispose:function(){this.dJ&&(this.dJ.f(this.ih),this.dJ.br(this.ig));System.a.b([this.ep,this.fz]);this.ep=null;this.fz=null;this.fA(this.fy=this.dU=this.dW=this.fM=null);this.er=null;_Ewa.mE.prototype.dispose.call(this)},hc:function(){this.eP(this.ep.q.x);this.ey(this.ep.q.y)},gj:function(n){var i=new _Ewa.kZ(this,n),t;return i.$$mn()?(t=i.$$cu().k(),n?t.a:t.b):new _Ewa.M(0,0)},fc:function(n){var t,i,r,u,f,pt,wt,bt,kt,it,b,gt,ni,ti,ii,ri,ui,fi,ei,oi,si,hi,ci,li,ot,c,g,nt,ai,vi,ct,rt,lt,yi,pi,wi,bi,ft,at,et,tt,k,ki,di,d;if(_Ewa.gN.prototype.fc.call(this,n),t=new _Ewa.FA.a(this.dD.e().ExcessiveClientViewportLogging),!this.dU){t.b("ActualNavigableBlockAreaIsNull",!0);return}if(!this.ep.g()||!this.dQ()){t.b("ViewportIsNotVisible",!0);return}var s=this.ep.f(),l=t.viewBufferTop=s.a.b,a=t.viewBufferLeft=s.a.a,y=t.viewBufferBottom=s.b.b,v=t.viewBufferRight=s.b.a,h,p,vt,yt;this.lh(l,y,vt={val:h},yt={val:p});h=vt.val;p=yt.val;this.lf(pt={val:i},wt={val:r},bt={val:u},kt={val:f});i=pt.val;r=wt.val;u=bt.val;f=kt.val;t.initialBlockMinimumX=i;t.initialBlockMaximumX=r;t.initialBlockMinimumY=u;t.initialBlockMaximumY=f;it=t.useSheetProcessedDataForRows=this.eT(y,!0)&&!this.ha(y,!0);b=t.useSheetProcessedDataForColumns=this.eT(v,!1)&&!this.ha(v,!1);t.firstVisibleViewBlockFlowExists=h?!0:!1;t.lastVisibleViewBlockFlowExists=p?!0:!1;t.previousBufferedViewportAreaExists=this.er?!0:!1;t.loadedBlockAreaExists=this.dP?!0:!1;var o=this.dU.b,e=this.dU.a,dt=!1;if(h||p){if(t.a("RequiredFlowsFound"),c=this.lg(h,p),!n&&c.f(s)&&this.dP.d(this.dP.e(this.dU))){t.b("ViewportIsSatisfied",!0);return}t.a(n?"forceViewportCalculation":"ViewportIsNotSatisfied");t.isLoadedBlockAreaWithinNavigableArea=this.dP.d(this.dP.e(this.dU));var gi=t.uncoveredAreaFromLeft=Math.max(0,c.a.a-s.a.a),nr=t.uncoveredAreaFromRight=Math.max(0,s.b.a-c.b.a),tr=t.uncoveredAreaFromTop=Math.max(0,c.a.b-s.a.b),ir=t.uncoveredAreaFromBottom=Math.max(0,s.b.b-c.b.b);g=Math.max(0,c.a.b-l);nt=Math.max(0,y-c.b.b);(nt>s.d()||g>s.d())&&(t.a("EmptyAreaIsGreaterThanBufferedArea"),nt=Math.min(nt,s.d()),g=Math.min(g,s.d()));var st=0,ut=0,w=h.y(s),ht=h.z(s);w||ht?(ut=Math.max(0,c.a.a-a),ut?(ct=0,ct=b?this.gX(a,c.a.a,!1):Math.floor(ut/this.ee),i=h.o-1-ct):(Diag.a.b(42075985,1,!!w.a.Z,null),i=w.a.Z?w.a.Z.X:0),o.X>i&&t.a("NavigableLeftTrimmedBlockMinimumX"),i=Math.max(o.X,i),st=Math.max(0,v-c.b.a),st?(rt=0,b?(rt=this.gX(c.b.a,v,!1),r=h.n+1+rt,r=Math.min(r,this.dR().j(!1))):(rt=Math.floor(st/this.ee),r=h.n+1+rt)):r=ht.Z.X,e.X<r&&t.a("NavigableRightTrimmedBlockMaximumX"),r=Math.min(e.X,r)):(t.a("NoneOfExistingBlocksAreWithinViewport"),b?(this.ik(a,v,ai={val:i},vi={val:r},!1),i=ai.val,r=vi.val):(r=Math.min(e.X,Math.max(o.X,Math.floor(v/this.ee))),i=Math.max(o.X,r-Math.floor((v-a)/this.ee))));i!==this.dP.b.X||r!==this.dP.a.X?(yi=this,lt=function(n){yi.le(n,i,r)}):(pi=this,lt=function(n){n.t(pi.cy())});_Ewa.FA.b(h,p,lt);(w||ht)&&!b?(Diag.a.b(42075988,1,!!w.a.Z,null),this.eM(!ut||!w.a.Z?w.b:w.b-Math.max(0,w.a.Z.X-i)*this.ee)):(wi=new _Ewa.bo(0,i,0,r,this.dN),bi=this.fk(wi.b).b,this.eM(Math.floor(bi.a/10)*10));g>0&&h.l>o.Y?(ft=Math.max(0,h.l-1),at=it?ft-this.gX(l,c.a.b,!0):ft-Math.floor(g/this.eq),o.Y>at&&t.a("NavigableTopTrimmedBlockMinimumY"),u=Math.max(o.Y,at),this.fN(i,r,u,ft,!0)):(o.Y>h.l&&t.a("NavigableTopTrimmedBlockMinimumY"),u=Math.max(o.Y,h.l));nt>0&&p.l<e.Y?(et=Math.max(0,p.l+1),it?(tt=et+this.gX(c.b.b,y,!0),tt=Math.min(tt,this.dR().j(!0))):tt=et+Math.floor(nt/this.eq),e.Y<tt&&t.a("NavigableBottomTrimmedBlockMaximumY"),f=Math.min(e.Y,tt),this.fN(i,r,et,f,!1)):(e.Y>p.l&&t.a("NavigableBottomTrimmedBlockMaximumY)"),f=Math.min(e.Y,p.l))}else t.a("RequiredFlowsAreNotFound"),!this.er&&this.dP?(t.a("NoPositionInformationAndInitialBlockAreaWasSeeded"),b?(this.ik(a,v,gt={val:i},ni={val:r},!1),i=gt.val,r=ni.val):(i=Math.max(o.X,Math.min(e.X,i)),r=Math.min(e.X,i+Math.floor((v-a)/this.ee))),it?(this.ik(l,y,ti={val:u},ii={val:f},!0),u=ti.val,f=ii.val):(u=Math.max(o.Y,Math.min(e.Y,u)),f=Math.min(e.Y,u+Math.floor((y-l)/this.eq)))):(t.a("PreviousPositionInformationNoLoadedBlockArea"),this.jv(),b?(this.gU(o.X,e.X,a,v,this.ee,this.dR(),!1,ri={val:i},ui={val:r}),i=ri.val,r=ui.val,this.he(l,a,i,u,o,e)):(!this.er||!this.dP||Math.abs(this.er.a.a-a)>this.ee/2&&Math.abs(this.er.b.a-v)>this.ee/2)&&(this.gU(o.X,e.X,a,v,this.ee,null,!1,fi={val:i},ei={val:r}),i=fi.val,r=ei.val,this.he(l,a,i,u,o,e)),it?(this.gU(o.Y,e.Y,l,y,this.eq,this.dR(),!0,oi={val:u},si={val:f}),u=oi.val,f=si.val,this.he(l,a,i,u,o,e)):(!this.er||!this.dP||Math.abs(this.er.a.b-l)>this.eq/2&&Math.abs(this.er.b.b-y)>this.eq/2)&&(this.gU(o.Y,e.Y,l,y,this.eq,null,!0,hi={val:u},ci={val:f}),u=hi.val,f=ci.val,this.he(l,a,i,u,o,e)),li=new _Ewa.bo(u,i,f,r,this.dN),ot=this.fk(li.b).b,this.eL(Math.floor(ot.b/10)*10),this.eM(Math.floor(ot.a/10)*10),dt=!0),this.fN(i,r,u,f,!1);t.calculatedBlockMinimumX=i;t.calculatedBlockMaximumX=r;t.calculatedBlockMinimumY=u;t.calculatedBlockMaximumY=f;i<=r&&u<=f||Diag.a.a(42075990,1,15,"GridViewBase.OnViewportChange: new calculated block area [{0},{1}:{2},{3}] is not normalized",i,u,r,f);this.it(u,f,!dt);k=0;i===this.dW.b.X?(k=-this.bJ(),this.eM(0)):this.bJ()||(b?(ki=i*this.ei,di=this.il(0,ki,this.dN),k=Math.floor(di.a/10)*10):k=Math.floor(Math.max(i,.25)*this.ee),this.eM(k));d=0;u===this.dW.b.Y?(d=-this.cz(),this.eL(0)):this.cz()||(this.dD.isChangeGateEnabled("OfficeVSO:4257365_InvestigateInvalidPushHeight")&&Diag.a.a(42075996,1,50,"GridViewBase.OnViewportChange: inadequate space for flows, adding some empty space by pushing down"),d=Math.floor(Math.max(l,this.eq*.5)),this.eL(d));this.er=s.e();this.fA(new _Ewa.bo(u,i,f,r,this.dN));_Ewa.mA.a("OnViewportChange",t.d(),t.c(),this.dJ,this.dD.j());t.b(t.e()?"ExistingWithChanges":"ExistingWithoutChanges",!1);(k||d)&&(t.viewportScrollAdjustmentX=k,t.viewportScrollAdjustmentY=d,this.ep.e(_Ewa.M.a(this.ep.p.a,new _Ewa.M(k,d))));_Ewa.FA.a.a--},ha:function(n,t){var i=this.im();return n>=(t?i.y:i.x)*.85},eT:function(){return!!this.dR()&&this.lo()},ii:function(n,t){var i=this.dU.c(),r=i.a,u=this.dW.a;n>0&&!(this.eR&8)&&(r.X=Math.min(r.X+n,u.X));t>0&&!(this.eR&4)&&(i.a.Y=Math.min(r.Y+t,u.Y));this.eC(i,2,!0)},lm:function(n){if(this.eS&&(!n||!this.gY)&&(n||!this.gZ)){var t=!1;n&&this.fy.a.Y<this.dW.a.Y&&(t=this.bc().f())?(this.gY=!0,this.ii(0,1)):!n&&this.fy.a.X<this.dW.a.X&&(t=this.bc().g())?(this.gZ=!0,this.ii(1,0)):t}},hk:function(n){_Ewa.gN.prototype.hk.call(this,n);this.fz&&(this.fz.a=n)},ex:function(){_Ewa.mE.prototype.ex.call(this);this.fA(null);this.eR=0;this.er=null;this.h()&&this.h().e(null)},eC:function(n,t,i){if(!_Ewa.bo.b(n,this.dU)){var r=null;if(n)switch(this.fx){case 0:case 1:r=n.c();this.fx=t;break;case 2:switch(t){case 1:r=n.c();this.fx=1;break;case 2:r=_Ewa.bo.c(this.dU.e(this.dW),n)}}else this.fx=0;this.dU=r;i&&this.fc(!1)}},im:function(){var i=this.iC(),n=i.b.a,t=i.b.b;return this.dD.a(778)&&_Ewa.t.a(this.dD)&&(n=Math.round(_Ewa.t.a(this.dD).e(n)),t=Math.round(_Ewa.t.a(this.dD).e(t))),new Sys.UI.Point(n,t)},fb:function(){var n,t;for(_Ewa.gN.prototype.fb.call(this),n=this.$$ge();n.$$mn();)t=n.$$cu(),t.s(this.bJ())},iq:function(){},lj:function(){},hb:function(){},ip:function(){},li:function(){},is:function(){var r;this.fc(!1);this.dU&&this.gT(this.dU.c(),this.eR);var n=this.cy(),t=null,i=new _Ewa.kZ(this,!1);i.$$mn()&&(n=Math.max((t=i.$$cu().k().b).a,n));r=this.cy()!==n;this.eU(n);r&&this.go(t,null,!1);this.gY=this.gZ=!1},ir:function(n){var t=this.eR|n.a;this.gT(n.b,t)},gT:function(n,t){var r=this.dP;if(this.eS&&r){var e=r.a,i=n.a,u=this.gj(!1),o=this.ep.p,f=o.b;!(t&8)&&u.a<=f.a+this.ep.p.c()&&r.a.X>=i.X&&(i.X=this.gW().a.X=Math.min(i.X+1,this.dW.a.X));!(t&4)&&u.b<=f.b+this.ep.p.d()&&e.Y>=i.Y&&(i.Y=this.gW().a.Y=Math.min(i.Y+1,this.dW.a.Y));this.eC(n,this.fx,!0);this.jC(t)}},fk:function(n){var i,r;if(this.dR()){i=n.Y*this.ej;r=n.X*this.ei;Diag.a.b(42076043,1,i>=0&&r>=0,"GridViewBase.EstimatedViewportPositionFromBlockPosition: Invalid blockPosition");var t=this.il(i,r,this.dN),f=this.eT(t.b,!0),e=this.eT(t.a,!1);if(e||f){var o=e?t.a:Math.max(0,n.X*this.ee),s=f?t.b:Math.max(0,n.Y*this.eq),h=new _Ewa.W(0,0,o,s),c=this.iC(),u=c.h(h);return u||(Diag.a.a(42076044,1,10,"EstimatedViewportPositionFromBlockPosition: calculatedViewportArea should intersect with the actual maximum viewport area"),u=new _Ewa.W(0,0,0,0)),u}}return this.iE(new _Ewa.M(n.X*this.ee,n.Y*this.eq),!1,!1)},jE:function(n){var f=this.dW.e(n.a),t,u,r,i;this.dD.isChangeGateEnabled("OfficeVSO:4257365_InvestigateInvalidPushHeight")&&!f&&Diag.a.a(590873731,1,50,"GridViewBase.SetViewportAndCanvasState: LoadedBlockArea input doesn't intersect with maximumNavigableBlockArea, viewportAndCanvasState.LoadedBlockArea={0}, maximumNavigableBlockArea={1}",n.a,this.dW);t=f||new _Ewa.bo(this.dW.a.Y,this.dW.a.X,this.dW.a.Y,this.dW.a.X,this.dN);u=this.dP?this.dP.e(t):null;!this.dJ.m()||n.b||u&&u.d(t)||this.ex();r=null;i=null;this.dU&&!t.e(this.dU)&&(this.dD.isChangeGateEnabled("OfficeVSO:4257365_InvestigateInvalidPushHeight")&&Diag.a.a(590747227,1,50,"GridViewBase.SetViewportAndCanvasState: Updating ActualNavigableArea to {0}",t.toString()),this.gl(null),this.gk(t),this.eC(t,1,!1));r=n.b||this.fk(t.b).b;i=n.c||r;this.fA(t);this.dD.isChangeGateEnabled("OfficeVSO:4257365_InvestigateInvalidPushHeight")&&!i.b&&Diag.a.b(590873730,1,!t.b.Y,"GridViewBase.SetviewportAndCanvasState: setting push height to 0, while the min y loaded block is {0}, ",t.b.Y);this.dD.a(792)&&(this.eL(i.b),this.eM(i.a),this.h().f().c()>0&&this.h().f().d()>0&&(this.fN(t.b.X,t.a.X,t.b.Y,t.a.Y,!1),this.it(t.b.Y,t.a.Y,!1)));this.h().e(r);this.dD.a(792)||(this.eL(i.b),this.eM(i.a))},fN:function(n,t,i,r,u){for(var s,f=0,o=0,h,e=i;e<=r;++e)this.ip(e,n,t),s=this.ek(e,n,t),this.li(s,n,t),u&&(f+=s.e());(h=this.cz())<f&&(o=f-h);this.eL(this.cz()-f);o&&this.ep.e(_Ewa.M.a(this.ep.p.a,new _Ewa.M(0,o)))},lo:function(){return this.dD.e().IsVersionHistorySession?!0:!(this.dD.c().b()||this.dD.bg())},gU:function(n,t,i,r,u,f,e,o,s){_Ewa.bz.m(n,t,i,r,u,f,e,this.eo(),this.dN,o,s)},ik:function(n,t,i,r,u){i.val=this.jB(n,u);r.val=this.jB(t,u)},gX:function(n,t,i){return _Ewa.bz.t(n,t,i,this.dN,this.X(),this.eo())},jB:function(n,t){return _Ewa.bz.a(n,t,this.dN,this.X(),this.eo())},lh:function(n,t,i,r){var u,o;if(i.val=null,r.val=null,this.dP)for(var f=this.dP.b.Y,e=this.cz(),s=this.$$ge();s.$$mn();){if(u=s.$$cu(),f!==u.l&&(Diag.a.a(595099973,1,15,"GridViewBase.GetVisibleFlows: Unexpected flow position = {0}, expected = {1}, LoadedBloackArea = {2}",u.l,f,this.dP),f=u.l),u.e()<=0&&Diag.a.a(595099972,1,15,"GridViewBase.GetVisibleFlows: Unexpected flow size of {0}, flow position = {1}",u.e(),u.l),o=e,e=o+u.e(),e<n){f++;continue}if(o>t){f++;break}i.val||(i.val=u);r.val=u;f++}},lf:function(n,t,i,r){n.val=-1;t.val=-1;i.val=-1;r.val=-1;this.dP&&(n.val=this.dP.b.X,t.val=this.dP.a.X,i.val=this.dP.b.Y,r.val=this.dP.a.Y)},lg:function(n,t){var i=n.k(),r=n===t?i:t.k();return new _Ewa.W(i.a.a,i.a.b,r.b.a-i.a.a,r.b.b-i.a.b)},ll:function(){this.is()},lk:function(n,t){this.ir(t)},le:function(n,t,i){this.iq(n,t,i);this.gS=!0;n.r(t,i);this.gS=!1;this.lj(n,t,i)},he:function(n,t,i,r,u,f){this.gO=this.er?this.er.e():null;this.gQ=t;this.gR=n;this.gM=i;this.gN=r;this.fL.X=u.X;this.fL.Y=u.Y;this.fL.PaneType=u.PaneType;this.fK.X=f.X;this.fK.Y=f.Y;this.fK.PaneType=f.PaneType;this.gP=_Ewa.u.a().a()},jv:function(){this.gO=null;this.gQ=-1;this.gR=-1;this.gM=-1;this.gN=-1;this.fL={};this.fK={};this.gP=_Ewa.u.a().a()}};_Ewa.FA.a=function(n){this.markersList=new($$sc.u.$$(String));n&&this.f()};_Ewa.FA.a.prototype={viewBufferTop:0,viewBufferLeft:0,viewBufferBottom:0,viewBufferRight:0,initialBlockMinimumX:0,initialBlockMaximumX:0,initialBlockMinimumY:0,initialBlockMaximumY:0,calculatedBlockMinimumX:0,calculatedBlockMaximumX:0,calculatedBlockMinimumY:0,calculatedBlockMaximumY:0,uncoveredAreaFromLeft:0,uncoveredAreaFromTop:0,uncoveredAreaFromRight:0,uncoveredAreaFromBottom:0,useSheetProcessedDataForRows:!1,useSheetProcessedDataForColumns:!1,firstVisibleViewBlockFlowExists:!1,lastVisibleViewBlockFlowExists:!1,previousBufferedViewportAreaExists:!1,loadedBlockAreaExists:!1,isLoadedBlockAreaWithinNavigableArea:!1,viewportScrollAdjustmentX:0,viewportScrollAdjustmentY:0,endReason:null,recursionDepth:0,markers:null,canLog:!1,d:function(){return new _Ewa.bo(this.initialBlockMinimumY,this.initialBlockMinimumX,this.initialBlockMaximumY,this.initialBlockMaximumX,1)},c:function(){return new _Ewa.bo(this.calculatedBlockMinimumY,this.calculatedBlockMinimumX,this.calculatedBlockMaximumY,this.calculatedBlockMaximumX,1)},e:function(){return this.initialBlockMinimumX!==this.calculatedBlockMinimumX||this.initialBlockMaximumX!==this.calculatedBlockMaximumX||this.initialBlockMinimumY!==this.calculatedBlockMinimumY||this.initialBlockMaximumY!==this.calculatedBlockMaximumY||this.viewportScrollAdjustmentX!==-1||this.viewportScrollAdjustmentY!==-1},a:function(n){this.canLog&&this.markersList.b(n)},b:function(n,t){this.canLog&&(this.endReason=n,this.g(),delete this.markersList,delete this.canLog,Diag.a.a(51515611,1,50,"GridViewBase.OnViewportChange: {0}",JSON.stringify(this)),t&&_Ewa.FA.a.a--)},f:function(){this.canLog=!0;_Ewa.FA.a.a++;this.recursionDepth=_Ewa.FA.a.a;this.recursionDepth>1&&Diag.a.a(51515612,1,50,"GridViewBase.OnViewportChange: recursion detected, depth: {0}",this.recursionDepth);this.endReason=this.markers="None";this.viewBufferTop=this.viewBufferLeft=this.viewBufferBottom=this.viewBufferRight=-1;this.initialBlockMinimumX=this.initialBlockMaximumX=this.initialBlockMinimumY=this.initialBlockMaximumY=this.calculatedBlockMinimumX=this.calculatedBlockMaximumX=this.calculatedBlockMinimumY=this.calculatedBlockMaximumY=this.uncoveredAreaFromLeft=this.uncoveredAreaFromTop=this.uncoveredAreaFromRight=this.uncoveredAreaFromBottom=this.viewportScrollAdjustmentX=this.viewportScrollAdjustmentY=-1},g:function(){this.markers=this.markersList.f().join(", ")}};_Ewa.FJ=function(n,t,i,r,u){_Ewa.FJ.resolveInheritance();this.d=this.B;_Ewa.FJ.initializeBase(this,[document.createElement("div"),null]);this.X=-1;this.Y=-1;this.bb=n;this.bD=!1;this.bk=u;this.Z=_Ewa.bo.a(r.X,r.Y,r.PaneType);this.W=this.f().b().t(i,this.Z);var f=this.f().br()[this.W];f&&(t===f.dC&&(t=f.dC.nextSibling),f.dispose(),Diag.a.a(50345439,1,50,"ViewBlock.Constructor: Block already exists in cache. Hash: {0}, Callstack: {1}",this.W,_Ewa.ce.a(!0,null)));this.f().br()[this.W]=this;this.dC.className="ewr-grdblk";this.bb.h().insertBefore(this.dC,t)};_Ewa.FJ.prototype={W:null,bn:"",f:function(){return this.bb.b()},bb:null,n:function(){return this.bb},Z:null,j:function(){return this.Z},x:function(){return this.Y===-1?_Ewa.a.A(this.dC):this.Y},R:function(){return this.X===-1?_Ewa.a.D(this.dC):this.X},a:function(){return this.W},Y:0,P:function(){return this.Y},X:0,O:function(){return this.X},bk:!1,bD:!1,Q:function(){return this.bD},dispose:function(){Diag.a.a(859204970,1,50,"{0}.Dispose: Removing viewblock at block hash = {1}",this.dz(),this.W);!_Ewa.a.G&&this.bb&&this.bb.a().parentNode&&_Ewa.a.g(this.dC);delete this.f().br()[this.W];this.bb=null;this.Z=null;this.W=null;this.bD=!0;_Ewa.hD.prototype.dispose.call(this)},bs:function(){var n;if(!this.bb)return 0;var i=this.dC,t=0,r=this.bb.i();for(n=i.previousSibling;n!==r;n=n.previousSibling)t+=_Ewa.gN.a(n).x();return this.bb.j()+t},cv:function(n,t){this.dC.hasChildNodes()&&n.hasChildNodes()?(t||(t=this.dC.firstChild),t.parentNode.replaceChild(n.firstChild,t)):n.hasChildNodes()&&_Ewa.a.bf(this.dC,n)}};_Ewa.gN=function(n,t,i,r,u,f){this.jF=Function.createDelegate(this,this.hh);this.iu=Function.createDelegate(this,this.jJ);this.jG=Function.createDelegate(this,this.lr);this.iv=Function.createDelegate(this,this.ix);_Ewa.gN.resolveInheritance();this.dw=this.dQ;this.i=this.B;this.p=this.eO;_Ewa.gN.initializeBase(this,[n,f,!0]);this.gm={};this.dJ=t;this.dN=u;this.ei=i;this.ej=r;this.ee=64*i;this.eq=20*r;t.j(this.iv);t.q(this.jG);t.X(this.iu);Sys.UI.DomElement.addCssClass(this.dC,"ewr-grdblkcontainer");this.fB=this.dC.appendChild(document.createElement("div"));this.fB.className="ewr-grdblkflowpush";this.fl=this.dC.appendChild(document.createElement("div"))};_Ewa.gN.b=function(n){return _Ewa.gN.c(_Ewa.ud,n)};_Ewa.gN.a=function(n){return _Ewa.gN.c(_Ewa.FJ,n)};_Ewa.gN.c=function(n,t){return _Ewa.hD.a(n,t)};_Ewa.gN.prototype={iy:!1,dJ:null,hm:0,hf:null,fO:null,fP:null,b:function(){return this.dJ},d:function(){return this.iy},iw:null,dy:function(){return this.iw},gm:null,br:function(){return this.gm},dN:0,G:function(){return this.dN},ei:0,du:function(){return this.ei},ej:0,dx:function(){return this.ej},ee:0,eq:0,cz:function(){var n=parseFloat(this.fB.style.height);return isNaN(n)?0:n},eL:function(n){return _Ewa.a.r(this.fB,n,!0)&&this.hg(),n},bJ:function(){return this.hm},eM:function(n){var t=Math.max(0,n);return this.hm!==t&&(this.hm=t,this.fb()),n},fB:null,fl:null,dv:function(){return this.fl},lp:function(){return this.hf||(this.hf=new _Ewa.M(0,0))},q:function(){var n=this.fO,i,r,u,t;if(!n){i=this.gm;for(r in i)u={key:r,value:i[r]},t=u.value.b(),t&&(n?n.F(t):n=t.f())}return this.fO=n},cx:function(){return this.fP||(this.fP=document.createElement("div"),this.fP.className="ewa-fo-container",this.dC.insertBefore(this.fP,this.dC.firstChild)),this.fP},dispose:function(){this.dJ.l(this.iv);this.dJ.bs(this.iu);this.ex();this.dJ=null;_Ewa.a.g(this.fB);this.fB=null;_Ewa.SI.prototype.dispose.call(this)},$$ge:function(){return new _Ewa.kZ(this,!0)},jI:function(n){return n},hh:function(n,t){if(this.fO=null,!t.c){var i=this.iz(t.a.b);i&&i.bT(t)}},hi:function(n){var t=isNullOrUndefined(n)?String.format("ViewBlockContainer.RemoveViewBlockFlowFromVerticalPosition ({0}): viewBlockFlow is null",this.dz()):String.format("ViewBlockContainer.RemoveViewBlockFlowFromVerticalPosition ({0}): Removed flow at position Y {1}",this.dz(),n.g());Diag.a.a(4990688,1,50,t);System.a.a(n)},hj:function(n){this.hi(this.hl(n))},ek:function(n,t,i){var r=this.hl(n),u=!r;return u?(r=new _Ewa.ud(this,n),this.lq(r)):this.dN===3&&r.j()!==r.m.bJ()&&r.s(r.m.bJ()),r.r(t,i),r},fc:function(){this.fO=null},bV:function(n){var i,r,t,u,f;return(i=_Ewa.a.i(this.dC))&&Common.g.d(i,n)&&(r=new Sys.UI.Point(n.x-i.x,n.y-i.y),this.d()&&(r.x=i.width-1-r.x),t=new _Ewa.M(_Ewa.Z.c(this.dC,this.d(),this.el())+r.x,this.ef()+r.y),t=_Ewa.M.a(this.lp(),t),u=this.jH(t))?(f=new Sys.UI.Point(t.a-u.bs(),t.b-u.bb.d()),new _Ewa.ue(u,f)):null},L:function(n){return this.iz(n)},hl:function(n){for(var i=this.$$ge(),t;i.$$mn();)if(t=i.$$cu(),t.l===n)return t;return null},bK:function(n){return this.jH(n)},hk:function(n){this.iy=n;this.iw=n?"right":"left"},ex:function(){var n=null;if(this.fl.childNodes.length){_Ewa.a.G=!0;try{for(n=new _Ewa.kZ(this,!1);n.$$mn();)this.hi(n.$$cu())}finally{_Ewa.a.G=!1;this.fl.innerHTML=""}this.eM(0);this.eL(0)}},hg:function(){},fb:function(){},ix:function(){this.fO=null},jJ:function(){},lr:function(n,t){var i=this.iz(t.a.b);i&&i.bU(t)},lq:function(n){for(var i=this.fl,r=this.$$ge(),t;r.$$mn();){if(t=r.$$cu(),t.l===n.l)return;if(t.l>n.l){i.insertBefore(n.dC,t.dC);return}}i.appendChild(n.dC)},iz:function(n){return this.gm[this.jI(n)]},jH:function(n){for(var i=this.cz(),u=this.$$ge(),t,r;u.$$mn();)if(t=u.$$cu(),t&&t.dC){if(r=t.e(),n.b>=i&&n.b<i+r)return t.A(n,this.dD.isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!0);i+=r}return null}};_Ewa.FK=function(n,t){this.c=n;this.b=t;this.$$rst()};_Ewa.FK.prototype={c:null,b:!1,d:null,a:null,$$cu:function(){return _Ewa.gN.a(this.a)},$$mn:function(){var n;do this.a=this.b?this.a.nextSibling:this.a?this.a.previousSibling:this.c.dC.lastChild;while(!(n=this.a===this.d)&&!this.$$cu());return!n},$$rst:function(){this.a=this.b?this.c.p:null;this.d=this.b?null:this.c.p}};_Ewa.FL=function(n,t){this.a=n;this.b=t};_Ewa.FL.prototype={a:null,b:0};_Ewa.ud=function(n,t){_Ewa.ud.resolveInheritance();this.a=this.B;_Ewa.ud.initializeBase(this,[document.createElement("div"),null]);this.m=n;this.l=t;this.dC.id=this.m.i().id+"_Flow_"+t;this.dC.className="ewr-grdblkflow";this.q=document.createElement("div");this.q.className="ewr-grdblkflowclip";this.p=document.createElement("div");this.p.className="ewr-grdblkpush";this.q.appendChild(this.p);this.x();this.dC.appendChild(this.q);Diag.a.a(41764288,0,50,"ViewBlockFlow.ViewBlockFlow: ViewBlockFlow has been created. Vertical position: {0}, PaneType={1}, Container={2}",t,this.m.G(),this.m.dz())};_Ewa.ud.prototype={m:null,b:function(){return this.m},q:null,h:function(){return this.q},l:0,g:function(){return this.l},o:0,n:0,t:function(n){return _Ewa.a.l(this.dC,n,!1),n},d:function(){for(var t=this.m.cz(),i=this.m.$$ge(),n;i.$$mn();){if(n=i.$$cu(),n===this)break;t+=n.c()}return t},c:function(){for(var t=0,i=this.p,n=i.nextSibling;n;n=n.nextSibling)n.firstChild&&(t=Math.max(t,parseInt(n.firstChild.style.height)));return t},f:function(){for(var t=this.m.cz(),i=this.m.$$ge(),n;i.$$mn();){if(n=i.$$cu(),n===this)break;t+=n.e()}return t},e:function(){for(var n=0,t=this.$$ge(),i;t.$$mn();)i=t.$$cu(),n=Math.max(n,i.R());return n},j:function(){var n=parseFloat(this.p.style.width);return isNaN(n)?0:n},s:function(n){return _Ewa.a.l(this.p,n,!0),n},p:null,i:function(){return this.p},u:function(){return this.o===-1&&this.n===-1?0:this.n-this.o+1},dispose:function(){_Ewa.a.G||_Ewa.a.g(this.dC);Diag.a.a(41764289,0,50,"ViewBlockFlow.Dispose: ViewBlockFlow has been disposed. Position: {0}, DomElementRemoved? = {1}",this.l,!_Ewa.a.G);this.r(-1,-1);this.m=null;this.p=this.q=null;_Ewa.a.G||_Ewa.a.k(this.dC,"");_Ewa.hD.prototype.dispose.call(this)},$$ge:function(){return new _Ewa.FK(this,!0)},C:function(){return!$$sc.b.p(this)},r:function(n,t){if(!this.m){Diag.a.a(37614239,1,10,"ViewBlockFlow.BatchInsertRemoveViewBlocksByPosition: BlockContainer is null, called after dispose.");return}if(this.t(this.m.cy()),n!==this.o||t!==this.n){var i=n===-1&&t===-1;Diag.a.a(41239630,1,50,"BatchInsertRemoveViewBlocksByPosition: removeAll = {0}, Length = {1}, startPositionX = {2}, endPositionX = {3}, MinimumBlockPositionX = {4}, MaximumBlockPositionX = {5}",i,this.u(),n,t,this.o,this.n);i||this.u()?i?this.w(this.o,this.n):t<this.o||n>this.n?(this.w(this.o,this.n),this.v(n,t)):(n<this.o?this.v(n,this.o-1):n>this.o&&this.w(this.o,n-1),t>this.n?this.v(this.n+1,t):t<this.n&&this.w(t+1,this.n)):this.v(n,t)}},k:function(){var n,t,i;if(!this.u())return new _Ewa.W(0,0,0,0);for(n=0,t=this.$$ge();t.$$mn();)i=t.$$cu(),n+=i.x();return new _Ewa.W(this.j(),this.f(),n,this.e())},A:function(n,t,i){var e=this.p.nextSibling,u,f,r;if(!e||(u=this.j(),u>n.a)||(f=_Ewa.i.d(this.dC,this.m.i(),this.m.d(),t,i,!1),!f))return null;for(u+=f.x,r=e;r;r=r.nextSibling)if(u+=_Ewa.a.A(r),n.a<=u)return _Ewa.gN.a(r);return null},y:function(n){var f=n.b.a,t=this.j(),i,r;if(t>f)return null;for(var e=n.a.a,o=this.o,u=this.$$ge();u.$$mn();){if(i=u.$$cu(),r=t+i.x(),r>=e)return new _Ewa.FL(i,t);t=r}return null},z:function(n){var u=n.b.a,t=this.j(),i,f,r;if(t>u)return null;for(i=null,f=this.$$ge();f.$$mn();){if(r=f.$$cu(),t+=r.x(),t>=u)return r;i=r}return i&&Math.min(t,u)>=Math.max(t,n.a.a)?i:null},x:function(){this.o=this.n=-1;this.m?this.s(this.m.bJ()):this.s(0)},v:function(n,t){var f=!this.u(),e=f||n===this.n+1,i,r,u;if(f&&(this.o=n),i=_Ewa.bo.a(-1,this.l,this.m.G()),e)for(r=n;r<=t;++r)this.n=i.X=r,this.m.cA(this,null,i);else for(u=t;u>=n;--u)this.o=i.X=u,this.m.cA(this,this.p.nextSibling,i)},w:function(n,t){for(var o,u,f=n===this.o,e=t===this.n,s=f&&e,r=this.n,i=this.q.lastChild;r>=n&&i!==this.p;r--)o=i,i=i.previousSibling,r<=t&&(u=_Ewa.gN.a(o),System.a.a(u),u=null);s?this.x():f?this.o=t+1:e&&(this.n=n-1)}};_Ewa.kZ=function(n,t){this.d=n;this.b=t;this.c=this.d.dv();this.a=null};_Ewa.kZ.prototype={d:null,a:null,c:null,$$cu:function(){return _Ewa.gN.b(this.a)},b:!1,$$mn:function(){if(this.b)for(this.a=this.a?this.a.nextSibling:this.c.firstChild;this.a&&!this.$$cu();)this.a=this.a.nextSibling;else for(this.a=this.a?this.a.previousSibling:this.c.lastChild;this.a&&!this.$$cu();)this.a=this.a.previousSibling;return!!this.a},$$rst:function(){this.a=null}};_Ewa.uf=function(n){this.C=Function.createDelegate(this,this.K);this.p=_Ewa.W.a().e();this.r=_Ewa.W.a().a.c();this.q=new Sys.UI.Point(0,0);_Ewa.uf.initializeBase(this,[n.dC,null]);this.o=n;this.dK().a("scroll",this.C,!1);var t=this;this.v=new($$sc.y.$$($$sc.a))(function(){return t.I()})};_Ewa.uf.a=function(){return Math.abs(window.self.orientation|0)%180==90};_Ewa.uf.prototype={o:null,s:null,y:!1,A:null,z:null,u:!1,v:null,w:null,x:null,c:function(n){this.dG("ekvac",n)},b:function(n){this.dH("ekvac",n)},i:function(n){this.dG("eksbrc",n)},n:function(n){this.dH("eksbrc",n)},h:function(){return this.q},t:!1,j:function(){return this.t},a:function(){return this.p},d:function(){return this.p.a},e:function(n){var t,i,u,r,f;return n?(t=new _Ewa.M(Math.max(0,Math.floor(n.a)),Math.floor(Math.max(0,n.b))),i=t.a-this.p.a.a,(u=_Ewa.cj.a()).m(u.d+i),r=t.b-this.p.a.b,(f=_Ewa.cj.a()).n(f.e+r),(i||r)&&(this.o.go(null,t,!1),this.r=t,this.t=!1,this.G(!1,!0))):(this.p=_Ewa.W.a().e(),this.r=_Ewa.W.a().a.c(),this.s=null),n},g:function(){return!_Ewa.W.a().g(this.p)&&!!this.o&&this.o.ij()},f:function(){return this.s||(this.s=_Ewa.bz.d(this.p,this.o.jz(),this.o.jA()))},dispose:function(){this.o=null;_Ewa.hD.prototype.dispose.call(this)},m:function(n){this.g()&&this.F(!0,!0,!0,n)},l:function(n){this.dE("eksbrc",new _Ewa.PI(n),null)},k:function(n,t){var i=this.o.dC,r;n.val=_Ewa.a.x(i);t.val=_Ewa.a.L(i);n.val||t.val||(r=i.style,r.overflowX="hidden",n.val=_Ewa.a.x(i),r.overflowX="",r.overflowY="hidden",t.val=_Ewa.a.L(i),r.overflowY="",_Ewa.a.y(i))},K:function(){var o,s,n,t,h,c,l,a;if(this.u||this.y||!this.g()){this.u=!1;return}_Ewa.cj.a().a("Scroll");this.t=!0;var f=this.o.dC,i=Math.round(f.scrollLeft),r=Math.round(f.scrollTop),u=!1,e=Common.c.d()?1:0;this.o.jx()&&(_Ewa.Z.n(this.o.dC,e)?(this.D(o={val:this.A},!0),this.A=o.val,u=!0):_Ewa.Z.o(this.o.dC,this.o.d(),this.o.dC.scrollLeft,e)&&(this.D(s={val:this.z},!1),this.z=s.val,u=!0));n=i-this.q.x;t=r-this.q.y;(n||t)&&((h=_Ewa.cj.a()).m(h.d+n),(c=_Ewa.cj.a()).n(c.e+t),n&&this.v.a().b>3&&this.w&&(l=this,this.w(function(){return{}})),t&&this.v.a().b>3&&this.x&&(a=this,this.x(function(){return{}})),this.q.x=i,this.q.y=r,this.E(),this.G(!0,i<0||r<0||u||this.u));this.o.dD.isChangeGateEnabled("OfficeVSO:4199603_NavigationScenarioTelemetry")&&this.o.dJ.m()&&_Ewa.cj.a().h("OnScroll")},E:function(){this.r.a=this.o.bc().d(this.q.x);this.r.b=this.q.y},G:function(n,t){this.F(n,t,!1,!1);this.o.dJ.be()},F:function(n,t,i,r){var f,u;this.y=!0;f=this.p;u=this.H();u.g(f)||(this.q=new Sys.UI.Point(this.o.bc().e(u.a.a),u.a.b),this.o.hc(i||t));var o=this.o.es.a,s=this.f().b,h=new _Ewa.M(Math.max(o.a,s.a),Math.max(o.b,s.b)),c=this.o.go(null,h,n),e;(c||t)&&(e=new Sys.UI.Point(this.o.el(),this.o.ef()),(!_Ewa.i.K(e,this.q)||this.J(e))&&(this.q=e,this.E(),u=this.H(),u.g(f)||this.o.hc(!0)));e=new Sys.UI.Point(this.o.el(),this.o.ef());(!f.f(u)||f.k()||_Ewa.W.a().g(f)||r)&&this.o.fc(r);this.y=!1;u.g(f)||this.dE("ekvac",null,null)},J:function(n){return this.o.d()&&n.x===this.q.x&&!n.x},D:function(n,t){if(!n.val||n.val.b>3){var i=this;n.val=$$sc.a.b(1).CWC(function(){i.o.lm(t)},this.dF())}},H:function(){var n,t,r,u;this.k(r={val:n},u={val:t});n=r.val;t=u.val;var f=this.o.dC,e=!!this.o&&this.o.ij(),i=_Ewa.bz.r(this.r,e,_Ewa.a.A(f),_Ewa.a.D(f),n,t);return this.p.g(i)||(_Ewa.U.a().by(i.toString()),this.s=null),this.p=i,this.p},I:function(){var n=new($$sc.C.$$(Boolean)),t=this;return _Ewa.bG.b(this.o.dD,function(i){t.w=i.b(_Ewa.bd.F,!1);t.x=i.b(_Ewa.bd.G,!1);n.b(!0)}),n.a}};_Ewa.kX=function(){this.a=new _Ewa.M(0,0);this.b=this.c=!0};_Ewa.kX.prototype={a:null,b:!1,c:!1};_Ewa.mE=function(n,t,i,r,u,f){this.iA=Function.createDelegate(this,this.ls);this.ec=new _Ewa.M(0,0);this.fm=new _Ewa.W(0,0,0,0);this.es=new _Ewa.kX;this.iB=-1;_Ewa.mE.initializeBase(this,[n,t,i,r,u,f]);this.eN=document.createElement("div");this.eN.className="ewr-grdusedrange";this.dC.insertBefore(this.eN,this.dC.firstChild)};_Ewa.mE.prototype={eN:null,cy:function(){return this.iB},eU:function(n){return this.iB=n,n},lt:function(){return this.dD.e().ViewportScollExtentLimit},dispose:function(){_Ewa.a.g(this.eN);this.eN=null;this.fm=null;this.ec=null;this.es=null;_Ewa.gN.prototype.dispose.call(this)},go:function(n,t,i){return this.gn(n,t,i,this.es.b,this.es.c,!1)},gn:function(n,t,i,r,u,f){var e,s,o,l,a,y,p,w;n&&(this.fm=f?new _Ewa.W(0,0,n.a,n.b):this.iE(n,r,u));e=t?this.iE(t,r,u).b:this.ec;s=this.fm.b;this.fm.f(new _Ewa.W(e.a,e.b,0,0))||(e=s);var h=!1,c=e.a,v=s.a;if((v>this.ec.a||c>v&&c>this.ec.a||i&&(!r||c!==this.ec.a))&&(h=!0,this.ec.a=Math.max(v,c)),o=e.b,l=s.b,(l>this.ec.b||o>l&&o>this.ec.b||i&&(!u||o!==this.ec.b))&&(h=!0,this.ec.b=Math.max(l,o)),h){if(this.iF(this.ec,this.d()),a=-_Ewa.Z.i(this.dC,this.d()),a>0)for(y=this.ec.a<this.cy(),_Ewa.a.K(this.eN,"paddingLeft",y?-1:a,"px",!1),p=this.$$ge();p.$$mn();)w=p.$$cu(),_Ewa.a.K(w.dC,"paddingLeft",y?a:-1,"px",!1);this.iD(f)}return h},ex:function(){this.es=new _Ewa.kX;this.fm=new _Ewa.W(0,0,0,0);this.ec=new _Ewa.M(0,0);_Ewa.gN.prototype.ex.call(this)},iD:function(){},iE:function(n,t,i){if(!n)return new _Ewa.W(0,0,0,0);var r=this.iC();return _Ewa.bz.w(n,this.ee,this.eq,r,t,i)},iC:function(){if(!_Ewa.mE.a){var t=Math.floor(29327360),r=new _Ewa.mE.b(t),i=Math.floor(572522496),u=new _Ewa.mE.b(i),n=new _Ewa.M(0,-1);_Ewa.i.f(r,0,t,n,this.iA);n.b=0;_Ewa.i.f(u,0,i,n,this.iA);_Ewa.mE.a=_Ewa.bz.j(Math.floor(n.a*.95),Math.floor(n.b*.95),this.ee,this.eq,!1,!1);this.iF(null,!1)}return _Ewa.mE.a},iF:function(n,t){if(!n){this.eN.style.cssText="";return}this.lu(n,t)},lu:function(n,t){var i=new _Ewa.hG(this.eN.style);i.d(t,n.a.toString()+"px");i.a.top=n.b.toString()+"px";i.b()},ls:function(n,t){var i=t,r=i.b===-1,u,f,e;return(this.iF(new _Ewa.M(r?n:0,r?0:n),!1),u=r?this.eN.offsetLeft:this.eN.offsetTop,f=this.lt(),u>f)?(r?i.a=f:i.b=f,0):u?(e=r?i.a:i.b,!e||u>e)?(r?i.a=u:i.b=u,-1):0:1}};_Ewa.mE.b=function(n){this.c=n};_Ewa.mE.b.prototype={c:0,a:function(n){return n},b:function(){return this.c}};_Ewa.Fs=function(n,t,i){this.cg=Function.createDelegate(this,this.dk);this.ch=Function.createDelegate(this,this.dr);this.ci=Function.createDelegate(this,this.dx);this.cC=Function.createDelegate(this,this.dv);_Ewa.Fs.initializeBase(this,[n]);_Ewa.ij.prototype.bY.call(this,t);this.bg=_Ewa.p.e(this.T);this.bf=_Ewa.p.g(this.T);this.bg||this.a().bm(1);this.bs().className="ewa-gridKeyHandler";this.a().ct().a("mousemove",this.cC,!1);n.h().c(this.ci);Common.c.h()&&this.T.R(this.ch);this.bc=new _Ewa.Fo(this);this.bL=i;this.cp=this.T.isChangeGateEnabled("OfficeVSO:3985157_FormulaBarTextSnap")};_Ewa.Fs.prototype={bc:null,bt:null,bM:"",cq:!1,bg:!1,cp:!1,bf:!1,C:function(n){this.dG("ekdc",n)},D:function(n){this.dH("ekdc",n)},b:function(){return _Ewa.ij.prototype.b.call(this)},e:function(n){return _Ewa.ij.prototype.b.call(this)!==n&&(this.bf?this.ct(n):_Ewa.ij.prototype.e.call(this,n),this.cr(new _Ewa.is(!1))),n},j:function(){var n=_Ewa.dH.a(this.T);return this.bb&&n?n.j():_Ewa.ij.prototype.j.call(this)},bb:!1,o:function(){return this.bb},G:function(n){return this.bb=n,n},W:null,bn:0,bw:0,br:!1,cj:0,ck:!1,v:function(n){return this.ck=n,n},cs:function(n){return this.bs().tabIndex=n,n},cl:null,bs:function(){return this.a().cm()},bL:null,dispose:function(){this.S&&(this.S.h().b(this.ci),this.S.c().S(this.ch));System.a.a(this.bc);this.bc=null;this.bL=null;this.W=null;this.cq=!0;_Ewa.ij.prototype.dispose.call(this)},h:function(n,t,i,r){var s,v,e,o,k,w,c,l,a;if(this.T.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")&&(s=this.a().cm(),Diag.a.a(592506880,0,50,"EditBox.EndEdit: gridKeyboardHandler is: {0}, parent is: {1}",s.id,s.parentNode?s.parentNode.id:"null")),this.bt&&(this.bt.a(),this.bt=null),!this.U){this.co();return}if(this.cq&&this.T.isChangeGateEnabled("OfficeVSO:3607503_EditBoxEndEditAfterDispose")&&Diag.a.a(50886678,0,15,"EditBox.EndEdit: Called after dispose - consider exiting the flow."),_Ewa.bH.a().l("EndEditToSetCell",2,-1),v={ShouldLogInTextEditorTelemetry:!0,textRuns:$$sc.a.a(Number,this.a().R())},_Ewa.bG.a(this.T).a(_Ewa.bd.g,null,v),n){var f=this.b(),h=!1,u=null;if(this.bh||this.cT()){if(e=this.dj(this.W,f),!e)return;if(h=e.b,h||(f=e.a),e.e&&this.T.a(176))u={},u.ParameterType=1,u.SourceRange=e.c;else if(this.T.x()&65536&&(o=this.T.w(),!o||!(o.d()||o.c()||o.q()||o.e())))if(this.T.a(179)){if(this.W.j()&&this.W.a>1){var b=new _Ewa.o(this.W.a-1,this.W.b,this.W.d-1,this.W.c,!1,!1),y=this.S.e(b),p=this.S.e(this.W);!isNullOrUndefined(y)&&y.O()||!isNullOrUndefined(p)&&p.O()?(u={},u.ParameterType=3):!f||!f.length||_Ewa.bK.b(f)||(u={},u.ParameterType=5)}}else u={},u.ParameterType=3}h||(u&&(k=String.format("EditBox:EndEdit, richValueParameterType, {0}, SourceRange.ToString(), {1}, PulloutRichColumnSourceIndex, {2}",u.ParameterType,u.SourceRange,u.PulloutRichColumnSourceIndex)),_Ewa.bH.a().g("EndEditToSetCell",2),_Ewa.bH.a().o("EndEdit",2,r),w=this.bf?this.dm():(c=new _Ewa.dJ,c.Text=f,c),this.S.ba(w,this.W,i,127,u),Diag.a.a(5870114,0,50,"Edit session was comitted, caller = "+t))}this.P(!1);this.bg&&this.cP(0);l=new _Ewa.bH.b("EditEndedEventHandlers",2);try{this.cL()}finally{l&&l.dispose()}this.a().cq();_Ewa.bH.a().g("EndEdit",2);_Ewa.bH.a().j(2);_Ewa.E.f();a=this.bs();a.className="ewa-gridKeyHandler";a.style.cssText="";this.dn();this.co();this.k(!0);this.W=null;this.br=!1;this.bb=!1;this.bn=this.bw=1;this.bM="";this.S.bq(0);this.cG();Diag.a.a(41219719,0,50,"Edit session was canceled")},cm:function(){var i=this.S.e(this.W),u=this.S.n(this.S.j().c(this.W)),r=u.K(),n=r.h(i?i.S():null),t;return n||(t=r.a,n=new _Ewa.W(t.a,t.b,0,0)),n},q:function(n,t,i,r){var e,u,o,f,c,s;this.T.isChangeGateEnabled("OfficeVSO:4011777_investigateCalculateMaximumClippingExtentsCrash")&&(e=this.a().cm(),Diag.a.a(592505059,0,50,"EditBox.StartEdit: gridKeyboardHandler is: {0}, parent is: {1}",e.id,e.parentNode?e.parentNode.id:"null"));this.b()!==""&&(this.co(),Diag.a.b(594634114,1,!1,"EditBox.StartEdit: Text is not empty, time={0}",_Ewa.i.a()));_Ewa.bH.a().j(0);var h=new($$sc.C.$$(Number)),a=this.T.isChangeGateEnabled("OfficeVSO:3476911_LogEditRichText")?{richText:n.a().v(),editor:this.bb?"FormulaBar":"Cell"}:{},v={ShouldLogInTextEditorTelemetry:!0,textRuns:h.a};_Ewa.bG.a(this.T).a(_Ewa.bd.h,a,v);this.bf&&this.cQ(n.a().bc());i&&this.S.F().b(this);t=!!(t|n.Q());u=n.r();n.bh()&&(u=_Ewa.i.S(u));o=t?this.bg?0:Number.NaN:u.length;t||(this.bf?(f=n.a().t(),f&&f.TextRuns&&f.TextRuns.length>1&&_Ewa.e.b(f.Text,u,!1)?this.dt(f):this.ct(u)):!u||!u.length||this.e(u));c=this.cR(n.a().c(),this.cl);t&&(c?(this.e("%"),this.bg||(o=0)):(this.bf&&this.ct(""),this.bM=n.c()));this.P(!0);Sys.UI.DomElement.addCssClass(this.bs(),"ewa-gridKeyHandler-editing");this.W=n.b().f();this.br=n.G();this.cj=n.a().c();s=this.a().cA();this.dw(n,s,!0,this.bf,r);var y=this.T.f().a(),p=new _Ewa.oQ(n,y,t,r),l=new _Ewa.bH.b("EditStartedEventHandlers",1);try{this.cd(p)}finally{l&&l.dispose()}this.dq();u.indexOf("=")||this.T.isChangeGateEnabled("OfficeVSO:3556055_DirectionFixes1")||(s.textAlign="");this.bt=this.T.p().b("UserAction","CellTyping");this.bt.d();this.bq();this.bm();this.bb||this.a().C(o);_Ewa.bH.a().j(1);h.b(this.a().R())},n:function(n){var t=n?"none":"";this.a().cm().style["pointer-events"]=t},M:function(n,t){return this.cl=n,this.U&&this.b()==="-"&&this.cR(this.cj,n)&&(this.e(this.b()+"%"),this.a().h(1)),_Ewa.ij.prototype.M.call(this,n,t)},ds:function(n){this.dE("ekdc",n,null)},cQ:function(n){this.bf&&this.a().cK(n)},dt:function(n){this.a().bn(n);this.cr(new _Ewa.is(!1))},dm:function(){return this.a().bi()},ct:function(n){this.a().bN(n)},co:function(){this.a().bh();this.cQ(null)},bk:function(n,t){this.bb||this.ck||_Ewa.ij.prototype.bk.call(this,n,t)},by:function(n,t){this.bb||_Ewa.ij.prototype.by.call(this,n,t)},cc:function(n){var i=this.bb,t;this.bb=!1;t=_Ewa.dH.a(this.T);t&&(t.P(!1),i&&(t.B(),t.k(!1)));n.stopPropagation();this.cF()},bp:function(n){this.j()&&!this.X&&(this.V=this.a().b(),this.Z=0,n.preventDefault());this.bg&&this.U&&this.cP(this.dl(this.b(),this.a().b()));this.cr(new _Ewa.is(!1));this.T.a(532)&&_Ewa.ij.prototype.bp.call(this,n)},bX:function(){this.br=!0;var n=_Ewa.ij.prototype.bX.call(this);return _Ewa.cz.b()&&this.bc.G(!0,null),n},ce:function(){return this.U&&!this.bb},cn:function(n){var t=this.T.f().a();n=!!(n|this.S.F().d(t));_Ewa.a.f(this.bs(),"ewa-gridKeyHandler-editing-offscreen",n)},cr:function(n){this.bq();n.a||this.bm();this.T.isChangeGateEnabled("OfficeVSO:3556055_DirectionFixes1")||this.bB(null);this.dE("ekcvc",n,null)},dp:function(n){return n>=48&&n<=57||n>=96&&n<=105},cR:function(n,t){var u,i,r;return t&&(u=this.dp(t.keyCode)&&!t.shiftKey,u&&(i=this.T.b().a(_Ewa.cv,268,!1),r=!1,r=i?i.y(n):_Ewa.ph.a(n,this.T.V()),r))?(Diag.a.a(23156483,0,50,"Adding % while typing to a cell which was pre-defined as percentage category"),!0):!1},dw:function(n,t,i,r,u){var o=this.T.isChangeGateEnabled("OfficeVSO:3556055_DirectionFixes1"),e,f;o&&(this.be=this.bF(n,u),this.bu=this.cS(n,u));r?(e=new _Ewa.hG(t),e.a.direction=_Ewa.bR.f(n.a())):e=_Ewa.bR.e(n.a(),t);f=e.a;f.backgroundColor=n.j()||n.a().d().s();r||(f.color=n.k(),f.textDecoration=_Ewa.bR.k(n.a()));o?(f.direction=this.be?"rtl":"ltr",f.textAlign=_Ewa.bR.c(this.bu)):f.textAlign=_Ewa.bR.b(n.a(),this.S.d())||(this.bF(n,null)?"right":"left");e.b();(i||this.U&&!this.j())&&(this.cO(n,i),this.bc.e=this.S.a().b().f())},cO:function(n,t){var r,i,f,u;if(this.U&&n){if(r=this.S,i=this.bL.d(n,r,t),!i){this.j()||(f=this.T.a(458)?r.a().d().c():r.a().a(),r.I(f,60,_Ewa.C.x,!1,null));return}u=this.a().cA();_Ewa.dq.a(u,r.d(),i.x-1+"px");u.top=i.y-1+"px";this.bw=Math.max(1,i.height);Common.c.a()&&_Ewa.e.b(_Ewa.bR.b(n.a(),this.S.d()),"right",!0)?(u.paddingRight="1px",this.bn=Math.max(1,i.width-1)):this.bn=Math.max(1,i.width);this.cn(this.cm().k())}},dq:function(){var t=Math.min(this.bn,this.bc.u),i=Math.min(this.bw,this.bc.j),n=this.a().cA();n.width=t+"px";n.height=i+"px";_Ewa.t.a(this.T).f()&&(n.zoom=_Ewa.t.a(this.T).b().toString())},dx:function(){var n,t;this.U&&(n=this.S.e(this.W),this.du(n)?(t=!0,this.bc.I(t,!1,!1),this.cO(n,!1),this.bc.G(t,null)):this.cn(this.cm().k()))},du:function(n){return this.S.b().h()?!!n&&n.a().j():!!n},dr:function(){this.U&&!this.j()&&(_Ewa.uf.a()||this.bs().scrollIntoViewIfNeeded(),this.S.h().c(this.cg))},dk:function(){var n=this.cm();n.k()&&this.S.I(this.S.a().b(),60,_Ewa.C.w,!1,null);this.S.h().b(this.cg)},dv:function(n){n.stopPropagation()},dj:function(n,t){var i=this.S.e(n);if(this.bh)return null;var u=i?i.r():null,f=this.T.f().a(),r=new _Ewa.tm(n,u,t,!1,f);return this.cK(r),r},dn:function(){var n=_Ewa.dH.a(this.T);n&&n.y()&&!this.X&&(this.X=!0,n.k(!0))},dl:function(n,t){var r,i;for(t=Math.min(t,n.length),r=0,i=0;i<t;i++)n.charAt(i)==="\n"&&r++;return r},cP:function(n){var t=_Ewa.dH.a(this.T),u;if(t&&t.a().f()&&t.J()&&!this.T.bn()&&(this.cp&&this.bg?t.a().g().scrollTop=18*n:t.a().cm().scrollTop=22*n,u=t.a().g().getElementsByClassName(richTextEditor.RichTextEditorConstants.editorLineClass)[n],u)){var i=_Ewa.a.i(u),r=_Ewa.a.i(t.a().cm()),f=i.y>r.y,e=i.y+i.height<r.y+r.height;Diag.a.b(42811908,1,f&&e,"Formula bar text is not well contained in text box. lineIndex:{0}, lineTop:{1}, lineBottom:{2}, boxTop:{3}, boxBottom:{4}",n,i.y,i.y+i.height,r.y,r.y+r.height)}}};_Ewa.Ft=function(n,t,i,r,u,f,e,o){this.l=Function.createDelegate(this,this.p);_Ewa.Ft.initializeBase(this,["ExtendedMultiRangeCellEnumerator",n,i,u,f]);this.i=t;this.c=r;this.o(e,o)};_Ewa.Ft.prototype={i:null,m:function(){return},o:function(n,t){this.d=new Array(this.g.length);for(var i=0;i<this.g.length;i++)this.d[i]=new _Ewa.Gv(this.h,this.i,this.g[i],this.j,this.f,this.l,n,t)},$$mn:function(){return this.e().$$mn()},p:function(){var n,t;this.e().$$rst();do this.f?this.c===this.d.length-1?this.c=0:this.c+=1:this.c?this.c-=1:this.c=this.d.length-1;while(this.h.X().h(this.e().g));return this.e().$$rst(),n=this.f?this.e().g.e():this.e().g.p(),n=_Ewa.f.t(this.h.X().k(n,this.f)),t=this.h.c().a(458)?this.i.d().a():[this.i.a()],this.h.bE(t,this.c,this.h.c().f().a().c(),null,n,null,null,60,_Ewa.C.C,!0,!1,n,!1,!1),this.e().b(n,!0)}};_Ewa.Fu=function(n,t){_Ewa.Fu.initializeBase(this,[n,2,t])};_Ewa.Fu.prototype={bv:function(){return new _Ewa.M(this.e().a.a,this.e().a.b)},x:function(){return new _Ewa.M(0,0)},m:function(){var n=this.c.bm();return new _Ewa.M(n,n)},n:function(){return new _Ewa.M(0,0)},ek:function(n,t,i){return this.g()?(this.f(),_Ewa.gN.prototype.ek.call(this,Math.min(n,this.k()),Math.min(t,this.j()),Math.min(i,this.j()))):null},f:function(){for(var n=0;n<=this.k();n++)_Ewa.gN.prototype.ek.call(this,n,0,this.j())}};_Ewa.Fv=function(n,t){_Ewa.Fv.initializeBase(this,[!1]);this.F=n;this.z=t;this.y=t.dD};_Ewa.Fv.prototype={I:null,A:null,F:null,z:null,y:null,f:function(n){this.dG("FOSC",n)},h:function(n){this.dH("FOSC",n)},s:function(n){this.dG("FOSCMU",n)},u:function(n){this.dH("FOSCMU",n)},k:function(n){this.dG("FOSCUA",n)},m:function(n){this.dH("FOSCUA",n)},B:null,c:function(){return this.B},x:null,a:function(){return this.x},g:function(){return this.A},v:function(n){return this.A!==n&&(this.A=n,this.x&&(this.x.G(!0),this.dE("FOSC",null,null))),n},e:function(){return this.D},q:function(n){var t=this.D;return this.D=n,(!n&&t&&t.a()||n&&n.a()&&!t||n&&n.a()&&t&&t.a()&&n.a().b!==t.a().b)&&this.dE("FOSCUA",null,null),n},D:null,t:function(){return _Ewa.O.a(this.y).a(this.I,null)},G:!1,n:function(){return this.G},r:function(n){return this.G=n,n},C:!1,o:function(){return this.C},l:function(){return!!this.x},dispose:function(){this.B=null;this.q(null)},b:function(n){var i,t;if(this.z.m()&&(this.y.isChangeGateEnabled("OfficeVSO:3904622_HideCellHighlightOnFloatingObjectSelection")&&(i=_Ewa.dH.a(this.y),i&&i.h(!0,"FloatingObjectsSelectionManager.SelectImage",0,null)),this.z.bP(!0,"FloatingObjectsSelectionManager.SelectImage")),this.z.P()){Diag.a.a(50628447,5,50,"FloatingObjectsSelectionManager.SelectImage: Not selecting object since since InDialogRangePicker is true");return}if(this.x!==n){this.l()&&(this.A=null,this.x.G(!1));this.M(n);switch(this.x.a().a){case 1:t=4;break;case 0:t=2;break;case 3:t=16;break;case 5:t=64;break;case 2:t=128;break;case 8:t=256;break;default:t=0}this.F.S(t);Diag.a.a(50628449,5,50,"FloatingObjectsSelectionManager.SelectImage: Selected Floating object with type: {0} , is Edit Mode: {1}",this.x.a().a,this.y.c().A());this.dE("FOSC",null,null);_Ewa.bG.a(this.y).a(_Ewa.bd.B,{floatingObjectType:_Ewa.L.a(this.x.a())},null)}},p:function(){this.dE("FOSCMU",null,null)},d:function(n,t){n&&this.x!==n||this.L(t)},w:function(n){if(n&&n.q()){var t=n.a()?n.a().a:99;t!==99&&n.bb(!0)}},i:function(n){if(!n||!n.a()||!n.q())return Diag.a.a(50628451,5,10,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelection: Can't select floating object; control is null or not selectable."),!1;if(!n.b())return Diag.a.b(50628480,5,!1,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelection: Expecting to have a DOM element associated to the floating object control."),!1;var i=n.a().a,t=this;return _Ewa.g.cw(_Ewa.l.b(_Ewa.gy,this.y.b(),103,104,0),function(r){if(t.z&&n&&n.a()){var u=r.a(),f=u.a(n.e(),n.b());u.g(n.e(),f);t.w(n);i===2&&t.z.dn()}},this.dF(),8),!0},j:function(n,t,i){var f=_Ewa.go.a(t,i),r,s,h,e,c,o,u;if(Diag.a.a(50628481,5,50,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelectionAsync: Going to navigate and select floating object [{0}] of type [{1}]",f,i),r=_Ewa.dU.a(Boolean,_Ewa.z.a(),this.dF(),"Task","Navigate To FloatingObject"),!n||!t||_Ewa.e.a(n.SheetName)||!this.y.f().f(n.SheetName))return Diag.a.b(50628482,0,!1,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelectionAsync: one or more input parameter is null"),r.b(!1),r.a;if(s=_Ewa.e.b(this.y.f().a().c(),n.SheetName,!1),!s){if(h=this.y.f().b(n.SheetName),!h.p())return Diag.a.b(50628484,0,!1,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelectionAsync: Sheet is not visible. Cannot navigate to non-visible sheet."),r.b(!1),r.a;h.g(!1)}return this.C=!0,e=_Ewa.f.b(n),c=this.z.I(e,3,_Ewa.C.X,!1,null),s&&c?this.E(t,f,i,e,r):(Diag.a.a(50628485,5,50,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelectionAsync: waiting for all blocks to be updated [{0}]",f),o=null,u=this,o=function(n,s){if(s.a)Diag.a.a(50628486,5,50,"FloatingObjectsSelectionManager.ChangeToFloatingObjectSelectionAsync: GotoRange is not completed yet. Keep waiting. [{0}]",f);else if(u.z.T(o),u.z.ce())u.E(t,f,i,e,r);else{var h=null;h=function(){u.z.co(h);u.E(t,f,i,e,r)};u.z.bZ(h)}},this.z.W(o)),r.a},E:function(n,t,i,r,u){var f,h,s,e,c,o,l;Diag.a.a(50628487,5,50,"FloatingObjectsSelectionManager.ContinueNavigationAfterAllBlocksUpdated: continue navigation to floating object [{0}]",t);f=this.J(n,i);f?f.bj()||i===3?this.H(u,t,f):(Diag.a.a(50628489,5,50,"FloatingObjectsSelectionManager.ContinueNavigationAfterAllBlocksUpdated: waiting for floating object image to complete downloading [{0}]",t),o=null,l=this,o=function(){l.H(u,t,f);f.B(o)},f.D(o)):(h=i+"_"+n,s=_Ewa.O.a(this.y),_Ewa.b.h(this.z,h,r.e())?(Diag.a.a(50628488,5,50,"FloatingObjectsSelectionManager.ContinueNavigationAfterAllBlocksUpdated: floating object control [{0}] hasn't been created yet. Continue waiting ",t),e=null,c=this,e=function(f,o){o.a.a().a===i&&_Ewa.e.b(o.a.a().b,n,!0)&&(s.w(e),c.E(n,t,i,r,u))},s.s(e)):this.H(u,t,null))},J:function(n,t){var i,r,f;if(t===99){if(i=_Ewa.O.a(this.y).b(),r=null,i)for(var e=i,o=e.length,u=0;u<o;++u)f=e[u],f.a().b===n&&(r=f);return r}return _Ewa.O.a(this.y).a(t+"_"+n,null)},H:function(n,t,i){i?n.b(this.i(i)):n.b(!1);this.C=!1},L:function(n){this.l()&&(this.x.G(!1),this.x=null,this.C||(this.F.S(1),this.dE("FOSC",null,null)));n&&(this.B=null,this.q(null),this.A=null)},M:function(n){n.G(!0);this.K(n)},K:function(n){this.x=n;this.I=n.a().h();this.B=n.a().b;this.q(n)}};_Ewa.jE=function(n,t){this.bN=n;this.bO=t;this.bN.I(!0)};_Ewa.jE.a=function(n){var t=new RegExp("\r(?!\n)"),i=n.split(t);return i.join("")};_Ewa.jE.prototype={bO:null,bN:null,a:function(){return this.bN},j:function(){return this.bN.x()},H:function(n){return this.bN.ct(n),n},o:function(){return this.bN.L()},bm:function(n){return this.bN.cu(n),n},k:function(){return this.bN.br()},A:function(n){return this.bN.cv(n),n},bB:function(){return this.bN.bZ()},bA:function(){return this.bN.bY()},P:function(){return this.bN.bX()},K:function(){return this.bN.bx()},M:function(){return this.bN.bC()},O:function(){return this.bN.bI()},Z:function(){return this.bN.by()},h:function(){return this.bN.R()},N:function(){return this.bN.bH()},ba:function(){return this.bN.bE()},L:function(){return this.bN.bB()},bb:function(){return this.bN.bF()},bz:function(){return this.bN.bO()},bC:function(){return this.bN.cc()},bD:function(){return this.bN.cg()},by:function(){return this.bN.bN()},E:function(){return this.bN.ca()},bg:function(){return this.bN.bQ()},bh:function(){return this.bN.bS()},f:function(){return this.bN.T()},B:function(){return this.bN.bM()},q:function(){return this.bN.bR()},bc:function(){return this.bN.bK()},bQ:function(){return this.bN.bD()},bG:function(){return this.bN.bz()},bI:function(){return this.bN.bG()},T:function(){return this.bN.bL()},bE:function(){return this.bN.ch()},t:function(){return this.bN.W()},bp:function(n){return this.bN.cA(n),n},s:function(){return this.bN.N()},V:function(n){return this.bN.cx(n),n},p:function(){return this.bN.O()},I:function(n){return this.bN.cy(n),n},bx:function(){return this.bN.bw()},bw:function(){return this.bN.bv()},y:function(){return this.bN.P()},bo:function(n){return this.bN.cz(n),n},d:function(){return this.bN.B()},J:function(n){return this.bN.bh(n),n},bi:function(){return this.bN.ce()},r:function(){return this.bN.w()},i:function(){return this.bN.l()},c:function(){return this.bN.f()},n:function(n){return this.bN.cC(n),n},m:function(){return this.bN.cd()},u:function(){return this.bN.bb()},bq:function(n){return this.bN.cD(n),n},bv:function(){return _Ewa.N.a(this.k(),this.j()).e()},x:function(){return this.bN.bu()},bn:function(n){return this.bN.cw(n),n},g:function(){return this.bN.ck()},br:function(n){return this.bN.cF(n),n},G:function(){return this.bN.cl()},bF:function(){return this.bN.ci()},bj:function(){return this.bN.cj()},v:function(){return this.bN.e()},bd:function(){return this.bN.g()},z:function(){return this.bN.bT()},C:function(){return this.bN.bU()},D:function(){return this.bN.bV()},Q:function(){return this.bN.U()},bf:function(){return this.bN.U()},be:function(){return this.bN.bP()},R:function(){return this.bN.co()},e:function(){return this.bN.k()},l:function(){return this.bN.bW()},b:function(){return this.bN.a(!1)},bP:function(){return!_Ewa.e.a(this.j())||this.bG()},bJ:function(){return this.bN.bJ()},bH:function(){return this.bN.bA()},F:function(){var n=new RegExp("(?:^'(.*))","g");return _Ewa.e.a(this.bN.w())?this.bN.w():this.bN.w().replace(n,"$1")},bl:function(n){return n?this.bA():this.bB()},bK:function(n,t,i){this.bN.cp(n,t,i)},U:function(n,t){return _Ewa.eU.b(n,t,this.bO,this.bN)},W:function(n){this.bN&&(this.bQ()||this.bP()?this.bN.cG(n,null):this.bM(n))},bM:function(n){this.bN&&this.bN.cs(n)},X:function(){return this.bN.bm(),this.bN.bh(""),!this.bP()},Y:function(){this.bN.bn()},bu:function(n){this.bN.bp(n)},bt:function(n){this.bN.bo(n)},bk:function(){var n=this.bN.bk();return n===3||n===4||n===2},S:function(){var n=this.e()?this.bO.z(this.b(),this.bO.j().c(this.b()),!1,!1):this.bO.R(this.bN),t,i;return n&&((t=n.b).a=t.a-1,(i=n.b).b=i.b-1),n},w:function(n,t){return _Ewa.eU.c(n,t,this.bO,this.bN)},bs:function(n,t,i,r){this.bN.J(n,t,i,r)},bL:function(n){return this.bN.cq(n)}};_Ewa.Zo=function(n,t,i){this.s=Function.createDelegate(this,this.w);_Ewa.Zo.resolveInheritance();this.dw=this.dQ;this.i=this.B;this.p=this.eO;_Ewa.Zo.initializeBase(this,[i,n.b(),n.du(),n.dx(),t,n.c()]);this.c=n;var r=this.dC.currentStyle,u=-1,f=-1;isNullOrUndefined(r)?Diag.a.a(41283865,1,50,"FreezePane: pane style is null, id = {0}, display = {1}. Using default border offset...",this.dC.id,this.dC.style.display):(u=_Ewa.i.r(r,n.d()?"borderLeftWidth":"borderRightWidth")*-1,f=_Ewa.i.r(r,"borderBottomWidth")*-1);this.o=new _Ewa.M(u,f);this.l=new _Ewa.M(0,0);this.dK().a("scroll",this.s,!1)};_Ewa.Zo.prototype={o:null,l:null,cy:function(){return this.r()?this.c.cy():_Ewa.mE.prototype.cy.call(this)},eU:function(n){var t,i;for(_Ewa.mE.prototype.eU.call(this,n),t=this.$$ge();t.$$mn();)i=t.$$cu(),i.t(n);return n},bJ:function(){return this.r()?this.c.bJ():0},h:function(){return this.c.h()},K:function(){var n=this.bv(),t=this.n();return new _Ewa.W(t.a,t.b,n.a,n.b)},c:null,k:function(){return this.e().i===this.ej?0:Math.floor(this.e().i/this.ej)},j:function(){return this.e().h===this.ei?0:Math.floor(this.e().h/this.ei)},e:function(){return this.c.j()},g:function(){return this.e().k(this.dN)},r:function(){return!1},dispose:function(){this.dK().b("scroll",!1);_Ewa.mE.prototype.dispose.call(this)},a:function(n){Diag.a.a(18363281,1,100,"FreezePane.Update: FreezePanesImprovements PaneType {0} PaneExists {1} ShowPane {2}.",this.dN,this.g(),n);this.g()?(n&&this.z(this.bv()),this.c.bY()&&this.f()):n&&this.t()},u:function(n,t,i){var u,r,f;if(this.dN!==3)Diag.a.b(3149832,1,!1,"FreezePane.InsertViewBlocksByPosition: InsertViewBlocksByPosition should NOT be called on the fixed or vertical freeze pane.");else if(this.g())if(n<=this.k())u=this.hl(n),u.r(t,i);else for(r=this.$$ge();r.$$mn();)f=r.$$cu(),f.r(t,i)},cA:function(n,t,i){return new _Ewa.gg(n,t,i,this.c)},hj:function(n){switch(this.dN){case 4:this.g()&&_Ewa.gN.prototype.hj.call(this,n)}},z:function(n){if(!this.l.d(n)){var t=_Ewa.M.a(n,_Ewa.M.a(this.o,this.m()));_Ewa.a.r(this.dC,t.b,!1);_Ewa.a.l(this.dC,t.a,!1);this.l=n.c()}this.dQ()||(Diag.a.a(18363282,1,100,"FreezePane.Show: FreezePanesImprovements actual show PaneType {0}",this.dN),this.dV(!0))},t:function(){this.dQ()&&(Diag.a.a(18363283,1,100,"FreezePane.Hide: FreezePanesImprovements actual hide PaneType {0}",this.dN),this.ex(),this.dV(!1),Diag.a.a(18363284,1,100,"FreezePane.Hide: FreezePanesImprovements actual hide complete PaneType {0}",this.dN))},w:function(){this.el()&&(this.dN===2||this.dN===4)&&(Diag.a.a(23614745,1,15,"FreezePane.OnScroll: Horizontal scroll detected on pane of type {0}",this.dN),this.eP(0));this.ef()&&(this.dN===2||this.dN===3)&&(Diag.a.a(23614746,1,15,"FreezePane.OnScroll: Vertical scroll detected on pane of type {0}",this.dN),this.ey(0))}};_Ewa.tX=function(n,t,i){_Ewa.tX.initializeBase(this,[n,t,i,i?3:4]);var r=this.dC.currentStyle;this.g=1;isNullOrUndefined(r)?Diag.a.a(41283866,1,50,"FreezePaneHeader: pane style is null, id = {0}, display = {1}. Using default border width...",this.dC.id,this.dC.style.display):this.g=_Ewa.i.r(this.dC.currentStyle,this.c?"borderBottomWidth":n.d()?"borderLeftWidth":"borderRightWidth")};_Ewa.tX.prototype={g:0,l:0,bJ:function(){return 0},j:function(){return Math.floor(this.e.dI.i/this.ej)},k:function(){return Math.floor(this.e.dI.h/this.ei)},o:function(){return this.e.dI.k(this.dN)},a:function(n){Diag.a.a(18363285,1,100,"FreezePaneHeader.Update: FreezePanesImprovements PaneType {0} ShowPane {1}.",this.dN,n);var t=this.e.dI;this.o()?(n&&this.w(this.c?t.a.b:t.a.a),this.t()):n&&this.u()},r:function(){},cA:function(n,t,i){var r=this.c&&i.Y<=this.j()||!this.c&&i.X<=this.k();return r?new _Ewa.it(n,t,_Ewa.bo.a(this.c?0:i.X,this.c?i.Y:0,this.dN)):null},ek:function(n,t,i){var u=null,r;if(this.o()){if(this.c&&n>this.j()?n=0:!this.c&&t>this.k()&&(t=0),this.c)for(r=0;r<=this.j();r++)_Ewa.tZ.prototype.ek.call(this,r,t,i);n=this.c?n:0;t=this.c?0:t;i=this.c?0:this.k();u=_Ewa.tZ.prototype.ek.call(this,n,t,i)}return u},w:function(n){this.l!==n&&(_Ewa.a.N(this.dC,!this.c,n-this.g,!1),this.l=n);this.dQ()||(Diag.a.a(18363286,1,100,"FreezePaneHeader.Show: FreezePanesImprovements actual show PaneType {0}",this.dN),this.dV(!0))},u:function(){this.dQ()&&(Diag.a.a(18363287,1,100,"FreezePaneHeader.Hide: FreezePanesImprovements actual hide PaneType {0}",this.dN),this.dV(!1),this.ex(),Diag.a.a(18363288,1,100,"FreezePaneHeader.Hide: FreezePanesImprovements actual hide completed PaneType {0}",this.dN))},t:function(){var n=this.e.dP,i,r,u,f,t;if(n)for(this.c?(i=n.b.X,r=n.a.X,u=0,f=this.j()):(i=0,r=this.k(),u=n.b.Y,f=n.a.Y),t=u;t<=f;t++)_Ewa.tZ.prototype.ek.call(this,t,i,r)}};_Ewa.tY=function(n){this.C=n;this.F=this.C.c().isChangeGateEnabled("OfficeVSO:4145974_GridContentQueriesCache");this.G=!this.C.c().a(903);this.F&&(this.E=new _Ewa.Fw(n),this.H=_Ewa.o.a(1,1,!1))};_Ewa.tY.a=function(n){var r=-1,u=-1,t,i;for(n.$$mn()&&(t=n.a().b(),r=t.l(),u=t.o());n.$$mn();)if(i=n.a().b(),i.l()!==r||i.o()!==u)return!1;return!0};_Ewa.tY.prototype={C:null,E:null,F:!1,G:!1,H:null,z:function(n){var t=this;return this.D("IsRangeEmpty",_Ewa.f.f(n),function(){var i=new _Ewa.dB("GridContentQueries.IsRangeEmpty",t.C,n,2,!0);try{while(i.$$mn())if(!_Ewa.e.d(i.$$cu().r()))return!1}finally{i&&i.dispose()}return!0})},w:function(n){var t=this;return this.D("IsFormulaInRange",_Ewa.f.f(n),function(){var i=new _Ewa.dB("GridContentQueries.IsFormulaInRange",t.C,n,2,!0),r;try{while(i.$$mn())if(i.$$cu().d()&&i.$$cu().d().length>0&&(r=i.$$cu().d().charCodeAt(0),r===61))return!0}finally{i&&i.dispose()}return!1})},x:function(n){var t=_Ewa.p.b(this.C.c()),i=this;return this.D("IsHyperlinkInRanges",_Ewa.f.E(n),function(){var r=new _Ewa.oT("GridContentQueries.IsHyperlinkInRanges",i.C,n,2,!0),u;try{while(r.$$mn())if(u=t?r.$$cu().a().n():!!r.$$cu().f(),u||r.$$cu().q())return!0}finally{r&&r.dispose()}return!1})},e:function(n){var t=this;return this.D("IsMergedCellInRange",_Ewa.f.f(n),function(){var r=!1,i=new _Ewa.dB("GridContentQueries.IsMergedCellInRange",t.C,n,2,!0);try{while(!r&&i.$$mn())r=i.$$cu().e()}finally{i&&i.dispose()}return r})},d:function(n){var t=this;return this.D("IsSingleMergedCell",_Ewa.f.f(n),function(){var r=!1,i=new _Ewa.dB("GridContentQueries.IsSingleMergedCell",t.C,n,2,!0);try{if(i.$$mn(),i.$$cu())r=i.$$cu().e()&&!i.$$mn();else return n.j()||Diag.a.a(50647321,1,15,"GridContentQueries.IsSingleMergedCell: Can't determine if IsSingleMergedCell. It happens when the blocks are not available yet when using ctrl+arrow in a dialog with picker. We'll return false, thus in case the 'go to' landed in a single merged cell, the text won't be replaced with the top left."),!1}finally{i&&i.dispose()}return r})},g:function(n){var t=this;return this.D("IsRichValueInRange",_Ewa.f.f(n),function(){var i=new _Ewa.dB("GridContentQueries.IsRichValueInRange",t.C,n,2,!0),r,u;try{while(i.$$mn())if(r=i.a(),u=r.o(),u)return!0}finally{i&&i.dispose()}return!1})},I:function(n,t){var i=this;return this.D("IsLinkedEntityInRange",_Ewa.f.f(n)+t,function(){var u=new _Ewa.dB("GridContentQueries.IsLinkedEntityInRange",i.C,n,2,!0),f,r;try{while(u.$$mn())if(f=u.a(),r=f.o(),(!t||!f.R())&&(r===1||r===3||r===2||r===4))return!0}finally{u&&u.dispose()}return!1})},y:function(n){return this.I(n,!0)},r:function(n){var t=this;return this.D("IsRefreshableLinkedEntityInRange",_Ewa.f.f(n),function(){var i=new _Ewa.dB("GridContentQueries.IsRefreshableLinkedEntityInRange",t.C,n,2,!0),r,u;try{while(i.$$mn())if(r=i.a(),u=r.o(),u===3)return!0}finally{i&&i.dispose()}return!1})},m:function(n){var t=this;return this.D("IsAmbiguousLinkedEntityInRange",_Ewa.f.f(n),function(){var i=new _Ewa.dB("GridContentQueries.IsAmbiguousLinkedEntityInRange",t.C,n,2,!0),r,u;try{while(i.$$mn())if(r=i.a(),u=r.o(),u===1)return!0}finally{i&&i.dispose()}return!1})},o:function(n){return this.v([n])},v:function(n){var t=this;return this.D("IsErrorInRanges",_Ewa.f.E(n),function(){var i=new _Ewa.oT("GridContentQueries.IsErrorInRanges",t.C,n,2,!0),r;try{while(i.$$mn())if(r=i.a(),r.V())return!0}finally{i&&i.dispose()}return!1})},a:function(n,t){var i=this;return this.D("GetTableContainingRange",_Ewa.f.f(n)+t,function(){var r=_Ewa.dr.c(i.C.c(),n,t);return r&&r.b.i(n)?r:null})},l:function(n,t){var i=this;return this.D("GetTableContainingRanges",_Ewa.f.E(n)+t,function(){if(!n||!n.length)return null;var r=i.a(n[0],t);return r?Common.L.b(n,function(n){return r.b.i(n)})?r:null:null})},i:function(n,t){var i=this;return this.D("IsRangeContainedInTable",_Ewa.f.f(n)+t,function(){var r=_Ewa.dr.c(i.C.c(),n,!1),u=!!r&&r.b.i(n);return t&&(u=u&&r.O),u})},p:function(n){var t=this;return this.D("IsRangeContainedInAutoFilter",_Ewa.f.I(n),function(){var i=null;return!t.C.c().f()||!(i=t.C.c().f().b(n.SheetName))||!i.u?!1:i.u.i(_Ewa.f.b(n))})},A:function(n){var t=this;return this.D("IsRangeEqualsAutoFilterRange",_Ewa.f.I(n),function(){var i=null;return!t.C.c().f()||!(i=t.C.c().f().b(n.SheetName))||!i.u?!1:i.u.g(_Ewa.f.b(n))})},h:function(n){var t=this;return this.D("IsRangeContainedInPivotTable",_Ewa.f.f(n),function(){return!!t.b(n)})},f:function(n){var t=this;return this.D("IsRangeIntersectsAndNotContainedInTable",_Ewa.f.f(n),function(){var i=_Ewa.dr.c(t.C.c(),n,!1);return!!i&&!i.b.i(n)})},c:function(n){var t=this;return this.D("IsRangeIntersectsTable",_Ewa.f.f(n),function(){var i=_Ewa.dr.c(t.C.c(),n,!1);return!!i})},q:function(n){var t=this;return this.D("IsRangeIntersectsTableHeader",_Ewa.f.f(n),function(){var i=_Ewa.dr.c(t.C.c(),n,!1);return!!i&&_Ewa.bV.d(i,n)})},s:function(n){var t=this;return this.D("AreAllCellsInRangeHavingSameStructure",_Ewa.f.f(n),function(){var i=new _Ewa.dB("GridContentQueries.AreAllCellsInRangeHavingSameStructure",t.C,n,2,!0);try{return _Ewa.tY.a(i)}finally{i&&i.dispose()}})},b:function(n){for(var i,r=null,f=this.C.A(n),u=f,e=u.length,t=0;t<e;++t)if(i=u[t],_Ewa.co.isInstanceOfType(i)){r=i;break}return r},u:function(n){var i=this,t=this.D("GetSpillingDynamicArrayFromAnchor",_Ewa.f.f(n),function(){for(var t,f=i.C.A(n),u=f,e=u.length,r=0;r<e;++r)if((t=u[r],_Ewa.fH.isInstanceOfType(t))&&!t.q&&t.e().g(n))return t;return null});return t?t.f():null},n:function(n){var t=this;return this.D("IsDynamicArrayRange",_Ewa.f.f(n),function(){if(!n)return!1;var i=t.u(n.e());return!!i&&i.g(n)})},t:function(n){var t=this;return this.D("GetRichValueFields",_Ewa.f.f(n),function(){var u=new $$sc.G,i=t.C.t("GridContentQueries.GetRichValueFields",n,2,!0),r,f,e;try{while(i.$$mn())if(r=i.$$cu().a().cf(),r&&r.e.length>0)for(f=r.$$lge();f.$$mn();)if(e=f.$$cu(),u.c(e),u.a>=64){Diag.a.a(592254937,0,50,"Reached 64 field max limit per column getting rich value fields from cache");break}}finally{i&&i.dispose()}return u})},j:function(n,t,i,r){var u,f,h,c;if(!t||!i||(u=t.b(),f=t.c(),!f||f.length<2||!(u==="DP"||u==="DL")))return!1;var l=r||this.C.h().d(),e=this.C.j()?this.C.j().c(n):1,y=this.C.X(),p=this.C.bx(),o,s,a,v;return(_Ewa.bz.c(n,y,p,a={val:o},v={val:s}),o=a.val,s=v.val,u==="DP"&&(e===1||e===3))?(h=l.a+f[0].width-i.x,o.a<h&&s.a>h):u==="DL"&&(e===1||e===4)?(c=l.b+f[0].height-i.y,o.b<c&&s.b>c):!1},B:function(n,t,i){var r=n.x-i.x,u=t.a+r,f=n.y-i.y,e=t.b+f;return new _Ewa.W(u,e,n.width,n.height)},k:function(n,t,i,r,u){if(!t||!i||!r)return!1;var c=u||this.C.cW().a,l=this.C.X(),a=this.C.bx(),f,e,s,h;_Ewa.bz.c(n,l,a,s={val:f},h={val:e});f=s.val;e=h.val;var o=this.B(t,c,r),v=o.a.a,y=o.a.b,p=o.b.a,w=o.b.b;return e.a<v||f.a>p?!1:f.b>w||e.b<y?!1:!0},D:function(n,t,i){var f,e,o,s,r,u;if(!this.F)return i();if(f=n+"_"+t,r=(s=this.E.c(f,o={val:e}),e=o.val,s),e){if(this.G)return u=i(),u?Object.getType(u)===Object.getType(!0)?Diag.a.a(592254935,1,50,"GridContentQueries.ComputeOrCache: bool cache for {0} is {1}",n,u===r?"correct":"wrong"):Object.getType(u)===Object.getType(this.H)&&Diag.a.a(592254934,1,50,"GridContentQueries.ComputeOrCache: Range cache for {0} is {1}",n,u.g(r)?"correct":"wrong"):Diag.a.a(592254936,1,50,"GridContentQueries.ComputeOrCache: when real result is null, cache for {0} is {1}",n,r?"wrong":"correct"),u}else r=i(),this.E.b[f]=r;return r}};_Ewa.Fw=function(n){this.a=Function.createDelegate(this,this.d);this.b={};n.c().c().p(this.a);n.b().d(this.a);n.b().c(this.a);n.v(this.a);n.c().f()&&n.c().f().c(this.a)};_Ewa.Fw.prototype={b:null,c:function(n,t){return n in this.b?(t.val=!0,this.b[n]):(t.val=!1,null)},d:function(){this.b={}}};_Ewa.bJ=function(n,t,i,r,u){this.cL=n;this.cM=t;this.cP=this.dJ=r;this.cQ=this.dy=u;this.dM=i;this.cI("GridDomCellProxy");this.cY=_Ewa.i.W();this.cO=n.c().c();this.dh=this.cO.isChangeGateEnabled("OfficeVSO:3556055_DirectionFixes1");this.dF=this.cO.a(712)};_Ewa.bJ.m=function(){return _Ewa.bJ.g||(_Ewa.bJ.g=_Ewa.cW.b({},["cv-wl","cv-wr","cv-wc","cv-wj","cv-wf"]))};_Ewa.bJ.j=function(){return _Ewa.bJ.d||(_Ewa.bJ.d=_Ewa.cW.b({},["cv-wl","cv-wr","cv-wc","cv-wj","cv-wf","cv-nwl","cv-nwr","cv-nwc","cv-nwj","cv-nwf"]))};_Ewa.bJ.b=function(){return _Ewa.bJ.a||(_Ewa.bJ.a=[],_Ewa.bJ.a[0]="",_Ewa.bJ.a[1]="left",_Ewa.bJ.a[2]="center",_Ewa.bJ.a[3]="right",_Ewa.bJ.a[5]="justify"),_Ewa.bJ.a};_Ewa.bJ.k=function(){return _Ewa.bJ.e||(_Ewa.bJ.e=_Ewa.cW.b({},["isl","isr","ishcs","ishcm","ishcl"]))};_Ewa.bJ.l=function(){return _Ewa.bJ.f||(_Ewa.bJ.f=new RegExp("[\r\n]","g"))};_Ewa.bJ.c=function(n){return parseInt(_Ewa.a.o(n,"data-spillOrigin","-1"))};_Ewa.bJ.n=function(n){return n.previousSibling&&_Ewa.bJ.c(n.previousSibling)!==-1?!0:!1};_Ewa.bJ.h=function(n){return n?2:2};_Ewa.bJ.i=function(n){var t=Error.create("GridDomCellProxy.AssertNotReached: unexpected logic reached. caller: "+n);_Ewa.ULSError.a(t,n,!1)};_Ewa.bJ.prototype={cO:null,cP:0,cQ:0,dJ:0,dy:0,cL:null,dM:null,cM:null,dt:null,dg:null,dp:!1,ec:!1,eb:!1,cY:null,cV:null,cZ:null,ed:0,dI:!1,dK:!1,dz:!1,dP:null,dd:null,di:!1,cW:null,dD:null,da:!1,de:!1,dL:!1,df:null,cX:null,ds:!1,dO:0,ea:!1,dq:null,dc:null,dh:!1,dC:null,dr:null,dA:null,dB:null,dG:null,dF:!1,d:function(){return this.cI("GridBlockModelProxy"),this.cL},ca:function(){return this.cI("IsUnlockedCell"),this.ec},bQ:function(){return this.cI("IsHiddenFormulaCell"),this.eb},bS:function(){this.cI("IsLegacyArrayFormulaCell");var n=this.cL.c().b().a(this.cL.a());return n.f(this.cP,this.cQ)},X:function(){return this.cI("NamedStyleId"),this.cR()?this.cR().X():-1},bk:function(){return this.cI("PaneType"),this.cL.G()},e:function(){var n,t,i,r;if(this.cI("OffsetWidth"),this.cU(),n=this.cQ,t=this.cM.d[n],this.dp)for(i=this.cM.b,r=i.length;++n<r&&i[n]<=this.dg.c;)t+=this.cM.d[n];return t},g:function(){var n,t,i,r;if(this.cI("OffsetHeight"),this.cU(),n=this.cP,t=this.cM.e[n],this.dp)for(i=this.cM.c,r=i.length;++n<r&&i[n]<=this.dg.d;)t+=this.cM.e[n];return t},q:function(){return this.cI("InitialRowHeight"),this.cM.e[this.dJ]},p:function(){return this.cI("InitialColumnWidth"),this.cM.d[this.dy]},E:function(){return this.cI("InitialColumnOffset"),this.cM.f()[this.dy]},G:function(){return this.cI("RowOffset"),this.cU(),this.cM.i()[this.cP]},z:function(){return this.cI("ColumnOffset"),this.cU(),this.cM.f()[this.cQ]},i:function(){return this.cI("InitialRowNumber"),this.cM.c[this.dJ]},h:function(){return this.cI("InitialColumnNumber"),this.cM.b[this.dy]},cf:function(){return this.cI("RichValueFields"),this.cL.L(this.cP,this.cQ)},o:function(){this.cI("RichValueType");var n=this.cR();return n?n.o():0},y:function(){this.cI("CellValueType");var n=this.cR();return n?n.y():0},s:function(){this.cI("CellValue");var n=this.cR();return n?n.s():null},ce:function(){this.cI("RichValueDomain");var n=this.cL.K(this.cP,this.cQ);switch(n){case 1:return _Ewa.ClientStringManager.a().a(744);case 2:return _Ewa.ClientStringManager.a().a(745);case 3:return _Ewa.ClientStringManager.a().a(746);default:return null}},c:function(){return this.cI("NumberFormatIndex"),this.cZ!=null||(this.cZ=this.cL.J(this.cP,this.cQ)),this.cZ},cB:function(n){return(this.cI("NumberFormatIndex.set"),this.cZ!=null&&this.cZ===n)?n:(this.cL.N(this.cP,this.cQ,n),this.cZ=n,n)},ba:function(){return this.cI("StampedCellNumberFormatIndex"),this.cR()?this.cR().ba():-1},bj:function(n){return this.cI("StampedCellNumberFormatIndex"),this.cR()&&this.cR().bj(n),n},B:function(){return this.cI("FormulaBarText"),this.dd||this.di||(this.dd=this.cL.I(this.cP,this.cQ),this.di=!0),this.dd},bh:function(n){if(this.cI("FormulaBarText.set"),this.I(!1),this.cS(),(n||this.di)&&this.dd===n)return n;var t=!n||!n.length?null:n;return this.cL.M(this.cP,this.cQ,t),this.dd=t,this.di=!0,n},F:function(){return this.cI("OriginalIfmt"),this.ed},bi:function(n){return this.cI("OriginalIfmt.set"),this.ed=n,n},eE:function(){return(this.cI("CellOuterHtml"),this.cJ())?Common.bC.b(this.cJ()):""},eJ:function(){this.cI("Overflow");this.I(!1);var n=this.cJ();return!n||!n.style?"":n.style.overflow},eX:function(n){this.cI("Overflow.set");this.I(!1);this.cS();var t=this.cJ();return t&&(t.style.overflow=n||"hidden"),n},x:function(){var n,t;return this.cI("BackgroundColor"),this.I(!1),n=this.cJ(),this.de&&(t=this.cJ().getElementsByClassName("ewr-spill-cell"),t.length>0&&(n=t[0])),!n||!n.style?"":n.style.backgroundColor},ct:function(n){var t,i;return this.cI("BackgroundColor.set"),this.I(!1),this.cS(),t=this.cJ(),this.de&&(i=this.cJ().getElementsByClassName("ewr-spill-cell"),t=i.length>0?i[0]:this.ez()),t&&(t.style.backgroundColor=n||"transparent"),n},L:function(){if(this.cI("Bold"),this.I(!1),!this.cN())return!1;var n=this.cN().fontWeight;return n?parseInt(n)>=700||_Ewa.e.b(""+n,"bold",!0)||_Ewa.e.b(""+n,"bolder",!0):!1},cu:function(n){return this.cI("Bold.set"),this.I(!1),this.db("fontWeight",n?"bold":"normal"),n},bI:function(){return this.cI("HasRichValueIcon"),!!this.dl("ewr-richvalueicon")},v:function(){return this.cI("HasRichText"),this.I(!1),!!this.cK()&&this.cK().getElementsByTagName("span").length>1},cl:function(){var n,i;this.cI("Wrapped");var r=this.dn(),u=_Ewa.bJ.m(),t=r.className.split(" ");for(n=0,i=t.length;n<i;++n)if(_Ewa.v.b(u,t[n],!1))return!0;return!1},br:function(){return this.cI("Color"),this.I(!1),this.cN()?this.cN().color:""},cv:function(n){return this.cI("Color.set"),this.I(!1),this.db("color",_Ewa.e.b(n,"#000000",!1)?"":n),n},bW:function(){return this.cI("IsSpillCell"),this.I(!1),this.de},bx:function(){return this.cI("HasAutoFilter"),this.I(!1),!!this.cm(null)},bC:function(){return this.cI("HasConditionalFormatting"),this.I(!1),!!_Ewa.a.e(this.cJ(),"cf",!1)},by:function(){return this.cI("HasBackgroundColor"),!_Ewa.e.a(this.x())||this.x()==="transparent"},bq:function(){return(this.cI("AutoFilterType"),this.I(!1),_Ewa.a.e(this.cJ(),"af-f",!1))?1:_Ewa.a.e(this.cJ(),"af-fsa",!1)?6:_Ewa.a.e(this.cJ(),"af-fsd",!1)?7:_Ewa.a.e(this.cJ(),"af-sd",!1)?3:_Ewa.a.e(this.cJ(),"af-sa",!1)?2:0},R:function(){return this.cI("HasFormula"),_Ewa.bK.c(this.B())},bH:function(){return this.cI("HasPhoneticInfo"),this.I(!1),!!_Ewa.a.o(this.cK(),"data-phoninfo",null)},l:function(){this.cI("OriginalHorizontalAlignment");var n=parseInt(_Ewa.a.o(this.dn(),"OriginalHorizontalAlignment",null));return isNaN(n)?0:n},C:function(){var t,n;return(this.cI("HorizontalAlignment"),t=this.l(),t)?t:(n=this.dj(),n==="left")?1:n==="right"?3:n==="center"?2:0},bZ:function(){return this.cI("IsTextRightAligned"),this.dj()==="right"||this.dh&&this.ej()&&this.Y()===2},bY:function(){return this.cI("IsTextLeftAligned"),this.dj()==="left"||this.dh&&this.ej()&&this.Y()===1},bX:function(){return this.cI("IsTextCenterAligned"),this.dj()==="center"},bE:function(){return this.cI("HasDatabar"),!!this.eM()},bB:function(){return this.cI("HasCommentNotch"),!!this.dl("ewa-cmnt-n")},bF:function(){return this.cI("HasIconSetImage"),!!this.dW()},cc:function(){this.cI("KpiIcon");var n=this.dW();return n?n.className:null},bO:function(){this.cI("IconName");var n=this.dW();return n?n.alt:""},cg:function(){return this.cI("ShrunkToFit"),this.dH("ShrinkToFit")},bN:function(){return this.cI("HorizontalFill"),this.dH("HorizontalFill")},bM:function(){return this.cI("HasValidHyperlink"),this.I(!1),!!this.T()&&!Sys.UI.DomElement.containsCssClass(this.T(),"ewr-invalid-hyperlink")},n:function(){return this.cI("HasHyperlink"),this.I(!1),!!this.T()},D:function(){return this.cI("HyperlinkUrl"),this.I(!1),this.T().innerText},u:function(){return this.cI("IsHyperlinkExternal"),this.I(!1),_Ewa.a.o(this.T(),"_link",null)!=="int"},bR:function(){return this.cI("IsHyperlinkFormula"),this.I(!1),!!this.T()&&!!this.T().getAttribute("_hf")},bK:function(){return this.cI("HasSparkline"),!!this.dl("sl")},bD:function(){return this.cI("HasContent"),!_Ewa.e.a(this.f())||!_Ewa.e.a(this.B())||this.bK()||this.bB()},ch:function(){this.cI("SparklineUrl");var n=this.dl("sl");return n?n.src:""},W:function(){return this.cI("Italic"),this.I(!1),this.cN()?this.cN().fontStyle==="italic":!1},cA:function(n){return this.cI("Italic.set"),this.db("fontStyle",n?"italic":"normal"),n},N:function(){this.cI("FontName");this.I(!1);try{return isNullOrUndefined(this.cN())?"":_Ewa.dq.c(this.cN())}catch(n){if(Common.c.a())return Diag.a.b(41764039,0,!1,"FormattedCell.get_FontName failed on IE: IsNullOrUndefined(AnchorCell):{0}, IsNullOrUndefined(this.TextElement):{1}, IsNullOrUndefined(this.TextCellStyle):{2}, error:{3}",isNullOrUndefined(this.cJ()),isNullOrUndefined(this.cK()),isNullOrUndefined(this.cN()),n.message),"";throw n;}},cx:function(n){return this.cI("FontName.set"),this.db("fontFamily",_Ewa.bR.d(n)),n},O:function(){return this.cI("FontSize"),this.dV()},cy:function(n){return this.cI("FontSize.set"),this.db("fontSize",n+"pt"),n},bw:function(){return(this.cI("FontSuperscript"),this.I(!1),!this.cK())?!1:this.cK().getElementsByTagName("sup").length>0?!0:!1},bv:function(){return(this.cI("FontSubscript"),this.I(!1),!this.cK())?!1:this.cK().getElementsByTagName("sub").length>0?!0:!1},P:function(){return(this.cI("FontStrikethrough"),this.I(!1),!this.cN()||!this.cN().textDecoration)?!1:this.cN().textDecoration.indexOf("line-through")>=0},cz:function(n){return this.cI("FontStrikethrough.set"),this.I(!1),n?this.ef("text-decoration","line-through"):this.eq("text-decoration","line-through"),n},w:function(){return this.cI("UnformattedCellText"),this.I(!1),this.bQ()?"":this.B()||this.f()},cd:function(){this.cI("OriginalText");this.I(!1);var n,t=this.f();return!this.ci()&&(n=_Ewa.a.o(this.cK(),"title",null))&&(t=n),t},ee:null,cE:function(n){return this.ee=n,n},bb:function(){return(this.cI("Underline"),this.I(!1),!this.cN()||!this.cN().textDecoration)?!1:this.cN().textDecoration.indexOf("underline")>=0},cD:function(n){return this.cI("Underline.set"),this.I(!1),n?(this.cw(!1),this.ef("text-decoration","underline")):this.eq("text-decoration","underline"),n},ci:function(){return this.cI("TooltipContainsErrorMessage"),this.I(!1),!!this.cK()&&Sys.UI.DomElement.containsCssClass(this.cK(),"tem")},cj:function(){return(this.cI("TooltipErrorMessage"),this.I(!1),this.ci())?_Ewa.a.o(this.cK(),"title",null):null},bz:function(){if(this.cI("HasBorders"),this.I(!1),!this.cJ()||!this.cJ().style)return!1;var n=this.cJ().style;return!_Ewa.e.a(n.border)||!_Ewa.e.a(n.borderLeft)||!_Ewa.e.a(n.borderRight)||!_Ewa.e.a(n.borderTop)||!_Ewa.e.a(n.borderBottom)},bG:function(){if(this.cI("HasLeftBorder"),this.I(!1),!this.cJ()||!this.cJ().style)return!1;var n=this.cJ().style;return!_Ewa.e.a(n.border)||!_Ewa.e.a(n.borderLeft)},bL:function(){if(this.cI("HasTopBorder"),this.I(!1),!this.cJ()||!this.cJ().style)return!1;var n=this.cJ().style;return!_Ewa.e.a(n.border)||!_Ewa.e.a(n.borderTop)},bJ:function(){if(this.cI("HasRightBorder"),this.I(!1),!this.cJ()||!this.cJ().style)return!1;var n=this.cJ().style;return!_Ewa.e.a(n.border)||!_Ewa.e.a(n.borderRight)},bA:function(){if(this.cI("HasBottomBorder"),this.I(!1),!this.cJ()||!this.cJ().style)return!1;var n=this.cJ().style;return!_Ewa.e.a(n.border)||!_Ewa.e.a(n.borderBottom)},dT:function(){return(this.dC!=null)?this.dC:0},dS:function(){return(this.dr!=null)?this.dr:0},du:function(){return(this.dA!=null)?this.dA:0},ek:function(){return(this.dB!=null)?this.dB:0},f:function(){var t,n,r,i,u;return this.cI("Text"),this.I(!1),t=this.dD||this.cK(),n=t?t.innerText:"",this.cb()?n=n.replace(_Ewa.bJ.l(),""):t&&this.cl()&&(r=t.innerHTML.replace("<BR>","<br>"),_Ewa.e.c(r,"<br>",!0)&&!_Ewa.e.k(n,"\n")&&(i=document.createElement("div"),u=r.split("<br>"),i.innerHTML=u.join("\n"),n=i.innerText,i=null)),_Ewa.e.i(n,"\u00a0"," ",!1,!0,!1)},cC:function(n){var u,t,f,r,i;this.cI("Text.set");this.I(!1);this.dE();this.cO.a(767)&&(n=this.eC(n));u=this.bu()&&!!this.cK().firstChild&&!isNullOrUndefined(this.cK().firstChild.tagName);t=u?this.cK().firstChild:this.cK();try{if(t.innerText="",!(!n||!n.length))for(n=_Ewa.jE.a(n),f=new RegExp("\r?\n"),r=n.split(f),i=0;i<r.length;++i)t.appendChild(document.createTextNode(r[i])),i<r.length-1&&t.appendChild(document.createElement("br"))}catch(e){Diag.a.a(41764040,0,10,"FormattedCell.set_Text failed: TextElement.class[{0}]",t?t.className:"null");throw e;}return n},t:function(){if(this.cI("FormattedText"),this.cR())return this.cR().t();if(!this.cO.c().v())return null;var n=new _Ewa.dJ;return n.Text=this.f(),n},bg:function(n){return n},bu:function(){return this.cI("DoubleUnderline"),Sys.UI.DomElement.containsCssClass(this.dn(),"ewr-du")},cw:function(n){if(this.cI("DoubleUnderline.set"),this.I(!1),!n&&this.cK()){var t=_Ewa.a.e(this.cK(),"ewa-du",!1);t&&t.firstChild&&t!==this.cK()&&t.parentNode.replaceChild(t.firstChild,t);Sys.UI.DomElement.removeCssClass(this.cK(),"ewr-du")}return n},ck:function(){this.cI("VerticalAlignment");this.I(!1);var n=this.dn();return isNullOrUndefined(n)||isNullOrUndefined(n.parentNode)?2:Sys.UI.DomElement.containsCssClass(n.parentNode,"ewr-vam")?1:Sys.UI.DomElement.containsCssClass(n.parentNode,"ewr-vaj")?3:Sys.UI.DomElement.containsCssClass(n.parentNode,"ewr-vad")?4:Sys.UI.DomElement.containsCssClass(n,"ewr-vat")?0:2},cF:function(n){var i,t;return this.cI("VerticalAlignment.set"),this.I(!1),this.cK()&&(Sys.UI.DomElement.removeCssClass(this.cK(),"ewr-vab"),Sys.UI.DomElement.removeCssClass(this.cK(),"ewr-vat"),this.cK().style.position="",this.da&&(i=this.cK().parentNode,i.removeChild(this.cK()),i.parentNode.replaceChild(this.cK(),i)),n?n===2&&Sys.UI.DomElement.addCssClass(this.cK(),"ewr-vab"):Sys.UI.DomElement.addCssClass(this.cK(),"ewr-vat"),(this.da=n===1)&&(t=this.cK().parentNode,this.dc=t.removeChild(this.cK()),t=t.appendChild(document.createElement("div")),t.className="ewr-vam",this.dc=t.appendChild(this.cK()),this.cK().style.position="relative")),n},bT:function(){return this.cI("IsPivotCellCollapsed"),!!this.be("di-cl")},bU:function(){return this.cI("IsPivotCellExpanded"),!!this.be("di-ex")},S:function(){return this.cI("HasPivotCellDrillIndicator"),!!this.bd("di-ex")||!!this.bd("di-cl")},Q:function(){return this.cI("HasExpandCollapseMenu"),!!this.be("pc-exclmenu")},bV:function(){return this.cI("IsSpillBlocker"),this.bD()||this.k()},j:function(){this.cI("InViewport");var n=this.cL.c().b().a(this.cL.a());return n.r>0},eH:function(){return this.cI("IsPreviousCellSpilled"),this.I(!1),this.dL},bt:function(){return this.cI("DoesCellExists"),!!this.dU(!1)},H:function(){this.cI("TextWithoutLineBreaks");var n=this.dU(!1);return n?n.innerText:null},cb:function(){return this.cI("IsVerticalText"),this.dH("VerticalText")||this.dH("VerticalWrapText")},Y:function(){return(this.cI("ReadingOrder"),!this.cN())?0:this.cN().direction==="ltr"?1:2},V:function(){return this.cI("IsRichErrorCell"),this.o()===5},T:function(){if(this.cI("Hyperlink"),this.I(!1),!this.cX&&!this.ds){var n=this.cK()?this.cJ().getElementsByTagName("a"):null;if(n&&n.length===1){this.cX=n[0];try{this.cX.href||(this.cX.href=null)}catch(t){this.cX=null}}this.ds=!0}return this.cX},A:function(){return _Ewa.a.e(this.cJ(),"ewa-cmnt-n",!1)},Z:function(){this.cI("RowOutline");var n=this.cR();return!this.dF||!n?0:n.Z()},M:function(){this.cI("ColumnOutline");var n=this.cR();return!this.dF||!n?0:n.M()},ej:function(){return!this.dj()||!this.dj().length},cN:function(){if(this.I(!1),!this.df){var n=this.dn();this.df=n?n.currentStyle:null}return this.df},dj:function(){if(this.I(!1),this.bW())if(this.dh){var n=_Ewa.bR.c(this.l());if(!isNullOrUndefined(n))return n;Diag.a.b(41764042,0,!1,"OriginalHorizontalAlignment = {0}",this.l())}else{if(!isNullOrUndefined(_Ewa.bJ.b()[this.l()]))return _Ewa.bJ.b()[this.l()];Diag.a.b(50872972,0,!isNullOrUndefined(_Ewa.bJ.b()[this.l()]),"OriginalHorizontalAlignment = {0}",this.l())}return Diag.a.b(41764043,0,!!this.cN(),"TextCellStyle shouldn't be null"),this.cN()?this.cN().textAlign:""},dv:function(){return this.cL.c().dy()},cR:function(){return!this.dG&&this.cL.c().c().c().v()&&this.dM.a(this.cL.e(),_Ewa.p.c(this.cO))&&(this.dG=this.cL.c().b().bn(this.cL.a(),this.cP,this.cQ)),this.dG},cJ:function(){return this.cI("AnchorCell"),this.dq},cK:function(){return this.cI("TextElement"),this.dc},bs:function(){return(this.cI("CssFont"),this.cK())?this.cK().currentStyle.font:""},a:function(){return this.cI("GetRange"),this.cU(),this.dg.f()},b:function(){return this.cI("GetFullRange"),this.cU(),this.dt.f()},dw:function(n){if(this.cY)return this.cY;if(!n&&null===this.cY)return null;var t=this.el(n,this.cL.H());return t&&(this.cY=t),t},cG:function(n,t){this.cI("SetCell");this.cJ()&&!this.bD()&&this.eG()&&_Ewa.a.k(this.cJ(),"");t||(t=this.dw(!1));this.et(n,t);this.cL.t(this.cP,this.cQ,n);this.er()},cs:function(n){this.cI("RemoveCell");this.I(!1);this.cJ()&&(this.cJ().parentNode.removeChild(this.cJ()),this.dq=null);this.cY=null;this.dQ();this.dR();this.et(n,this.dw(!1));this.er()},bm:function(){this.cI("ClearContents");this.I(!1);this.eh();this.cJ()&&(_Ewa.a.k(this.cJ(),""),this.dc=null)},bp:function(n){if(this.cI("CloneCellStyle"),this.I(!1),n){this.cS();var t=n.i(),i=!!n.a().l();this.J(t,i,!1,!1);this.cF(n.g());this.ct(n.j());this.cu(n.o());this.cD(n.u());this.cw(n.x());this.cz(n.y());this.cv(n.k());this.cx(n.s());this.cy(n.p());this.cA(n.t())}},bo:function(n){var t,i;this.cI("CloneCellBorders");this.I(!1);n&&n.a().cJ()&&(t=n.a().cJ(),this.cJ()||this.cS(),(n.bG()||t.style.backgroundColor)&&(i=-1,_Ewa.dq.a(this.cJ().style,this.cL.c().d(),parseInt(this.cJ().style[this.dv()])+i+"px")),this.cJ().style.borderLeft=t.style.borderLeft,this.cJ().style.borderRight=t.style.borderRight,this.cJ().style.padding=t.style.padding,this.cJ().style.paddingRight=t.style.paddingRight,this.cJ().style.paddingLeft=t.style.paddingLeft,this.cJ().style.top=t.style.top,this.cJ().style.borderTop=t.style.borderTop,this.cJ().style.overflow=t.style.overflow)},bn:function(){this.cI("ClearFormat");this.cu(!1);this.cA(!1);this.cD(!1);this.cw(!1);this.cv("");this.ct("transparent");this.df=null},J:function(n,t,i,r){this.cI("SetHorizontalAlignment");this.I(!1);var u;u=!t;n&&this.db("textAlign",this.dh?_Ewa.bR.c(n):_Ewa.bJ.b()[n]);!i&&this.cK()&&(u||r?this.cK().removeAttribute("OriginalHorizontalAlignment"):this.cK().setAttribute("OriginalHorizontalAlignment",n))},dQ:function(){this.cI("CleanCachedStyle");this.cV=null},dR:function(){this.cI("CleanCachedValues");this.cZ=null;this.dd=null;this.di=!1},K:function(n,t,i){var r=this.eN();n?this.eR(r)?this.fc(r):this.ey(r,i)&&this.fb(t,r):this.eW(r)},fe:function(){this.cJ()||this.cS();this.bL()&&this.ew(this.dx(this.cJ().style.borderTopWidth));this.bG()&&this.eu(this.dx(this.cJ().style.borderLeftWidth));this.bJ()&&this.ev(this.dx(this.cJ().style.borderRightWidth))},m:function(n,t,i){if(n)switch(i){case 0:this.ew(_Ewa.gM.b(t,i));break;case 1:this.ff(_Ewa.gM.b(t,i));break;case 2:this.eu(_Ewa.gM.b(t,i));break;case 3:this.ev(_Ewa.gM.b(t,i))}},r:function(n,t,i){Diag.a.b(51468231,0,!!n,"GridDomCellProxy.SetBorders: borderFormat is null");this.cI("SetBorders");this.I(!1);this.cJ()||this.cS();this.eD();(t&2)==2&&(this.cJ().style.borderTop=this.dk(n,0,i));(t&1)==1&&(this.cJ().style.borderBottom=this.dk(n,0,!i));(t&4)==4&&(this.cO.K()?this.cJ().style.borderRight=this.dk(n,2,i):this.cJ().style.borderLeft=this.dk(n,2,i));(t&8)==8&&(this.cO.K()?this.cJ().style.borderLeft=this.dk(n,2,!i):this.cJ().style.borderRight=this.dk(n,2,!i))},cr:function(){this.cI("RemoveBorderByPosition");_Ewa.bJ.i("RemoveBorderByPosition");return},bf:function(n){var t,f,i,e,r,o,u;this.cI("RemoveBorders");this.I(!1);this.cJ()||this.cS();t=0;this.cJ().style.top="0px";this.cJ().style.height=this.g()-1+"px";this.bG()?(t=this.du()-Math.floor(Math.max(0,this.du()-1)/2),this.dN(t)):this.bL()&&(t=1,this.dN(t));this.cJ().style.borderTop="unset";this.cJ().style.borderBottom="unset";this.cJ().style.borderLeft="unset";this.cJ().style.borderRight="unset";this.cJ().style.paddingTop="unset";this.cJ().style.paddingBottom="unset";this.cJ().style.paddingLeft="unset";this.cJ().style.paddingRight="unset";n.d===this.dt.d&&(f=this.cT(!1,!0),f&&(i=f.a(),i.cJ()||i.cS(),i.cJ().style.borderTop="unset"));n.c===this.dt.c&&(this.cO.K()?(o=this.cT(!0,!0),o&&(u=o.a(),u.cJ()||u.cS(),u.cJ().style.borderRight="unset")):(e=this.cT(!0,!0),e&&(r=e.a(),r.cJ()||r.cS(),r.cJ().style.borderLeft="unset")))},cT:function(n,t){var i=this.dm(n,t),r;try{return r=i.$$cu(),i.$$mn(),i.$$cu()}finally{i&&i.dispose()}},eN:function(){switch(this.cK().style.textAlign){case"left":return!1;case"right":return!0;default:return this.cL.c().l().H()}},eR:function(n){var t=this.C()===2;return t&&this.ep(n)},fc:function(n){this.cK()&&this.cK().style&&(this.cK().style.textAlign=null,this.cK().style.display="inline-block",this.cK().style.overflow="visible",this.cK().style.width=null,this.cK().style.left=n?null:"0",this.cK().style.right=n?"0":null,n&&_Ewa.dq.b(this.cK().style,!n))},fb:function(n,t){var i,r,u,f;if(this.cI("SetSpillTextAttributes"),this.I(!1),n<0){Diag.a.a(41764051,0,50,"FormattedCell.SetSpillTextAttributes: Invalid width received");return}i=this.eO(n,t,this.cO.K());this.fa(t,this.cO.K(),i);_Ewa.a.v(this.cK(),i-_Ewa.bJ.h(t));r=this.fd();_Ewa.a.v(this.cJ(),r?i:i-1);this.bW()||(u=this.a(!1).b-1,this.cJ().style.height=this.q().toString()+"px",this.cJ().setAttribute("data-spillOrigin",u),this.cK().className=this.cK().className+" ewr-spill-text",f=this.l()===1||!this.l()||this.l()===3,(this.dZ()||this.by())&&f&&(this.eA(),this.eY()),r||(this.cJ().style.backgroundColor="White",this.cJ().style.height="inherit",this.cJ().style.paddingBottom=null,this.cJ().style.paddingTop=null,this.cJ().style.top=null),this.l()===3&&(this.cK().style.direction="rtl",this.cK().style.overflow="visible"))},eW:function(n){var f,i,e,t,r,o,u;(this.cI("RemoveSpillTextAttributes"),this.I(!1),isNullOrUndefined(this.cJ()))||(f=this.l()===1||!this.l(),this.cJ().style.backgroundColor=null,i=this.cJ().firstChild,i&&i.className==="ewr-cc"&&f&&!n&&(e=this.cK(),t=this.dl("ewr-spill-cell"),Diag.a.b(41764052,0,!isNullOrUndefined(t),"FormattedCell.RemoveSpillTextAttributes: spillDiv shouldn't be null"),isNullOrUndefined(t)||(r=this.by()||this.dZ(),this.cJ().style.borderTop=t.style.borderTop,this.cJ().style.borderLeft=t.style.borderLeft,this.cJ().style.backgroundColor=t.style.backgroundColor,this.cJ().style.top="-1px",_Ewa.a.g(t),_Ewa.a.I(this.cJ()),this.cJ().appendChild(r?i:e),o="1px",this.es(r?o:null))),this.cJ().removeAttribute("data-spillOrigin"),this.cJ().style.height=null,this.cK()&&(this.cK().className=this.cK().className.replace("ewr-spill-text",""),this.cK().className=this.cK().className.trim()),u=this.e()-1,this.cJ().style.width=u+"px",this.eV(n,this.cO.K()),this.cK()&&(_Ewa.a.v(this.cK(),u-_Ewa.bJ.h(n)),this.l()===3&&(this.cK().style.direction=null,this.cK().style.overflow=null)))},ey:function(n,t){this.cI("CanSpill");this.I(!1);var i=this.f(),r=_Ewa.bK.b(i),u=this.cL.c().g().q(this.a(!1));return!(this.k()||this.cl()||_Ewa.e.h(i)||this.cg()||this.bN()||r||this.l()===2||this.ep(n)||this.cq(t)||u)},cq:function(n){if(this.cI("IsBooleanValue"),this.I(!1),!n)return!1;var t=this.f().toUpperCase();return Array.contains(n,t)?!0:!1},cH:function(n,t,i){var e=!1,r,o,u,f,s;return n.Result.ActiveSheetID!==i?e:(this.cI("UpdateSetCellImmediateContent"),o=1,u=n.Result,r=u.Html,this.cO.a(146)&&(o=u.Decision),f=!0,s=_Ewa.gg.b(u.FormulaValue),f=this.B()===s,f||this.bh(s),!r||!r.length?Diag.a.a(41764053,1,15,"Invalid SetCell response, skipped cell immediate update. Client stopwatch id = {0}",n.clientStopwatchId):e=this.eU(r,"SetCell",n.clientStopwatchId,o,f,t),e)},ep:function(n){if(this.cI("IsBlockedCell"),this.I(!1),this.l()===2)return this.eQ();var t=this.dm(!0,n===this.cO.K());try{return t.$$mn(),!!t.$$cu()&&t.$$cu().D()}finally{t&&t.dispose()}},U:function(){return this.cI("IsDynamicArrayNonAnchor"),this.cU(),this.dK},bP:function(){return this.cI("IsDynamicArrayAnchor"),this.cU(),this.dz},co:function(){return this.cI("GetSpillingDynamicArrayRange"),this.cU(),this.dP},bl:function(n,t){this.cI("NotifyRecalc");this.cL.u(this.cP,this.cQ,n,t)},k:function(){return this.cI("IsMerged"),this.cU(),this.dp},I:function(n){var t,i,r,u,f;(this.cI("Init"),n||!this.ea)&&(this.df=null,this.dD=null,this.cX=null,this.cW=null,this.dc=null,this.ds=!1,this.de=!1,this.dL=!1,this.dq=this.dw(!1),this.cJ()&&(this.eg(),t=this.cJ().lastChild,!t||Sys.UI.DomElement.containsCssClass(t,"af-img")||Sys.UI.DomElement.containsCssClass(t,"sl")||(i=null,t=(f=this.dY(t,r={val:this.cW},u={val:i}),this.cW=r.val,i=u.val,f),this.da=!!i,t&&(this.dc=t,(t=t.firstChild)&&t.nodeType===1&&(t=_Ewa.a.e(this.cK(),"di-table",!1),t&&(this.dD=t.rows[0].lastChild))))),this.ea=!0)},cp:function(n,t,i){this.cI("InsertHyperlink");this.I(!1);var r=String.format('<a target="_blank" href="{0}" style="{1}" {2}="{3}">{4}<\/a>',Common.e.f(t),Common.e.f(i),"_link","ext",Common.e.b(n));this.eh();this.cK().innerHTML=r},cS:function(){return this.cI("EnsureAnchorCell"),this.I(!1),this.cJ()||(this.dq=this.dw(!0),this.eg()),this.cJ()},dE:function(){var f,n,t,i,r,e,u,o,s,h,c,l,a;this.cI("EnsureTextCell");this.I(!1);this.cK()||(this.cS(),f=this.dX(),n=f.cloneNode(!0),this.dc=this.eo(n),this.dI&&(t=-1,i=-1,this.q()===this.cM.h||_Ewa.e.a(this.cK().style.maxHeight)||(r=_Ewa.a.bu(this.cK()),r>=0&&(e=this.q()-this.cM.h,t=r+e),Diag.a.a(41764055,0,50,"Initial row height is different than default: initial {0}, default: {1}, current max-height {2}",this.q(),this.cM.h,r)),this.p()===this.cM.j||_Ewa.e.a(this.cK().style.width)||(u=_Ewa.a.B(this.cK()),u>=0&&(o=this.p()-this.cM.j,i=u+o)),t>0&&_Ewa.a.bw(this.cK(),t),i>0&&_Ewa.a.v(this.cK(),i)),this.cW?(this.cW.parentNode.replaceChild(n,this.cW),s=this.cJ().lastChild,a=this.dY(s,c={val:this.cW},l={val:h}),this.cW=c.val,h=l.val,a):this.cJ().appendChild(n))},dX:function(){var n,t,i;return(this.cI("GetStyleMapElement"),this.cV)?this.cV:(n=this.cP,this.cV=this.cL.m(),this.dI=!0,this.cL.c().b().g()&&this.cV)?this.cV:(t=this.cM.p[n],t&&(i=_Ewa.i.n(t,this.cM.r[n],this.cQ,_Ewa.i.B),i>=0))?this.cL.h()?(this.dI=!1,this.cV=this.cL.h().childNodes[this.cM.q[n][i]]):(Diag.a.a(41764056,0,15,"GridDomCellProxy.GetStyleMapElement: StylesContainer is null for non-default style"),this.cV):!this.cL.h()||!this.cL.h().hasChildNodes()?(Diag.a.a(41764057,0,15,"GridDomCellProxy.GetStyleMapElement: {0} for default style",this.cL.h()?"StylesContainer doesn't have child nodes":"StylesContainer is null"),this.cV):this.cV=this.cL.h().childNodes[this.cL.h().childNodes.length-1]},bc:function(){return(this.cI("GetCellFont"),this.cR())?this.cR().bc():(!this.cO.c().v(),null)},dW:function(){var t,r,i,n;if(this.I(!1),!this.cK()||!(t=(this.da?this.cK().parentNode:this.cK()).previousSibling))return null;for(r=_Ewa.bJ.k(),i=t.className.split(" "),n=0;n<i.length;n++)if(_Ewa.v.b(r,i[n],!1))return t.firstChild;return null},dH:function(n){return this.I(!1),!!this.cK()&&!!this.cK().getAttribute(n)},ez:function(){var n=this.ei();return this.cJ().insertBefore(n,this.cJ().firstChild),n},cI:function(n){if(this.dM.b()){var t=Error.create("VerifyRenderingInHtml: rendering in canvas, caller: "+n);_Ewa.ULSError.a(t,n,!1)}},dU:function(n){var t=this.cL.c().b().a(this.cL.a()),i;return!t||!t.F?null:(i=$get("gridRows",t.F),!i)?null:this.el(n,i)},be:function(n){return this.cI("GetDrillRootCell"),this.I(!1),_Ewa.a.e(this.cJ(),n,!0)},bd:function(n){return this.cI("GetDrillIndicatorElement"),_Ewa.a.e(this.be(n),"di-img",!1)},cn:function(){return this.cI("GetSingleClickSortArrow"),_Ewa.a.e(this.cJ(),"ewa-nov2-scs-arrow",!1)},ef:function(n,t){if(this.cK()){var i=this.cK().style[n];this.db(n,i==="none"?t:i+" "+t)}},eq:function(n,t){var i,r;if(this.cK()&&this.cK().style)if(i=this.cK().style[n],i&&i!=="none")r=i.replace(t,""),this.db(n,_Ewa.e.d(r)?"none":r);else return},eh:function(){this.cX=null;this.ds=!1;this.df=null},en:function(){var n=0;return n|=this.bG()?4:0,n|=this.bJ()?8:0,n|=this.bA()?1:0,n|(this.bL()?2:0)},eK:function(){var n=this.en(),t,i,r;return n&1||(t=this.cT(!1,!0),n|=t&&t.T()?1:0),n&4||(i=this.cT(!0,!1),n|=i&&i.bJ()?8:0),n&2||(r=this.cT(!1,!1),n|=r&&r.bH()?2:0),n},dm:function(n,t){var i=this.a(!1),r;return i.b=n?1:this.a(!1).b,i.c=n?this.a(!1).r:this.a(!1).c,i.a=n?this.a(!1).a:1,i.d=n?this.a(!1).d:this.a(!1).s,r=new _Ewa.dB("GridDomCellProxy.GetCellEnumerator",this.cL.c(),i,2,t),r.b(this.a(!1),!0),r},eU:function(n,t,i,r,u){var a=!1,f=this.cL.c().dt(),c,l;f.innerHTML=n;f=f.firstChild;var s=this.dw(!0),v=!1,y=Common.bC.b(s),p=s.innerText,w=Common.bC.b(f),b=f.innerText,e=!0,o=_Ewa.e.b(y,w,!1),h=this.eS();return _Ewa.e.b(p,b,!1)&&(h?(e=r===1,e&&o&&(Diag.a.a(41764059,0,50,"GridDomCellProxy.PutHtml: Server-side html comparison was wrong, continuing with the client result (which is - don't update the DOM)"),e=!o,h=!1)):e=!o),e?(s.parentNode.replaceChild(f,s),this.cY=f,this.dQ(),this.dR(),this.cG(!1,null),v=!0,(e||!o)&&(c=this.cL.c().b().a(this.cL.a()),c.H=c.H&-2),a=!0):o||(this.cG(!1,f),(e||!o)&&(l=this.cL.c().b().a(this.cL.a()),l.H=l.H&-2)),this.eT(t,i,s,f,v,h,u,o,_Ewa.bK.b(this.B()),r),a},eO:function(n,t,i){var f=0,r,u;this.dO=0;r=this.dm(!0,i===t);try{u=r.$$cu();do this.dO++,f+=u.v(),r.$$mn(),u=r.$$cu();while(f<n&&u&&!u.D())}finally{r&&r.dispose()}return f--,f},eV:function(n,t){var i=this.z().toString()+"px";!t&&n?this.cJ().style.left=i:t&&!n&&(this.cJ().style.right=i)},fa:function(n,t,i){var r=(this.z()-(i-this.e())).toString()+"px";!t&&n?(this.cK().style.direction="rtl",this.cJ().style.left=r):t&&!n&&(this.cK().style.direction="ltr",this.cJ().style.right=r)},eQ:function(){var t=this.dm(!0,!1),n;try{n=this.dm(!0,!0);try{return t.$$mn(),n.$$mn(),!!t.$$cu()&&!!n.$$cu()&&t.$$cu().D()&&n.$$cu().D()}finally{n&&n.dispose()}}finally{t&&t.dispose()}},fd:function(){var t,n,i,r;if(this.dZ())return!0;t=!1;n=this.dm(!0,!0);try{for(i=n.$$cu(),r=1;r<this.dO&&!t;r++)n.$$mn(),i=n.$$cu(),t=t||i.T()||i.Z()}finally{n&&n.dispose()}return t},es:function(n){var i=this.en(),r=this.eK(),t=_Ewa.rl.a(i,r,this.by());t&4&&(this.cJ().style.paddingLeft=n);t&8&&(this.cJ().style.paddingRight=n);t&2&&(this.cJ().style.paddingTop=n);t&1&&(this.cJ().style.paddingBottom=n)},eY:function(){this.es("1px");this.cJ().style.borderTop=null;this.cJ().style.borderLeft=null;this.cJ().style.backgroundColor=null},dZ:function(){return this.bG()||this.bL()},eA:function(){var i=this.ei(),n=this.cJ().firstChild,t;return n.className!=="ewr-cc"?(t=document.createElement("div"),t.className="ewr-cc",this.cJ().insertBefore(i,n),_Ewa.a.bf(t,this.cJ()),this.cJ().appendChild(t)):n.firstChild&&n.insertBefore(i,n.firstChild),i},ei:function(){var n=document.createElement("div"),i,t;return n.className="ewr-spill-cell",n.style.height=this.q().toString()+"px",i=this.bG()?this.p()-1:this.p(),n.style.width=i.toString()+"px",n.style.paddingLeft="0px",n.style.paddingRight="0px",n.style.paddingTop="0px",n.style.top=this.bL()?"0px":"-1px",n.style.backgroundColor=this.x(),this.bL()||_Ewa.a.bo(n,_Ewa.a.V(n)+1),t=this.z()-_Ewa.i.r(this.cJ().style,this.dv()),this.dv()==="left"?n.style.left=t.toString()+"px":n.style.right=t.toString()+"px",n.style.borderTop=this.cJ().style.borderTop,n.style.borderLeft=this.cJ().style.borderLeft,n},eg:function(){this.cJ()&&(this.de=_Ewa.bJ.c(this.cJ())!==-1,this.dL=_Ewa.bJ.n(this.cJ()))},dn:function(){return this.I(!1),this.cK()||this.eo(null)},eo:function(n){var i,r,t,u,f,e;return n||(n=this.dX()),i=(e=this.dY(n,u={val:r},f={val:t}),r=u.val,t=f.val,e),this.da=!!t,i},db:function(n,t){var i,r;(this.I(!1),this.cK())&&(i=this.cO.a(176)&&this.bI(),i&&n==="fontSize"||(this.cK().style[n]=t),n==="textAlign"&&this.ex(t),i&&(n==="color"||n==="fontSize")&&(r=this.dl("ewr-richvalueicon"),this.eZ(n,t,r)))},dl:function(n){this.I(!1);var t=this.de?this.cJ().parentNode:this.cJ();return _Ewa.a.e(t,n,!1)},ex:function(n){for(var r,f=_Ewa.bJ.j(),u=this.cK().className.split(" "),t=[],i=0,e=u.length;i<e;++i)_Ewa.v.b(f,u[i],!1)||Array.add(t,u[i]);r=this.cl()||this.eF();switch(n){case"left":Array.add(t,r?"cv-wl":"cv-nwl");break;case"center":Array.add(t,r?"cv-wc":"cv-nwc");break;case"right":Array.add(t,r?"cv-wr":"cv-nwr")}this.cK().className=t.join(" ")},eF:function(){var n=this.cK();return!!n&&!!n.innerHTML&&n.innerHTML.indexOf("<br>")>-1},eZ:function(n,t,i){var o;if(n==="color")i.style.color=t;else if(n==="fontSize"){var f=this.dV(),h=parseInt(i.style.width),c=parseInt(i.style.height);this.cK().style.fontSize=t;i.style.fontSize=t;var e=this.dV(),r=Math.round(h*e/f),u=Math.round(c*e/f);if(i.style.width=r.toString()+"px",i.style.height=u.toString()+"px",o=i.firstChild.tagName==="svg",o){var s=i.firstChild,l=r-1,a=u-1;s.setAttribute("width",l.toString()+"px");s.setAttribute("height",a.toString()+"px")}this.cK().style.paddingLeft=r.toString()+"px";this.da&&Sys.UI.DomElement.containsCssClass(this.cK().parentNode,"ewr-vam")&&(i.style.marginTop=(-u/2).toString()+"px");this.cK().style.paddingLeft=r.toString()+"px";this.da&&Sys.UI.DomElement.containsCssClass(this.cK().parentNode,"ewr-vam")&&(i.style.marginTop=(-u/2).toString()+"px")}},dV:function(){var t=0,n;return n=this.eL(),n.indexOf("px")>=0?t=Math.round(parseFloat(n)*.75*2)/2:n.indexOf("pt")>=0&&(t=parseFloat(n)),t},eL:function(){this.I(!1);var t=this.eI(),n,i=!!this.cK()&&!_Ewa.e.a(this.cK().style.fontSize),r=i?this.cK().style.fontSize:null,u=this.cN()?this.cN().fontSize:null;return n=t||r||u,n||(Diag.a.a(41764064,0,50,"FormattedCell.GetFontSize: font size is null"),n="11pt"),n},eI:function(){return _Ewa.a.o(this.dn(),"OrigFontSize",null)},cm:function(){return this.cI("GetAutoFilterInteractivityElement"),_Ewa.a.e(this.cJ(),"af-img",!1)},eM:function(){return this.I(!1),_Ewa.a.e(this.cJ(),"db",!1)},dY:function(n,t,i){t.val=null;i.val=null;var r=n;return r&&r.className==="ewr-cc"&&(t.val=r,r=r.lastChild),r&&this.eB(r)&&(i.val=r,r=r.lastChild),r},eB:function(n){return Sys.UI.DomElement.containsCssClass(n,"ewr-vam")||Sys.UI.DomElement.containsCssClass(n,"ewr-vaj")||Sys.UI.DomElement.containsCssClass(n,"ewr-vad")},er:function(){this.cL.c().b().bu(this.cL.a())},eS:function(){return this.cO.a(146)},eT:function(n,t,i,r,u,f,e,o,s,h){var c={},a,v,w,b,k;c.a=t;c.b=n;c.q=s;c.u=_Ewa.zX.toString(h);c.d=u;c.e=o;c.f=f;var y=i.innerText,l=r.innerText,p=_Ewa.e.o(_Ewa.e.p(y.trim(),"\ua0c2"),"\ua0c2");c.g=_Ewa.e.h(p);c.h=_Ewa.e.D(p);c.i=_Ewa.e.q(l);c.j=_Ewa.e.k(l,"%");c.k=_Ewa.bK.b(p);c.p=e;a=_Ewa.a.bj(r);v=_Ewa.a.bj(i);isNullOrUndefined(a)||isNullOrUndefined(a.currentStyle)||isNullOrUndefined(v)||isNullOrUndefined(v.currentStyle)||(w=_Ewa.N.a(a.currentStyle.color,i.style.backgroundColor).d(),b=_Ewa.N.a(v.currentStyle.color,i.style.backgroundColor).d(),c.n=_Ewa.e.b(a.style.textAlign,v.style.textAlign,!1),c.o=!!a.currentStyle&&!!v.currentStyle&&w===b);u&&(k=_Ewa.e.o(_Ewa.e.p(l.trim(),"\ua0c2"),"\ua0c2"),c.l=!_Ewa.e.b(y,l,!1)&&_Ewa.e.b(p,k,!1));c.r=s?_Ewa.e.j(this.B()):null;c.s=_Ewa.e.j(y);c.m=_Ewa.e.j(l);c.t=y===l;_Ewa.z.a().a(8,c,!0)},el:function(n,t){var e,c,u,r;if(this.cU(),!t)return null;if(e=t.childNodes[this.cP],!e)return c="",this.cL.c()&&(u=this.cL.c().j(),u&&(c=String.format("InFreezePanesMode = {0}, FirstFrozenColumn = {1}, FirstFrozenRow = {2}",u.e(),u.f,u.g))),Diag.a.a(41764067,1,10,"GetElementInRowsContainer: rowsContainer.ChildNodes[{0}] returned null. rowsContainer.ChildNodes.Length = {1} , create = {2}, freezePanesInfo : [{3}]",this.cP,t.childNodes.length,n,c),null;var l=this.dv(),v="borderLeftWidth",y="paddingLeft";l!=="left"&&(v="borderRightWidth",y="paddingRight");for(var f=this.cM.f()[this.cQ],a=this.e()-1,o=!1,i=e.firstChild;i;i=i.nextSibling){if(_Ewa.a.J(i,"ewr-spill-text-background")){o=!0;continue}var p=i.style,s=_Ewa.i.r(p,l,v,y),h=_Ewa.bJ.c(i);if(h!==-1){if(this.dg.b===h+1)return i;o=!1}if(f+a<=s&&!o)break;if(s<0&&!f&&h===-1||f<=s&&h===-1&&(!o||a>=s-f))return i}return r=null,n&&((r=document.createElement("div")).className="ewr-ca",r.style[l]=f+"px",r.style.width=a+"px",e.insertBefore(r,i)),r},et:function(n,t){var u=this.cL.c().b().a(this.cL.a()),r,i,f;if(u.F){if(r=u.n,!r){Diag.a.a(41764098,0,10,"GridDomCellProxy.UpdateCellInBlockCacheItem: gridBlockContentResponse is null");return}if(!r.Content){Diag.a.a(41764099,0,10,"GridDomCellProxy.UpdateCellInBlockCacheItem: gridBlockContentResponse.Content is null");return}i=this.dU(!0);i&&(t?(f=t.cloneNode(!0),i.parentNode.replaceChild(f,i)):i.parentNode.removeChild(i))}},cU:function(){var u,s,i;if(!this.dg){var n=this.cP,t=this.cQ,f=this.cM.c,e=this.cM.b,h=f[n],c=e[t],r=_Ewa.o.a(h,c,!1),o=r;if(this.dp=_Ewa.em.e(this.cM.k,n,t),this.dp)for(u=0,s=this.cM.t().length;u<s;u++)if(i=this.cM.A()[u],i&&i.i(r)){for(r=i,o=this.cM.t()[u];n>0&&f[n-1]>=i.a;)this.cP=--n;while(t>0&&e[t-1]>=i.b)this.cQ=--t;break}this.eP(r);this.ec=!!((this.cM.s[n]|0)&1<<t);this.eb=!!((this.cM.o[n]|0)&1<<t);this.dg=r;this.dt=o}},eG:function(){return!_Ewa.e.a(this.x())||this.bz()},eP:function(n){var r,t;if(this.dK=!1,this.dz=!1,this.dP=null,this.cO.a(127)){r=this.cL.c().A(n);for(var u=r,f=u.length,i=0;i<f;++i)if(t=u[i],_Ewa.fH.isInstanceOfType(t)&&!$$as(_Ewa.fH,t).q){this.dz=n.e().g(t.e());this.dK=!this.dz;this.dP=t;break}}},em:function(){var n=0;return this.bz()&&(n=1,this.bG()?this.dx(this.cJ().style.borderLeftWidth)>1&&(n=2):this.bJ()&&this.dx(this.cJ().style.borderRightWidth)>1&&(n=2)),n},ew:function(n){var t,i;this.dC=n;t=this.cT(!1,!1);t&&(i=t.a(),i.dr=n)},ff:function(n){var t,i;this.dr=n;t=this.cT(!1,!0);t&&(i=t.a(),i.dC=n)},eu:function(n){var t,i;this.dA=n;t=this.cT(!0,!1);t&&(i=t.a(),i.dB=n)},ev:function(n){var t,i;this.dB=n;t=this.cT(!0,!0);t&&(i=t.a(),i.dA=n)},dk:function(n,t,i){var r="";switch(t){case 0:r=i?_Ewa.gM.a(n,1):_Ewa.gM.a(n,0);break;case 2:r=i?_Ewa.gM.a(n,3):_Ewa.gM.a(n,2)}return r},eD:function(){var n=0,c=!!this.du(),l=!!this.ek(),a=!!this.dS(),v=!!this.dT(),f=_Ewa.rl.b(c,l,v,a),r,h,u;n=_Ewa.rl.a(f,f,!1);var t=Math.floor(Math.max(0,this.dT()-1)/2),e=Math.floor(this.dS()/2),i=Math.floor(Math.max(0,this.du()-1)/2),y=Math.floor(this.ek()/2),o=this.g()-1,p=this.e()-1,s=0;!this.bz()&&this.bD()&&(s=1);n&2?(this.cJ().style.top="-1px",this.cJ().style.paddingTop="1px"):(r=this.dT()-t,r&&(this.cJ().style.top=-r+"px"),t>0&&(this.cJ().style.height=o-(t+e)+"px"));n&1&&!this.bD()?this.cJ().style.paddingBottom="1px":this.dS()>1&&t>0&&(this.cJ().style.height=o-(t+e)+s+"px");n&4?(h=-1+this.em(),this.dN(h),this.cJ().style.paddingLeft="1px"):(u=this.du()-i-this.em(),u&&this.dN(-u),i>0&&(this.cJ().style.width=p-(i+y)+"px"));n&8&&(this.cJ().style.paddingRight="1px")},dN:function(n){_Ewa.dq.a(this.cJ().style,this.cL.c().d(),parseInt(this.cJ().style[this.dv()])+n+"px")},dx:function(n){n=n.substring(0,n.length-2);return parseInt(n)},eC:function(n){if(!n)return"";var r=" ",i="\u00a0",t=n;return n.trim().length?n.length===1?n:(t=t.replace(new RegExp("  ","g"),r+i),t.startsWith(r)&&(t=i+t.substr(1)),t.endsWith(r)&&(t=t.substr(0,t.length-1)+i),t):t.replace(new RegExp(" ","g"),i)}};_Ewa.Fx=function(n,t){this.c=Function.createDelegate(this,this.e);_Ewa.Fx.initializeBase(this,[n,null]);this.b=t;this.b.c(this.c)};_Ewa.Fx.prototype={b:null,a:null,dispose:function(){this.b.b(this.c);this.b=null;this.a=null;_Ewa.hD.prototype.dispose.call(this)},d:function(n,t,i){var r=n.S(),u,e,o;if(!r)return null;var f=t.j(),s=f.c(n.b()),a=t.h().a();if(!this.a||i){if(u=t.i(),t.c().a(778)&&t.c().isChangeGateEnabled("OfficeVSO:4265763_FixTextBoxMisalignmentInZoomWithRTL")){if(this.a=_Ewa.i.d(u,u.offsetParent,t.d(),t.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!1,!1),!this.a)return null;e=_Ewa.i.d(u.offsetParent,this.dC.parentNode,t.d(),t.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!1,!1);e&&(this.a.y+=e.y)}else if(this.a=_Ewa.i.d(u,this.dC.parentNode,t.d(),t.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!1,!1),!this.a)return null;t.c().isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled")||(o=t.bc(),o.b()&&o.c()&&!u.clientLeft&&(this.a.x-=_Ewa.Z.a()));t.cc(this.a)}var h=t.n(s).x(),c=_Ewa.er.a(s,a.a),l=t.bm()+-1;return new Sys.UI.Bounds(r.a.a+this.a.x+h.a-f.a.a+l-c.a,r.a.b+this.a.y+h.b-f.a.b+l-c.b,n.l()?Math.min(r.c(),n.v()):r.c(),r.d())},e:function(){this.a=null}};_Ewa.gf=function(n){this.a=n};_Ewa.gf.b=function(n,t){var i,r;n&&t&&t.StyleMapHtml&&(i=document.createElement("div"),_Ewa.a.k(i,t.StyleMapHtml),i=_Ewa.gf.a(i),r=_Ewa.gf.a(n),r?r.parentNode.replaceChild(i,r):n.appendChild(i))};_Ewa.gf.a=function(n){return _Ewa.a.a(n,"gridStyles")};_Ewa.gf.prototype={n:null,l:null,a:null,g:null,f:function(){return this.l||(this.l=_Ewa.i.v(this.d))},i:function(){return this.n||(this.n=_Ewa.i.v(this.e))},b:null,c:null,d:null,e:null,h:0,j:0,p:null,r:null,q:null,t:function(){return this.g?this.g.a:null},A:function(){return this.g?this.g.b:null},s:null,o:null,k:null,w:function(n,t){var i=[];return this.a.m()&&!this.a.q()&&(i=_Ewa.em.c(n,this.a,this.c,this.b,t,!1)),i},v:function(n,t){return!this.a.m()||this.a.q()?null:_Ewa.em.b(n,this.a,t,!1)},u:function(n){return!this.a.m()||this.a.q()?null:_Ewa.em.a(n,this.a,this.i(),this.f(),this.e,this.d)},B:function(n,t){if(t.val=null,!n)return null;var i=-1,r=-1,u,f,e,h=(e=_Ewa.i.T(n,this.i(),this.f(),this.e,this.d,u={val:i},f={val:r}),i=u.val,r=f.val,e);if(h){var c=n.x-this.f()[r],l=n.y-this.i()[i],o=this.c[i],s=this.b[r];return t.val=new _Ewa.o(o,s,o,s,!0,!1),new Sys.UI.Point(c,l)}return null},m:function(n){var t,i,u;if(n&&(t=n.m(),!!(t^n.k())&&n.h(this.a.b())&&(i=t?this.f():this.i(),u=t?this.d:this.e,i&&u))){var f=t?this.b:this.c,e=_Ewa.i.q(f,t?n.b:n.a),o=_Ewa.i.q(f,t?n.c:n.d),r=this.a.r(),s,h=f[o]<=(t?n.c:n.d);return s=i[o]-i[e]+(h?u[o]:0),t?new _Ewa.W(r.a+i[e],r.b,s,this.a.R()):new _Ewa.W(r.a,r.b+i[e],this.a.x(),s)}return null},x:function(n){if(n&&n.h(this.a.b())){var r=new _Ewa.o(n.a,1,n.d,n.r,!0,!1),u=new _Ewa.o(1,n.b,n.s,n.c,!0,!1),t=this.m(r),i=this.m(u);return new _Ewa.W(i.a.a,t.a.b,i.c(),t.d())}return null},y:function(n){this.c=n.RowNumbers;this.b=n.ColumnNumbers;this.d=n.ColumnWidths;this.e=n.RowHeights;this.l=n.ColumnOffsets;this.n=n.RowOffsets;this.j=n.DefaultColumnWidth;this.h=n.DefaultRowHeight;this.z(n);this.k=n.MergedFlags||[];this.g=new _Ewa.pP(n.MergedRanges,this.k);this.s=n.UnlockedFlags||[];this.o=n.HiddenFormulaFlags||[]},z:function(n){this.p=n.StyleMapColumnsNew||[];this.r=n.StyleMapSpansNew||[];this.q=n.StyleMapIdxsNew||[]}};_Ewa.Fy=function(n){this.p=null;this.o=new Array(0);this.n(n,0)};_Ewa.Fy.prototype={o:null,a:function(){return this.o},q:0,f:function(){return this.q},c:function(){return this.o[this.q]},p:null,j:function(){return this.p},d:function(){return this.o.length},b:function(){return this.o.length===1},e:function(){return this.o.length===1&&this.o[0].j()},n:function(n,t){Diag.a.b.apply(null,[590357594,0,!t||t===1||this.o.length>0,"GridSelection.UpdateSelection: SelectedRanges can't be empty with SelectionUpdateType = {0}"].concat([t]));t||Array.clear(this.o);this.p=null;switch(t){case 3:this.o[this.q]=n;break;case 0:case 1:Array.add(this.o,n);this.q=this.o.length-1;break;case 2:this.p=n;break;case 5:break;default:Diag.a.b(590357593,0,!1,"GridSelection.UpdateSelection: Unsupported SelectionUpdateType = {0}",t)}},m:function(n,t){this.o=n;this.q=t},k:function(n){this.p&&(Diag.a.b(590357592,0,!!n,"GridSelection.FinalizeDeselectionFromPreview: newSelectionIfRemainsEmpty is null"),this.r(this.p,n),this.p=null)},g:function(){return!!this.p},l:function(){return _Ewa.f.F(this.o)},i:function(n){return Diag.a.b(590357591,0,!!n&&n.j(),"GridSelection.DoesContainCell: cell should be a single cell."),this.h(n)},h:function(n){var r;Diag.a.b(590357590,0,!!n,"GridSelection.DoesContainRangeWithoutSplitting: range shouldn't be null.");for(var i=this.o,u=i.length,t=0;t<u;++t)if(r=i[t],r.i(n))return!0;return!1},r:function(n,t){for(var i,r,s,o,u=new Array(0),f=0;f<this.o.length;f++)if(i=this.o[f],i.h(n)){r=i.n(n);s=[new _Ewa.o(r.d+1,i.b,i.d,i.c,!1,!1),new _Ewa.o(r.a,r.c+1,r.d,i.c,!1,!1),new _Ewa.o(r.a,i.b,r.d,r.b-1,!1,!1),new _Ewa.o(i.a,i.b,r.a-1,i.c,!1,!1)];for(var h=s,c=h.length,e=0;e<c;++e)o=h[e],o.E()&&Array.add(u,o)}else Array.add(u,i);u.length||Array.add(u,t);this.o=u;this.q=this.o.length-1}};_Ewa.Fz=function(n){this.f=n;this.g=n.c()};_Ewa.Fz.prototype={f:null,g:null,b:function(n){var r;if(!this.f.by())for(var i=this.f.H(),u=i.length,t=0;t<u;++t)r=i[t],r.dC.style.cursor=n},e:function(n,t,i){return new _Ewa.Fq(this.f,n,t,i)},c:function(){var n=_Ewa.dH.a(this.g),t=this.g.k()?_Ewa.cF.a(this.g):null,i=this.f.m()&&(!this.f.E()||this.f.be()),r=!!n&&n.a().bH(),u=this.g.o().bo()&&(!t||!t.j());return!i&&!(Common.c.c()&&!r)&&!u},a:function(){var n=this.d(),t;n&&(t=this,n.catch(function(){}))},d:function(){var n=this.g.b().a(_Ewa.cY,254,!1);return n?n.e("GridView/ClearClipboardState",!0,!1,!1,0):typeof Promise!="undefined"?Promise.resolve(!0):null}};_Ewa.FF=function(n,t){_Ewa.FF.initializeBase(this,[n.a,n.b,n.d,n.c,!1,!1]);this.q=t};_Ewa.FF.prototype={q:null};_Ewa.kW=function(){};_Ewa.kW.d=function(n,t,i,r,u,f){_Ewa.kW.a(n,t,i,r,u,f,!0,!1)};_Ewa.kW.c=function(n,t,i,r,u,f){var e=!!(t.m()^t.k());_Ewa.kW.a(n,t,i,r,u,f,e,!0)};_Ewa.kW.a=function(n,t,i,r,u,f,e,o){var s=null,a=n.dJ.h(),c,h,l;i&&(s=n.bd(i.e()),c=a?n.dJ.C(i.e(),n.dD.T()):s,s&&c&&(o||c.g(i.e(),!1,!1))&&(u.val=e?s.v(t):s.w(t),(o||c.g(i.p(),!1,!1))&&(f.val=u.val)));r&&(h=n.bd(r.p()),s!==h&&h&&(l=a?n.dJ.C(r.p(),n.dD.T()):h,f.val=o||!l||l.g(r.p(),!1,!1)?e?h.v(t):h.w(t):null))};_Ewa.kW.b=function(n,t,i,r,u,f,e,o){var s=null,h;i&&r&&(s=n.b().e(r.e(),!1));o.val=e.val=s?n.R(s):null;!t.j()&&u&&f&&(h=n.b().e(f.p(),!1),o.val=h?n.R(h):null)};_Ewa.cf=function(n,t,i,r){var o,s,h,u,e,l;this.hA=Function.createDelegate(this,this.kF);this.iK=Function.createDelegate(this,this.ks);this.hJ=Function.createDelegate(this,this.kU);this.iN=Function.createDelegate(this,this.kz);this.iO=Function.createDelegate(this,this.kA);this.iP=Function.createDelegate(this,this.jk);this.iQ=Function.createDelegate(this,this.kJ);this.iL=Function.createDelegate(this,this.kw);this.iM=Function.createDelegate(this,this.kx);this.gv=Function.createDelegate(this,this.hS);this.hw=Function.createDelegate(this,this.kv);this.hq=Function.createDelegate(this,this.kp);this.iH=Function.createDelegate(this,this.ke);this.iI=Function.createDelegate(this,this.kf);this.hu=Function.createDelegate(this,this.kt);this.iJ=Function.createDelegate(this,this.kr);this.hs=Function.createDelegate(this,this.kq);this.hK=Function.createDelegate(this,this.kV);this.ht=Function.createDelegate(this,this.gf);this.fT=Function.createDelegate(this,this.ko);this.fR=Function.createDelegate(this,this.km);this.fS=Function.createDelegate(this,this.kn);this.hy=Function.createDelegate(this,this.kC);this.hC=Function.createDelegate(this,this.kH);this.hp=Function.createDelegate(this,this.kl);this.hB=Function.createDelegate(this,this.kG);this.hH=Function.createDelegate(this,this.kO);this.hI=Function.createDelegate(this,this.jm);this.hD=Function.createDelegate(this,this.kI);this.hx=Function.createDelegate(this,this.ky);this.hF=Function.createDelegate(this,this.kL);this.hE=Function.createDelegate(this,this.kK);this.hG=Function.createDelegate(this,this.kM);this.fV=Function.createDelegate(this,this.kN);this.fU=Function.createDelegate(this,this.kD);this.hz=Function.createDelegate(this,this.kE);this.hv=Function.createDelegate(this,this.ku);this.hr=Function.createDelegate(this,this.ji);this.iS=Function.createDelegate(this,this.kQ);this.iR=Function.createDelegate(this,this.kP);this.jo=[16];this.gB=[];this.eQ=new($$sc.v.$$(_Ewa.js));this.bi=this.el;this.cu=this.eP;this.bn=this.ef;this.cv=this.ey;this.bx=this.eo;this.p=this.eO;this.ci=this.io;_Ewa.cf.resolveInheritance();this.dw=this.dQ;this.c=this.lw;this.i=this.B;_Ewa.cf.initializeBase(this,[i,t,t.bI,t.bJ,1,n]);t.bz=this;this.dD=n;this.dT=n.c();this.ge=!1;this.ev=n.a(72);this.eg=new _Ewa.tY(this);this.eX=new _Ewa.Fz(this);this.ic=n.a(827)?32:27;o=this.dD.z().a(56)||this.dD.z().a(55);o&&this.jQ();_Ewa.cf.e=n.bX(64);Common.c.p()||Common.c.G()&&this.dD.isChangeGateEnabled("OfficeVSO:4227261_calculateDevicePixelRatioInIE10")?(this.eW=-1,this.iZ(!1),this.gi=_Ewa.bS.a().b(null),this.gi.a("resize",this.iR,!1),this.fr=_Ewa.y.a().a(this.iS,this.dD.e().DprChangeEventDelay,_Ewa.m.bd,!0,!1)):(s=this,this.fr=_Ewa.y.a().a(function(){s.dE("gvDPRC",null,null)},this.dD.e().DprChangeEventDelay,_Ewa.m.bb,!0,!1),this.iW());this.dD.a(778)&&(this.fF=this.dD.isChangeGateEnabled("OfficeVSO:4313604_AvoidOnAsyncZoomContentAreaOnPlt")?_Ewa.y.a().a(this.hr,200,_Ewa.m.b,!1,!1):_Ewa.y.a().a(this.hr,200,_Ewa.m.b,!0,!1));this.gr.d(this.eB=r);this.hR=_Ewa.bz.e(_Ewa.cf.b(),1,1,this.ej,this.ei,this.dN,this.dR());this.eI=new _Ewa.gh(this.fd(0,0,!0),this);this.eE=new _Ewa.tX(this,this.fd(0,1,!0),!1);this.dY=new _Ewa.tZ(this,this.fd(0,2,!0),!1,this.dN);this.eF=new _Ewa.tX(this,this.fd(1,0,!0),!0);this.dZ=new _Ewa.tZ(this,this.fd(1,0,!1),!0,this.dN);this.eD=new _Ewa.Fu(this,this.fd(1,1,!0));this.eb=new _Ewa.FI(this,this.fd(1,1,!1));this.ea=new _Ewa.FC(this,this.fd(1,2,!0));this.iV(this.dC);this.iV(this.eB);h=Common.c.b()?"ff":Common.c.i()?"ie8":Common.c.k()?"ie7":"";Sys.UI.DomElement.addCssClass(this.eB,h);this.fI=[this.dY,this.ea];this.fJ=[this.dZ,this.eb];this.eY=[this.dZ,this.dY,this.eF,this.eE,this.eD,this.ea,this.eb];this.eu=[this,this.eD,this.ea,this.eb];this.gz=[this.dY,this.eE];this.gA=[this.dZ,this.eF];this.dI=new _Ewa.er(null,this.dD.a(902));n.f().I(this.hv);for(var c=this.eu,a=c.length,f=0;f<a;++f)u=c[f],Array.add(this.gB,new _Ewa.tW(this,u.dC,5)),Common.f.a().a("msospPointerUp",u.dC,this.hz),(u!==this||this.dD.a(778)&&this.dD.a(940))&&Common.J.a().a(Common.t.a(),u.dC,this.fU);this.dD.a(778)&&this.dD.a(940)&&Common.J.a().a(Common.t.a(),this.dD.q(),this.fU);Common.l.a().a("touchstart",this.eb.dC,this.fV);Common.l.a().a("touchmove",this.eb.dC,this.hG);Common.l.a().a("touchend",this.eb.dC,this.hE);Common.l.a().a("touchstart",this.ea.dC,this.fV);Common.l.a().a("touchmove",this.ea.dC,this.hF);Common.l.a().a("touchend",this.ea.dC,this.hE);this.gD=this.dD.isChangeGateEnabled("OfficeVSO:4289738_fixFreezePaneTouchScrollSelectsCell");this.gD||(this.fu=new Sys.UI.Point(0,0));this.gb=!1;this.dM=new _Ewa.FG(this);this.dM.bi.f(this.hx);e=_Ewa.cf.m(n);this.fY=new _Ewa.Fx(e,this.h());this.kg();this.eJ=_Ewa.jF.b(this,this.dM,e,this.fY);this.dX=new _Ewa.gt(n,this,n.c().c().w(),!0,null);this.fq=!1;n.c().g(this.hD);n.E(this.hI);this.h().c(this.hH);this.dM.g(this.hB);this.dM.h(this.hp);this.dX.m(this.hC);this.dT.p(this.hy);n.f().i(this.fS);n.n().i(this.fS);n.n().c(this.fR);n.f().c(this.fR);n.f().w(this.fT);n.n().w(this.fT);n.R(this.ht);n.d().a().x(this.hK);_Ewa.p.s(this.dD)&&n.d().a().r(this.hs);this.dJ.c(this.jF);this.dJ.x(this.iJ);this.jr(n.K(),!0);this.hZ();_Ewa.bl.a(n).a(this);l=this;this.fp=new($$sc.y.$$($$sc.n.$$(_Ewa.fL)))(function(){return _Ewa.l.a(_Ewa.fL,n.b(),18,l.dF(),-2)});this.gG=!!_Ewa.ca.b(this.dD)&&_Ewa.ca.b(this.dD).d();this.gH=!!_Ewa.ca.c(this.dD)&&_Ewa.ca.c(this.dD).d();this.v(this.hu);this.eK=new _Ewa.FM(this);this.fZ=new _Ewa.iC(this.dD);this.hP=n.isChangeGateEnabled("OfficeVSO:3556055_DirectionFixes1");this.fn=n.isChangeGateEnabled("OfficeVSO:4057732_ReducingAoi75Tag");this.fW=new _Ewa.Fp(this);this.jM(t.cL);this.dD.a(116)&&(gridRenderer.GridBlockRendererGlobals.initializeGridRendererImageLoader(this.iI,this.iH),this.dT.i()?this.jf():this.dT.n(this.hq))};_Ewa.cf.b=function(){return _Ewa.cf.d||(_Ewa.cf.d=new _Ewa.o(1,1,1048576,16384,!1,!0))};_Ewa.cf.g=function(n){var t,i,r,u=(r=_Ewa.cf.j(n,i={val:t}),t=i.val,r);return new _Ewa.cf(n,_Ewa.mC.a(n),_Ewa.a.e(u,"ewa-scrollbars",!1),t)};_Ewa.cf.h=function(n,t,i,r,u,f,e){var c,v,y,p=i-t+1,w,b,s,o,h,l,a;return y=r?n.l():n.o(),c=r?n.a:n.b,v=r?n.d:n.c,w=c-t,b=i-v,w>b?i=v:t=c,s=r?new _Ewa.o(t,n.b,i,n.c,!1,!1):new _Ewa.o(n.a,t,n.d,i,!1,!1),p>y&&(o=u?y:r?e:f,h=p%o,t<c?t=h>0?t+h-o:t:i=h>0?i-h+o:i,r?(l=n.a-Math.floor((n.a-1)/o)*o,a=n.d+Math.floor((s.s-n.d)/o)*o,s.a=Math.max(t,l),s.d=Math.min(i,a)):(l=n.b-Math.floor((n.b-1)/o)*o,a=n.c+Math.floor((s.r-n.c)/o)*o,s.b=Math.max(t,l),s.c=Math.min(i,a))),s};_Ewa.cf.a=function(n,t,i,r,u){if(_Ewa.cf.e){var f={};f.a=t;f.b=_Ewa.cf.c;f.c=n;f.d=i;f.e=r;f.f=u;_Ewa.z.a().a(13,f,!1)}};_Ewa.cf.l=function(n,t,i){var r=n.X*30+t.c-1,u=n.Y*28+t.d-1,f=i.i(u,r,!1);return f.e(t)};_Ewa.cf.j=function(n,t){var i=n.N(),r=i.ownerDocument.createElement("div");return _Ewa.a.k(r,_Ewa.cf.i(n)),t.val=r.firstChild,i.insertBefore(t.val,i.firstChild),i};_Ewa.cf.i=function(n){var t=n.isChangeGateEnabled("OfficeVSO:4269827_DarkerFreezePane")?"ewr-vertical-frozen-dark-border":"ewr-vertical-frozen-border",i=n.isChangeGateEnabled("OfficeVSO:4269827_DarkerFreezePane")?"ewr-horizontal-frozen-dark-border":"ewr-horizontal-frozen-border",r="<table class='ewr-grdcontarea-ltr' role='presentation' style='border-collapse: collapse' cellspacing='0' cellpadding='0' table-layout='fixed'> <tr><td valign='top'><div class='ewr-hdrcornercontainer ewrol-cmax0 ewrol-rmax0' role='presentation'><div class='ewr-grdblk'><\/div> <div class='ewr-hdrcornerwidget'><\/div><\/div><\/td><td class='ewr-paneswrapper' valign='top'><div id='{0}pnColHdrDiv' class='ewa-hidden ewr-colhdrcontainer "+t+" ewr-grdblkcontainer' role='presentation'><\/div><\/td><td class='ewr-paneswrapper ewr-namedsheetview-background-enabled' valign='top'><div id='{0}columnHeadersDiv' class='ewr-colhdrcontainer ewr-grdblkcontainer' role='presentation'><\/div><\/td><\/tr><tr><td valign='top' class='ewr-grdblk-background-color'><div id='{0}pnRwHdrDiv' class='ewa-hidden ewr-rowhdrcontainer "+i+" ewr-grdblkcontainer' role='presentation'><\/div><div id='{0}rowHeadersDiv' class='ewr-rowhdrcontainer ewr-grdblkcontainer' role='presentation'><\/div><\/td><td class='ewr-paneswrapper' valign='top'><div id='{0}fiPnSheetContentDiv' class='ewa-hidden ewr-sheetcontainer ewr-frozen-sheetcontainer "+i+" "+t+" ewr-grdblkcontainer' role='presentation' ><\/div><div id='{0}vPnSheetContentDiv' class='ewa-hidden ewr-sheetcontainer ewr-frozen-sheetcontainer "+t+" ewr-grdblkcontainer' role='presentation'><\/div><\/td><td class='ewr-paneswrapper' valign='top'><div id='{0}hPnSheetContentDiv' class='ewa-hidden ewr-sheetcontainer ewr-frozen-sheetcontainer "+i+" ewr-grdblkcontainer' role='presentation'><\/div><div id='{0}sheetContentDiv' class='ewr-sheetcontainer ewr-grdblkcontainer ewa-scrollbars' role='presentation'><\/div><\/td><\/tr><\/table>";return String.format(r,n.m())};_Ewa.cf.n=function(n,t){var i=new Sys.UI.Point(t.a,t.b);return n.l()?i.y=t.b-n.n().f():i.x=t.a-n.q(),n.i(i)};_Ewa.cf.p=function(n,t,i,r){if(n){var u={};u.a=r?r.c():"";u.b=n.e;u.c=n.d;u.d=_Ewa.vg.toString(n.c);u.e=n.b;_Ewa.z.a().a(7,u,!0);_Ewa.z.a().c(t.c(),i.c(),_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0);r&&_Ewa.z.a().c(i.c(),r.c(),_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0)}};_Ewa.cf.m=function(n){var t,r,u,f,i,e,o;return _Ewa.cz.b()?(r=!1,u="gridKeyboardContentEditable",t=document.getElementById(u),t||(t=_Ewa.cf.k(_Ewa.p.e(n)),t.id=u,r=!0),r&&(f=n.m()+"contentAreaDiv",i=document.getElementById(f),Diag.a.b(21301144,3,!!i,"GridView.GetGridKeyboardHandlerDomElement: expected to find contentAreaDiv with id: {0}",f),i.insertBefore(t,i.firstChild))):(e=n.m()+"gridKeyboardInput",o=document.getElementById(e),Diag.a.b(21301145,3,!!o,"GridView.GetGridKeyboardHandlerDomElement: expected to find gridKeyboardInputElement with id: {0}",e),t=o),Diag.a.a(21301146,3,50,"GridView.GetGridKeyboardHandlerDomElement return elementId: {0} and element type: {1}",t.id,t.nodeName),t};_Ewa.cf.k=function(n){var t=document.createElement("div");return t.className="ewa-gridKeyHandler",n||(t.setAttribute("contenteditable","true"),t.setAttribute("role","textbox"),t.setAttribute("spellcheck","false"),t.setAttribute("autocomplete","false"),t.setAttribute("autocorrect","off"),t.style.whiteSpace="pre-wrap",t.tabIndex=0),t};_Ewa.cf.prototype={ic:0,fI:null,fJ:null,eY:null,dM:null,ge:!1,dT:null,dZ:null,dY:null,eB:null,eI:null,eF:null,eE:null,eD:null,eb:null,ea:null,eJ:null,dL:null,eZ:null,fi:null,fj:null,ew:null,hR:null,fe:!1,ft:!1,eA:null,en:null,hV:null,gc:0,eH:null,fs:null,id:!1,gL:0,fg:null,ev:!1,fa:null,fh:null,ff:null,gG:!1,gH:!1,fr:null,fF:null,gi:null,ez:null,eK:null,fu:null,gg:!1,hP:!1,gb:!1,gD:!1,fw:null,gF:!0,bZ:function(n){this.dG("gvCAFOR",n)},co:function(n){this.dH("gvCAFOR",n)},cH:function(n){this.dG("gvGE",n)},dd:function(n){this.dH("gvGE",n)},bO:function(n){this.dG("gvBAIC",n)},bS:function(n){this.dH("gvBAIC",n)},cI:function(n){this.dG("gvVBPEC",n)},de:function(n){this.dH("gvVBPEC",n)},W:function(n){this.dG("gvAABU",n)},T:function(n){this.dH("gvAABU",n)},cG:function(n){this.dG("gvDPRC",n)},dc:function(n){this.dH("gvDPRC",n)},cF:function(n){this.dG("gvCAZC",n)},jL:function(n){this.dG("gvEBC",n)},kS:function(n){this.dH("gvEBC",n)},ca:function(n){this.dG("gvGVBR",n)},cp:function(n){this.dH("gvGVBR",n)},cb:function(n){this.dG("gvVC",n)},cq:function(n){this.dH("gvVC",n)},jM:function(n){this.dG("gvSPDU",n)},df:function(n){this.dH("gvSPDU",n)},u:function(){return this.eB.parentNode},bX:function(){return this.dM.bj},cd:function(){return this.eI},cS:function(){return this.dZ},bg:function(){return this.dY},a:function(){return this.dM},f:function(){return this.dL},bl:function(){return this.be()?_Ewa.dH.a(this.dD):this.dL},bM:function(){return this.eJ.Z},m:function(){return this.dL.i()},E:function(){return!!this.dL&&this.dL.j()},gw:!1,cP:function(){return this.gw},bI:function(n){return this.gw=n,n},et:!1,P:function(){return this.et},cs:function(n){return this.et=n,n},em:null,F:function(){return this.em},be:function(){return this.dL.o()},U:function(){return _Ewa.a.L(this.dY.dC)},S:function(){return _Ewa.a.x(this.dZ.dC)},fo:0,bh:function(){return this.fo},bq:function(n){return this.fo=n,n},ed:!1,Y:function(){return this.ed},J:function(){return this.dI.e()&&!this.d()},cQ:function(){return this.dY.f},cR:function(){return this.dZ.f},fX:0,bm:function(){return this.fX},eu:null,H:function(){return this.eu},gz:null,gA:null,eG:function(){return this.dT.b()},fq:!1,cg:function(){return this.fq},fn:!1,jb:function(){return _Ewa.o.a(Math.max(this.dI.b,this.ew.a),Math.max(this.dI.d,this.ew.b),!1)},fW:null,bQ:function(){return this.fW},bv:function(){return new _Ewa.M(this.h().a().c(),this.h().a().d())},x:function(){return new _Ewa.M(this.dI.a.a,this.dI.a.b)},K:function(){return this.h().a()},D:function(){return this.eJ.cm()},bw:function(){return!_Ewa.B.a(this.dD.j())&&this.eJ.cu()},bf:function(){return"GK"},dI:null,j:function(){return this.dI},dX:null,k:function(){return this.dX},el:function(){return _Ewa.hD.prototype.el.call(this)},eP:function(n){var r;_Ewa.hD.prototype.eP.call(this,n);_Ewa.hD.prototype.el.call(this)!==n&&(this.jj(),_Ewa.hD.prototype.eP.call(this,n));for(var i=this.fI,u=i.length,t=0;t<u;++t)r=i[t],r.eP(this.el());return n},ef:function(){return _Ewa.hD.prototype.ef.call(this)},ey:function(n){var r;_Ewa.hD.prototype.ey.call(this,n);_Ewa.hD.prototype.ef.call(this)!==n&&(this.jj(),_Ewa.hD.prototype.ey.call(this,n));for(var i=this.fJ,u=i.length,t=0;t<u;++t)r=i[t],r.ey(this.ef());return n},jx:function(){return this.dD.k()},ce:function(){return this.fD&&this.dJ.bf()},eh:null,ia:function(n){return this.ew=n?n.f():null,n},O:function(){for(var t,n=null,r=this.eu,u=r.length,i=0;i<u;++i)t=r[i],n?n.F(t.q()):t.q()&&(n=t.q().f());return n},cw:function(){return this.dZ.dQ()},kX:function(n){return this.cw()!==n&&this.dZ.dV(this.dY.dV(this.eI.cr(n))),n},eg:null,g:function(){return this.eg},eX:null,r:function(){return this.eX},l:function(){return this.dL},iT:!1,dj:function(n){return this.iT=n,n},dt:function(){return this.fg||(this.fg=document.createElement("div"),_Ewa.a.b(this.fg,!1,!0),document.body.appendChild(this.fg)),this.fg},cT:function(){return"GK"},gx:!1,ij:function(){return this.gx},ga:!1,cO:function(){return this.ga},di:function(n){return this.ga=n,n},hL:!1,dh:function(n){return this.hL=n,n},hM:!1,by:function(){return this.hM},ct:function(n){return this.hM=n,n},eW:0,V:function(){return this.eW},fZ:null,w:function(){return this.fZ},eo:function(){var n=this.dI?this.dI.b:1,t=this.dI?this.dI.d:1,i=_Ewa.gI.a(n,t);return this.X().b(i,!1)},fE:null,gy:null,fp:null,fH:function(){return this.eG()?this.eh:_Ewa.cf.b()},jV:function(){return this.fH()?this.fH().n(this.q()):null},jp:function(n){return n&&n.d(this.fi)||(this.fi=n),n},fY:null,cX:function(){this.dL=new _Ewa.Fs(this,this.eJ,this.fY);this.em=new _Ewa.Pv(this.dD,this.dL);this.dE("gvEBC",null,null);this.dL.c(this.hw);this.jm(this.dD,new _Ewa.nW(_Ewa.bq.a(this.dD),_Ewa.bq.b(this.dD),this.dT.m()));this.dl(!1);this.dX.k()},dr:function(n){n.ActiveSheetProcessedDataResult&&(!this.dD.j()||_Ewa.e.b(this.dD.j().c(),n.ActiveSheetName,!1))?(this.hW(n.ActiveSheetProcessedDataResult,n.ActiveSheetName),this.dT.B(this.gv)):(n.ActiveSheetProcessedDataResult&&(this.jD(n.ActiveSheetName,n.ActiveSheetProcessedDataResult),Diag.a.a(590394049,1,50,"GridView.UpdateSheetProcessedDataFromOpenWorkbook: The SheetProcessedData recieved from open workbook is of different sheet than the active sheet")),this.dT.D(this.gv));this.eK.b.SessionStartNavigableRangePx=isNullOrUndefined(this.ec)?"undefined":this.ec.toString();this.dD.j()?this.eK.b.SessionStartUsedRange=isNullOrUndefined(this.dD.j().b)?"undefined":this.dD.j().b.toString():this.eK.b.InitialActiveItem="null"},jO:function(n,t,i,r,u){var f=this.dJ.e(_Ewa.o.a(n.a,n.b,!1),!1),e=f?f.b():n.f();return _Ewa.cf.h(n,t,i,r,u,e.o(),e.l())},dispose:function(){var t,n;Diag.a.a(39706843,1,50,"GridView.Dispose: start dispose object");for(var r=this.eu,u=r.length,i=0;i<u;++i)t=r[i],Common.f.a().b("msospPointerUp",t.i(),this.hz),(t!==this||this.dD.a(778)&&this.dD.a(940))&&Common.J.a().b(Common.t.a(),t.i(),this.fU);this.dD.a(778)&&this.dD.a(940)&&Common.J.a().b(Common.t.a(),this.dD.q(),this.fU);Common.l.a().b("touchstart",this.eb.dC,this.fV);Common.l.a().b("touchmove",this.eb.dC,this.hG);Common.l.a().b("touchstart",this.ea.dC,this.fV);Common.l.a().b("touchmove",this.ea.dC,this.hF);this.ez&&(this.ez.c("cut",!0)&&this.ez.b("cut",!0),this.ez.c("copy",!0)&&this.ez.b("copy",!0),this.ez.c("paste",!0)&&this.ez.b("paste",!0));n=this.dD;n&&(n.G(this.hI),this.dT.t(this.hy),n.f().h(this.fS),n.n().h(this.fS),n.n().e(this.fR),n.f().e(this.fR),n.f().y(this.fT),n.n().y(this.fT),n.c().h(this.hD),n.S(this.ht),n.f().O(this.hv),n.d().a().D(this.hK),_Ewa.p.s(this.dD)&&n.d().a().u(this.hs),this.dT.B(this.gv),this.eK.j(),this.eK=null);this.h()&&this.h().b(this.hH);this.dL&&this.dL.d(this.hw);this.dM&&(this.dM.i(this.hB),this.dM.j(this.hp),this.dM.bi.h(this.hx));this.dX&&this.dX.q(this.hC);System.a.b([this.eZ,this.fr,this.fF,this.gi,this.eJ,this.dL,this.dM,this.dX,this.fY,this.em,this.fW]);System.a.b(this.gB);this.fr=null;this.fF=null;this.gi=null;this.eZ=null;this.gB=null;this.eJ=null;this.dM=null;this.dX=null;this.fW=null;_Ewa.a.g(this.fg);this.fg=null;this.fG();this.ft=!1;this.eh=this.ew=null;this.fj=null;this.fi=this.hR=null;_Ewa.FA.prototype.dispose.call(this);System.a.b([this.eD,this.eb,this.ea,this.eF,this.eE,this.dZ,this.dY,this.eI]);!this.fp.b&&_Ewa.ck.a(this.fp.a())&&System.a.a(this.fp.a().a());this.eD=this.eb=this.ea=null;this.eF=this.eE=null;this.dZ=this.dY=null;this.eI=null;this.eB=null;this.y(this.hu)},eO:function(){this.eX.c()&&this.eJ.cG()},C:function(n,t){return t||(this.bj(),_Ewa.b.b(this,"GridView.SetFocus",3,null)),!t},bj:function(){this.dM.bi.d(null,!0);this.eO()},bT:function(){var n=this.dM.bi.a();n&&n.bb(!0);this.bj()},bU:function(){var n=this.dM.bi.a();return n?(n.bb(!0),!0):this.C(!0,!1)},dA:function(n){return _Ewa.a.h(this.D(),n)&&this.dM.e()===1},cC:function(){},bL:function(){},ja:function(n){return this.dR()?this.dR().e(n):-1},cn:function(){var n=this.dM.u();return this.Z(n)},n:function(n){switch(n){case 1:return this;case 2:return this.eD;case 3:return this.ea;case 4:return this.eb;default:return Diag.a.b(3149847,0,!1,"GridView.PaneContentContaienr: the specified named pane type '{0}' is invalid. Returning the master pane content container.",n),this}},jX:function(){var n=_Ewa.a.i(this.dC),i=this.dI,r,t,u,f;return i.e()&&(i.k(4)&&i.k(3)?(r=_Ewa.a.i(this.n(4).i()),t=_Ewa.a.i(this.n(3).i()),n.x=this.d()?t.x:r.x,n.y=t.y,n.height=r.height+t.height,n.width=r.width+t.width):i.k(4)?(u=_Ewa.a.i(this.n(4).i()),this.d()||(n.x=u.x),n.height=u.height,n.width+=u.width):(f=_Ewa.a.i(this.n(3).i()),n.y=f.y,n.height+=f.height,n.width=f.width)),n},cZ:function(n){return n===2||n===3?this.eF:this.dZ},bG:function(n){return n===2||n===4?this.eE:this.dY},A:function(n){var r=[],t,i,u,f;if(n)for(t=this.bA(null,!1).$$ge();t.$$mn();)i=t.$$cu(),u=i.b(),n.h(u)&&(f=this.dJ.a(i.W),Array.addRange(r,_Ewa.f.D(n,f.X,!1)));return r},jP:function(n){var t,i,o=this.dI.c(new _Ewa.o(n.SelectionTop,n.SelectionLeft,n.SelectionBottom,n.SelectionRight,!1,!1)),r,u,f,e;return _Ewa.bz.i(o,this.dI.b,this.dI.d,r={val:t},u={val:i}),t=r.val,i=u.val,f=n.ScrollableLeftOffset>=this.dI.d,e=n.ScrollableTopOffset>=this.dI.b,_Ewa.kY.c(n,this.ei,this.ej,t,i,f,e)},t:function(n,t,i,r){return new _Ewa.dB(n,this,t,i,r)},bs:function(n,t,i,r){return new _Ewa.oT(n,this,t,i,r)},cj:function(){var n=this.jd();return n?n.a:(n=this.jc(),n?n.a:-1)},bC:function(){var t=this.jd(),n;return t&&(n=this.ka(),n)?t.n(n):this.jc()},bD:function(){var n=this.bC();return n&&(this.dI.n===1||this.dI.n===2)&&(this.dI.i>0&&(n.a=this.dI.l()?this.dI.g:n.a-1),this.dI.h>0&&(n.b=this.dI.l()?this.dI.f:n.b-1)),n},bo:function(){var n=this;return $$sc.b.c(_Ewa.o,$$sc.b.b(_Ewa.jG,_Ewa.o,this.bA(null,!1),function(n){return n.b()}))},bt:function(n,t,i){var r,s,h,u;n&&n.length||(n=this.dD.j().c());for(var e=_Ewa.o.a(t,i,!1),c=this.dJ,l=this.dD.c().d(),o=c.r(),a=o.length,f=0;f<a;++f)if((r=o[f],!(r.r<=0)||r.n.Information.Revision===l)&&(s=!!r.q&&r.q!==2,s&&(h=this.dJ.bl(r),u=this.dJ.s(h),u&&(Diag.a.b(41534177,1,!!u.b(),"GridView.GetCellFromBlockCache: expect blockModelProxy.BlockRange != null. blockModelProxy.blockHash: {0}, isRenderingCellsFromModel: {1}, cacheItem.State: {2}",u.e(),this.dJ.h(),r.q),r.v.c()===n&&u.b()&&u.b().i(e)))))return u.g(e,!0,!1);return null},dq:function(){this.ce()&&this.dE("gvCAFOR",null,null)},cr:function(){this.h().e(new _Ewa.M(0,0))},cm:function(){this.fq=!0;this.dX.o()},bu:function(n){(n||this.fq)&&(this.fq=!1,this.dl(n))},gd:function(n,t,i,r,u){return this.gE(n,t,i,null,u||this.dM.b(),r,!1,!1)},I:function(n,t,i,r,u){if(Diag.a.a(595096450,1,50,"GridView.GotoRangeKeepCurrentSelection: target range={0}, caller={1}",n?n.toString():"null",i),this.js())return Diag.a.a(595072276,1,50,"GridView.GotoRangeKeepCurrentSelection: all the headers are hidden, stopping the goto process"),!0;t=t?60:0;this.ft=!0;var f=r?t:60;return this.hO(null,n,f,null,u,i),this.gd(n,null,t,i,null)},ck:function(n,t,i,r){var f,u,e;return this.m()||this.et?!1:(Diag.a.b(41493469,1,!!n,"GridView.GotoSheetRangeKeepCurrentSelection: sheetRange was null."),Diag.a.b(41493470,1,!!n.SheetName,"GridView.GotoSheetRangeKeepCurrentSelection: SheetName property inside sheetRange was null."),f=this.dD,u=f.f().b(n.SheetName),!u||!!u.i)?(Diag.a.b(41493471,1,!1,"GridView.GotoSheetRangeKeepCurrentSelection: the specified sheet '{0}' either does not exist or it is hidden.",n.SheetName),!1):(e=f.f().a(),e!==u&&u.g(!1),!i&&this.Z(_Ewa.f.b(n)))?!0:this.I(_Ewa.f.b(n),t,r,!0,null)},jU:function(n){var t=this.dI.x(n);return this.X().b(t,!1)},kb:function(n,t){switch(n){case 1:return this.X().f(t);case 2:return t?this.eo().d-1:this.eo().c-1;case 3:return t?this.eo().d-1:this.X().f(t);case 4:return t?this.X().f(t):this.eo().c-1}return Diag.a.b(593780809,0,!1,"GridView.LastVisibleCellByPane: Invalid pane type."),t?1048576:16384},kc:function(n,t,i,r){var u={},f,e;this.dD.D(u);u.FirstRow=u.LastRow=n.ActiveCellTop-1;u.FirstColumn=u.LastColumn=n.ActiveCellLeft-1;f=new _Ewa.jj;f.a=this.jP(n);this.ft?(e=_Ewa.f.b(u),this.hO(f,e,60,null,null,i),this.gd(e,null,t,i,null)):this.o(u,null,null,f,t,i,r,!1,!0,null,!1,!0)},o:function(n,t,i,r,u,f,e,o,s,h,c,l){n||(n=_Ewa.f.a(this.fH()?this.fH().e():_Ewa.o.a(1,1,!1),this.dD),Diag.a.a(51663886,0,50,"GridView.GotoAndUpdateSelection: no range was passed. gotoCaller={0}",f));var a=_Ewa.f.b(n);this.je([a],0,n.SheetName,n.NamedObjectName,t,i,r,u,f,e,o,s,h,c,l)},bE:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){if(!_Ewa.f.u(n,!0)){Diag.a.b(51663888,0,!1,"GridView.GotoAndSetSelection: newSelection is not valid");return}if(t<0||t>=n.length){Diag.a.b(51663889,0,!1,"GridView.GotoAndSetSelection: indexOfActiveRange is not valid");return}this.je(n,t,i,r,u,f,e,o,s,0,h,c,l,a,v)},bb:function(n,t,i,r){_Ewa.bH.a().o("StartEdit",1,i);_Ewa.bH.a().c("StartEdit",-1);var u=this;return _Ewa.g.cs(_Ewa.b.b(this,"GridView.StartEdit",3,new _Ewa.SA(i,!0)),function(){var f=u.e(null),e,o;if(!u.dL.a().f()||!f||!u.dD.Y([f.b()],1)||f.N()&&!u.hL&&u.ga){u.dL.e("");return}u.fo=t;u.m()||(e=u.hP&&i&&i.rawEvent.type==="keypress"?i.rawEvent:null,o=n&&e&&e.key?_Ewa.Dx.a(e.key.charCodeAt(0)):null,u.dL.q(f,n,r,o))},this.dF(),11,$$sc.c.a)},s:function(n){if(!this.m())return!1;var t=this.dL.j()&&!n;return t||this.bP(!0,"GridView.StopEditing"),t},cY:function(n){return!!this.em&&this.em.g(n)},cM:function(){this.eJ.bc()},e:function(n){var t=this.dJ.e(n||this.dM.bh,!1);return t?new _Ewa.jE(t,this):null},cU:function(n,t){return this.dM.bB(n,t)},ch:function(n,t){var i=this;return $$sc.b.b(_Ewa.FD,_Ewa.oS,$$sc.b.a(t.l(n,!1,!1)),function(n){return $$as(_Ewa.oS,new _Ewa.jE(n,i))})},R:function(n){var u=n.d(),r=this.bz(u.e()),t,i;return r?(t=new Sys.UI.Point(n.z(),n.G()),i=r.r(),new _Ewa.W(i.a+t.x,i.b+t.y,n.e(),n.g())):null},Q:function(n){var u,f,i,t,r,e,o;return(Diag.a.b(41162629,1,!!n,"GridVIew.GetCellBounds: expect cellProxy != null."),u=n.d(),f=this.bz(u.e()),!f)?(Diag.a.b(41162630,1,!1,"GridVIew.GetCellBounds: expect gridViewBlock != null, blockHash = {0}.",u.e()),Sys.UI.DomElement.getBounds(this.eI.D())):(i=new Sys.UI.Point(n.z(),n.G()),t=Sys.UI.DomElement.getBounds(f.d()),this.d()?(e=i.x,o=n.p(),r=t.x+t.width-e-o,Diag.a.b(41162631,1,r>=0,"GridVIew.GetCellBounds: expect cellOriginX to be positive.")):r=t.x+i.x,new Sys.UI.Bounds(r,t.y+i.y,n.e(),n.g()))},bR:function(n,t){var h,i,f,e,r,o,s;t.val=null;h=this.eu;i=null;for(var c=h,l=c.length,u=0;u<l;++u)if(f=c[u],e=_Ewa.a.i(f.i()),e&&Common.g.d(e,n)){i=f;break}return i?(r=i.bV(n),!r)?null:(o=r.b,!o)?null:(s=$$as(_Ewa.gg,o),s?s.ba().B(r.a,t):null):null},z:function(n,t,i,r){var h,tt,it,rt,ut,ft,et,o,e,b;if(n=n||this.dM.u(),h=this.fH(),!n||!h||!n.n(h))return null;var c=this.dI,g=this.n(c.c(n.e())),l=this.n(c.c(n.p())),nt=g.q(),a=l.q(),f=null,u=null,w=n.n(nt),s=n.n(a);if(s||c.c(n.p())!==1||(l=this.n(c.c(n.V())),a=l.q(),s=n.n(a)),!i||n.m()&&n.k()?(n.m()^n.k())?(_Ewa.kW.d(this,n,w,s,rt={val:f},ut={val:u}),f=rt.val,u=ut.val):(_Ewa.kW.b(this,n,nt,w,a,s,ft={val:f},et={val:u}),f=ft.val,u=et.val):(_Ewa.kW.c(this,n,w,s,tt={val:f},it={val:u}),f=tt.val,u=it.val),!f||!u){if(o=n.n(h).n(this.O()),o){e=new _Ewa.dB("GridView.GetViewportArea",this,o,1,!0);try{f||(e.c(!0),e.$$rst(),e.$$mn()&&(f=this.R(e.a())));u||(e.c(!1),e.$$rst(),e.$$mn()&&(u=this.R(e.a())))}finally{e&&e.dispose()}}else o=n;!this.q()||f&&u||(b=this.hQ(this.dP),o.h(b)&&this.q().h(b)&&(f=u=_Ewa.IF.a(o,this,new _Ewa.dB("GridView.GetViewportArea2",this,this.q(),2,!0))))}if(!f||!u)return null;var ot=g.x(),st=l.x(),v=this.n(t).x(),y=f.a.b+ot.b-v.b,k=u.a.b+st.b-v.b+u.d()-y,p=f.a.a+ot.a-v.a,d=u.a.a+st.a-v.a+u.c()-p;return r&&(y=_Ewa.t.a(this.dD).c(y),k=_Ewa.t.a(this.dD).c(k),p=_Ewa.t.a(this.dD).c(p),d=_Ewa.t.a(this.dD).c(d)),new _Ewa.W(p,y,d,k)},bp:function(n){var i=this.e(null),t;return i?(t=this.n(this.dI.c(i.b())).x(),n.b>=t.b+_Ewa.a.D(this.dY.i())-1&&n.a>=t.a+_Ewa.a.A(this.dZ.i())-1):!1},cN:function(n){this.id=!0;this.gL=1/n},bB:function(n){return this.dJ.T(n)},bH:function(n){return new _Ewa.cf.f(this,n)},hQ:function(n){return _Ewa.b.d(n,this.ei,this.ej)},dk:function(n,t){this.eI.i(n,t)},bP:function(n,t){var i=String.format("{0}->GridView.EndEdit",t);this.dL.h(n,i,0,null)},gE:function(n,t,i,r,u,f,e,o){var s=new _Ewa.cf.o(this.dD.e().ExcessiveClientViewportLogging,n,t,f,i,u,this.eK.k()),ut=this.fH(),w=this.dD,g,v,nt,h,ft,at,y,tt,it,b,et,rt,c,l,a,lt,d;if(ut)n.h(ut)||(n.bL(ut),t=n.e().f());else return g=w.y().c(),Diag.a.a(51672473,1,50,"GridView.GotoRangeInternal: navigableRange is null; IsNamedObjectView = {0}, InWebPart = {1}, InEmbedView = {2}, IsAppUnloading = {3}, gotoCaller = {4}",g.n(),g.c(),g.d(),this.dD.bn(),f),!1;if(!this.en||n.g(this.en)||n.g(this.eA)||this.fG(),!i)return s.b(),!1;if(this.eK.o(n,u,f),(!this.en||n.g(this.en))&&this.ib(n,t,i),this.h().g()&&(v=this.q())){if(nt=!1,h=o?this.hU(null,null,n):this.hU(r,t,n),s.isLoadedUserSelectionViewportAreaFound=!!h,ft=s.areAllBlocksConsistentAndRendered=this.dJ.o(4,w.j())&&!this.ed,at=this.dJ.o(5,w.j()),!h&&ft){if(y=t||n,tt=this.dI.c(y),tt!==1&&(y.c<this.dI.f||y.d<this.dI.g))return Diag.a.a(593893201,1,50,"GridView.GotoRangeInternal: range {0}, can not be reached, firstFrozenColumn {1} firstFrozenRow {2}",y,this.dI.f,this.dI.g),this.iX(s,"Range is located in the unreachable area of the freezed panes"),!0;if(it=this.hT(tt),it&&it.h(y)){b=new _Ewa.dB("GridView.GotoRangeInternal",this,it,1,!0);try{b.b(y,!0);h=this.z(b.k(),1,!1,!1)}finally{b&&b.dispose()}if(nt=!0,!h)return Diag.a.a(51648534,1,15,"GridView.GotoRangeInternal: range {0}, in pane {1} intersects its loaded range (master pane range is {2}), but is not present",y,tt,v),this.iX(s,"Range is hidden"),!0}else if(!this.eH){if(et=w.d().a().b(!1),this.dT.a()){if(rt=this.eK.l(),rt===this.dD.e().FindRangeThresholdForTelemetry&&Diag.a.a(40665825,0,50,"GridView.GotoRangeInternal: viewport loop detected, findRangeCalls passed the threshold"),rt===this.dD.e().ViewportInfiniteLoopThreshold)Diag.a.a(41174801,0,50,"GridView.GotoRangeInternal: long viewport loop detected, removing all view blocks"),this.ex(),s.removeAllViewBlocks=!0;else if(rt===this.dD.e().ViewportMaxLoopThreshold&&!this.d())return this.fG(),this.ft=!1,this.gI(!1,"Avoiding infinite loop",s),!0;this.fs||this.cV(this.dD.j().c());this.eH=_Ewa.j.C(w.d().a(),_Ewa.f.c(n,this.dD),this.iM,this.iL,null,et);s.findRangeRequest=!0}else Diag.a.a(33863586,0,15,"GridView.GotoRangeInternal: Session is not active, shouldn't send FindRange requests.");var p=v.ca(),ot=n.b-p.b,st=ot?(n.a-p.a)/ot:1,ht=n.a>p.a,ct=n.b>p.b,vt=ht?v.d:v.a,yt=ct?v.c:v.b,pt=Math.floor(n.b+st*(yt-n.b)),wt=Math.floor(n.a+(vt-n.a)/st),k=v.n(new _Ewa.o(p.a,p.b,wt,pt,!0,!1));k&&(k=ht||ct?k.p():k.e(),n=k,s.loadedRangeInterceptSelection=n.toString(),h=this.z(!t||!v.h(t)?n:t,1,!1,!1))}}if(h)if(c=this.h().a(),i&1?(s.horizontalGotoPositioning="Center",l=h.a.a+h.c()/2-c.c()/2):i&64||i&4&&h.a.a<=c.a.a?(s.horizontalGotoPositioning=i&64?"MatchLeft":"Left",l=h.a.a):i&8&&h.b.a>c.b.a&&(!(i&4)||h.b.a>=c.a.a)?(s.horizontalGotoPositioning="Right",l=c.a.a+h.b.a-c.b.a):e&&i&8&&h.a.a<=c.a.a?(s.horizontalGotoPositioning="RightAndCrossPaneSelection",l=0):this.cy()<c.b.a?(s.horizontalGotoPositioning="BlankSpaceAtTheEnd",l=Math.max(0,this.cy()-c.c())):l=c.a.a,i&2?(s.verticalGotoPositioning="Center",a=h.a.b+h.d()/2-c.d()/2):i&128||i&16&&h.a.b<=c.a.b?(s.verticalGotoPositioning=i&128?"MatchTop":"Top",a=h.a.b):i&32&&h.b.b>c.b.b&&(!(i&16)||h.b.b>=c.b.b)?(s.verticalGotoPositioning="Bottom",a=h.b.b-c.d()):e&&i&32&&h.b.b<c.a.b?(s.verticalGotoPositioning="BottomAndCrossPaneSelection",a=0):a=c.a.b,lt=i===32||i===8?n.p():n.e(),d=n?this.dI.c(lt):1,l=d===1||d===3?Math.max(0,l):this.h().d().a,a=d===1||d===4?Math.max(0,a):this.h().d().b,s.scrollLeftDifference=l-this.h().d().a,s.scrollTopDifference=a-this.h().d().b,this.kh(this.en)||l===this.h().d().a&&a===this.h().d().b||(s.isVisibleAreaChanged=!0,this.h().e(new _Ewa.M(l,a))),this.eA){if(this.hX(this.h().a(),r,t,this.eA,nt,!1,!1))return this.eA=null,this.gI(!0,"First visible range was found",s),!0}else if(this.hX(this.h().a(),r,t,this.en,nt,!1,!1)||this.en&&(this.dI.f>this.en.c||this.dI.g>this.en.d))return this.fG(),this.ft=!1,this.gI(!0,"Range was found",s),!0}return s.b(),!1},iX:function(n,t){this.fG();this.ft=!1;this.eA=null;this.gI(!0,t,n)},jk:function(n,t){var r="",u,i,h,f,e,o,s;if(_Ewa.R.a(n)||(r=t?t.q:null,u=!!n&&!!n.RequestTelemetryData,this.fZ.g(r,n.StateId,u?n.RequestTelemetryData.EcsOperationDuration:0,u?n.RequestTelemetryData.EcsRequestDuration:0,u?n.RequestTelemetryData.WfeRequestDuration:0)),!_Ewa.R.a(n)&&n.Result){if(this.dD.isChangeGateEnabled("OfficeVSO:4270805_CalctsMergeCells2")){if(!this.dT.o()){Diag.a.a(590210590,1,50,"GridView.OnSetCellOperationWebMethodSuccess: No active sheet to update");return}if(i=t,h=this.dJ.B(i,this.dT.o().a),h&&$$sc.b.Ct(_Ewa.ua,h)>1){Diag.a.a(590435799,1,50,"GridView.OnSetCellOperationWebMethodSuccess Merge Cell ({0},{1})-({2},{3}) spans across blocks - ignore immediate response",i.a,i.b,i.d,i.c);return}}if(f=this.dJ.e(t,!1),f){if(e=this.dD.p().b("UserAction","SetCellImmediate"),e.d(),o=f.d().o(),s=n.StateId,o!==-1&&s!==-1&&o>=s){Diag.a.a(38885153,1,50,"GridView.OnSetCellOperationWebMethodSuccess Result is older than cache. blockRevision={0} resultRevision={1}",o,s);return}var a=_Ewa.B.b(this.dT.o()),l=!1,c=n.Result;isNullOrUndefined(c.LatestClientInstantaneousChangeRequestId)||isNullOrUndefined(this.fE)||!_Ewa.e.b(this.fE,c.LatestClientInstantaneousChangeRequestId,!1)?Diag.a.a(594405452,1,50,"GridView.OnSetCellOperationWebMethodSuccess Result {0} does not match last SetCell {1} - ignoring to prevent flickering",c.LatestClientInstantaneousChangeRequestId,this.fE):l=f.cH(n,r,a);l&&_Ewa.b.a(this.dD).w().f(r,_Ewa.bj.f,!0);_Ewa.ks.a(e);_Ewa.z.a().c(e.c(),n.clientStopwatchId,_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0)}}},kJ:function(n,t,i){this.jk(n,t,i);var r=this;this.dD.b().c(_Ewa.cH,211,function(n){n.d(_Ewa.ClientStringManager.a().a(1542),"assertive")})},cc:function(n){this.id&&(n.x=n.x*this.gL|0,n.y=n.y*this.gL|0)},ba:function(n,t,i,r,u){var at,o,k,v,l,s,e,h,a,y,c,ft,g,bt,ht,ct,lt;if(!t){Diag.a.b(51663628,0,!1,"GridView.SetCell: editRange is null! canceling action.");return}if(u&&(at=String.format("GridView:SetCell, richValueParameterType, {0}, SourceRange.ToString(), {1}, PulloutRichColumnSourceIndex, {2}",u.ParameterType,u.SourceRange,u.PulloutRichColumnSourceIndex)),o=n.Text,h=this.dD.p().b("UserAction","SetCellInstantaneous"),h.d(),a=this.dD.p().b("UserAction","SetCellInstantaneousFrame"),a.d(),_Ewa.ks.a(a),this.fZ.e(0,h.c(),""),i?(l=this.dM.a(),s=this.dM.b(),y=s):(l=s=t,y=l.e()),e=this.e(y),this.dD.Y([l],1)){var f=this.dD,vt=new _Ewa.bP(f.f()),d=_Ewa.bK.b(o),ut=_Ewa.e.s(o),yt=!o||!o.length;if(k=!d&&ut&&!this.eG()&&vt.a(128),c=null,ft=this.fp.a(),e&&_Ewa.ck.a(ft)){g=new _Ewa.bH.b("ShowInstantaneousData",2);try{c=this.fp.a().a().f(f,e,n,k,a.c(),_Ewa.p.J(f),-1,h.c(),0,!1)}finally{g&&g.dispose()}c.a&&(e=this.e(y))}else Diag.a.a(33863587,1,50,"GridVIew.FormatCellsAction: ShowInstantaneousDataEntryOnCell didn't occur.");h.a();var et=_Ewa.f.c(s,f),nt=_Ewa.f.d(l,f),p=f.d().a().b(!!c),w=null;if(k){c&&(this.fE=null);var ot=_Ewa.f.d(l,f),st=_Ewa.be.d(o,!0),kt=this,pt=function(n,t){return f.M(),_Ewa.j.g(f.d().a(),ot,o,st,!1,i===1,r,n,t,s,p,null)},dt=this,wt=function(){return new _Ewa.ni(ot,o,st)};v=new _Ewa.bh(526,0,pt,0,wt)}else{c&&(this.fE=p.ClientRequestId);var b=null,tt=-1,it=-1,rt=0;e&&e.a()&&(b=this.dJ.bk(e.a().d().e()),tt=b.b.X*this.ei,it=b.f()*this.ei,rt=b.b.PaneType);bt=this;ht=function(){return new _Ewa.pM(nt,o)};w=this.dD.p().a("UserAction","SetCellUserAction");v=_Ewa.mx.a(f)&&_Ewa.mx.a(f).a(s)?new _Ewa.bh(527,0,this.cK(et,n,nt,tt,it,rt,i,r,s,p,w,e,u,h.c()),0,ht):new _Ewa.QF(this,et,n,s,nt,tt,it,rt,i,r,p,w,e,u,h.c())}_Ewa.cf.p(c,h,a,w);ct=d&&_Ewa.e.c(o,"!",!0);lt=this.dD.a(855)?_Ewa.bd.D:_Ewa.bd.C;_Ewa.bG.a(f).a(lt,{editRange:t.toString(),isFormula:d,isLink:ut,isEmptyText:yt,isSheetRef:ct,IsInFormulaBarEdit:this.be(),isRichText:!!e&&e.a().v()},null);v.v=1;f.h().a(v,null)}},cK:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){var y=this.dD,d=_Ewa.B.h(y.j(),this.dT),w="",b=-1,k=-1;l?(this.dJ.h()||(l.a()||(l=this.e(l.b())),l&&$$as(_Ewa.bJ,l.a())&&(w=l.a().eE())),l.a()&&(b=l.a().c(),k=l.a().F())):Diag.a.a(23633995,0,50,"GridView.BuildInvokeSetCellWebMethodDelegate: (SetCell) Sending empty string as instantaneous html and -1 as ifmt since the FormattedCell is null");var g=this.dD.b().a(_Ewa.cv,268,!1),nt=!g||!g.b(),p=this;return function(l,g){var it=null,rt,tt;return it=new _Ewa.FF(s,v),y.M(),rt=!p.dD.isChangeGateEnabled("OfficeVSO:4120980_SetCellNullAsEmpty")||!isNullOrUndefined(t.Text),Diag.a.b(592556546,0,rt,"GridView.BuildInvokeSetCellWebMethodDelegate: (SetCell) changes null value to empty string"),tt=null,tt=p.dD.isChangeGateEnabled("OfficeVSO:4203010_ScreenReaderOnGridPullout2")&&a&&(a.ParameterType===4||a.ParameterType===2)?p.iQ:p.iP,p.dD.a(855)?_Ewa.j.T(y.d().a(),d,n,t,i,r,u,f,e,o,y.e().RenderingOptions,y.q().id,y.c().d(),_Ewa.n.a(l,tt),g,it,h,c,w,a,y.bp(),b,k,nt):_Ewa.j.R(y.d().a(),d,n,t.Text,i,r,u,f,e,o,y.e().RenderingOptions,y.q().id,y.c().d(),_Ewa.n.a(l,tt),g,it,h,c,w,a,y.bp(),b,k,nt)}},gj:function(n){var t=_Ewa.FA.prototype.gj.call(this,n),u=_Ewa.O.a(this.dD),e,i;if(u)for(var f=u.b(),o=f.length,r=0;r<o;++r)e=f[r],(i=e.bH())&&(t.a=n?Math.min(i.a.a,t.a):Math.max(i.b.a,t.a),t.b=n?Math.min(i.a.b,t.b):Math.max(i.b.b,t.b));return t},hc:function(n){var u,e;if(this.jh(),n)_Ewa.FA.prototype.hc.call(this,n);else{for(var r=this.fI,o=r.length,t=0;t<o;++t)u=r[t],u.eP(this.h().h().x);for(var f=this.fJ,s=f.length,i=0;i<s;++i)e=f[i],e.ey(this.h().h().y)}},fc:function(n){var r;this.hZ();this.ie(!this.ed);for(var i=this.eY,u=i.length,t=0;t<u;++t)r=i[t],r.fc(n);_Ewa.FA.prototype.fc.call(this,n);(this.dD.a(115)||this.dD.isChangeGateEnabled("OfficeVSO:4182253_LogEstimatedBlockTimeInDom2"))&&this.dE("gvVC",null,null)},db:function(n){var t=this;_Ewa.lH.b(function(){t.dE("gvGVBR",null,n)},this.dD.i())},da:function(n){this.dE("gvGVBR",null,n)},cA:function(n,t,i){return new _Ewa.gg(n,t,i,this)},hh:function(n,t){var i=this.dD,y,d,r,u,l,a,v,w,f,e,o,nt;if(i.j()){this.dT.a()||!this.dT.O()||_Ewa.G.a(i).r()||(y=i.p().a("Task","BlockingGridviewOnSessionless"),_Ewa.G.a(i).n(!0,"BlockingGridviewOnSessionless",null),Diag.a.a(24469582,0,50,"GridView.OnBlockCacheItemChanged Gridview was blocked during sessionless"),d=this,_Ewa.g.cw(this.dT.P(),function(){y.a()},this.dF(),11));r=$$as(_Ewa.dp,this.dD.p().b("DOMUpdate",this.eV()));r.d();u=window.performance;this.dI.q&&(this.ff=$$as(_Ewa.dp,this.dD.p().b("DOMUpdate",this.eV())),this.ff.d(),_Ewa.cf.c=Common.A.a().a,this.ev&&u.mark("GridView.OnBlockCacheItemChanged firststart"));this.ed&&this.eQ.c(t.a.b);this.ev&&u.mark("GridView.OnBlockCacheItemChanged start "+t.a.b);this.dI.q=!1;this.fv(i.j().b,!0,null,!1);for(var p=this.eY,g=p.length,c=0;c<g;++c)l=p[c],this.dI.k(l.dN)&&(l.hh(n,t),this.ed&&this.eQ.b(t.a.b,t));if(_Ewa.gN.prototype.hh.call(this,n,t),this.ed||this.hN(t.a.a.n),a=_Ewa.O.a(this.dD),a&&!this.ed&&(v=t.a.a.n.FloatingObjectsMetaData,w=!_Ewa.eX.a(this.dD,v)||_Ewa.eX.b(this.dD,v,t.a.a.K,t.a.a.G),a.g(t.a,w)),t.a.a.q===5&&this.eh&&(f=this.fi)&&(o=this.L(t.a.b),o&&(e=o.b())&&this.ed)){this.eQ.b(t.a.b,t);f=f.c();var b=f.a,h=this.eh.p(),s=null,k=t.a.a.n.Information.BlockCachePosition;e.c>=h.c&&e.b<h.c&&(b.X=k.X,s=o.br().b,this.fj.a=s.a);e.d>=h.d&&e.a<h.d&&(b.Y=k.Y,s=s||o.br().b,this.fj.b=s.b);this.jp(f)}this.fn?(nt=this,r.g(function(){},!1)):r.a();_Ewa.cf.a("GridView.OnBlockCacheItemChanged",this.dD.e().UserSessionId,this.dD.e().GridPerformanceImprovementType,t.a.b,r.b());this.ev&&(u.mark("GridView.OnBlockCacheItemChanged end "+t.a.b),u.measure("GridView.OnBlockCacheItemChanged","GridView.OnBlockCacheItemChanged start "+t.a.b,"GridView.OnBlockCacheItemChanged end "+t.a.b))}},dm:function(n){this.fh=$$as(_Ewa.dp,this.dD.p().b("DOMUpdate",this.eV()));this.fh.d();this.fa={};this.fa.a=this.dD.e().UserSessionId;this.fa.b=_Ewa.cf.c;this.fa.c=n;this.fa.d=this.dD.e().GridPerformanceImprovementType},dp:function(){this.fo=this.fo===1?0:1},dl:function(n){var t=new _Ewa.bP(this.dD.f());if((n||this.dM.bn||!this.dD.bg())&&!t.f()){if(!this.eG()&&this.em.d(this.dD.j()))return;this.dX.i()}},bA:function(n,t){for(var s,u,h,f,i,e=[],o=this.eu,c=o.length,r=0;r<c;++r)for(s=o[r],u=s.$$ge();u.$$mn();)for(h=u.$$cu(),f=h.$$ge();f.$$mn();)if(i=f.$$cu(),i.b()&&(n?n(i):!0)&&(e.push(i),t))break;return $$sc.b.a(e)},bz:function(n){for(var u,i,r=this.eu,f=r.length,t=0;t<f;++t)if(u=r[t],i=$$as(_Ewa.jG,u.L(n)),i)return i;return Diag.a.a(41283868,0,50,"GridView.GetGridViewBlockFromHashCodeAllPanes: Could not find view block: {0}. Returning null.",n),null},cL:function(n){return new _Ewa.FB(n,this)},bd:function(n){return $$sc.b.g(this.ld(n),null)},dn:function(){this.ea&&this.ea.el()!==this.el()&&(Diag.a.a(23614747,1,50,"GridView.SyncFreezePaneScrolls: Horizontal scroll is not in sync with master's ScrollLeft"),this.ea.eP(this.el()));this.eb&&this.eb.ef()!==this.ef()&&(Diag.a.a(23614748,1,50,"GridView.SyncFreezePaneScrolls: Vertical scroll is not in sync with master's ScrollTop"),this.eb.ey(this.ef()))},bF:function(n,t){var u=this.dI.c(n),i=this.hT(u),r=this.hQ(this.dP);return(!!i&&i.h(n)||!!r&&r.h(n))&&this.dJ.o(t,this.dD.j())},Z:function(n){return this.hX(this.h().a(),null,n,n,!1,!0,!0)},jg:function(n,t){var i=this.hT(n);if(!i)return!0;switch(n){case 3:return i.a===t;case 4:return i.b===t}return!0},cV:function(n){var t=this.dD.d().a().b(!1);this.dT.a()&&(this.dD.T()===n?Diag.a.a(590439776,1,50,"GridView.GetSheetProcessedDataByName: requesting SheetProcessedData for the active sheet"):Diag.a.a(42869012,1,50,"GridView.GetSheetProcessedDataByName: requesting SheetProcessedData for sheet which is not the active sheet at the moment"),this.fs=_Ewa.Ix.a(this.dD.d().a(),n,this.iO,this.iN,n,t))},cl:function(){this.gg||(window.requestAnimationFrame(this.hJ),this.gg=!0)},io:function(n,t){if(this.dD.isChangeGateEnabled("OfficeVSO:4185972_GetHeaderBlockDataFromHeaderBlock")){var r=t?this.cZ(n.PaneType):this.bG(n.PaneType),u=this.dJ.t(this.dD.j(),n),i=r.L(u);if(i)return i.o()}return this.iY(n,t)},iY:function(n,t){var f,r,e,o=this.jU(n.PaneType);t?(f=n.Y,r=28,e=o.d):(f=n.X,r=30,e=o.c);var i=f*r+e,s=this.kb(n.PaneType,t),u=Math.min(i+r-1,s);if(Diag.a.b(593780808,0,i<=u,"GridView.GetHeaderBlockData: cellStart ({0}) > cellEnd ({1}), blockPosition.X = {2}, blockPosition.Y = {3}, blockPosition.PaneType = {4}, isRow = {5}",i,u,n.X,n.Y,n.PaneType,t),u>=i)try{return this.X().n(i,u,t)}catch(h){_Ewa.ULSError.a(h,"GridView.GetHeaderBlockData",!1)}return this.jy().n(i,i+r,t)},gK:function(n,t,i){var r=null;return r=i?this.eD&&this.eD.K().o(n)?this.eD:this.eb:this,!i&&t&&(n.a=n.a+_Ewa.Z.c(this.dC,this.d(),this.el()),n.b=n.b+this.ef()),Diag.a.b(17880518,1,!!r,"GridVIew.CellFromViewportPosition: container is null, DOM is corrupted."),r?r.bK(n):null},gC:function(n,t,i){var f,r,u;if(t)if(f=t.r(),r=new Sys.UI.Point(n.a-f.a,n.b-f.b),!i&&t.f().d()&&(r.x=t.x()-r.x),this.dJ.h()){if(u=this.dJ.s(t.a()),Diag.a.b(40749216,1,!!u,"GridVIew.CellFromViewportPosition: blockModelProxy is null."),u)return u.p(r)}else return t.i(r);return null},ex:function(){var i;_Ewa.FA.prototype.ex.call(this);for(var t=this.eY,r=t.length,n=0;n<r;++n)i=t[n],i.ex()},il:function(n,t,i){var r=i===1||i===4?this.eo().c-1:0,u=i===1||i===3?this.eo().d-1:0,e=this.dR().i(n+u,t+r,!1),o=this.dR().i(u,r,!1),f=e.e(o);return Diag.a.b(42252175,1,f.f(),"CellOffsetData.Substract: unexpected negative values in CellOffsetData"),f},iD:function(n){var t=this.es,f=t.b?this.fm.c():t.a.a+this.fX,e=t.c?this.fm.d():t.a.b,o=this.ec,s=this.gj(!1),h=Math.max(s.a,f),p=Math.max(s.b,e),i,c,a,y;this.dY.eU(this.ea.eU(this.eU(h)));i=this.dD.c().c();this.fX>0&&(i.d()||i.e())&&(c=2,this.dC.style.overflow=Math.abs(h-_Ewa.a.A(this.dC))<c&&p<_Ewa.a.D(this.dC)?"hidden":"auto");for(var l=this.fI,w=l.length,r=0;r<w;++r)a=l[r],a.gn(new _Ewa.M(f,0),new _Ewa.M(o.a,0),!0,!1,!1,n);for(var v=this.fJ,b=v.length,u=0;u<b;++u)y=v[u],y.gn(new _Ewa.M(0,e),new _Ewa.M(0,o.b),!0,!1,!1,n);_Ewa.mE.prototype.iD.call(this,n)},ir:function(n){_Ewa.FA.prototype.ir.call(this,n);var a=n.c.a,v=n.b.a,o=!!(n.a&4),s=o||!!(n.a&1),h=!!(n.a&8),c=h||!!(n.a&2),t=_Ewa.bo.a(c?v.X:a.X,s?v.Y:a.Y,this.dN),i=this.L(this.dJ.t(this.dD.j(),t));if(i){this.kY(c,s,i);var u=this.dW.c(),e=u.a,f=this.ew.f(),l=!1,r=this.fi.a,y=e.X<Math.max(t.X,c?0:r.X),p=e.Y<Math.max(t.Y,s?0:r.Y);(y||p)&&(y&&(e.X=Math.max(t.X,r.X),f.c=t.X>r.X?i.b().c:this.eh.c),p&&(e.Y=Math.max(t.Y,r.Y),f.d=t.Y>r.Y?i.b().d:this.eh.d),l=!0);(h||o)&&(h&&(f.c=i.b().c,u.a.X=t.X),o&&(f.d=i.b().d,u.a.Y=t.Y),l=!0);l&&(this.ia(f),this.hd(u),this.eC(u,2,!0));this.eG()?this.gn(this.es.a,null,!0,!1,!1,!0):this.go(this.es.a,null,!0)}},iq:function(n,t,i){_Ewa.FA.prototype.iq.call(this,n,t,i);this.dY.r(n.l,t,i);this.ea.u(n.l,t,i)},hb:function(n){_Ewa.FA.prototype.hb.call(this,n);var t=n.l;this.dZ.hj(t);this.eb.hj(t)},ip:function(n,t,i){var f;_Ewa.FA.prototype.ip.call(this,n,t,i);for(var u=this.eY,e=u.length,r=0;r<e;++r)f=u[r],f.ek(n,t,i)},hg:function(){_Ewa.gN.prototype.hg.call(this);this.dZ.eL(this.cz());this.eb.eL(this.cz());this.dE("gvVBPEC",null,null)},fb:function(){_Ewa.FA.prototype.fb.call(this);this.dY.eM(this.ea.eM(this.bJ()));this.dE("gvVBPEC",null,null)},is:function(){var n=window.performance,i,r,rt,e,t,f,s,h,c,l,a,k,g,tt,it,st,ht,ct;if(this.ev&&n.mark("GridView.OnBlockCacheConsistent start"),i=$$as(_Ewa.dp,this.dD.p().b("DOMUpdate",this.eV())),i.d(),this.ed){for(r=this.eQ.i(),rt=this,r=$$sc.b.l(String,String,r,function(n){return n}),e=r.$$ge();e.$$mn();){t=e.$$cu();f=this.eQ.a(t);for(var p=this.eY,ut=p.length,o=0;o<ut;++o)s=p[o],h=s.L(t),h?h.bl():s.dN===f.a.a.n.Information.BlockCachePosition.PaneType&&Diag.a.a(20259406,0,50,"Block {0} is not connected to its container",t);c=this.L(t);c?c.bl():1===f.a.a.n.Information.BlockCachePosition.PaneType&&Diag.a.a(20259407,0,50,"Block {0} is not connected to its container",t);this.hN(f.a.a.n)}if(this.ie(!0),l=_Ewa.O.a(this.dD),l)for(a=r.$$ge();a.$$mn();){var ft=a.$$cu(),u=this.eQ.a(ft),w=u.a.a.n.FloatingObjectsMetaData,b=!_Ewa.eX.a(this.dD,w)||_Ewa.eX.b(this.dD,w,u.a.a.K,u.a.a.G);l.g(u.a,b);b&&this.dJ.p(u.a.a,!0)}this.gf(null,Sys.EventArgs.Empty)}this.dI.q=!0;!this.dJ.i()&&this.dJ.g()&&_Ewa.U.a().Y();k=this.ed;this.ed=!1;this.jR();this.jh();_Ewa.FA.prototype.is.call(this);_Ewa.cj.a().h("OnBlockCacheConsistent");this.ev&&n.mark("GridView.OnBlockCacheConsistent startscroll");for(var d=this.fI,et=d.length,v=0;v<et;++v)g=d[v],g.eP(this.el());for(var nt=this.fJ,ot=nt.length,y=0;y<ot;++y)tt=nt[y],tt.ey(this.ef());this.ev&&(n.mark("GridView.OnBlockCacheConsistent endscroll"),n.measure("GridView.OnBlockCacheConsistent","GridView.OnBlockCacheConsistent startscroll","GridView.OnBlockCacheConsistent endscroll"));this.gh(this.dD.j(),!0,!1);this.lb();this.jt();this.dD.isChangeGateEnabled("OfficeVSO:4248277_MeasureCachedViewportStaleness")&&this.fw&&(this.fw.j(this.q(),this.dD.j().c())&&this.fw.i(this.gF,this.dD.c().z(),!1,this.bC()),this.fw.h(),this.fw=null);this.ed=k&&!this.dJ.m();this.ed||(this.kR(),this.eQ=new($$sc.v.$$(_Ewa.js)));this.gs(!0);it=_Ewa.gC.a(this.dD);it.g();this.ev&&(n.mark("GridView.OnBlockCacheConsistent end"),n.measure("GridView.OnBlockCacheConsistent","GridView.OnBlockCacheConsistent start","GridView.OnBlockCacheConsistent end"),n.measure("GridView.UpdateCycleCompleted","GridView.OnBlockCacheItemChanged firststart","GridView.OnBlockCacheConsistent end"),n.getEntriesByName("FreezePanes request sent")&&n.getEntriesByName("FreezePanes request sent").length>0&&n.measure("FreezePanesDuration","FreezePanes request sent","GridView.OnBlockCacheConsistent end"));this.fn?(st=this,i.g(function(){},!1)):i.a();_Ewa.cf.a("GridView.OnBlockCacheConsistent",this.dD.e().UserSessionId,this.dD.e().GridPerformanceImprovementType,"NA",i.b());this.fh&&(this.fn?(ht=this,this.fh.g(function(){},!1)):this.fh.a(),this.fa.f=this.fh.b(),_Ewa.z.a().a(13,this.fa,!1),this.fh=null,this.fa=null);this.ff&&(this.fn?(ct=this,this.ff.g(function(){},!1)):this.ff.a(),_Ewa.cf.a("GridViewOperationUpdateCompleted",this.dD.e().UserSessionId,this.dD.e().GridPerformanceImprovementType,"NA",this.ff.b()),this.ff=null);this.gF=this.gF&&this.dD.c().d()===-1},ix:function(n,t){_Ewa.gN.prototype.ix.call(this,n,t);Common.a.g||this.hN(null)},kr:function(n,t){var i=t.a.a.n.FloatingObjectsMetaData,r=!_Ewa.eX.a(this.dD,i)||_Ewa.eX.b(this.dD,i,t.a.a.K,t.a.a.G);r&&!this.ed&&this.dJ.p(t.a.a,!0)},kt:function(){this.dq()},ld:function(n){var t=this;return this.bA(function(i){return!t.eQ.c(i.a())&&n.h(i.b())},!0)},je:function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y){var b,w,k,p;if((!this.dD.a(458)||h)&&n.length!==1){Diag.a.b(51663890,0,!1,"GridView.GotoAndUpdateOrSetSelection: Invalid parameters. Can't update the selection with more than one range, except for setting a new selection.");return}if(o=o?60:0,e&&s&&(s+="_Vacs"),b=this.dD,w=n[t],!this.eG()||!r||!r.length){if(!(!i||!i.length)&&(p=b.f().b(i),p)){if(!!p.i)return;(c||this.fe)&&(this.ib(w,u,o),p.x(Common.L.c(n)),p.s=t,p.w(u?u.f():w.e().f()),this.fe=c);p.g(v)}}else k=b.n().b(r),k&&k.g(v);if(Diag.a.a(50434385,1,50,"GridView.GotoAndUpdateOrSetSelection: target range={0}, caller={1}, viewportAndCanvasState={2}",w.toString(),s,e?"not null":"null"),this.js()){Diag.a.a(595072275,1,50,"GridView.GotoAndUpdateOrSetSelection: all the headers are hidden, stopping the goto process");return}this.hO(e,a||w,o,f,null,s);this.fe||f||!this.eA?this.dD.a(458)&&!h?this.dM.P(n,t,u,o,l,s,!1,!v,y):this.dM.f(n[0],u,o,h,l,s,!1,!v,y):Diag.a.a(51663891,0,50,"GridView.GotoAndUpdateOrSetSelection: select is not called. gotoCaller = {0}",s)},gI:function(n,t,i){i.gotoEnded=!0;i.isSuccess=n;i.convergenceScenario=t;i.b();this.fs=null;this.eK.p(t);this.eH&&(this.dD.d().a().h(this.eH.d),this.eH=null);var r=this.dJ.o(4,this.dD.j());this.dE("gvGE",new _Ewa.Ib(n,r),null)},kV:function(n,t){Diag.a.a(590439775,1,50,"GridView.ScheduleGetSheetProcessedDataPrefetch: potential SheetProcessedData operation was executed");var i=this.dD.e().GetRangeContentPrefetchDelayInMs,r=this;$$sc.a.b(i).CW(function(){r.hS(n,t)})},hS:function(){this.dD.j()&&this.cV(this.dD.j().c())},kq:function(n,t){var i=t.a,r=t.b;_Ewa.R.a(i)||(i.SheetProcessedData&&i.SheetProcessedData.N?this.hW(i.SheetProcessedData,i.SheetProcessedData.N):r.q&&(Diag.a.a(589969153,1,15,"GridView.OnBeforeWebMethodSuccessCallback: {0}",i.SheetProcessedData?"The sheet name is null":"SheetProcessedDataResult is null"),this.hS(null,null)))},kA:function(n,t){var i,r;if(Diag.a.a(42869013,1,50,"GridView.OnGetSheetProcessedDataSuccess"),_Ewa.R.a(n)){Diag.a.a.apply(null,[37582424,1,50,"GridView.OnGetSheetProcessedDataSuccess: Errors: {0}."].concat(n.Errors));this.fs=null;i=_Ewa.h.g(n.Errors,[-1100324317,800805146],"GridView:OnGetSheetProcessedDataSuccess");this.dT.q(i);return}r=t;this.hW(n.Result,r)},kz:function(n){Diag.a.a(42869014,1,50,"GridView.OnGetSheetProcessedDataFailure");this.fs=null;var t=n.b,i=_Ewa.V.a(t);i&&_Ewa.h.c(i)&&Diag.a.a(37582425,1,50,"GridView.OnGetSheetProcessedDataFailure: handling http error: {0}.",t.c)},kZ:function(n,t){this.jD(n,t);this.dD.cu(n)&&this.fv(this.dD.j().b,!0,null,!0)},hW:function(n,t){this.kZ(t,n);this.dD.cu(t)&&this.dE("gvSPDU",null,null)},js:function(){return this.jN()||this.dD.bn()},jN:function(){return!!this.dR()&&(this.dR().e(!0)<0||this.dR().e(!1)<0)},hX:function(n,t,i,r,u,f,e){var o=f?i||r:this.en,s=this.hU(t,i,r),a=n.i(s),h=!1,c=!1,l=!1;return this.dI&&(h=this.dI.j(o,3)&&n.l(s),c=this.dI.j(o,4)&&n.m(s),l=this.dI.j(o,2)),this.bF(o,e?4:1)&&(a||h||c||l||u)},ki:function(n){var t=this.ec?this.ec:new _Ewa.M(0,0),i=this.fk(n).b;return i.a<=t.a&&i.b<=t.b},cW:function(){var t=this.bC(),n;return t?(n=_Ewa.bz.b(t,this.dR(),this.eo(),!1),new _Ewa.W(n.a,n.b,this.h().a().c(),this.h().a().d())):this.h().a()},kj:function(n,t){var r,u,i,f,e;return n.n(this.jV())?(r=this.dD.a(745),u=this.dD.isChangeGateEnabled("OfficeVSO:3952535_ScrollActiveCellIntoViewOnKeyboardUp")&&this.dD.P(),(r||u)&&((i=this.dD.v().l(),f=_Ewa.i.d(this.dC,this.dD.q(),this.d(),this.dD.isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!0,!1),r&&t&&t.a&&this.eg.j(n,i,f,null))||(e=i.e(),u&&this.eg.k(n,e,i,f,null))))?!0:!1:!0},hY:function(n,t,i){_Ewa.cj.a().a(n);Diag.a.a(356253897,1,50,"GridView.LogViewportAdjustment: caller={0}, isViewportAndCanvasState={1}, isUsingSheetProcessedData={2}",n,t,i)},hO:function(n,t,i,r,u,f){var o,s,w,b,y,c,l,k,d,e,g,a,nt,tt;if(n)this.hY(f,!0,!!this.dR()),this.jE(n);else if(this.kj(t,u))if(o=null,s=null,_Ewa.bz.c(t,this.dR(),this.eo(),w={val:o},b={val:s}),o=w.val,s=b.val,y=!1,o&&s&&this.eT(s.b,!0)&&this.eT(s.a,!1))this.h().k(k={val:c},d={val:l}),c=k.val,l=d.val,e=null,r&&(e=this.dR().b(r.bK(),!1),e=e?e.e(this.eo()):null,e&&!e.f()&&(Diag.a.a(595068751,0,15,"AdjustViewBySelectionRange: viewportTopLeftCellOffsetData is invalid"),e=null)),g=new _Ewa.W(o.a,o.b,s.a-o.a,s.b-o.b),a=_Ewa.bz.q(g,this.cW(),i,this.dR(),this.eo(),c,l,e),a=this.jn(t,u,new _Ewa.W(a.a,a.b,c,l)),this.cJ(a,c,l,f);else{var it=_Ewa.bz.g(t.e(),this.dI.b,this.dI.d,this.ej,this.ei,this.dR()),p=it[0],h=this.eG()?this.fk(p).a:this.fk(p).b,v=null;this.eT(h.a,!1)&&this.eT(h.b,!0)&&(this.lc(p,nt={val:v}),v=nt.val,y=!0);switch(i){case 32:case 16:h.a=this.h().d().a;break;case 4:case 8:h.b=this.h().d().b}h=this.jn(t,u,new _Ewa.W(h.a,h.b,this.h().a().c(),this.h().a().d()));this.hY(f,!1,!1);this.h().e(h);y&&(tt=new _Ewa.bo(0,0,v.Y,v.X,1),this.eC(tt,1,!1))}},jn:function(n,t,i){var r=i.a,e=this.dD.a(745),o=this.dD.isChangeGateEnabled("OfficeVSO:3952535_ScrollActiveCellIntoViewOnKeyboardUp")&&this.dD.P(),u,f;return(e||o)&&(u=this.dD.v().l(),f=_Ewa.i.d(this.dC,this.dD.q(),this.d(),this.dD.isChangeGateEnabled("OfficeVSO:4071894_IeAndEdgeMisplacedEditorInRtlEnabled"),!0,!1),e&&t&&t.a&&(r=_Ewa.oW.b(this,n,t,i,this.im(),u,f)),o&&(r=_Ewa.oW.c(this,n,r,u,f))),r},lc:function(n,t){var r=this.fl.children.length,u=this.jW(),o=Math.floor(u/2),s=Math.floor(r/2),f=Math.max(n.X-o,this.dW.b.X),e=Math.max(n.Y-s,this.dW.b.Y),h=Math.min(f+u,this.dW.a.X),c=Math.min(e+r,this.dW.a.Y),i=new _Ewa.bo(e,f,c,h,1);t.val=_Ewa.bo.a(i.a.X,i.a.Y,this.dN);this.dU&&!i.e(this.dU)&&(this.gl(null),this.gk(i),this.eC(i,1,!1),this.fN(i.b.X,i.a.X,i.b.Y,i.a.Y,!1))},jW:function(){for(var t=this.$$ge(),n;t.$$mn();)return n=t.$$cu(),n.n-n.o+1;return Diag.a.a(50373573,0,15,"GridView.GetBlocksCountInFlow: there are no flows exist"),1},lb:function(){var e,t,o,i,s,r,h,u,c;if(this.dD.bX(8)){for(var f=this.eY,l=f.length,n=0;n<l;++n)for(e=f[n],t=e.$$ge();t.$$mn();)for(o=t.$$cu(),i=o.$$ge();i.$$mn();)s=i.$$cu(),_Ewa.a.y(s.dC);for(r=this.$$ge();r.$$mn();)for(h=r.$$cu(),u=h.$$ge();u.$$mn();)c=u.$$cu(),_Ewa.a.y(c.dC)}},kY:function(n,t,i){var f=n||t?i.br().b:null,r=this.es,u=new _Ewa.kX;u.b=!n&&r.b;u.c=!t&&r.c;u.a=new _Ewa.M(n?f.a:r.a.a,t?f.b:r.a.b);this.es=u},jt:function(){if(this.eA){var n=this.gd(this.eA,null,192,_Ewa.C.h,null);n&&(this.eA=null)}this.en&&this.gd(this.en,this.hV,this.gc,_Ewa.C.h,null)},kR:function(){var n=!!this.en,t;n&&Diag.a.a(23385668,0,50,"GridView.RaiseAllBlocksUpdatedEvent: GotoRange is still ongoing");t=new _Ewa.BQ(this.eQ.i(),n);this.dE("gvAABU",t,null)},fG:function(){this.eH&&(this.dD.d().a().h(this.eH.d),this.eH=null);this.ib(null,null,0)},ib:function(n,t,i){this.en=n?n.f():null;this.hV=t?t.f():null;this.gc=i},hT:function(n){var i=this.jY(n),t;return i&&(t=i.q(),t)?t:(Diag.a.b(19974020,1,!!this.O(),"GridVIew.GetPaneLoadedRange: FullLoadedRange is null."),this.O())},kI:function(n,t){var r,f,i,u,e;if(this.dI&&this.dI.e()&&(t.b||t.a&&!t.b)){for(r={},r.IsActiveAfterTotallySilent=t.b,f=this.bA(null,!1).$$ge();f.$$mn();)i=f.$$cu(),u={},u.BlockRevision=i.o(),i.H()&&i.H().childNodes&&(u.RowsContainer=i.H().childNodes.length),r[i.W]=u;e=_Ewa.F.a(r);Diag.a.a(51143427,1,50,e)}},kh:function(n){return!!n&&this.dI.f>n.c&&this.dI.g>n.d},hU:function(n,t,i){return n?this.R(n):this.z(t||i,1,!1,!1)},ka:function(){var t=new _Ewa.M(this.h().a().a.a,0),i=this.dY.bK(t),n;return i?(n=_Ewa.cf.n(i,t),n?n.a(!1):null):null},jd:function(){for(var u=this.h().a().a.b,t=this.cz(),f=this.dZ.$$ge(),n,i,r;f.$$mn();){if(n=f.$$cu(),t+n.c()<u){t+=n.c();continue}for(i=n.$$ge();i.$$mn();){var o=i.$$cu(),s=u-t,e=o.i(new Sys.UI.Point(0,s));return e?(r=e.a(!1).a,new _Ewa.o(r,1,r,16384,!1,!1)):null}}return null},jc:function(){var i=null,n=this.h().a().a,r=this.gK(n,!1,!1),t=this.gC(n,r,!0);return t?(i=t.a(!1),n=new _Ewa.M(n.a+Math.min(6,t.e()*.25),n.b+Math.min(6,t.g()*.25))):n=new _Ewa.M(n.a+6,n.b+6),r=this.gK(n,!1,!1),t=this.gC(n,r,!0),t&&(i=t.a(!1)),i},fv:function(n,t,i,r){var s=n===this.eh||!!n&&n.g(this.eh),u,o,f,e;!r&&s||Common.a.g||(this.eh=n,n?(u=_Ewa.bz.e(n,this.dI.b,this.dI.d,this.ej,this.ei,this.dN,this.dR()),this.jp(u),r&&!this.d()?this.jw(u):this.gk(u),o=u.a,this.fj=this.fk(o).b,f=i?i.a:null,this.eG()?(this.ia(n),this.hd(u)):(this.ia(_Ewa.cf.b()),this.hd(_Ewa.bz.e(_Ewa.cf.b(),this.dI.b,this.dI.d,this.ej,this.ei,this.dN,this.dR()))),t?e=_Ewa.bo.c(_Ewa.bo.c(this.dU,this.gW()),_Ewa.bo.c(f,u)):(e=_Ewa.bo.c(f,u),this.gl(null)),n&&i&&this.jE(i),this.eC(e,t?2:1,!0)):(this.eh=null,this.fi=this.gk(this.hd(this.gl(null))),this.eC(null,2,!0),this.fj=null))},jR:function(){var e=this.dP,o=this.fi,r=this.dU;if(e&&o&&r){var f=r.c(),n=f.a,u=r.a,t=o.a,i=e.a,s=this.gW().a;i.X<u.X&&u.X>t.X&&(n.X=this.eS?Math.max(i.X,t.X):Math.min(i.X,t.X),n.X=Math.max(n.X,s.X));i.Y<u.Y&&u.Y>t.Y&&(n.Y=this.eS?Math.max(i.Y,t.Y):Math.min(i.Y,t.Y),n.Y=Math.max(n.Y,s.Y));r.d(f)||(this.eC(f,2,!0),this.gn(this.fj,null,!0,!1,!1,!0))}},kE:function(n){var t,i;if(!this.dD.isChangeGateEnabled("OfficeVSO:3715074:_ForceMouseUpEventOnCommentDraft")&&(t=this.dD.b().a(_Ewa.eZ,65,!1),t&&t.bm()))return!0;if(!this.m()&&n.c===this.dC)return!1;if(!this.m()||this.dL.j()||this.gw||this.dL.W.g(this.dM.bh)||this.dL.h(!0,"GridView.OnPointerUp",0,n.a),n.b===3)i=this,$$sc.a.b(1).CW(function(){i.eO()});else{if(this.dM.bc===-1&&this.dM.bj===1)return Diag.a.a(24135697,1,50,"GridView.OnPointerUp: not focusing on grid since modeless dialog is focused"),!1;this.eO()}return!1},kD:function(n){if(this.dD.a(778)&&this.dD.a(940)){if(n.i()||n.n()){if(!_Ewa.t.a(this.dD)||!_Ewa.t.a(this.dD).i())return!1;if(this.m())return Diag.a.a(590484829,1,50,"GridView.OnMouseWheel: A cell is being edited -> don't zoom"),!0;if(this.dD.br())return Diag.a.a(590484828,1,50,"GridView.OnMouseWheel: A modal dialog is opened -> don't zoom"),!0;var t;return t=n.f===this.dC?n.get_clientPoint():n.f===this.eb.dC?new Sys.UI.Point(0,n.get_clientPoint().y):n.f===this.ea.dC?new Sys.UI.Point(n.get_clientPoint().x,0):new Sys.UI.Point(0,0),_Ewa.t.a(this.dD).h(n.h<0,t),!0}return n.f===this.dD.q()||n.f===_Ewa.b.a(this.dD).i()?!1:(this.ey(this.ef()+Math.floor(n.h*30)),!0)}return n.i()||n.n()?!1:(this.ey(this.ef()+Math.floor(n.h*30)),!0)},kN:function(n){var t=n.a;return this.fu=this.gD?null:_Ewa.i.F(t),this.gb=!0,!1},kK:function(){return this.gb=!1,!1},jl:function(n,t){if(!this.gb)return!1;var r=n.a,i=_Ewa.i.F(r);return this.fu&&this.kW(t,this.fu,i),this.fu=i,!1},kW:function(n,t,i){var r,u;n===4?(r=t.y-i.y,this.ey(this.ef()+r)):n===3&&(u=t.x-i.x,this.eP(this.el()+u))},kM:function(n){return this.jl(n,4)},kL:function(n){return this.jl(n,3)},kn:function(n,t){if(!_Ewa.cC.isInstanceOfType(n)||this.dD.y().b()){this.dE("gvBAIC",t,null);var i=!!this.em&&this.em.i();i&&this.dQ()&&this.s(!0);this.fG();this.fv(null,!0,null,!1);this.ex();this.dT.v()&&t.a&&_Ewa.B.p(t.a)&&i&&this.cV(t.a.a)}},km:function(n,t){var e=this.dD,s=this.dV(_Ewa.B.d(e.j())),i,o,r,u,f;if(!s){this.dL.cs(-1);return}(i=t.a,!_Ewa.cC.isInstanceOfType(n)||this.dD.y().b())&&(this.jr(i.r(),!1),o=this.cw(),this.kX(i.I&&(e.c().c().a&2080)==2080||!this.eG()),this.fv(i.b,!1,i.j,!1),this.gh(i,!0,!1),e.bI(),this.ge&&(_Ewa.O.a(this.dD).C(),_Ewa.O.a(this.dD).B(),this.ge=!1),r=null,i.j?this.fe=!1:_Ewa.J.isInstanceOfType(i)?(u=i.y,!this.fe&&u&&i.o()&&i.o().a-u.a<=this.ej*2&&i.o().b-u.b<=this.ei*2?(r=u,this.eA=u):(r=i.v(),this.eA=null,this.fe=!0,i.j=null)):r=i.v(),this.em&&this.em.f()?(i.g(!1),this.I(r||i.v(),0,_Ewa.C.N,!1,null),f=this.em.d(i),this.dL.cn(f),this.dL.cs(f?-1:0),f&&this.gJ(new Array(0))):(this.bE(i.X(),i.s,i.c(),_Ewa.dX.isInstanceOfType(i)?i.a:null,i.o(),r,i.j,i.j?i.j.d:0,_Ewa.C.M,this.fe,!0,null,t.c,!1),this.ho(!!t.b,t.c),this.dL.cs(0)),o!==this.cw()&&this.gf(null,Sys.EventArgs.Empty))},ie:function(n){var t=window.performance,u;this.ev&&t.mark("GridView.UpdatePanes start");for(var r=[this.eD,this.ea,this.eb,this.eF,this.eE],f=r.length,i=0;i<f;++i)u=r[i],u.a(n);this.ev&&(t.mark("GridView.UpdatePanes end"),t.measure("GridView.UpdatePanes","GridView.UpdatePanes start","GridView.UpdatePanes end"))},ku:function(){this.ge=!0;_Ewa.O.a(this.dD).J()},ko:function(n,t){if(!_Ewa.cC.isInstanceOfType(n)||this.dD.y().b()){Diag.a.a(20193374,1,50,"GridView.OnActiveItemPanesChanged: start wait for all blocks");var i=this.dI.z(t.a),r=!!this.dD.f()&&this.dD.f().M();this.ed=i&&!(!t.a&&r)&&_Ewa.bq.d(this.dD);this.kk(t);this.dI.w(t.a);this.dD.isChangeGateEnabled("OfficeVSO:4104233_ForceUpdatingUsedRangeAfterFreezePaneDataChange2")?i&&!r&&this.dD.c().v()&&this.fv(this.dD.j().b,!0,null,!0):this.dD.a(792)&&i&&this.dD.j()&&this.dR()&&this.fv(this.dD.j().b,!0,null,!0);this.ie(!this.ed);this.ed||this.gf(null,Sys.EventArgs.Empty);this.dL.bc.q=!0}},kk:function(n){var t="NoFreezedPane";n.a&&(t=String.format("FreezedCell: {0}, VisibleColumns: {1}, VisibleRows: {2}",_Ewa.o.a(n.a.FirstScrollableRow,n.a.FirstScrollableColumn,!1).toString(),n.a.VisibleColumns,n.a.VisibleRows));Diag.a.a(42815876,1,50,"GridView.OnActiveItemPanesChanged: ShouldWaitForAll={0}, {1}",this.ed,t)},gh:function(n,t,i){var r,u;n&&this.dT.F()&&this.dQ()&&this.dP&&(r=n.j||(n.j=new _Ewa.jj),i&&(this.dD.a(458)?(u=this.dM.d(),n.x(Common.L.c(u.a())),n.s=u.f(),n.w(this.dM.b().f())):(n.x([this.dM.a().f()]),n.s=0,n.w(this.dM.b().f()))),t&&(r.b=this.h().d().c(),r.c=this.gj(!0)),(i||t)&&(r.a=this.dP.c()),r.d=this.en?this.gc:i?60:0)},jm:function(n,t){(t.a||this.jT(),t.b)||(this.ln(!this.eG()),this.jq(),this.eB.parentNode.style.top=(this.eS?4:0).toString()+"px",this.eJ.bh(),this.hZ(),this.dl(!1))},jq:function(){var t=this.eS&&!_Ewa.bm.a(this.dD.e(),1),n=t?this.ic:0;this.dD.a(778)&&_Ewa.t.a(this.dD)&&(n=Math.ceil(_Ewa.t.a(this.dD).e(n)));this.eB.parentNode.style.bottom=n.toString()+"px"},ky:function(){this.dE("vbCS",null,null)},kl:function(){var n=this.et||this.dL.j();n||(this.dD.a(458)&&!this.dM.d().b()?this.dX.b(this.dM.u(),[20],!0):this.dX.f(!1,!1));this.gh(this.dD.j(),!1,!n);this.dT.K()},jr:function(n,t){var u;if(t||this.d()!==n){_Ewa.a.z(this.eB,n,"ewr-grdcontarea-rtl","ewr-grdcontarea-ltr");this.eB.dir=n?"rtl":"ltr";this.hk(n);for(var r=this.eY,f=r.length,i=0;i<f;++i)u=r[i],u.hk(n)}},kG:function(){var n=this.et||this.dL.j();n?this.dX.d(this.dM.v().e(),this.jo,!0,null,!0):(this.dX.k(),this.dX.i());this.gh(this.dD.j(),!1,!n);this.dT.K()},jj:function(){if(!this.dU){if(!this.dP){Diag.a.a(22922184,0,10,"loadedBlockArea is null");return}this.eC(this.dP.c(),1,!0)}this.gT(this.dU.c(),this.eR)},ks:function(){this.gf(this,Sys.EventArgs.Empty);System.a.a(this.eZ);this.eZ=null},jh:function(){var n,t;this.h()&&this.h().g()&&this.cw()&&(n=this.dY.dC,_Ewa.a.l(n,this.h().a().c(),!1),_Ewa.a.r(this.dZ.dC,this.h().a().d(),!1),t=!this.bc().h()&&this.bc().b()?_Ewa.Z.a():-1,_Ewa.a.K(n,this.d()?"marginRight":"marginLeft",t,"px",!1),_Ewa.a.K(n,this.d()?"marginLeft":"marginRight",-1,"px",!1))},hN:function(n){var t,i;this.h()&&this.h().g()&&this.dP?(t=this.iU(this.dZ,this.eF),t=this.iU(this.dY,this.eE)||t,n&&(i=n.Content)&&(t=this.ju(this.dY,this.eE,i.MaxColumnOutlineLevel|0)||t,t=this.ju(this.dZ,this.eF,i.MaxRowOutlineLevel|0)||t),t&&(this.dL.bc.q=!0,this.eZ=_Ewa.dL.a(this.iK,0,_Ewa.m.bc,this.eZ))):(System.a.a(this.eZ),this.eZ=null)},ju:function(n,t,i){return((this.dD.c().c().a&2080)==2080||(i=0),n.f!==i)?(n.s(t.s(i)),!0):!1},iU:function(n,t){var i=0,r=this.dD.j(),u="em",f,e,h;if(n.dQ()&&(_Ewa.J.isInstanceOfType(r)&&$$as(_Ewa.J,r).G()?i=n.c?.5+Math.max(3,this.q()?this.q().d.toString().length:0)*.75:1.45:(i=r.I?13:2,u="px")),f=n.c?"width":"height",e=_Ewa.a.K(this.eI.cm(),f,i,u,!1),e){for(var s=[n.dC,t.dC],c=s.length,o=0;o<c;++o)h=s[o],_Ewa.a.K(h,f,i,u,!1);!n.c&&n.dQ()&&(n.dV(!1),n.dV(!0))}return e},gf:function(){var f=window.performance,u,n,o,t,s,h,c;this.ev&&f.mark("GridView.OnContentAreaResized start");var e=null,i=1,r=1;this.dD.a(778)&&_Ewa.t.a(this.dD)&&(i=_Ewa.t.a(this.dD).n(this.dD.N()),r=_Ewa.t.a(this.dD).b(),i!==r&&(e=_Ewa.t.a(this.dD).o(i,r),_Ewa.t.a(this.dD).l(this.dD.N())),this.dD.isChangeGateEnabled("OfficeVSO:4150292_ZoomPerfTelemetry")&&this.dD.e().IsGridCanvasRenderingSupported&&_Ewa.b.a(this.dD).b().g()&&_Ewa.b.a(this.dD).w().f(_Ewa.cT.b,_Ewa.cT.c,!1));this.h()&&(this.jq(),u=this.eB.parentNode,n=this.dC,_Ewa.a.y(u),_Ewa.a.y(this.dY.dC),_Ewa.a.y(this.dZ.dC),o=Math.max(1,_Ewa.a.L(u)-this.U()-this.dI.a.b),this.dD.a(778)&&_Ewa.t.a(this.dD)&&_Ewa.t.a(this.dD).f()&&(o-=1),t=_Ewa.a.r(n,o,!1),t=_Ewa.a.l(n,Math.max(1,_Ewa.a.x(u)-this.S()-this.dI.a.a),!1)||t,t=t||!this.gx,_Ewa.a.y(n),s=this.la(),(t||s)&&(h=_Ewa.a.L(n),c=_Ewa.a.x(n),(c<=1||h<=1)&&this.dD.isChangeGateEnabled("OfficeVSO:4291833_LogIfResizeHidesMasterPane")&&Diag.a.a(18416263,1,50,"GridView.OnContentAreaResized: Master Pane/Scrollable area size is zero. MasterPaneWidth={0}, MasterPaneHeight={1}, WindowWidth={2}, WindowHeight={3}",c,h,_Ewa.a.x(this.dD.q()),_Ewa.a.L(this.dD.q())),this.gx=!0,this.h().m(s),this.dU&&this.gT(this.dU.c(),this.eR)),this.dD.a(778)&&e&&_Ewa.t.a(this.dD).p(e,i,r));this.ev&&(f.mark("GridView.OnContentAreaResized end"),f.measure("GridView.OnContentAreaResized","GridView.OnContentAreaResized start","GridView.OnContentAreaResized end"))},kP:function(){this.fr.a()},kQ:function(){this.h()&&(Common.c.p()||Common.c.G()&&this.dD.isChangeGateEnabled("OfficeVSO:4227261_calculateDevicePixelRatioInIE10"))&&this.iZ(!0)},iZ:function(n){var i,t;Diag.a.b(41730830,3,Common.c.p()||Common.c.G(),"ExplicitCheckDevicePixelRatio should only be called for safari or IE10 browser");i=1;Common.c.p()&&(i=window.devicePixelRatio);t=window.outerWidth/window.innerWidth*i;this.eW!==t&&(this.eW=t,Diag.a.a(39981983,1,50,"new DevicePixelRatio = {0}.",t),t>10&&Diag.a.a(594134561,1,15,"DPR is too large, DPR = {0}, innerWidth = {1}, outerWidth = {2}.",t,window.innerWidth,window.outerWidth),n&&this.dD.e().IsGridCanvasRenderingSupported&&this.dE("gvDPRC",null,null))},iW:function(){this.eW=window.devicePixelRatio;this.gy=window.matchMedia(this.jS());this.gy.addListener(this.hA);var n=this.eW>10?15:50;Diag.a.a(40777232,1,n,"new DevicePixelRatio = {0}.",this.eW)},dg:function(){for(var r=!0,t=[],u=this.$$ge(),i,n,f;u.$$mn();)i=u.$$cu(),i.C()?Array.add(t,i):r=!1;for(n=0;n<t.length;n++)f=t[n],this.kT(f);r&&this.fA(null)},kF:function(){this.gy.removeListener(this.hA);this.iW();this.dD.e().IsGridCanvasRenderingSupported&&this.fr.a()},cJ:function(n,t,i,r){var o,s,a,f,v;if(this.hY(r,!1,!!this.dR()),!this.dR()){this.h().e(n);return}var u=_Ewa.bz.n(this.dR(),this.eo(),new _Ewa.W(n.a,n.b,t,i),this.jz(),this.jA()),h=_Ewa.bo.a(u.a.X,u.a.Y,this.dN),e=null,c=this.im(),l=_Ewa.bz.f(new _Ewa.W(n.a,n.b,t,i),c.x,c.y),y=_Ewa.cf.l(u.b,this.eo(),this.dR());e=_Ewa.oW.a(y,n,l);o=!1;this.dU?(s=u.e(this.dU),a=!!s&&s.d(u),a&&this.ki(u.a)||(this.gl(null),f=u.c(),f.b.X=0,f.b.Y=0,this.jw(f),this.eC(u,1,!1),o=!0)):Diag.a.a(595068750,0,50,"AdjustViewBySelectionRange: ActualNavigableBlockArea is null");this.dD.isChangeGateEnabled("OfficeVSO:4288020_UpdateLoadedBlockAreaOnGoto")&&this.fA(u.c());this.fN(u.b.X,u.a.X,u.b.Y,u.a.Y,!1);_Ewa.mA.a(r,this.dP,u,this.dJ,this.dD.j());this.eL(e.y);this.eM(e.x);this.it(u.b.Y,u.a.Y,!1);this.dD.isChangeGateEnabled("OfficeVSO:4288020_UpdateLoadedBlockAreaOnGoto")||this.fA(u.c());this.h().e(l);o&&(v=new _Ewa.bo(0,0,h.Y,h.X,1),this.eC(v,1,!1))},ds:function(n){if(n)this.fF.a();else{var t=this;$$sc.a.b(0).CWRCT(Boolean,function(){return t.ji(),!0},null,0,$$sc.c.a)}},ji:function(){this.fc(!0);this.dD.e().IsGridCanvasRenderingSupported&&this.dJ.g()&&(this.dE("gvCAZC",null,null),this.dD.isChangeGateEnabled("OfficeVSO:4150292_ZoomPerfTelemetry")&&_Ewa.b.a(this.dD).w().f(_Ewa.cT.b,_Ewa.cT.d,!1))},jS:function(){if(Common.c.n()){var n=window.screen.deviceXDPI+1,t=window.screen.deviceXDPI-1;return String.format("screen and (min-resolution: {0}dpi) and (max-resolution: {1}dpi)",t,n)}return String.format("screen and (resolution: {0}dppx)",this.eW)},kT:function(n){if(this.dP){if(this.dP.b.Y!==n.l&&this.dP.a.Y!==n.l){Diag.a.a(595149460,1,15,"GridView.RemoveEmptyFlows: Removing flow {0} without updating LoadedBlockArea {1}",n.l,this.dP);return}this.dP.b.Y===n.l?this.dP.b.Y++:this.dP.a.Y===n.l&&this.dP.a.Y--}this.hb(n);this.hi(n)},kx:function(n){if(this.eH=null,_Ewa.R.a(n)){var t=_Ewa.h.g(n.Errors,[-356977682],"GridView:OnFindRangeSuccess");this.dT.q(t)}else this.kc(n.Result,this.gc,_Ewa.C.O,3)},kw:function(n){this.eH=null;var i=n.b,t=_Ewa.V.a(i);t&&_Ewa.h.c(t)?(Diag.a.a(36569609,1,50,"GridView.OnFindRangeFailure: handling http error: {0}.",i.c),this.dD.c().q(t)):this.jt()},kO:function(){this.m()&&this.kB();this.gh(this.dD.j(),!0,!1);this.h().j()&&this.dT.K()},kH:function(){this.fq||this.em&&this.em.a()?this.gJ(new Array(0)):this.dD.a(458)?this.gJ(this.dM.bd.a()):this.gJ([this.dM.a()])},gJ:function(n){for(var r,i=[this.dZ,this.dY,this.eF,this.eE],u=i.length,t=0;t<u;++t)r=i[t],r.x(n)},kC:function(n,t){(this.dD.isChangeGateEnabled("OfficeVSO:4248277_MeasureCachedViewportStaleness")&&(this.fw=new _Ewa.oV(this.bC(),this.dD.j()?this.dD.j().c():null,!!this.fs,this.dI,this.dD.c().m())),t.b!==-1)&&(this.fv(this.eh,!0,null,!0),this.jC(0),this.es=new _Ewa.kX,this.fj=new _Ewa.M(0,0))},hZ:function(){this.fX=this.eG()&&!this.dJ.g()?2:0},kv:function(){var i=this.e(null),n=this.dD,t,r;i&&i.N()&&!this.ga?(t=_Ewa.dH.a(n),t&&(t.a().k=this.be()),_Ewa.Q.a(n).b().b()!=="cw41"&&(r=_Ewa.Q.a(n).a().a(),r.PICAuefb=this.be(),_Ewa.G.a(n).a(new _Ewa.cy("cw41",5,null))),this.dL.h(!1,"GridView.OnEditingStarted",0,null)):this.dD.a(788)||_Ewa.G.a(n).a(new _Ewa.cy("cw39",0,null))},kB:function(){var n=_Ewa.Q.a(this.dD);n.b().b()==="cw40"||this.dD.a(788)||n.b().b()==="cw39"&&(n.b().g(),n.e("cw40"))},fd:function(n,t,i){var r=this.eB.rows[n].cells[t];return i?r.firstChild:r.lastChild},iV:function(n){var t=this.dD.e().ThemedBackgroundColor;if(!(!t||!t.length))try{n.style.backgroundColor=t}catch(i){if(t.toLowerCase().indexOf("!important")<0)throw i;}},la:function(){var n=!1;return this.gG||_Ewa.ca.b(this.dD)&&_Ewa.ca.b(this.dD).d()&&(this.gG=!0,n=!0),this.gH||_Ewa.ca.c(this.dD)&&_Ewa.ca.c(this.dD).d()&&(this.gH=!0,n=!0),n},jY:function(n){for(var i,r=this.eu,u=r.length,t=0;t<u;++t)if(i=r[t],i.dN===n)return i;return null},kg:function(){var n=Common.a.b().b().a("GK"),t=this;n.f(function(){t.kd()})},kd:function(){this.C(!0,!1)},jT:function(){this.dD.bh()||Sys.UI.DomElement.addCssClass(this.dC,"ewr-grddisableprint")},jQ:function(){this.ez=_Ewa.bS.a().a(document.body);var t=this,n=function(n){n.stopPropagation();n.preventDefault()};this.ez.a("cut",n,!0);this.ez.a("copy",n,!0);this.ez.a("paste",n,!0)},jZ:function(){for(var u,n,t,i=new($$sc.u.$$(_Ewa.em)),f=this.dJ.r(),e=f.length,r=0;r<e;++r)u=f[r],Object.getType(u)===_Ewa.em&&(n=u,n&&this.dJ.v().a(n.E,_Ewa.p.c(this.dD))&&n.bu()?i.b(n):(t=this.bz(n.E),t&&t.q()&&t.bN()&&t.bN().isDirty()&&i.b(n)));return i},kU:function(n){var r,t,l,e,o,h,c;if(!this.dJ.v().b()){this.gg=!1;return}if(r=_Ewa.i.a(),t=this.jZ(),t.e.length>0){l=this;t.Sc(function(n,t){return n.bE()-t.bE()});for(var i=_Ewa.i.a(),a=i-r,u=0,f=0,s=0,v=this.dD.e().MaxRenderingTimeOnRAFCallbackMs;(f<1||i-r<v)&&u<t.e.length;)e=t.a(u),e.r>0?(o=this.bz(e.E),o&&(o.bl(),f++)):s++,u++,i=_Ewa.i.a();if(h=i-n,c=i-r,Diag.a.a(50689363,1,50,"RenderDirtyBlocksRAFCallback: rendered {0} out of {1} blocks. renderTotalDuration = {2}ms. rAFTotalDuration = {3}ms, prepDuration = {4}ms, blocks registered for idle = {5}",f,t.e.length,c,h,a,s),u<t.e.length){window.requestAnimationFrame(this.hJ);return}}this.gg=!1},ke:function(n){Diag.a.a(590485131,0,10,"GridView.HandleGridImageLoadFailure: {0}",n)},kf:function(n){var u,i;if(n&&n.length){for(var r=n,f=r.length,t=0;t<f;++t)u=r[t],i=this.dJ.a(u).a(),i&&i.setDirty();this.cl()}},jf:function(){try{gridRenderer.GridBlockRendererGlobals.setStaticImageUrl(0,this.dD.e().EmptyPivotTableImageUrl)}catch(n){Diag.a.a(590485130,0,10,"GridView.InitializeGridRendererStaticResources: {0}",n)}},kp:function(){this.jf();this.dT.y(this.hq)}};_Ewa.cf.o=function(n,t,i,r,u,f,e){n&&(this.c(),this.targetRange=t.toString(),this.activeCell=i?i.toString():"null",this.gotoCaller=r,this.gotoRangePositioning=u,this.activeCellPriorGoto=f?f.toString():"null",this.a=!0,this.findRangeCallsPriorGoto=e)};_Ewa.cf.o.prototype={gotoEnded:!1,isSuccess:!1,convergenceScenario:null,isLoadedUserSelectionViewportAreaFound:!1,areAllBlocksConsistentAndRendered:!1,findRangeRequest:!1,findRangeCallsPriorGoto:0,removeAllViewBlocks:!1,isVisibleAreaChanged:!1,scrollLeftDifference:0,scrollTopDifference:0,horizontalGotoPositioning:null,verticalGotoPositioning:null,loadedRangeInterceptSelection:null,targetRange:null,activeCell:null,gotoCaller:null,gotoRangePositioning:0,activeCellPriorGoto:null,a:!1,b:function(){this.a&&Diag.a.a(51488353,1,50,"GridView.GotoRangeInternal: {0}",JSON.stringify(this))},c:function(){this.gotoEnded=!1;this.isSuccess=!1;this.convergenceScenario="None";this.isLoadedUserSelectionViewportAreaFound=!1;this.areAllBlocksConsistentAndRendered=!1;this.findRangeRequest=!1;this.removeAllViewBlocks=!1;this.isVisibleAreaChanged=!1;this.scrollLeftDifference=-1;this.scrollTopDifference=-1;this.horizontalGotoPositioning="None";this.verticalGotoPositioning="None";this.loadedRangeInterceptSelection="None";this.targetRange="None";this.activeCell="None";this.gotoCaller="None";this.activeCellPriorGoto="None"}};_Ewa.cf.f=function(n,t){this.$$rst=this.reset;this.$$mn=this.moveNext;this.b=n;this.i=t;this.c=t};_Ewa.cf.f.prototype={c:null,i:null,b:null,j:null,f:null,d:null,g:null,k:null,h:null,a:-1,l:function(){return this.j=this.b.dJ.B(this.c,this.b.dD.T()),this.f=this.j.$$ge(),this.e},e:function(){return this.f.$$mn()?(this.d=this.f.$$cu(),!this.c.n(this.d.b()))?this.e:(this.g=this.d.g(this.c.n(this.d.b()),!1,!1),!this.g)?this.e:(this.k=new _Ewa.jE(this.g,this.b),this.a=2,this.n):this.m},m:function(){this.a=3},n:function(){return this.e},dispose:function(){},$$ge:function(){return this.a===-1?(this.a=0,this):new _Ewa.cf.f(this.b,this.i).$$ge()},moveNext:function(){if(this.a===3)return!1;for(this.a?this.a=1:(this.a=1,this.h=this.l());this.a===1;)this.h=this.h();return this.a!==3},reset:function(){throw Error.invalidOperation("Reset() is not supported");},$$cu:function(){return this.k}};_Ewa.Zp=function(){};_Ewa.Zp.b=function(){_Ewa.br.a().b(_Ewa.bdr.$$(Function),197,new _Ewa.Zp.a)};_Ewa.Zp.a=function(){_Ewa.Zp.a.initializeBase(this);this.k()};_Ewa.Zp.a.prototype={b:function(){var n=this;this.j(function(n){var i=n.b(),t=_Ewa.cf.g(n);return i.b(_Ewa.eD,174,t),t.cX(),i.b(_Ewa.eG,170,new _Ewa.eG(n,t)),i.b(_Ewa.tK,290,new _Ewa.tK(n)),t})}};_Ewa.uc=function(){};_Ewa.uc.$$=function(n){var u=_Ewa.__tc=_Ewa.__tc||{},t="uc$"+n.getName().replace(/\./g,"_"),i,o,f,e,r;if(!u[t]){i=u[t]=function(){for(var t=[],n=0;n<arguments.length;++n)t[n]=arguments[n];_Ewa.uc.apply(this,t)};i.registerClass("_Ewa.__tc."+t);o={"_Ewa.uc":{T:n},ctor:_Ewa.uc};i.prototype.$$gta=o;f=_Ewa.uc.prototype;for(e in f)r={key:e,value:f[e]},"constructor"!==r.key&&(i.prototype[r.key]=r.value)}return u[t]};_Ewa.uc.prototype={a:null,c:null,b:null,e:function(n,t,i){var r,u,f,e,o,s,h,c,l,a;return this.a&&(e=this.a.e(n,f={val:u},null),u=f.val,e)&&u&&(s=u.e(t,o={val:r},this.$$gta["_Ewa.uc"].T===Number||Type.isEnum(this.$$gta["_Ewa.uc"].T)?0:this.$$gta["_Ewa.uc"].T===Boolean?!1:null),r=o.val,s)?r:this.b&&(c=this.b.e(t,h={val:r},this.$$gta["_Ewa.uc"].T===Number||Type.isEnum(this.$$gta["_Ewa.uc"].T)?0:this.$$gta["_Ewa.uc"].T===Boolean?!1:null),r=h.val,c)?r:this.c&&(a=this.c.e(n,l={val:r},this.$$gta["_Ewa.uc"].T===Number||Type.isEnum(this.$$gta["_Ewa.uc"].T)?0:this.$$gta["_Ewa.uc"].T===Boolean?!1:null),r=l.val,a)?r:i},g:function(n,t,i,r,u){if(!r(this.e(n,t,u),i)){if(r(i,u)){this.h(n,t);return}this.a||(this.a=new($$sc.r.$$($$sc.r.$$(this.$$gta["_Ewa.uc"].T))));var f,e,o;(o=this.a.e(n,e={val:f},null),f=e.val,o)||(f=new($$sc.r.$$(this.$$gta["_Ewa.uc"].T)),this.a.b(n,f));f.b(t,i)}},f:function(n,t){var u,o,f,i,r,c;if(!n){Diag.a.a(34210245,1,100,"SparseCellTableCache.Update: table content empty, clearing cache.");this.d();return}if(u=null,n.Cols){Diag.a.a(34210246,1,100,"SparseCellTableCache.Update: populating overridden columns.");u=new($$sc.r.$$(this.$$gta["_Ewa.uc"].T));for(var l=n.Cols,y=l.length,e=0;e<y;++e)o=l[e],u.b(o.Idx,o.Val)}if(f=null,i=null,n.Rows){Diag.a.a(34210247,1,100,"SparseCellTableCache.Update: populating overridden rows and cells.");f=new($$sc.r.$$(this.$$gta["_Ewa.uc"].T));for(var a=n.Rows,p=a.length,s=0;s<p;++s)if(r=a[s],t(r.Val)&&f.b(r.Idx,r.Val),r.Cells){i||(i=new($$sc.r.$$($$sc.r.$$(this.$$gta["_Ewa.uc"].T))));i.b(r.Idx,new($$sc.r.$$(this.$$gta["_Ewa.uc"].T)));for(var v=r.Cells,w=v.length,h=0;h<w;++h)c=v[h],i.a(r.Idx).b(c.Idx,c.Val)}}Diag.a.a(34210248,1,100,"SparseCellTableCache.Update: maps updated successfully, overridden rows = {0}, columns = {1}, cells = {2}.",f?f.f:0,u?u.f:0,i?i.f:0);this.b=u;this.c=f;this.a=i},d:function(){this.a=null;this.c=null;this.b=null},h:function(n,t){if(this.a){var i,r,u;(u=this.a.e(n,r={val:i},null),i=r.val,u)&&i.i(t)}}};_Ewa.gg=function(n,t,i,r){var u,f;this.bJ=Function.createDelegate(this,this.cp);this.bK=Function.createDelegate(this,this.cr);this.bV=Function.createDelegate(this,this.cn);this.bI=Function.createDelegate(this,this.co);this.bx=new(_Ewa.uc.$$(Number));this.bw=new(_Ewa.uc.$$(Array));this.p=this.i;_Ewa.gg.resolveInheritance();this.d=this.B;_Ewa.gg.initializeBase(this,[n,t,r.c().j(),i,r.c().a(72)]);u="GridViewBlock";this.fC=u;this.V=r;this.bP=new _Ewa.iu(this.V,this,this.W,this.bk);this.bH=new _Ewa.oR(this.V.b());this.bA=new _Ewa.ub(this,this.V.c());this.bg=r.ci(i,!0);this.bf=r.ci(i,!1);r.c().e().IsGridCanvasRenderingSupported&&(this.bj=new _Ewa.hv(this,this.V),this.V.cG(this.bI),r.c().a(778)&&this.V.cF(this.bV));this.f().b().z(r.c().j(),this.Z,f={val:this.W});this.W=f.val;_Ewa.gg.a.a()&&this.V.v(this.bK)};_Ewa.gg.b=function(n){var t,i;if(!n)return null;for(t="",n.length>1,i=0;i<n.length-1;i++)t+=n[i],t+="]\]>";return t+n[n.length-1]};_Ewa.gg.c=function(){var t=document.createElement("div"),n=t.style;return n["pointer-events"]="auto",t.style.filter="progid:DXImageTransform.Microsoft.gradient(startColorstr=#FFFFFF, endColorstr=#FFFFFF)",n["pointer-events"]!=="auto"&&(n.filter==="none"||!n.filter)};_Ewa.gg.prototype={bL:0,bC:null,bB:null,bp:null,by:!1,bE:!1,bo:null,bd:null,bG:null,bH:null,bu:null,bv:null,bt:null,bA:null,bP:null,bj:null,bm:null,bi:null,bh:null,bz:!1,bg:null,bf:null,o:function(){return this.bd?this.bd.Information.Revision:-1},C:function(){var n=this.V.b().a(this.W);return n?n.V:-1},b:function(){return this.bo||(this.bo=_Ewa.b.e(this.ba().c,this.ba().b))},bc:null,m:function(){return this.bc},H:function(){return this.bB||(this.bB=_Ewa.a.a(this.bc,"gridRows"))},V:null,c:function(){return this.V},h:function(){return this.bC},G:function(){return this.f().G()},be:null,bN:function(){return!this.be||!this.be.GridBlockModel?null:gridRenderer.GridBlockRendererFactoryGlobal.getModelAccessor(this.be.GridBlockModel)},q:function(){return!!this.be},e:function(){return this.W},A:function(){return this.Z},s:function(){return this.bc.style.backgroundColor},y:function(){var n=this.V.b().a(this.W);return n?n.H:0},z:function(n){var t=this.V.b().a(this.W);return t&&(t.H=n),n},bW:null,S:function(n){return this.bW=n,n},bX:null,T:function(n){return this.bX=n,n},bq:function(){return this.ck()&&this.by},bF:function(){return this.br().i(this.bO())},ck:function(){return this.V.c().e().IsGridCanvasRenderingSupported&&this.V.b().g()},bM:function(){return this.bq()?this.bj:this.bP},L:function(n,t){var e=new($$sc.u.$$(String)),r,o,s,u,h,c,f,l,i;if(this.bv&&(s=this.bv.e(n,o={val:r},null),r=o.val,s)&&(c=r.e(t,h={val:u},null),u=h.val,c)){if(!this.bt)return Diag.a.a(25020034,0,10,"GridDomCellProxy.GetCellRichValueFields: cellsRichValueFieldIndexes has content, but allRichValueFields is null"),null;for(f=u.$$lge();f.$$mn();)l=f.$$cu(),i=this.bt.c(l),Diag.a.b(25020036,1,!!i,"cellsRichValueFieldIndexes has a value for the cell, but richValueField should not be null"),i&&e.b(i.Value)}return e},K:function(n,t){var i=0,r,u,f,e,o;return this.bu&&(f=this.bu.e(n,u={val:r},null),r=u.val,f)&&(o=r.e(t,e={val:i},0),i=e.val,o),i},J:function(n,t){return this.bx.e(n,t,-1)},N:function(n,t,i){var r=this;this.bx.g(n,t,i,function(n,t){return n===t},-1)},bO:function(){return this.f().K()},I:function(n,t){var i=this.bw.e(n,t,null);return _Ewa.gg.b(i)},M:function(n,t,i){var r=null,u;i&&(r=i.split("]\]>"));u=this;this.bw.g(n,t,r,function(n,t){if(!n&&!t)return!0;if(!n||!t||n.length!==t.length)return!1;for(var i=0;i<n.length;i++)if(!_Ewa.e.b(n[i],t[i],!1))return!1;return!0},null)},u:function(n,t,i,r){this.bA.i(n,t,i,r)},t:function(n,t,i){this.bA.h(n,t,i)},F:function(n){(this.bq()||n)&&(Diag.a.a(39966424,1,50,"GridViewBlock.ForceHtmlRendering viewBlock {0} was forced to re-render using html grid renderer",this.W),n||(this.by=!1),this.bl())},U:function(){var u=0,f,i,t,e,o;if(isNullOrUndefined(this.bm))return 0;if(f=this.V.b(),i=$$as(_Ewa.dp,this.bm),i){var s=_Ewa.u.a().b().m,h=i.b(),n=f.a(this.e()),r=2;n&&(r=n.B);u=this.bL;t=this;i.g(function(i){if(i&&!i.h){var u=String.format("GridViewBlock.Full render: {0}, startTime: {1}, endTime: {2}, duration: {3}, block: {4}, source: {5}, digest: {6}, ecsDigest: {7}",isNullOrUndefined(t.bM())?"":t.bM().b(),i.s.m,s,h,t.e(),n?_Ewa.gb.toString(r):"Unknown",n?n.N:"null",n?n.P:"null");t.bE&&!r?Diag.a.a(41194710,1,50,u):Diag.a.a(41194711,1,50,u)}},!0)}else Diag.a.b(41194709,1,!1,"GridViewBlock.Full render: stopwatch == null, could not cast this.domStopwatch as Stopwatch.");try{e=window.performance;e.mark("onload completed")}catch(c){}return o=_Ewa.gC.a(this.V.c()),o.f(this.bE),this.V.h().l(this),u},cb:function(n,t,i,r,u){if(this.bm=this.bm||r.b("DOMUpdate",u+":Full render:"+this.eV()),this.bm.d(),i(t),Common.c.g()){var f=this;window.requestAnimationFrame(function(){f.U()})}else Common.c.p()||t.appendChild(this.cg(n));return this.bm.c()},E:function(){Diag.a.a(40461537,1,50,"GridViewBlock.ForceCanvasRendering viewBlock {0} was forced to re-render using Canvas grid renderer");this.bl()},ba:function(){return this.bG||(this.bG=new _Ewa.gf(this))},dispose:function(){try{this.f()&&this.f().b().w(this.W);this.V&&(_Ewa.gg.a.a()&&this.V.y(this.bK),this.V.c().e().IsGridCanvasRenderingSupported&&this.V.dc(this.bI),this.V.c().a(115)&&this.bj&&this.bj.dispose(),this.cc(),this.bQ("Dispose"));this.bx.d();this.bw.d();this.bh&&(this.bh.dispose(),this.bh=null);_Ewa.FJ.prototype.dispose.call(this)}catch(n){Diag.a.a(40395410,0,10,"GridBlockManager.Dispose failed: {0}",n.message)}},l:function(n,t){return this.ba().w(n,t)},g:function(n,t){return this.ba().v(n,t)},i:function(n){return this.ba().u(n)},bT:function(n){var t=n.a.a;switch(t.q){case 0:case 2:case 4:this.bc||this.cj(n);break;case 1:case 3:case 5:this.cs(n)}},bU:function(n){var r=n.a.a,t=r.n,u,e,i;if(this.V.b().h()||(u=t.Content,this.ba().z(u),_Ewa.gf.b(this.bc,u),this.bC=_Ewa.gf.a(this.bc)),this.bp&&!this.V.b().h())for(var s=this.bp,c=s.length,f=0;f<c;++f)if(e=s[f],e)for(var h=e,l=h.length,o=0;o<l;++o)i=h[o],i&&(i.dQ(),i.dR());this.cd(t);this.bt=r.bD();this.cf(t);this.ce(t);r.bF(t)},r:function(){return Diag.a.b(19146068,1,!!this.bb,'GridViewBlock.GetViewportOrigin: HashKey {0} Flow Removed. Additional Data {{"Timestamp":{1},"PreviousViewportArea":{ 2},"ViewBufferLeft":{3},"ViewBufferTop":{4},"BlockMinimum":{5},"BlockMinimuY":{6},"NavigableBlockAreaTopLeft":{7},"NavigableBlockAreaBottomRight":{8},"BlockPosition": {9},"BlockRange": {10}}}',this.W,this.V.gP,this.V.gO,this.V.gQ,this.V.gR,this.V.gM,this.V.gN,this.V.fL,this.V.fK,this.Z,this.bo),new _Ewa.M(this.bs(),this.bb?this.bb.f():0)},br:function(){var n=this.r();return new _Ewa.W(n.a,n.b,this.x(),this.R())},v:function(n){return this.ba().m(n)},w:function(n){return this.bG.x(n)},bl:function(){Diag.a.a(18363290,1,100,"GridViewBlock.ReplaceDomElements: FreezePanesImprovements HashKey {0}",this.W);var n=window.performance;this.bk&&n.mark("GridViewBlock.ReplaceDOM start "+this.W);this.bd&&this.bd.Content?this.bR():this.V.c().a(799)&&this.q()&&this.bj.a();this.bk&&(n.mark("GridViewBlock.ReplaceDOM end "+this.W),n.measure("GridViewBlock.ReplaceDOM "+this.W,"GridViewBlock.ReplaceDOM start "+this.W,"GridViewBlock.ReplaceDOM endreplace "+this.W),n.measure("GridViewBlock.ReplaceDOM full "+this.W,"GridViewBlock.ReplaceDOM start "+this.W,"GridViewBlock.ReplaceDOM end "+this.W))},k:function(n,t,i){var r,u;return i?new _Ewa.bJ(this,this.ba(),this.bH,n,t):(r=this.bp[n],r||(this.bp[n]=r=[]),u=r[t],u||(r[t]=new _Ewa.bJ(this,this.ba(),this.bH,n,t)))},ch:function(){var e;if(!this.bd&&!this.q())return!1;var r=this.V.V(),u=this.V.c().a(778)?_Ewa.t.a(this.V.c()).b():1,n=r*u,t=Math.round(this.Y*n),i=Math.round(this.X*n),f=t>3072||i>1024;return f&&(e=i>1e5||t>1e5?15:50,Diag.a.a(595096646,1,e,"GridViewBlock::DoesBlockExceedsCanvasBufferLimit: Canvas limit exceeded, DPR = {0}, Zoom = {1}, scaleFactor = {2}, scaledWidthPx = {3}, scaledHeightPx = {4}, blockWidth = {5}, blockHeight = {6}, blockHash = {7}",r,u,n,t,i,this.Y,this.X,this.e())),f},ct:function(){var t=this.V.V(),i=this.V.c().a(778)?_Ewa.t.a(this.V.c()).b():1,n=t*i,f=Math.floor(3072/n),e=Math.floor(1024/n),r=Math.ceil(this.Y/f)*Math.ceil(this.X/e),u=r>this.V.c().e().MaxNumberOfCanvasesPerBlock;return u&&Diag.a.a(594134560,1,15,"GridViewBlock::ShouldFallbackDueToNumberOfRequiredCanvases: width = {0}, height = {1}, DPR: {2}, Zoom: {3}, scaleFactor: {4}, numberOfCanvasesRequired: {5}, blockHash = {6}",this.Y,this.X,t,i,n,r,this.e()),u},D:function(){var n=this.V.b().a(this.W);return n?n.D():!1},cu:function(n){this.bB=null;this.bc=_Ewa.a.e(n,"ewr-sheettable",!1);this.bC=_Ewa.gf.a(this.bc)},cj:function(n){var e=this.V,i,u,r,f,t,o,s;this.bo=null;e.cw()&&(u=e.cS().L(this.W))&&u.J?(i=u.R(),this.ba().c=u.u,this.ba().e=u.y):(i=this.bb&&this.bb.e()?this.bb.e():this.bg.b(),this.ba().c=this.bg.c,this.ba().e=this.bg.a);e.cw()&&(f=e.bg().L(this.W))&&f.J?(r=f.x(),this.ba().b=f.u,this.ba().d=f.y):(r=this.bf.b(),this.ba().b=this.bf.c,this.ba().d=this.bf.a);n.a.a.q===4&&(r=i=0);this.bC=this.bB=this.bc=null;_Ewa.a.k(this.dC,"<div style='width:"+r+"px;height:"+i+"px'><\/div>");_Ewa.a.bn(this.dC,r);_Ewa.a.bq(this.dC,r);_Ewa.a.bm(this.dC,i);_Ewa.a.bp(this.dC,i);this.Y=r;this.X=i;t=this.V.c();t.isChangeGateEnabled("OfficeVSO:4289585_DetachShowingToast")&&_Ewa.G.a(t).b()&&_Ewa.G.a(t).d("Scroll","",!0);o=t.a(938)&&_Ewa.G.a(t).b();s=t.c().S()||o;this.V.c().a(799)&&this.V.b().bj()&&!this.bS()&&this.bj&&!this.bd&&s&&(!t.isChangeGateEnabled("OfficeVSO:4289585_DetachShowingToast")&&o&&_Ewa.G.a(t).d("Scroll","",!0),this.be=this.ci(),this.bj.a());this.cq();this.bY()&&this.ca()},ci:function(){var n=new _Ewa.AW,r,u,i,f,e,t;return n.RenderFlags=this.V.c().e().CanvasRenderFlags,n.BlockWidth=this.bf.b(),n.ColumnNumbers=this.bf.c,n.ColumnWidths=this.bf.a,n.ColumnOffsets=this.bf.f(),n.BlockHeight=this.bg.b(),n.RowNumbers=this.bg.c,n.RowHeights=this.bg.a,n.RowOffsets=this.bg.f(),n.ShowGridLines=!0,n.IsRtl=this.V.d(),n.Cells=[],r=[],u=new _Ewa.rG,u.ID=0,Array.add(r,u),n.Fonts=r,i=[],f=new _Ewa.rF,f.ID=-2,Array.add(i,f),e=new _Ewa.rF,e.ID=-1,Array.add(i,e),n.Styles=i,t={},t.GridBlockModel=n,t.Content={},t.Content.OverlayGridHtml="",t.Content.RowNumbers=n.RowNumbers,t.Content.ColumnNumbers=n.ColumnNumbers,t.Content.MaxColumnOutlineLevel=this.V.cQ(),t.Content.MaxRowOutlineLevel=this.V.cR(),t},cq:function(){this.V.c().isChangeGateEnabled("OfficeVSO:4182253_LogEstimatedBlockTimeInDom2")&&!this.bz&&(this.bz=!0,this.V.cb(this.bJ))},cc:function(){this.V.c().isChangeGateEnabled("OfficeVSO:4182253_LogEstimatedBlockTimeInDom2")&&this.bz&&(this.bz=!1,this.V.cq(this.bJ))},bR:function(){this.V.c().a(799)&&(this.be=null);this.bM().c();this.cc();this.bQ("RenderSevrerContent");this.V.c().isChangeGateEnabled("4039692_AddEventListenersForAutoFilterOnClient")&&(!this.V.b().i()&&this.V.c().isChangeGateEnabled("OfficeVSO:4281011_RaiseBlockRenderedEventSyncedInPLT")?this.V.da(this):this.V.db(this))},ca:function(){if(_Ewa.cj.a().o(),this.V.c().isChangeGateEnabled("OfficeVSO:4182253_LogEstimatedBlockTimeInDom2")){Diag.a.b(592053139,1,this.bF()&&!this.bi,"GridViewBlock.StartEstimatedContentTimer: IsBlockInViewport={0}, estimatedContentStartTime={1}",this.bF(),this.bi);this.bi=_Ewa.u.a().b();var n=this;this.bh=_Ewa.y.a().a(function(){n.cm(n.e())},this.V.c().e().EstimatedContentExaggeratedDurationThreshold,_Ewa.m.ba,!0,!0)}},cp:function(){if(this.bY()){this.ca();return}this.cl()&&this.bQ("OnViewportChange")},bY:function(){return!this.bi&&this.bF()&&this.dQ()?!0:!1},cl:function(){return this.bi&&!this.bF()&&this.dQ()?!0:!1},cm:function(n){this.bD||Diag.a.a(16789579,1,15,"GridViewBlock.LogExaggeratedDurationForEstimatedContentInDom: the estimated content is in DOM for more than {0} msecs, blockHash {1}",this.V.c().e().EstimatedContentExaggeratedDurationThreshold,n)},bQ:function(n){if(this.bi&&(_Ewa.cj.a().p(this.V.c()),this.V.c().isChangeGateEnabled("OfficeVSO:4182253_LogEstimatedBlockTimeInDom2"))){var t=_Ewa.u.a().b().m-this.bi.m;t>this.V.c().e().EstimatedContentExaggeratedDurationThreshold&&(Diag.a.a(593051745,1,50,"GridViewBlock.LogEstimatedContentDuration: the estimated content is in DOM for {0} msecs, blockHash {1}, caller={2}",t,this.e(),n),this.bh.c()&&this.bh.d());this.bi=null;this.bh.dispose();this.bh=null}},cs:function(n){var i=n.a.a,t=i.n,r,f,u,e;if(this.bo=null,r=t.Content,this.ba().y(r),this.bp=[],f=_Ewa.p.c(this.V.c()),u=i.B===2,this.by=f?t.IsCanvasRenderingSupported:t.IsCanvasRenderingSupported&&!u,this.bE=t.IsCanvasRenderingSupported,this.bd=t,this.cd(t),this.bt=i.bD(),this.cf(t),this.ce(t),this.Y=r.Size[0],this.X=r.Size[1],_Ewa.a.bn(this.dC,this.Y),_Ewa.a.bq(this.dC,this.Y),_Ewa.a.bm(this.dC,this.X),_Ewa.a.bp(this.dC,this.X),this.bn=i.I.c(),f||!this.bq()||!u){this.V.Y()||this.bR();this.bL=this.o();var o=this.V.b().h()&&!!t.GridBlockModel&&this.V.b().bi()!==t.GridBlockModel.RenderFlags,s=this.bS(),h=t.IsCanvasRenderingSupported;!u&&(!h||o||s)&&this.V.b().k("GridViewBlock::SetServerContent blockSupported = "+h+" renderingBRSMismatch = "+o+"isCanvasBufferLimitExceeded = "+s,!1);e=this.V.c().b().a(_Ewa.cv,268,!1);this.bq()?i&&i.bL(e,this.V.b().A()):this.bA.j(e,this.V.b().A());this.V.c().c().bR()||_Ewa.U.a().U(this.W);_Ewa.bq.b(this.V.c())&&_Ewa.U.a().a("ContentChangedDuringSwitch");i.bF(t)}},bS:function(){return this.V.c().a(115)?!1:this.ct()||this.V.V()>10},co:function(){Diag.a.a(593051744,1,50,"GridViewBlock.OnDevicePixelRatioChanged: re-render Canvas if needed");this.bZ()},cn:function(){Diag.a.a(593051743,1,50,"GridViewBlock.OnContentAreaZoomChanged: re-render Canvas if needed");this.bZ()},bZ:function(){if(this.bq()&&this.bd)if(Diag.a.b(594344078,1,this.Y!==-1&&this.X!==-1,"GridViewBlock::OnDevicePixelRatioChanged: Block dimensions are invalid after server response. blockWidth = {0}, blockHeight = {1}",this.Y,this.X),this.bS())this.V.b().k("GridViewBlock::OnDevicePixelRatioChanged : Canvas buffer limit exceeded",!1);else{var n=this.V.b().a(this.W);n&&this.bR()}},cf:function(n){var i,r,o,u;if(n&&n.Content){if(!n.Content.RichValueFieldIndexes){this.bv=null;return}var s=n.Content.RichValueFieldIndexes,v=this,t=new($$sc.y.$$($$sc.r.$$($$sc.r.$$($$sc.u.$$(Number)))))(function(){return new($$sc.r.$$($$sc.r.$$($$sc.u.$$(Number))))});if(s.Rows){Diag.a.a(25020037,1,100,"GridViewBlock.UpdateRichValueFieldsMap: populating cells.");for(var h=s.Rows,l=h.length,f=0;f<l;++f)if(i=h[f],i.Cells){t.a().b(i.Idx,new($$sc.r.$$($$sc.u.$$(Number))));for(var c=i.Cells,a=c.length,e=0;e<a;++e){for(r=c[e],o=new($$sc.u.$$(Number)),u=0;u<r.Val.length;++u)o.b(r.Val[u]);t.a().a(i.Idx).b(r.Idx,o)}}}Diag.a.a(25020038,1,100,"GridViewBlock.UpdateRichValueFieldsMap: maps updated successfully, cells = {0}.",t.a()?t.a().f:0);this.bv=t.a()}},ce:function(n){var t,f;if(n&&n.Content){if(!n.Content.RichValueDomains){this.bu=null;return}var e=n.Content.RichValueDomains,l=this,i=new($$sc.y.$$($$sc.r.$$($$sc.r.$$(_Ewa.rj))))(function(){return new($$sc.r.$$($$sc.r.$$(_Ewa.rj)))});if(e.Rows)for(var o=e.Rows,h=o.length,r=0;r<h;++r)if(t=o[r],t.Cells){i.a().b(t.Idx,new($$sc.r.$$(_Ewa.rj)));for(var s=t.Cells,c=s.length,u=0;u<c;++u)f=s[u],i.a().a(t.Idx).b(f.Idx,f.Val)}this.bu=i.a()}},cd:function(n){var t,i;n&&n.Content&&(t=this,this.bx.f(n.Content.Ifmt,function(n){return n>=0}),i=this,this.bw.f(n.Content.FormulaValues,function(n){return!!n&&!!n.length}))},cr:function(){for(var n=this.H();n;)Sys.UI.DomElement.removeCssClass(n,"ewr-grid-zindex"),n=n.previousSibling},cg:function(n){var t=document.createElement("img"),r,i;return t.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=",t.style.display="none",t.setAttribute("blockHash",n),r=this,i=function(n){_Ewa.Gim.tduc(n)},t.onload=i,t}};_Ewa.FB=function(n,t){this.p=this.i;_Ewa.FB.resolveInheritance();this.d=this.B;_Ewa.FB.initializeBase(this,[document.createElement("div"),null]);this.bb=t;this.bf=new _Ewa.oR(t.b());this.bl(n)};_Ewa.FB.prototype={V:null,bf:null,o:function(){return-1},C:function(){return-1},X:null,b:function(){return this.X},bk:null,bg:null,W:null,m:function(){return this.W},bd:null,H:function(){return this.bd},bb:null,c:function(){return this.bb},be:null,h:function(){return this.be},x:function(){return this.Z},R:function(){return this.Y},Z:0,P:function(){return this.Z},Y:0,O:function(){return this.Y},bc:0,G:function(){return this.bc},q:function(){return!1},bj:!1,Q:function(){return this.bj},j:function(){return Diag.a.b(20821021,0,!1,"IViewBlock.Position shouldn't be called for GridViewRange instance"),null},A:function(){return Diag.a.b(40749217,0,!1,"IViewBlock.BlockPosition shouldn't be called for GridViewRange instance"),null},s:function(){return Diag.a.b(40749218,0,!1,"IViewBlock.WorkbookBackgroundColor shouldn't be called for GridViewRange instance"),"0xFFF"},a:function(){return Diag.a.b(20821022,0,!1,"IViewBlock.HashCode shouldn't be called for GridViewRange instance"),null},e:function(){return Diag.a.b(40749219,0,!1,"IViewBlock.BlockHashCode shouldn't be called for GridViewRange instance"),null},f:function(){return Diag.a.b(20821023,0,!1,"IViewBlock.BlockContainer shouldn't be called for GridViewRange instance"),null},n:function(){return Diag.a.b(20821024,0,!1,"IViewBlock.BlockFlow shouldn't be called for GridViewRange instance"),null},ba:0,y:function(){return this.ba},z:function(n){return this.ba=n,n},bh:null,S:function(n){return this.bh=n,n},bi:null,T:function(n){return this.bi=n,n},dispose:function(){_Ewa.hD.prototype.dispose.call(this)},l:function(n,t){return this.V.w(n,t)},g:function(n,t){return this.V.v(n,t)},i:function(n){return this.V.u(n)},k:function(n,t,i){return Diag.a.b(24933921,0,!i,"GridViewRange.GetCell should always be called with createDisconnected == false"),new _Ewa.bJ(this,this.V,this.bf,n,t)},r:function(){return new _Ewa.M(0,0)},v:function(n){return this.V.m(n)},w:function(n){return this.V.x(n)},J:function(){return-1},L:function(){return null},U:function(){return 0},K:function(){return 0},N:function(){},I:function(){return null},M:function(){},u:function(){},t:function(){},E:function(){},F:function(){},D:function(){return!1},bl:function(n){var t=n.Content;this.V=new _Ewa.gf(this);this.V.y(t);this.Z=t.Size[0];this.Y=t.Size[1];this.bk=this.V.c;this.bg=this.V.b;this.X=_Ewa.b.e(this.V.c,this.V.b);var i=n.PaneViewData,r=this.X.a,u=this.X.b,f=i?i.FirstScrollableRow:1,e=i?i.FirstScrollableColumn:1;this.bc=r<f&&u<e?2:r<f&&u>=e?3:r>=f&&u<e?4:1;_Ewa.a.k(this.dC,t.GridHtml);this.W=_Ewa.a.e(this.dC,"ewr-sheettable",!1);_Ewa.gf.b(this.W,t);this.be=_Ewa.gf.a(this.W);this.bd=_Ewa.a.a(this.W,"gridRows")}};_Ewa.tZ=function(n,t,i,r){_Ewa.tZ.initializeBase(this,[t,n.dJ,30,28,r,n.dD]);this.e=n;this.c=i;i&&(this.hf=new _Ewa.M(0,-2));this.m=new _Ewa.fZ(this.dC,3,null)};_Ewa.tZ.prototype={f:0,m:null,dz:function(){return this.c?"RowHeader":"ColumnHeader"},h:function(){return this.e.h()},cy:function(){return this.c||!this.e?_Ewa.mE.prototype.cy.call(this):this.e.cy()},eU:function(n){var t,i;for(_Ewa.mE.prototype.eU.call(this,n),t=this.$$ge();t.$$mn();)i=t.$$cu(),i.t(n);return n},bJ:function(){return this.c||!this.e?0:this.e.bJ()},c:!1,s:function(n){if(n=Math.max(Math.min(8,n),-1),n!==this.f){var t=this.n();this.f=n;Sys.UI.DomElement.addCssClass(this.dC,this.n());Sys.UI.DomElement.addCssClass(this.e.eI.D(),this.n());Sys.UI.DomElement.removeCssClass(this.dC,t);Sys.UI.DomElement.removeCssClass(this.e.eI.D(),t)}return n},e:null,n:function(){return(this.c?"ewrol-rmax":"ewrol-cmax")+this.f},dispose:function(){System.a.a(this.m);this.e=null;_Ewa.mE.prototype.dispose.call(this)},x:function(n){var t,r,i,u;if(_Ewa.B.c(this.e.dD.j()))for(t=this.$$ge();t.$$mn();)for(r=t.$$cu(),i=r.$$ge();i.$$mn();)u=i.$$cu(),u.bd(n)},jI:function(n){var i="",t=n.match(new RegExp("^(.*)_(\\d+)_(\\d+)_(\\d+)$","i"));return t&&t.length===5&&(Array.removeAt(t,0),t[this.c?1:2]="0",i=t.join("_")),i},r:function(n,t,i){if(!this.c){var r=this.hl(0);r.r(t,i)}},cA:function(n,t,i){return new _Ewa.it(n,t,_Ewa.bo.a(this.c?0:i.X,this.c?i.Y:0,this.dN))},ek:function(n,t,i){return this.c?_Ewa.gN.prototype.ek.call(this,n,0,0):_Ewa.gN.prototype.ek.call(this,0,t,i)},fb:function(){var n,t;if(_Ewa.gN.prototype.fb.call(this),!this.c)for(n=this.$$ge();n.$$mn();)t=n.$$cu(),t.s(this.bJ())},jJ:function(){for(var t=this.$$ge(),i,n,r;t.$$mn();)for(i=t.$$cu(),n=i.$$ge();n.$$mn();)r=n.$$cu(),r.E=-1}};_Ewa.it=function(n,t,i){var r,u;this.N=Function.createDelegate(this,this.bg);this.T=Function.createDelegate(this,this.ba);this.E=-2;_Ewa.it.resolveInheritance();this.q=this.bs;this.d=this.B;_Ewa.it.initializeBase(this,[n,t,n.b().e.dD.j(),i,n.b().e.dD.a(72)]);r="HeaderViewBlock";this.fC=r;this.w=[];u=this.s=this.G().e;this.t=this.G().c;this.K=this.s.dD.a(458);this.L=this.s.dD.isChangeGateEnabled("OfficeVSO:4243807_removeHeaderBlockDataNullCheck");this.v=u.iY(i,this.t);this.u=this.v.c;this.y=this.v.a;this.z=this.v.f();this.s.dD.r()&128&&(this.dK().a("mouseover",this.T,!1),Common.f.a().a("msospPointerOver",this.dC,this.N),Common.l.a().a("touchstart",this.dC,this.N))};_Ewa.it.c=function(n,t,i,r,u,f,e){return String.format('<div class="{0}" style="{1}:{2}px;{3}:{4}px"><div class="{5}">{6}<\/div><\/div>',f,t,i,r,u,n,e)};_Ewa.it.prototype={z:null,M:null,I:!1,J:!1,A:null,D:null,C:null,F:null,K:!1,L:!1,h:function(n){this.dG("ubhek",n)},g:function(n){this.dH("ubhek",n)},u:null,b:function(){return this.u},y:null,v:null,o:function(){return this.v},t:!1,l:function(){return this.t},w:null,e:function(){return this.w},dz:function(){return this.t?"RowHeaderBlk":"ColumnHeaderBlk"},x:function(){return this.t?_Ewa.a.A(this.G().dC):this.Y===-1?_Ewa.a.A(this.dC):this.Y},R:function(){return this.t?this.X===-1?_Ewa.a.D(this.dC):this.X:_Ewa.a.D(this.G().dC)},s:null,G:function(){return this.f()},dispose:function(){this.S();this.u=null;this.z=null;this.A=null;_Ewa.FJ.prototype.dispose.call(this)},p:function(){var n=this.w.length;return n?new _Ewa.it.b(this,n-1):null},c:function(n){for(var r,t=0,i=this.u.length;t<i;++t)if(r=this.w[t],_Ewa.a.h(r,n))return new _Ewa.it.b(this,t);return null},r:function(){return null},i:function(n){if(!this.z||!this.y)return null;var t=_Ewa.i.n(this.z,this.y,this.t?n.y:n.x,_Ewa.i.B);return t=t>=0?t:~t-1,t>=0?new _Ewa.it.b(this,t):null},m:function(n){if(!n.j())return null;var t=_Ewa.i.n(this.u,null,this.t?n.a:n.b,_Ewa.i.h);return t<0&&(t=Math.max(0,Math.min(this.u.length-1,~t))),new _Ewa.it.b(this,t)},bT:function(n){var t=n.a.a;switch(t.q){case 0:case 2:this.be(n);break;case 1:case 3:case 5:this.bh(n)}},bU:function(){},bl:function(){var n,t,u,e;if(this.F){n=window.performance;this.bk&&n.mark("HeaderViewBlock.ReplaceDOM start "+this.W);t=$$as(_Ewa.dp,this.s.dD.p().b("DOMUpdate","JS execution: "+this.eV()+": "+this.W));t.d();this.dE("ubhek",new _Ewa.vD(this),null);var f=this.F.cloneNode(!0),r=this.t?"ewr-rowhdrcontainer-brdr":"ewr-colhdrcontainer-brdr",i=_Ewa.a.e(this.dC,r,!1);this.cv(f,i);i=_Ewa.a.e(this.dC,r,!1);this.w=i?i.children:[];_Ewa.cf.a("HeaderViewBlock.ReplaceDOM elements part",this.s.dD.e().UserSessionId,this.s.dD.e().GridPerformanceImprovementType,this.W,t.b());this.bk&&n.mark("HeaderViewBlock.ReplaceDOM endreplace "+this.W);_Ewa.a.N(this.dC,!this.t,this.t?this.X:this.Y,!1);u=this.K?this.s.dM.d().a():[this.s.dM.a()];this.bd(u);this.s.fn?(e=this,t.g(function(){},!1)):t.a();_Ewa.cf.a("HeaderViewBlock.ReplaceDOM full",this.s.dD.e().UserSessionId,this.s.dD.e().GridPerformanceImprovementType,this.W,t.b());this.bk&&(n.mark("HeaderViewBlock.ReplaceDOM end "+this.W),n.measure("HeaderViewBlock.ReplaceDOM "+this.W,"HeaderViewBlock.ReplaceDOM start "+this.W,"HeaderViewBlock.ReplaceDOM endreplace "+this.W),n.measure("HeaderViewBlock.ReplaceDOM full "+this.W,"HeaderViewBlock.ReplaceDOM start "+this.W,"HeaderViewBlock.ReplaceDOM end "+this.W))}},k:function(n){var t=this.dC,i,f;if(n&&t&&t.firstChild&&n.length){this.S();i=t.firstChild.cloneNode();_Ewa.a.k(i,"");for(var u=n,e=u.length,r=0;r<e;++r)f=u[r],i.appendChild(f);t.replaceChild(i,t.firstChild);this.w=t.firstChild.children}},bd:function(n){var t,r;if(_Ewa.B.c(this.s.dD.j()))for(t=0,r=this.w.length;t<r;++t){var u=this.w[t],f=this.u[t],h=t<r-1?this.u[t+1]:f+1,e=this.H(n,f,h,this.t),i=u.className,c=Math.max(i.indexOf("pre-sel"),i.indexOf("pre-cellsel")),o=i.indexOf(" ",c),s=o>0?e+i.substr(o):e;s!==i&&(u.className=s)}},be:function(n){var i,h,c,l,a,r,y,f,p,e;if(!this.I&&this.U(n)&&(i=this.s,_Ewa.B.c(i.dD.j()))){var o=i.hQ(new _Ewa.bo(this.Z.Y,this.Z.X,this.Z.Y,this.Z.X,this.Z.PaneType)),s=this.K?i.dM.d().a():[i.dM.a()],t=new Sys.StringBuilder;if(t.append('<div class="'),t.append(this.t?'ewr-rowhdrcontainer-brdr" style="height:':'ewr-colhdrcontainer-brdr" style="width:'),this.L||this.v?t.append(this.v.b()):t.append(this.t?i.eq:i.ee),t.append('px;">'),this.L||this.v)for(this.t?(this.X=this.v.b(),h="ewr-rhc",c="height",l="top"):(this.Y=this.v.b(),h="ewr-chc",c="width",l=this.s.d()?"right":"left"),a=0,r=0;r<this.u.length;++r){var u=this.u[r],w=this.v.a[r],g=this.t?u.toString():_Ewa.o.b(u),b=r!==this.u.length-1?this.u[r+1]:u+1,nt=r?this.u[r-1]:u-1,k=u-nt>1,d=b-u>1,tt=this.H(s,u,b,this.t)+this.bf(k,d,this.t),v=w-1;v-=k?1:0;v-=d?1:0;t.append(_Ewa.it.c(h,c,v,l,a,tt,g));a+=w}else{if(this.t){for(y=0,f=o.a;f<=o.d;++f)t.append(_Ewa.it.c("ewr-rhc","height",19,"top",y,this.H(s,f,f+1,!0),f.toString())),y+=20;this.X=i.eq}else for(p=0,e=o.b;e<=o.c;++e)t.append(_Ewa.it.c("ewr-chc","width",63,this.s.d()?"right":"left",p,this.H(s,e,e+1,!1),_Ewa.o.b(e))),p+=64;this.Y=i.ee}t.append("<\/div>");this.I=!0;this.A=t.toString();this.bc(this.A)}},U:function(n){return!n.a.a.q&&this.E===-2?!0:n.a.a.n.Information.Revision>this.E},bh:function(n){var i,t,f,r,u;this.U(n)&&(i=n.a.a.n,t=i.Content,this.bn=n.a.a.I.c(),this.t?(this.u=t.RowNumbers,this.y=t.RowHeights,this.z=t.RowOffsets,this.s.dD.isChangeGateEnabled("OfficeVSO:4185972_GetHeaderBlockDataFromHeaderBlock")&&(this.v=new _Ewa.ri(t.RowHeights,t.RowNumbers)),this.X=t.Size[1]):(this.u=t.ColumnNumbers,this.y=t.ColumnWidths,this.z=t.ColumnOffsets,this.s.dD.isChangeGateEnabled("OfficeVSO:4185972_GetHeaderBlockDataFromHeaderBlock")&&(this.v=new _Ewa.ri(t.ColumnWidths,t.ColumnNumbers)),this.Y=t.Size[0]),Diag.a.b(36266759,0,!!this.z,"HeaderViewBlock.SetServerContent. gridOffsets is null. isRow: {0}. block position = {1}",this.t,this.Z),f=!!this.D,r=!1,this.A&&(u=this.t?t.RowHeaderHtml:t.ColumnHeaderHtml,_Ewa.e.b(this.A,u,!1)?(r=!0,_Ewa.it.a.h()):(_Ewa.it.a.i(),this.s.dD.a(782)&&Diag.a.a(594321729,0,50,"HeaderViewBlock: Incorrect header estimation found. Estimated data: {0}, Server data: {1}",this.A,u))),r||this.bc(this.t?t.RowHeaderHtml:t.ColumnHeaderHtml),f&&this.V(null),this.E=i.Information.Revision,this.J=!0,this.A=null,this.I=!1)},bc:function(n){this.S();var t=this.s.dD.p().b("DOMUpdate",this.eV());t.d();this.F=document.createElement("div");_Ewa.a.k(this.F,n);this.s.ed||this.bl();t.a();_Ewa.cf.a("HeaderViewBlock.SetBlockHTML",this.s.dD.e().UserSessionId,this.s.dD.e().GridPerformanceImprovementType,this.W,t.b())},S:function(){System.a.b([this.M,this.C]);this.M=null;this.C=null;this.D=null},bf:function(n,t,i){var r,u;return i?(r=" ewrch-row-hidden",u=" ewrch-row-hidden-pre"):(r=" ewrch-col-hidden",u=" ewrch-col-hidden-pre"),(n?r:"")+(t?u:"")},H:function(n,t,i,r){var u,f,e,o,s,h,c,l;if(this.s.dM.e()===1)if(r){if(u=this,Common.L.a(n,function(n){return n.k()&&n.bi(t)}))return"ewrch-row-sel";if(f=this,Common.L.a(n,function(n){return n.bi(t)}))return"ewrch-row-cellsel";if(e=this,Common.L.a(n,function(n){return n.k()&&n.bi(i)}))return"ewrch-row-nosel ewrch-row-pre-sel";if(o=this,Common.L.a(n,function(n){return n.bi(i)}))return"ewrch-row-nosel ewrch-row-pre-cellsel"}else{if(s=this,Common.L.a(n,function(n){return n.m()&&n.bh(t)}))return"ewrch-col-sel";if(h=this,Common.L.a(n,function(n){return n.bh(t)}))return"ewrch-col-cellsel";if(c=this,Common.L.a(n,function(n){return n.m()&&n.bh(i)}))return"ewrch-col-nosel ewrch-col-pre-sel";if(l=this,Common.L.a(n,function(n){return n.bh(i)}))return"ewrch-col-nosel ewrch-col-pre-cellsel"}return r?"ewrch-row-nosel":"ewrch-col-nosel"},ba:function(n){this.V(n)},bg:function(){return this.ba(null),!1},V:function(){if(!this.D&&this.s.dD.r()&128){this.C=new _Ewa.fK;this.D=_Ewa.l.a(Function,this.s.dD.b(),136,this.C.a(),0);var n=this;_Ewa.g.cw(this.D,function(t){n.M=t.a()(n.s,n)},this.C.a(),3)}}};_Ewa.it.b=function(n,t){this.i=t;this.h=n};_Ewa.it.b.prototype={i:0,h:null,d:function(){return this.h},e:function(){return _Ewa.a.A(this.h.w[this.i])},g:function(){return _Ewa.a.D(this.h.w[this.i])},bk:function(){return this.h.f().G()},a:function(){var n=this.h,t,i;return n.t?(t=n.u[this.i],new _Ewa.o(t,1,t,16384,!1,!0)):(i=n.u[this.i],new _Ewa.o(1,i,1048576,i,!1,!0))},b:function(){return this.h.w[this.i]},f:function(){var n=this.h.t?this.h.bb.d():this.h.bs();return this.h.z?this.h.z[this.i]+n:(Diag.a.a(36266760,0,10,"HeaderViewBlock.GetViewportOrigin: gridOffsets is null. block position = {0}",this.h.Z),n)},c:function(){return this.h.y?this.h.y[this.i]:(Diag.a.a(38367433,0,10,"HeaderViewBlock.GetGridExtent: GridExtents is null. block position = {0}",this.h.Z),-1)},bl:function(){}};_Ewa.it.a=function(){};_Ewa.it.a.h=function(){_Ewa.it.a.g(!0)};_Ewa.it.a.i=function(){_Ewa.it.a.g(!1)};_Ewa.it.a.g=function(n){_Ewa.it.a.f>=5||(n?(_Ewa.it.a.a++,_Ewa.it.a.c++):(_Ewa.it.a.b++,_Ewa.it.a.d++),(_Ewa.it.a.c+_Ewa.it.a.d)%_Ewa.it.a.e||(_Ewa.it.a.e*=2,_Ewa.it.a.f++,Diag.a.a(51709957,0,50,"HeaderViewBlock EstimationReporter: Correct:{0}, Incorrect:{1}, Total Correct:{2}, Total Incorrect: {3}",_Ewa.it.a.a,_Ewa.it.a.b,_Ewa.it.a.c,_Ewa.it.a.d),_Ewa.it.a.a=_Ewa.it.a.b=0))};_Ewa.FC=function(n,t){_Ewa.FC.initializeBase(this,[n,3,t])};_Ewa.FC.prototype={bv:function(){return new _Ewa.M(this.h().a().c(),this.e().a.b)},x:function(){return new _Ewa.M(this.e().a.a,0)},r:function(){return!0},m:function(){return new _Ewa.M(0,this.c.bm())},n:function(){return new _Ewa.M(this.h().d().a,0)},ek:function(n,t,i){return this.g()?(this.f(),_Ewa.gN.prototype.ek.call(this,Math.min(n,this.k()),t,i)):null},fb:function(){var n,t;for(_Ewa.gN.prototype.fb.call(this),n=this.$$ge();n.$$mn();)t=n.$$cu(),t.s(this.bJ())},f:function(){var t=this.c.bN(),i,r,n;if(t)for(i=t.b.X,r=t.a.X,n=0;n<=this.k();n++)_Ewa.gN.prototype.ek.call(this,n,i,r)}};_Ewa.iu=function(n,t,i,r){this.g=n;this.e=n.c();this.f=t;this.d=i;this.h=r;this.i=this.e.isChangeGateEnabled("OfficeVSO:4057732_ReducingAoi75Tag")};_Ewa.iu.b=function(n){var t=n.style,r=t.whiteSpace,u=t.overflow,f=t.width,i;return t.whiteSpace="nowrap",t.overflow="hidden",t.width="1px",i=n.scrollWidth,t.whiteSpace=r,t.overflow=u,t.width=f,i};_Ewa.iu.c=function(n,t){_Ewa.a.br(n,n.parentNode,t)};_Ewa.iu.prototype={e:null,g:null,f:null,d:null,h:!1,i:!1,b:function(){return"HtmlGridViewBlockRenderer"},c:function(){this.p(this.f.dC);this.n()},a:function(){Diag.a.b(593780814,1,!1,"HtmlGridViewBlockRenderer::RenderSkeleton - Skeleton should always be rendered with the canvas renderer")},dispose:function(){},p:function(n){var u,i,f,t,r,e;Diag.a.a(39916555,1,100,"HtmlGridViewBlockRenderer.UpdateHtmlDom: FreezePanesImprovements HashKey {0}",this.d);u=window.performance;this.h&&u.mark("HtmlGridViewBlockRenderer.UpdateHtmlDom start "+this.d);i=$$as(_Ewa.dp,this.e.p().b("DOMUpdate","JS execution: "+this.b()+": "+this.d));i.d();f=this.e.bX(128);t=f?this.g.b().a(this.d):null;t&&t.F?r=t.F.cloneNode(!0):(r=document.createElement("div"),_Ewa.a.k(r,this.f.bd.Content.GridHtml));_Ewa.gf.b(_Ewa.a.e(r,"ewr-sheettable",!1),this.f.bd.Content);_Ewa.z.a().c(this.o(r,n,this.e.p()),this.f.bn,_Ewa.bb.toString(0),_Ewa.bb.toString(0),!0);t&&!t.F;this.f.cu(n);this.h&&(u.mark("HtmlGridViewBlockRenderer.UpdateHtmlDom end "+this.d),u.measure("HtmlGridViewBlockRenderer.UpdateHtmlDom "+this.d,"HtmlGridViewBlockRenderer.UpdateHtmlDom start "+this.d,"HtmlGridViewBlockRenderer.UpdateHtmlDom end "+this.d));this.i?(e=this,i.g(function(){},!1)):i.a();_Ewa.cf.a("HtmlGridViewBlockRenderer.UpdateHtmlDom",this.e.e().UserSessionId,this.e.e().GridPerformanceImprovementType,this.d,i.b());this.g.b().u().d()},o:function(n,t,i){var u=this,r=function(t){_Ewa.a.I(t);_Ewa.a.bf(t,n)};return this.f.cb(this.f.W,t,r,i,this.b())},n:function(){var n=this.e.p().b("DOMUpdate",this.d+this.b());n.d();this.l();n.a();_Ewa.cf.a("HtmlGridViewBlockRenderer.RenderAdditionalDecorationStyles render gridlines",this.e.e().UserSessionId,this.e.e().GridPerformanceImprovementType,this.d,n.b())},l:function(){for(var e,o,s,h,f=this.f.dC.getElementsByClassName("ewrcp"),n=f.length,t=0,i=0,r=0,u=n-1;u>=0;u--)e=f[u],this.k(e,o={val:t},s={val:i},h={val:r}),t=o.val,i=s.val,r=h.val;n>0&&Diag.a.a(39916558,0,50,'HtmlGridViewBlockRenderer.DoClientFormatting: {{"ElementsCount":{0}, "VerticalWrapCount":{1}, "HorizontalFillCount":{2}, "shrinkToFitCount":{3}, "Stopwatch":{4}}',n,t,i,r,this.f.bn)},q:function(n){var t,i,u;_Ewa.iu.a||(_Ewa.iu.a=new RegExp("<br>","i"));var f=n.innerHTML.split(_Ewa.iu.a),r=f.length,o=n.parentNode.clientHeight/(n.scrollHeight+r),e=o*r-1;if(e>1){for(t=new Sys.StringBuilder("<table class='vertwrap'><tr>"),i=0;i<r;){for(t.append("<td>"),u=0;u<e;u++)i<r&&(t.append(f[i]),i++,i<r&&t.append("<br>"));t.append("<\/td>")}t.append("<\/tr><\/table>");n.innerHTML=t.toString()}},k:function(n,t,i,r){var u=!!n.getAttribute("VerticalWrapText"),f;n.getAttribute("HorizontalFill")&&(this.m(n),i.val++);n.getAttribute("ShrinkToFit")&&(f=u||!!n.getAttribute("VerticalText"),_Ewa.iu.c(n,f),r.val++);u&&(this.q(n),t.val++)},j:function(n,t){var r,i,u;if(n.nodeType===3&&n.nodeValue===t)return n;for(r=n.childNodes,i=r.length-1;i>=0;--i)if(u=this.j(r[i],t),u)return u;return null},m:function(n){var o=n.textContent,i=o||n.innerText,t,r,u;if(i.length&&n.offsetWidth&&n.scrollWidth&&(t=this.j(n,i),t)){var s=t.parentNode||n,f=_Ewa.iu.b(s),e=f?Math.floor(_Ewa.a.x(n.parentNode)/f):0;if(e>1){for(r=new Sys.StringBuilder,u=0;u<e;++u)r.append(i);t.nodeValue=r.toString()}}}};_Ewa.oT=function(n,t,i,r,u){_Ewa.oT.initializeBase(this,[!1]);this.k=n;this.h=t;this.f=u;this.j=r;this.g=_Ewa.f.p(i);this.c=u?0:i.length-1;this.m()};_Ewa.oT.prototype={h:null,c:0,f:!1,j:0,d:null,k:null,m:function(){this.d=new Array(this.g.length);for(var n=0;n<this.g.length;n++)this.d[n]=new _Ewa.dB(this.k,this.h,this.g[n],this.j,this.f)},e:function(){return this.d[this.c]},s:function(n){var r;this.f=n;for(var i=this.d,u=i.length,t=0;t<u;++t)r=i[t],r.c(n);return n},g:null,b:function(){return this.g},r:function(){return this.e().k()},$$cu:function(){return this.e().$$cu()},t:function(n){var r;this.j=n;for(var i=this.d,u=i.length,t=0;t<u;++t)r=i[t],r.e(n);return n},a:function(){return this.e().a()},dispose:function(){for(var i,t=this.d,r=t.length,n=0;n<r;++n)i=t[n],i.dispose();this.g=null},$$mn:function(){while(!this.e().$$mn())if((!this.f||this.c!==this.d.length-1)&&(this.f||this.c))this.c=this.f?this.c+1:this.c-1,this.e().$$rst();else return!1;return!0},n:function(n,t){return this.e().b(n,t)},q:function(){for(var i,t=this.d,r=t.length,n=0;n<r;++n)i=t[n],i.P()},$$rst:function(){this.c=this.f?0:this.d.length-1;this.e().$$rst()}};_Ewa.dB=function(n,t,i,r,u){this.F=Function.createDelegate(this,this.bf);this.G=Function.createDelegate(this,this.bg);this.N=Function.createDelegate(this,this.bh);this.M=Function.createDelegate(this,this.be);this.x={};_Ewa.dB.initializeBase(this,[n,i,t]);this.y=u;this.e(r);this.$$rst();this.f.W(this.M);this.f.c().a(120)&&this.f.b().y(this.N);this.H=this.f.c().a(871)};_Ewa.dB.prototype={n:null,y:!1,A:0,H:!1,h:function(){return this.y},c:function(n){var r;if(this.y!==n){if(this.y=n,this.n)for(var i=this.n,u=i.length,t=0;t<u;++t)r=i[t],r.b=n;this.p()&&this.R()}return n},t:function(){return this.A},e:function(n){return this.A!==n&&(this.A=n,this.B=this.A===1?_Ewa.jH.d:_Ewa.jH.e,this.Z()),n},bd:function(){var u=[],i,n;if(!this.n&&this.f){this.n=[];for(var r=this.f.H(),f=r.length,t=0;t<f;++t)i=r[t],n=new _Ewa.kZ(i,this.h()),n.$$rst(),n.$$mn(),Array.add(this.n,n),Array.add(u,i.dN)}return this.n},dispose:function(){this.f&&(this.f.b().l(this.G),this.f.b().b(this.F),this.f.T(this.M),this.f.c().a(120)&&this.f.b().D(this.N));this.x=null;this.n=null;_Ewa.jH.prototype.dispose.call(this)},$$mn:function(){return this.O(),_Ewa.jH.prototype.$$mn.call(this)},b:function(n,t){return this.X(n,t)},z:function(){this.x={};this.n=null;this.f&&(this.f.b().l(this.G),this.f.b().b(this.F))},bi:function(n){var i,r,t,u;if(n){for(i=[],r=this.i.a,t=0,u=this.o;t<u;++t)Array.add(i,r[t].a);Diag.a.a(1718759792,1,50,"LoadedRangeCellEnumerator.TraceLoadedRangeCellElements: id = {0}, Added cell ranges = {1}",this.r,i.join(","))}},X:function(n,t){if(this.O(),this.f){var i=this.f.b().e(n,!1);if(i)if(this.H){if(n=i.b().n(this.g),!n)return Diag.a.a(590436425,1,50,"LoadedRangeCellEnumerator.InternalMoveClosest: id = {0}. MoveClosest was called with a range that doesn't intersect the range of the enumerator. rangeCell full range = {1}, this.Range = {2}",this.r,i.b(),this.g),!1}else n=i.b()}return _Ewa.jH.prototype.b.call(this,n,t)},O:function(){var r,v,u,t,n,i,f,e,o,a,s;if(!this.n){r=[];v=this.bd();for(var y=v,k=y.length,c=0;c<k;++c)for(u=y[c],u.$$rst();u.$$mn();)for(var d=u.$$cu(),l=this.f.b(),p=d.$$ge();p.$$mn();){if(t=p.$$cu(),n=t.a(),t.Q()){Diag.a.a(42510562,1,50,"LoadedRangeCellEnumerator.PopulateCache: id = {0}, ViewBlock {1} was disposed. Ignoring this viewBlock.",this.r,n);continue}if(i=_Ewa.v.a(this.x,n,null),!i||!i.c.g(this.g)){if(f=l.s(n),!f){if(Diag.a.a(40722711,1,50,"LoadedRangeCellEnumerator.PopulateCache: blockModelProxy should not be null, id: {0}, blockHash: {1}, RenderingState = {2}",this.r,n,l.i()),l.h())continue;f=t}this.x[n]=i=new _Ewa.dB.a(this.g,t.j(),f)}Array.add(r,i)}for(this.i.f(),this.o=0,e=r.length-1;e>=0;--e)for(o=r[e],a=o.b,s=a.length-1;s>=0;--s){var h=a[s],w=this.H?new _Ewa.jH.a(h.a(!1).n(this.g),h,o.a):new _Ewa.jH.a(h.a(!1),h,o.a),b=_Ewa.f.f(w.a);this.i.d(b)||this.o++;this.i.c(b,w)}this.Z();this.f.b().j(this.G);this.f.b().c(this.F)}},Z:function(){this.R();this.i.h(this.B);this.bi(!1);this.q&&this.X(this.q,!0)},bg:function(){this.f&&this.f.Y()||this.z()},bf:function(){this.f&&this.f.Y()||this.z()},bh:function(){this.Y()},be:function(){this.f&&this.f.Y()&&this.Y()},Y:function(){Diag.a.a(592315919,1,50,"LoadedRangeCellEnumerator.ReinitializeCache: id = {0}",this.r);this.z();this.f&&this.O()}};_Ewa.dB.a=function(n,t,i){this.a=t;this.c=n.f();this.b=i.l(n,!1,!1)};_Ewa.dB.a.prototype={a:null,b:null,c:null};_Ewa.jH=function(n,t,i){_Ewa.jH.initializeBase(this,[!1]);this.r=n;this.i=new _Ewa.v(!0);this.g=t;this.f=i};_Ewa.jH.c=function(){return _Ewa.jH.b||(_Ewa.jH.b=new _Ewa.jH.a(null,null,null))};_Ewa.jH.e=function(n,t){var i=n.a,r=t.a;return _Ewa.i.h(i.a,r.a)?i.a-r.a:i.b-r.b};_Ewa.jH.d=function(n,t){var i=n.a,r=t.a;return _Ewa.i.h(i.b,r.b)?i.b-r.b:i.a-r.a};_Ewa.jH.prototype={r:null,k:function(){return this.Q().a},a:function(){return this.Q().c},$$cu:function(){var n=this.Q();return n.c?new _Ewa.jE(n.c,this.f):null},g:null,d:function(){return this.g},f:null,i:null,j:0,q:null,B:null,o:0,p:function(){return this.ba(this.j)},dispose:function(){this.P();this.i=null;this.f=null;this.g=null;this.B=null;_Ewa.ZU.prototype.dispose.call(this)},$$rst:function(){this.R();this.q=null},$$mn:function(){var n=this.j;return(this.m(),!this.p())?this.bj(n)?(this.q=this.i.a[this.j].a,!0):!1:!1},b:function(n,t){var u,i,r;return(Diag.a.b(592315918,1,!!n,"LoadedRangeCellEnumeratorBase.MoveClosest: id = {0}, range is null",this.r),!this.p()&&n.g(this.k()))?!0:(u=new _Ewa.ds(this.i.a),i=_Ewa.i.f(u,0,this.o,new _Ewa.jH.a(n,null,null),this.B),i>=0)?(this.j=i,this.q=this.i.a[this.j].a,!0):(r=~i,t&&r>=0&&r<this.o)?(this.j=r,this.q=this.i.a[this.j].a,!0):!1},P:function(){this.i&&(this.i.f(),this.o=0)},Q:function(){return this.p()?_Ewa.jH.c():this.i.a[this.j]},R:function(){this.j=this.h()?-1:this.o},m:function(){this.j=this.h()?Math.min(this.j+1,this.o):Math.max(-1,this.j-1)},bj:function(n){var r,u;if(this.ba(n))return!0;var t=this.i.a[n],i=this.i.a[this.j],f=!!t.b&&!!i.b;return f&&(r=Math.abs(t.b.Y-i.b.Y)>1&&t.c.h()===i.c.h(),u=Math.abs(t.b.X-i.b.X)>1&&t.c.i()===i.c.i(),r||u)?(Diag.a.a(42874893,1,50,"LoadedRangeCellEnumeratorBase.IsMoveNextWithinSequence blocks are not sequenced, MoveNext should return false. id = {0}, previous X: {1}, current X: {2}, previous Y: {3}, current Y: {4}",this.r,t.b.X,i.b.X,t.b.Y,i.b.Y),!1):!0},ba:function(n){return n<0||n>=this.o}};_Ewa.jH.a=function(n,t,i){this.c=t;this.a=n;this.b=i};_Ewa.jH.a.prototype={a:null,c:null,b:null};_Ewa.FE=function(n,t,i){this.i=n;this.o=t;this.p=i;this.h=new Array(0)};_Ewa.FE.prototype={i:null,o:null,p:null,l:"",j:"",h:null,e:function(){return this.h},m:null,d:function(){return this.m},b:function(n){return this.m=n,n},f:function(){return this.l+this.j},c:function(n,t){switch(t){case 3:this.r(n);break;case 0:this.n();this.k(n);break;case 1:this.k(n);break;case 4:this.n();break;default:Diag.a.b(50888711,0,!1,"RangePicker.UpdateSelection: Unsupported SelectionUpdateType = {0}",t)}},g:function(n){var r;this.n();for(var i=n,u=i.length,t=0;t<u;++t)r=i[t],this.k(r)},a:function(n){if(!_Ewa.bw.a(this.h)){var t=this.h[this.h.length-1];if(t.b===_Ewa.B.b(this.i.c().j()))return t.a}return n?this.i.F().a()?this.i.bC():this.i.a().b():null},n:function(){Array.clear(this.h);this.l="";this.j=""},k:function(n){Array.add(this.h,n);_Ewa.e.a(this.j)||(this.l+=this.j+this.p);this.j=this.q(n.a)},r:function(n){this.h.length?(this.h[this.h.length-1]=n,this.j=this.q(n.a)):this.k(n)},q:function(n){var t=this.i.F().e().K(),i=this.i.F().j(),r=this.i.g().n(n);return this.o(n,t,i,r)}};_Ewa.FG=function(n){var t,u;this.bw=Function.createDelegate(this,this.bI);this.bx=Function.createDelegate(this,this.bJ);this.by=Function.createDelegate(this,this.bK);this.bz=Function.createDelegate(this,this.bL);this.bv=Function.createDelegate(this,this.bs);this.br=[];_Ewa.FG.initializeBase(this,[!1]);this.be=n;this.bf=n.dD;t=_Ewa.o.a(1,1,!1);this.bf.a(458)&&(this.bd=new _Ewa.Fy(t));this.bm=new _Ewa.FE(this.be,this.bv,this.bf.e().ListSeparator);this.bg=new _Ewa.dj(this,this.be,t,this.bz,this.by,this.bx,this.bw);this.bi=new _Ewa.Fv(this,n);this.bj=1;this.bc=-1;this.bo=t;for(var r=n.eu,f=r.length,i=0;i<f;++i)u=r[i],Array.add(this.br,new _Ewa.tW(this.be,u.i(),10));this.bn=this.bf.bG()&&_Ewa.bm.a(this.bf.e(),10);this.be.eX.b("default");this.bp=new _Ewa.FH(this,this.bf);this.bu=new _Ewa.Qj(this.bf,this);this.bC()};_Ewa.FG.prototype={bi:null,bg:null,bf:null,be:null,bp:null,bu:null,bk:0,bt:null,h:function(n){this.dG("ACC",n)},j:function(n){this.dH("ACC",n)},z:function(n){this.dG("MT",n)},x:function(n){this.dH("MT",n)},H:function(n){this.dG("PD",n)},N:function(n){this.dH("PD",n)},I:function(n){this.dG("TE",n)},T:function(n){this.dG("DC",n)},g:function(n){this.dG("SC",n)},i:function(n){this.dH("SC",n)},s:function(n){this.dG("SS",n)},t:function(n){this.dH("SS",n)},l:function(n){this.dG("SE",n)},k:function(n){this.dH("SE",n)},D:function(n){this.dG("SA",n)},G:function(n){this.dH("SA",n)},c:function(){return this.bi},bh:null,b:function(){return this.bh},u:function(){if(this.bl||(this.bl=this.bh,this.bf.a(458)?this.bd.e():this.a().j()))return this.bl;var n=this.be.bB(this.bh);return n&&(this.bl=n.n(this.bf.a(458)?this.bd.c():this.a())),this.bl},a:function(){if(this.bf.a(458)){if(!this.bd.b()){var n=String.format("SelectionManager.SingleSelectedRange: Number of selected ranges: {0}",this.bd.d());_Ewa.ULSError.a(Error.invalidOperation(n),n,!1);Diag.a.b(594908960,0,!1,n)}return this.bd.c()}return this.bt},bd:null,d:function(){return this.bd},bm:null,v:function(){return this.bm},bc:0,q:function(){return this.bc},o:function(n){return this.bc=n,n},bo:null,n:function(){return this.bo},y:function(n){return this.bo=n,n},bj:0,e:function(){return this.bj},p:function(){return this.L(!1,!0)},A:function(){return this.V(!1,!0)},bn:!1,bl:null,K:function(){return this.bk},O:function(n){return this.bk=n,this.bu.f(),n},dispose:function(){System.a.b(this.br);this.br=null;this.be=null;_Ewa.cs.prototype.dispose.call(this)},S:function(n){this.bj=n},Y:function(){this.bl=null},J:function(){this.bm.c(null,4);this.bm.b(this.bh);this.bg.cj()},F:function(n){this.dE("MT",n,null)},bD:function(){if(this.bf.a(458)){var n=this;return Common.L.a(this.bd.a(),function(n){return n.b===1&&n.c===16384&&n.a===1&&n.d===1048576})}return this.a().b===1&&this.a().c===16384&&this.a().a===1&&this.a().d===1048576},bG:function(n,t,i,r){return this.be.m()||this.be.E()||this.be.et?!i:this.bi.l()?!0:this.bf.a(458)?r&&t?!0:!this.bd.h(n):!this.a().i(n)},C:function(){if(this.bf.a(458)){var n=this;return Common.L.a(this.bd.a(),function(t){return n.be.eg.e(t)})}return this.be.eg.e(this.a())},w:function(){if(this.bp.a!=null)return this.bp.a;var n=this.bf.a(458)?this.bd.e()||this.bd.b()&&this.be.eg.d(this.bd.c()):this.a().j()||this.be.eg.d(this.a());return this.bp.a=n,n},W:function(){this.bn||(this.bn=!0,this.be.dl(!1))},r:function(){return this.be.eg.i(this.bh,!1)},B:function(){return this.be.eg.h(this.bh)},R:function(n,t){this.bg.h(n,t,!0)},V:function(n,t){var i=this.bh;return _Ewa.f.v(i,this.bf,t,!1,n,!1)},L:function(n,t){var r,i,u;if(this.bf.a(458)){for(r=new Sys.StringBuilder,i=0;i<this.bd.d();i++){if(i&&r.append(this.bf.e().ListSeparator),u=this.bs(this.bd.a()[i],n,t,!1),!u)return Diag.a.b(595153929,0,!1,"SelectionManager.GetSelectedRangesString: rangeReferenceString is null, i = {0}",i),null;r.append(u)}return r.toString()}return this.bs(this.a(),n,t,!1)},M:function(n){this.bg.Q=n},f:function(n,t,i,r,u,f,e,o,s){s&&(n=this.bg.bd(n));var h=this.bq(),c=this.bf.a(458)&&(h||!this.bd.b()||r===1);this.bg.cg(n,t,i,r,u,f,e,c,o)},P:function(n,t,i,r,u,f,e,o,s){var h,l,c,a;if(!this.bf.a(458)){Diag.a.b(51663895,0,!1,"SelectionManager.SetSelection: DiscontinuousSelection is disabled");return}if(!_Ewa.f.u(n,!0)){Diag.a.b(51663896,0,!1,"SelectionManager.SetSelection: the selection is not valid");return}if(t<0||t>=n.length){Diag.a.b(51663897,0,!1,"SelectionManager.SetSelection: invalid indexOfActiveCell = {0}, when selection.Length = {1}",t,n.length);return}if(i&&!n[t].i(i)){Diag.a.b(51663898,0,!1,"SelectionManager.SetSelection: the new selected range at indexOfActiveRange = {0} is {1}, and it doesn't contain activeCell = {2}",t,n[t],i);return}if(s)for(h=0;h<n.length;h++)n[h]=this.bg.bd(n[h]);if(l=new _Ewa.bP(this.bf.f()),!l.j(n,this.be)){Diag.a.a(595343232,0,50,"SelectionManager.SetSelection: The new selection is not allowed due to sheet protection.");return}this.bq()?(c=!0,a=_Ewa.db.a(_Ewa.B.b(this.bf.j()),n),this.bm.g(a)):(c=!this.bd.b()||n.length!==1,this.bd.m(n,t));this.bg.cg(n[t],i,r,3,u,f,e,c,o)},E:function(n,t){switch(t){case-1714837581:var i=this.bk===1||this.bk===2;return this.O(i?0:2),Diag.a.a(594395540,0,50,"SelectionManager.HandleKeyDown: ToggleSelectionModeAddRange, new mode is {0}",_Ewa.yw.toString(this.bk)),!0;case 1872288872:return this.O(0),!1;case-764174209:return this.bA(!0),!0;case 1229311401:return this.bA(!1),!0;case-840507085:return this.bE(),!0;default:return this.bg.ct(n,t)}},X:function(n,t){return this.bg.bT(n,t)},U:function(n,t,i){this.bg.ck(n,t,i)},bB:function(n,t){return this.bg.bP(n,t)},m:function(n,t,i,r,u,f){return this.bg.V(n,t,i,r,u,f)},Z:function(n,t,i){return this.bg.bL(n,t,i)},bb:function(n,t){this.bg.bS(n,t)},Q:function(n,t,i){this.bg.p(n,t,i)},ba:function(){return this.bg.d},bE:function(){if(!this.be.m()&&!this.be.et){var n=this.bf.a(458)?this.bd.c():this.a(),t=_Ewa.f.t(this.be.X().u(n));t.j()||this.be.X().h(n)||this.be.o(_Ewa.f.a(n,this.bf),_Ewa.f.S(t,this.u()),null,null,60,_Ewa.C.W,3,!0,!0,null,!1,!0)}},bA:function(n){var i,r,t,u,f,e;if(!this.be.m()&&!this.be.et)for(i=this.be.X(),r=this.bd.a(),t=1;t<=this.bd.d();t++)if(u=(this.bd.f()+(n?t:this.bd.d()-t))%this.bd.d(),f=r[u],!i.h(f)){e=_Ewa.f.t(i.k(f.e(),!0));this.P(r,u,e,60,!0,_Ewa.C.bb,!1,!0,!0);return}},bs:function(n,t,i,r){var u=this.be.eg.d(n)?this.bg.bd(n).e():n;return _Ewa.f.v(u,this.bf,i,!1,t,r)},bL:function(n){this.bf.a(458)&&this.bd&&this.bd.g()||this.bq()||(this.bt=n)},bK:function(n){this.bf.a(458)&&this.bd&&this.bd.g()||(this.bq()?this.bm.b(n):(this.bm.b(n),this.bh=n))},bJ:function(n){return this.bf.a(458)&&this.bd.g()?(this.bd.k(n),!0):!1},bI:function(n,t,i){if(this.bk===2?(i||(i=1),this.O(1)):this.bk===1&&(i||(i=3)),this.bq()){this.bf.a(458)||(i=0);var r=$$as(_Ewa.J,this.bf.j()),u=r?r.h:null;this.bm.c(new _Ewa.db(n,u),i)}else this.bf.a(458)&&i!==5&&(this.bH(n,t,i)&&(i=2),this.bd.n(n,i))},bH:function(n,t,i){var r,u;return this.be.m()?!1:i===3&&this.bd.g()?!0:this.bk===1||this.bk===2?!1:i===1?n.k()&&this.bc===1?(r=_Ewa.o.f(t.a,t.a,!1),this.bd.h(r)):n.m()&&this.bc===2?(u=_Ewa.o.e(t.b,t.b,!1),this.bd.h(u)):this.bd.i(t):!1},bq:function(){return!!this.be&&(this.be.E()||this.be.et)},bC:function(){var n=Common.a.b().b().a("document"),t=this;n.f(function(){t.bF()})},bF:function(){this.bj===1?this.be.dD.isChangeGateEnabled("OfficeVSO:4217268_SetFocusKeepCurrentViewport")?this.be.bj():this.be.C(!0,!1):470&this.bj?this.bi.a()?this.bi.a().bb(!0):Diag.a.a(39920472,0,15,"SelectionManager.SetFocusToDocument: Can't return focus to document. Command selection mode is {0} but SelectedFloatingObjectControl is null",_Ewa.oz.a(this.bj)):this.bj===8||Diag.a.a(39920473,0,15,"SelectionManager.SetFocusToDocument: Don't know how to return focus to document. Command selection mode is {0}",_Ewa.oz.a(this.bj))}};_Ewa.FH=function(n,t){this.b=Function.createDelegate(this,this.c);n.g(this.b);t.c().p(this.b)};_Ewa.FH.prototype={a:null,c:function(){this.a=null}};_Ewa.FI=function(n,t){_Ewa.FI.initializeBase(this,[n,4,t])};_Ewa.FI.prototype={bv:function(){return new _Ewa.M(this.e().a.a,this.h().a().d())},x:function(){return new _Ewa.M(0,this.e().a.b)},m:function(){return new _Ewa.M(this.c.bm(),0)},n:function(){return new _Ewa.M(0,this.h().d().b)},ek:function(n,t,i){return this.g()?(this.f(),_Ewa.gN.prototype.ek.call(this,n,Math.min(t,this.j()),Math.min(i,this.j()))):null},f:function(){var t=this.c.bN(),i,r,n;if(t)for(i=t.b.Y,r=t.a.Y,n=i;n<=r;n++)_Ewa.gN.prototype.ek.call(this,n,0,this.j())}};_Ewa.FM=function(n){this.b={};this.c=n.dD.p().b("DOMUpdate","ViewportLoop");this.m(n.dD.e());this.h=n};_Ewa.FM.prototype={g:0,f:0,e:0,d:null,c:null,a:null,h:null,b:null,o:function(n,t,i){if(this.a)this.a.viewportConvergenceCycles++;else{this.c.d();var r=this;this.d=_Ewa.y.a().a(function(){r.n(String.format("{0} seconds from start without stop",r.e/1e3))},this.e,_Ewa.m.cz,!0,!0);this.a=new _Ewa.FN(_Ewa.u.a().a(),n,t,this.h,this.b,i)}},l:function(){return this.a?(this.a.viewportConvergenceFindRangeCalls++,this.a.viewportConvergenceFindRangeCalls):(Diag.a.b(42258497,1,!1,"ViewportLoop::RecordFindRange, failed to increment FindRangeCall count because loop start wasn't called"),0)},k:function(){return this.a?this.a.viewportConvergenceFindRangeCalls:0},p:function(n){if(!this.a){Diag.a.b(42231316,1,!1,"ViewportLoop::StopViewportConvergenceSampling, can't log the required telemetry because loop end is called without loop start");return}this.i(n);this.a.viewportConvergenceFindRangeCalls===1?this.a.d():this.a.viewportConvergenceFindRangeCalls>=this.g?this.a.b():this.a.viewportConvergenceCycles>=this.f&&this.a.c();this.c.a();this.a=null;this.d.dispose()},j:function(){this.d&&(Diag.a.a(50619076,1,50,"ViewportLoop.Dispose: disposing async timer of xloop"),this.d.dispose())},i:function(n){this.c?this.a.viewportConvergenceTime=this.c.b():Diag.a.b(42231317,1,!1,"ViewportLoop::StopViewportConvergenceSampling, ViewportConvergenceStopwatch is null, this is unexpected");this.a.convergenceScenario=n},n:function(n){this.i(n);this.a.b()},m:function(n){this.g=n.FindRangeThresholdForTelemetry;this.f=n.ConvergenceCyclesThresholdForTelemetry;this.e=n.TimeToLogUndetectedLoop;this.b.ServerDocId=n.DocumentHostInfo.ServerDocId;this.b.Browser=n.BrowserNameAndVersion;this.b.ClientVersion=n.BuildVersion}};_Ewa.FN=function(n,t,i,r,u,f){var e=!0,o,s;if(this.gotoCaller=f,this.startTime=n,this.targetSelection=isNullOrUndefined(t)?"undefined":t.toString(),this.sourceSelection=isNullOrUndefined(i)?"undefined":i.toString(),!r){this.a("GridViewIsNull");e=!1;return}this.scrollTop=r.ef();this.scrollLeft=r.el();this.visibleArea=isNullOrUndefined(r.h())||isNullOrUndefined(r.h().a())?"undefined":r.h().a().toString();this.currentNavigableRangePx=isNullOrUndefined(r.ec)?"undefined":r.ec.toString();o=r.eh;o&&(this.currentUsedRange=o.toString(),o.p().d>1e3&&o.p().c>1e3&&(e=!1));this.uiCulture=r.dD.e().UICultureTagLcid;try{s=Math.round(window.outerWidth/window.innerWidth*100);this.zoom=String.format("{0}%",s);Math.abs(s-100)>2&&(e=!1)}catch(h){this.zoom="Unavailable"}this.metadata=u;r.dR()?(r.dR().d&&(this.sheetProcessedData=_Ewa.zW.a(r.dR().a)),r.eT(r.h().f().b.a,!1)||(this.a("NoSheetProcessedDataForColumns"),r.ha(r.h().f().b.a,!1)&&(this.a("Reached max pixel for columns"),e=!1)),r.eT(r.h().f().b.b,!0)||(this.a("NoSheetProcessedDataForRows"),r.ha(r.h().f().b.b,!0)&&(this.a("Reached max pixel for rows"),e=!1))):this.a("NoSheetProcessedData");r.dD.c().z()&&(this.a("CoAuth"),e=!1);r.dI.e()&&(this.freezePaneData=String.format("FreezedCell: {0}, VisibleColumns: {1}, VisibleRows: {2}",_Ewa.o.a(r.dI.b,r.dI.d,!1).toString(),r.dI.h,r.dI.i),this.a("FreezePane"));r.d()&&(this.a("rtl"),e=!1);_Ewa.bq.b(r.dD)&&this.a("PageLoadedFromCache");r.eG()&&(this.a("NOV"),e=!1);r.dD.e().IsVersionHistorySession&&this.a("VersionHistorySession");e&&this.a("SimpleScenario");this.reloadCount=r.dD.F().c();this.reloadCount>1&&this.a("AfterReload")};_Ewa.FN.prototype={convergenceScenario:null,viewportConvergenceCycles:0,viewportConvergenceFindRangeCalls:0,viewportConvergenceTime:0,startTime:null,targetSelection:null,sourceSelection:null,scrollTop:0,scrollLeft:0,visibleArea:null,currentNavigableRangePx:null,currentUsedRange:null,tags:"",metadata:null,uiCulture:0,zoom:null,gotoCaller:null,freezePaneData:null,reloadCount:0,sheetProcessedData:null,d:function(){Diag.a.a(204268431,0,50,JSON.stringify(this))},b:function(){Diag.a.a(388817807,0,15,JSON.stringify(this))},c:function(){var n={ConvergenceScenario:this.convergenceScenario,StartTime:this.startTime,ViewportConvergenceCycles:this.viewportConvergenceCycles,ViewportConvergenceTime:this.viewportConvergenceTime};Diag.a.a(38064156,0,50,JSON.stringify(n))},a:function(n){this.tags+=_Ewa.e.a(this.tags)?n:String.format(", {0}",n)}};_Ewa.Qr=function(){this.lastCheckTime=null;this.lastSuccessfulCheckTime=null;this.successCount=0;this.blackPixelFailureCount=0;this.otherFailureCount=0};_Ewa.Qr.prototype={lastSuccessfulCheckTime:null,lastCheckTime:null,successCount:0,blackPixelFailureCount:0,otherFailureCount:0,a:function(){return"CanvasHealth"}};_Ewa.Qs=function(){this.maxFOInViewport=0;this.maxFOInCache=0;this.totalSvgShapesRendered=0;this.hitRate=0;this.veto=!1;this.typesRendered={};this.typesInViewportAtEndOfSession={};this.typesInCacheAtEndOfSession={};this.failureReasons={};this.allFloatingObjectsHaveLoaded=!0;this.floatingObjectControlsCreated=0;this.floatingObjectControlsLoaded=0;this.placeholders={};this.placeholders[_Ewa.ft.a().a]=0;this.placeholders[_Ewa.ft.b().a]=0;this.placeholders[_Ewa.ft.c().a]=0;this.placeholders[_Ewa.ft.d().a]=0};_Ewa.Qs.prototype={typesRendered:null,typesInViewportAtEndOfSession:null,typesInCacheAtEndOfSession:null,placeholders:null,maxFOInViewport:0,maxFOInCache:0,totalSvgShapesRendered:0,hitRate:0,veto:!1,vetoReason:null,failureReasons:null,slowestInSession:null,allFloatingObjectsHaveLoaded:!1,floatingObjectControlsCreated:0,floatingObjectControlsLoaded:0,a:function(){return"Floating Objects"}};_Ewa.Qt=function(n){this.f=n};_Ewa.Qt.prototype={f:null,d:0,c:0,e:0,g:0,b:null,a:function(){if(!this.b){this.b=new _Ewa.Qs;var n=this;this.f.b().c(_Ewa.hb,276,function(){_Ewa.gC.a(n.f).b(n.b)})}return this.b},n:function(n){var t=_Ewa.L.a(n);t in this.a().typesRendered||(this.a().typesRendered[t]=0);this.a().typesRendered[t]=this.a().typesRendered[t]+1;this.h(n,!1);n.u()&&this.a().totalSvgShapesRendered++},h:function(n,t){var i=_Ewa.L.a(n);i in this.a().typesInViewportAtEndOfSession||(this.a().typesInViewportAtEndOfSession[i]=0);this.a().typesInViewportAtEndOfSession[i]=this.a().typesInViewportAtEndOfSession[i]+1;this.d++;this.a().maxFOInViewport=this.d>this.a().maxFOInViewport?this.d:this.a().maxFOInViewport;t?this.e++:this.g++;this.p()},m:function(n){var t=_Ewa.L.a(n);t in this.a().typesInCacheAtEndOfSession||(this.a().typesInCacheAtEndOfSession[t]=0);this.a().typesInCacheAtEndOfSession[t]=this.a().typesInCacheAtEndOfSession[t]+1;this.c++;this.a().maxFOInCache=this.c>this.a().maxFOInCache?this.c:this.a().maxFOInCache},j:function(n){var t=_Ewa.L.a(n);Diag.a.b(39990410,5,t in this.a().typesInViewportAtEndOfSession&&this.a().typesInViewportAtEndOfSession[t]>0,"FloatingObjectSessionEndsReport.ReportFloatingObjectRemovedFromViewport: No floating objects of type {0} in the view port.",t);this.a().typesInViewportAtEndOfSession[t]=this.a().typesInViewportAtEndOfSession[t]-1;this.d--},i:function(n){var t=_Ewa.L.a(n);Diag.a.b(39990411,5,t in this.a().typesInCacheAtEndOfSession&&this.a().typesInCacheAtEndOfSession[t]>0,"FloatingObjectSessionEndsReport.ReportFloatingObjectRemovedFromCache: No floating objects of type {0} in the cache.",t);this.a().typesInCacheAtEndOfSession[t]=this.a().typesInCacheAtEndOfSession[t]-1;this.c--},l:function(n,t){t||this.a().veto||(this.a().veto=!0,this.a().vetoReason=n);n in this.a().failureReasons||(this.a().failureReasons[n]=0);this.a().failureReasons[n]=this.a().failureReasons[n]+1},q:function(n){(!this.a().slowestInSession||this.a().slowestInSession.e2ERenderingTime<n.e2ERenderingTime)&&(this.a().slowestInSession=_Ewa.po.a(n))},p:function(){this.a().hitRate=(this.e+this.g)?this.e/(this.e+this.g):0},k:function(n,t,i){this.a().allFloatingObjectsHaveLoaded=n;this.a().floatingObjectControlsCreated=t;this.a().floatingObjectControlsLoaded=i},o:function(n){this.a().placeholders[n.a]=this.a().placeholders[n.a]+1}};_Ewa.TG=function(){};_Ewa.TG.registerInterface("_Ewa.TG");_Ewa.TH=function(){};_Ewa.TH.registerInterface("_Ewa.TH");_Ewa.Ix=function(){};_Ewa.Ix.a=function(n,t,i,r,u,f){var e=n.a(1,f);return e.sheetName=t,_Ewa.j.a(n,"GetSheetProcessedData",e,i,r,u,132,null)};_Ewa.wi.registerClass("_Ewa.wi",_Ewa.hD);_Ewa.tK.registerClass("_Ewa.tK",_Ewa.baY);_Ewa.jH.registerClass("_Ewa.jH",_Ewa.ZU,_Ewa.ZC,Sys.IEnumerator$1,Sys.IDisposable);_Ewa.dB.registerClass("_Ewa.dB",_Ewa.jH);_Ewa.Gv.registerClass("_Ewa.Gv",_Ewa.dB);_Ewa.Gw.registerClass("_Ewa.Gw",_Ewa.dB);_Ewa.eX.registerClass("_Ewa.eX",null,Sys.IDisposable);_Ewa.eG.registerClass("_Ewa.eG",_Ewa.cs,_Ewa.IQ);_Ewa.gt.registerClass("_Ewa.gt",_Ewa.hD,_Ewa.bcB,Sys.IDisposable);_Ewa.Nh.a.registerClass("_Ewa.Nh.a");_Ewa.IE.registerClass("_Ewa.IE",null,Sys.IDisposable);_Ewa.Qj.registerClass("_Ewa.Qj",_Ewa.cs,Sys.IDisposable,_Ewa.vP,Common.IRootUser);_Ewa.LX.registerClass("_Ewa.LX");_Ewa.vc.registerClass("_Ewa.vc",null,_Ewa.vV);_Ewa.dj.registerClass("_Ewa.dj");_Ewa.Fo.registerClass("_Ewa.Fo",_Ewa.hD);_Ewa.tW.registerClass("_Ewa.tW",_Ewa.fZ);_Ewa.hv.a.registerClass("_Ewa.hv.a");_Ewa.hv.d.registerClass("_Ewa.hv.d");_Ewa.Fp.registerClass("_Ewa.Fp",_Ewa.cs,_Ewa.Zs,Sys.IDisposable);_Ewa.jF.registerClass("_Ewa.jF",_Ewa.bhS);_Ewa.gh.registerClass("_Ewa.gh",_Ewa.Xs,_Ewa.vV);_Ewa.gh.f.registerClass("_Ewa.gh.f");_Ewa.mC.registerClass("_Ewa.mC",_Ewa.fY,_Ewa.hw,_Ewa.bbO,Sys.IDisposable,_Ewa.ZE);_Ewa.mC.b.registerClass("_Ewa.mC.b");_Ewa.gN.registerClass("_Ewa.gN",_Ewa.SI,_Ewa.ZG,_Ewa.hL,Sys.IDisposable,Sys.IEnumerable$1);_Ewa.mE.registerClass("_Ewa.mE",_Ewa.gN);_Ewa.FA.registerClass("_Ewa.FA",_Ewa.mE);_Ewa.FA.a.registerClass("_Ewa.FA.a");_Ewa.FJ.registerClass("_Ewa.FJ",_Ewa.hD,_Ewa.ZF,Sys.IDisposable);_Ewa.ud.registerClass("_Ewa.ud",_Ewa.hD,_Ewa.ZH,Sys.IEnumerable$1,Sys.IDisposable);_Ewa.uf.registerClass("_Ewa.uf",_Ewa.hD,_Ewa.bdK);_Ewa.Fs.registerClass("_Ewa.Fs",_Ewa.ij,_Ewa.Zu,_Ewa.kb,Sys.IDisposable);_Ewa.oT.registerClass("_Ewa.oT",_Ewa.ZU,_Ewa.ZB,Sys.IEnumerator$1,Sys.IDisposable);_Ewa.Ft.registerClass("_Ewa.Ft",_Ewa.oT);_Ewa.Zo.registerClass("_Ewa.Zo",_Ewa.mE,_Ewa.bcx,_Ewa.ZD,_Ewa.ZG,_Ewa.hL,Sys.IDisposable,Sys.IEnumerable$1);_Ewa.Fu.registerClass("_Ewa.Fu",_Ewa.Zo);_Ewa.Fv.registerClass("_Ewa.Fv",_Ewa.cs);_Ewa.jE.registerClass("_Ewa.jE",null,_Ewa.oS);_Ewa.tZ.registerClass("_Ewa.tZ",_Ewa.mE);_Ewa.tX.registerClass("_Ewa.tX",_Ewa.tZ,_Ewa.bcx);_Ewa.bJ.registerClass("_Ewa.bJ",null,_Ewa.hx,_Ewa.FD);_Ewa.Fx.registerClass("_Ewa.Fx",_Ewa.hD);_Ewa.FF.registerClass("_Ewa.FF",_Ewa.o);_Ewa.FF.prototype.toString=_Ewa.o.prototype.toString;_Ewa.cf.registerClass("_Ewa.cf",_Ewa.FA,_Ewa.Zy,_Ewa.eD,_Ewa.Zr,_Ewa.ZD,_Ewa.ZG,_Ewa.hL,Sys.IDisposable,Sys.IEnumerable$1,_Ewa.vV);_Ewa.cf.o.registerClass("_Ewa.cf.o");_Ewa.cf.f.registerClass("_Ewa.cf.f",null,Sys.IDisposable,Sys.IEnumerable$1,Sys.IEnumerator$1);_Ewa.Zp.a.registerClass("_Ewa.Zp.a",_Ewa.qE.$$(Function));_Ewa.gg.registerClass("_Ewa.gg",_Ewa.FJ,_Ewa.jG,_Ewa.ZF,Sys.IDisposable,_Ewa.IO,_Ewa.ua,_Ewa.bbM);_Ewa.FB.registerClass("_Ewa.FB",_Ewa.hD,_Ewa.jG,_Ewa.ZF,Sys.IDisposable,_Ewa.IO,_Ewa.ua,_Ewa.bbM);_Ewa.it.registerClass("_Ewa.it",_Ewa.FJ,_Ewa.ZA,_Ewa.ZF,Sys.IDisposable);_Ewa.it.b.registerClass("_Ewa.it.b",null,_Ewa.Zz,_Ewa.FD);_Ewa.FC.registerClass("_Ewa.FC",_Ewa.Zo);_Ewa.dB.a.registerClass("_Ewa.dB.a");_Ewa.jH.a.registerClass("_Ewa.jH.a");_Ewa.FG.registerClass("_Ewa.FG",_Ewa.cs,_Ewa.bdq,_Ewa.bdp);_Ewa.FI.registerClass("_Ewa.FI",_Ewa.Zo);_Ewa.FN.registerClass("_Ewa.FN");_Ewa.eW.c=null;_Ewa.eW.b=null;_Ewa.eG.b={};_Ewa.eG.a=new($$sc.v.$$(_Ewa.fi));_Ewa.gt.d=[];_Ewa.gt.c=null;_Ewa.gt.b=null;_Ewa.dj.b=null;_Ewa.dj.c=null;_Ewa.hv.b=new _Ewa.W(0,0,0,0);_Ewa.bM.d=null;_Ewa.bM.i=($$t_0=new _Ewa.bM.e,$$t_0.a=new _Ewa.bs(255,0,0),$$t_0.b=0,$$t_0.c=0,$$t_0);_Ewa.bM.h=($$t_0=new _Ewa.bM.e,$$t_0.a=new _Ewa.bs(0,255,0),$$t_0.b=1,$$t_0.c=0,$$t_0);_Ewa.bM.g=($$t_0=new _Ewa.bM.e,$$t_0.a=new _Ewa.bs(0,0,255),$$t_0.b=0,$$t_0.c=1,$$t_0);_Ewa.bM.j=($$t_0=new _Ewa.bM.e,$$t_0.a=new _Ewa.bs(255,255,0),$$t_0.b=1,$$t_0.c=1,$$t_0);_Ewa.gh.a=null;_Ewa.FA.a.a=0;_Ewa.mE.a=null;_Ewa.bJ.g=null;_Ewa.bJ.d=null;_Ewa.bJ.a=null;_Ewa.bJ.e=null;_Ewa.bJ.f=null;_Ewa.cf.d=null;_Ewa.cf.c="";_Ewa.cf.e=!1;_Ewa.gg.a=new($$sc.y.$$(Boolean))(_Ewa.gg.c);_Ewa.it.a.a=0;_Ewa.it.a.c=0;_Ewa.it.a.b=0;_Ewa.it.a.d=0;_Ewa.it.a.e=10;_Ewa.it.a.f=0;_Ewa.iu.a=null;_Ewa.jH.b=null;_Ewa.Zp.b();